{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptography κΈ°μ΄ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">π </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">π’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        ν•κµ­μ–΄
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">β€οΈ</span>
                    <span class="theme-icon dark">π™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">Cryptography κΈ°μ΄</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Cryptography κΈ°μ΄</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/01_Security_Fundamentals.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security κΈ°μ΄μ™€ Threat Modeling</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/03_Hashing_and_Integrity.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">λ©μ°¨</a></li>
<li><a href="#1">1. μ•”νΈν•™ κ°μ”</a><ul>
<li><a href="#11">1.1 μ „μ²΄ κµ¬μ΅°</a></li>
<li><a href="#12">1.2 ν•µμ‹¬ κ°λ…</a></li>
<li><a href="#13-python-cryptography">1.3 Python Cryptography λΌμ΄λΈλ¬λ¦¬ μ„¤μ •</a></li>
</ul>
</li>
<li><a href="#2">2. λ€μΉ­ μ•”νΈν™”</a><ul>
<li><a href="#21-aes-advanced-encryption-standard">2.1 AES (Advanced Encryption Standard)</a></li>
<li><a href="#22-fernet">2.2 Fernet: λ†’μ€ μμ¤€μ λ€μΉ­ μ•”νΈν™”</a></li>
</ul>
</li>
<li><a href="#3">3. λΈ”λ΅ μ•”νΈ μ΄μ λ¨λ“</a><ul>
<li><a href="#31-ecb">3.1 ECB λ¨λ“ (μ λ€ μ‚¬μ©ν•μ§€ λ§μ„Έμ”)</a></li>
<li><a href="#32-cbc">3.2 CBC λ¨λ“ (λ κ±°μ‹, μ£Όμν•΄μ„ μ‚¬μ©)</a></li>
<li><a href="#33-ctr">3.3 CTR λ¨λ“</a></li>
</ul>
</li>
<li><a href="#4-aes-gcm">4. AES-GCM: ν„λ€ ν‘μ¤€</a><ul>
<li><a href="#41-aes-gcm">4.1 AES-GCM κµ¬ν„</a></li>
<li><a href="#42-aes-gcm">4.2 AES-GCMμ„ μ‚¬μ©ν• νμΌ μ•”νΈν™”</a></li>
</ul>
</li>
<li><a href="#5-chacha20-poly1305">5. ChaCha20-Poly1305</a><ul>
<li><a href="#51-chacha20-poly1305">5.1 ChaCha20-Poly1305 κµ¬ν„</a></li>
<li><a href="#52-xchacha20-poly1305-nonce">5.2 XChaCha20-Poly1305 (ν™•μ¥ Nonce)</a></li>
</ul>
</li>
<li><a href="#6">6. λΉ„λ€μΉ­ μ•”νΈν™”</a><ul>
<li><a href="#61">6.1 ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”</a></li>
</ul>
</li>
<li><a href="#7-rsa">7. RSA</a><ul>
<li><a href="#71-rsa">7.1 RSA ν‚¤ μƒμ„± λ° μ•”νΈν™”</a></li>
<li><a href="#72-rsa">7.2 RSA ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”</a></li>
</ul>
</li>
<li><a href="#8">8. νƒ€μ› κ³΅μ„  μ•”νΈν•™</a><ul>
<li><a href="#81-ecdsa">8.1 ECDSA (νƒ€μ› κ³΅μ„  λ””μ§€ν„Έ μ„λ… μ•κ³ λ¦¬μ¦)</a></li>
<li><a href="#82-ed25519">8.2 Ed25519 (ν„λ€ μ„λ… μ•κ³ λ¦¬μ¦)</a></li>
</ul>
</li>
<li><a href="#9">9. ν‚¤ κµν™</a><ul>
<li><a href="#91-diffie-hellman">9.1 Diffie-Hellman ν‚¤ κµν™</a></li>
<li><a href="#92-ecdh-diffie-hellman">9.2 ECDH (νƒ€μ› κ³΅μ„  Diffie-Hellman)</a></li>
<li><a href="#93-x25519">9.3 X25519 ν‚¤ κµν™</a></li>
</ul>
</li>
<li><a href="#10">10. λ””μ§€ν„Έ μ„λ…</a><ul>
<li><a href="#101">10.1 λ””μ§€ν„Έ μ„λ… μ‘λ™ λ°©μ‹</a></li>
<li><a href="#102">10.2 μ‹¤μµ: λ¬Έμ„ μ„λ… μ‹μ¤ν…</a></li>
</ul>
</li>
<li><a href="#11_1">11. μΌλ°μ μΈ ν•¨μ •κ³Ό ν”Όν•λ” λ°©λ²•</a><ul>
<li><a href="#111">11.1 μ•”νΈν•™μ μΉλ…μ μΈ μ£„μ•…</a></li>
<li><a href="#112-nonce">11.2 Nonce μ¬μ‚¬μ© μ¬μ•™</a></li>
<li><a href="#113-vs">11.3 μ•μ „ν• λ‚μ vs μ•μ „ν•μ§€ μ•μ€ λ‚μ</a></li>
</ul>
</li>
<li><a href="#12_1">12. ν„λ€ κ¶μ¥ μ‚¬ν•­</a><ul>
<li><a href="#121-2025">12.1 μ•κ³ λ¦¬μ¦ μ„ νƒ κ°€μ΄λ“ (2025+)</a></li>
<li><a href="#122">12.2 ν‚¤ ν¬κΈ° κ¶μ¥ μ‚¬ν•­</a></li>
<li><a href="#123">12.3 μ–‘μ μ΄ν›„ μ•”νΈν•™</a></li>
</ul>
</li>
<li><a href="#13">13. μ—°μµ λ¬Έμ </a><ul>
<li><a href="#1_1">μ—°μµ λ¬Έμ  1: λ€μΉ­ μ•”νΈν™” (μ΄κΈ‰)</a></li>
<li><a href="#2_1">μ—°μµ λ¬Έμ  2: ν•μ΄λΈλ¦¬λ“ μ•”νΈν™” (μ¤‘κΈ‰)</a></li>
<li><a href="#3_1">μ—°μµ λ¬Έμ  3: ν‚¤ κµν™ ν”„λ΅ν† μ½ (μ¤‘κΈ‰)</a></li>
<li><a href="#4-nonce">μ—°μµ λ¬Έμ  4: Nonce μ¬μ‚¬μ© κ³µκ²© (κ³ κΈ‰)</a></li>
<li><a href="#5">μ—°μµ λ¬Έμ  5: λ””μ§€ν„Έ μ„λ… κ²€μ¦ (κ³ κΈ‰)</a></li>
<li><a href="#6_1">μ—°μµ λ¬Έμ  6: μ•”νΈν•™μ  κ°μ‚¬ (κ³ κΈ‰)</a></li>
</ul>
</li>
<li><a href="#14">14. μ°Έκ³  μλ£</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="cryptography">Cryptography κΈ°μ΄<a class="header-link" href="#cryptography" title="Permanent link">&para;</a></h1>
<p><strong>μ΄μ „</strong>: <a href="./01_Security_Fundamentals.md">01. Security κΈ°μ΄</a> | <strong>λ‹¤μ</strong>: <a href="./03_Hashing_and_Integrity.md">03. Hashingκ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</a></p>
<hr />
<p>μ•”νΈν•™μ€ μλ„λ λ‹Ήμ‚¬μλ§ μ ‘κ·Όν•  μ μλ„λ΅ ν†µμ‹ κ³Ό λ°μ΄ν„°λ¥Ό λ³΄νΈν•λ” κ΄€ν–‰μ…λ‹λ‹¤. μ΄ λ μ¨μ€ ν„λ€ μ•”νΈν•™μ λ‘ κ°€μ§€ μ£Όμ” λ¶„μ•ΌμΈ λ€μΉ­ λ° λΉ„λ€μΉ­ μ•”νΈν™”μ™€ ν‚¤ κµν™ ν”„λ΅ν† μ½, λ””μ§€ν„Έ μ„λ…, κ·Έλ¦¬κ³  μ‹¤μ©μ μΈ Python κµ¬ν„μ„ λ‹¤λ£Ήλ‹λ‹¤. μ΄ λ μ¨μ΄ λλ‚λ©΄ μ£Όμ–΄μ§„ λ¬Έμ μ— λ€ν•΄ μ¬λ°”λ¥Έ μ•”νΈν™” κΈ°λ³Έ μ”μ†λ¥Ό μ„ νƒν•κ³  κ°€μ¥ μΌλ°μ μΈ ν•¨μ •μ„ ν”Όν•  μ μκ² λ©λ‹λ‹¤.</p>
<p><strong>λ‚μ΄λ„</strong>: β­β­β­</p>
<p><strong>ν•™μµ λ©ν‘</strong>:
- λ€μΉ­ λ° λΉ„λ€μΉ­ μ•”νΈν™”μ μ°¨μ΄μ  μ΄ν•΄ν•κΈ°
- Pythonμ—μ„ AES-GCMκ³Ό ChaCha20-Poly1305 μ•”νΈν™” κµ¬ν„ν•κΈ°
- λΉ„λ€μΉ­ μ•”νΈν•™μ„ μ„ν• RSA, ECDSA, Ed25519 μ΄ν•΄ν•κΈ°
- Diffie-Hellmanκ³Ό ECDH ν‚¤ κµν™ κµ¬ν„ν•κΈ°
- λ””μ§€ν„Έ μ„λ… μƒμ„± λ° κ²€μ¦ν•κΈ°
- μΌλ°μ μΈ μ•”νΈν•™μ  ν•¨μ • μΈμ‹ν•κ³  ν”Όν•κΈ°
- ν„λ€ μ•”νΈν•™ κ¶μ¥ μ‚¬ν•­ μ μ©ν•κΈ°</p>
<hr />
<h2 id="_1">λ©μ°¨<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-μ•”νΈν•™-κ°μ”">μ•”νΈν•™ κ°μ”</a></li>
<li><a href="#2-λ€μΉ­-μ•”νΈν™”">λ€μΉ­ μ•”νΈν™”</a></li>
<li><a href="#3-λΈ”λ΅-μ•”νΈ-μ΄μ-λ¨λ“">λΈ”λ΅ μ•”νΈ μ΄μ λ¨λ“</a></li>
<li><a href="#4-aes-gcm-ν„λ€-ν‘μ¤€">AES-GCM: ν„λ€ ν‘μ¤€</a></li>
<li><a href="#5-chacha20-poly1305">ChaCha20-Poly1305</a></li>
<li><a href="#6-λΉ„λ€μΉ­-μ•”νΈν™”">λΉ„λ€μΉ­ μ•”νΈν™”</a></li>
<li><a href="#7-rsa">RSA</a></li>
<li><a href="#8-νƒ€μ›-κ³΅μ„ -μ•”νΈν•™">νƒ€μ› κ³΅μ„  μ•”νΈν•™</a></li>
<li><a href="#9-ν‚¤-κµν™">ν‚¤ κµν™</a></li>
<li><a href="#10-λ””μ§€ν„Έ-μ„λ…">λ””μ§€ν„Έ μ„λ…</a></li>
<li><a href="#11-μΌλ°μ μΈ-ν•¨μ •κ³Ό-ν”Όν•λ”-λ°©λ²•">μΌλ°μ μΈ ν•¨μ •κ³Ό ν”Όν•λ” λ°©λ²•</a></li>
<li><a href="#12-ν„λ€-κ¶μ¥-μ‚¬ν•­">ν„λ€ κ¶μ¥ μ‚¬ν•­</a></li>
<li><a href="#13-μ—°μµ-λ¬Έμ ">μ—°μµ λ¬Έμ </a></li>
<li><a href="#14-μ°Έκ³ -μλ£">μ°Έκ³  μλ£</a></li>
</ol>
<hr />
<h2 id="1">1. μ•”νΈν•™ κ°μ”<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 μ „μ²΄ κµ¬μ΅°<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    ν„λ€ μ•”νΈν•™ λ¶„λ¥                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  Cryptography                                                        β”‚
β”‚  β”β”€β”€ Symmetric (κ³µμ  ν‚¤)                                             β”‚
β”‚  β”‚   β”β”€β”€ Block Ciphers                                               β”‚
β”‚  β”‚   β”‚   β”β”€β”€ AES (128/192/256-bit key)                               β”‚
β”‚  β”‚   β”‚   β”β”€β”€ Modes: ECB, CBC, CTR, GCM, CCM                        β”‚
β”‚  β”‚   β”‚   β””β”€β”€ Legacy: DES, 3DES, Blowfish (ν”Όν•  κ²ƒ)                  β”‚
β”‚  β”‚   β””β”€β”€ Stream Ciphers                                              β”‚
β”‚  β”‚       β”β”€β”€ ChaCha20(-Poly1305)                                    β”‚
β”‚  β”‚       β””β”€β”€ Legacy: RC4 (κΉ¨μ§, ν”Όν•  κ²ƒ)                            β”‚
β”‚  β”‚                                                                   β”‚
β”‚  β”β”€β”€ Asymmetric (κ³µκ°/κ°μΈ ν‚¤ μ)                                    β”‚
β”‚  β”‚   β”β”€β”€ Encryption                                                  β”‚
β”‚  β”‚   β”‚   β”β”€β”€ RSA-OAEP                                               β”‚
β”‚  β”‚   β”‚   β””β”€β”€ ECIES (Elliptic Curve Integrated Encryption)           β”‚
β”‚  β”‚   β”β”€β”€ Digital Signatures                                          β”‚
β”‚  β”‚   β”‚   β”β”€β”€ RSA-PSS                                                β”‚
β”‚  β”‚   β”‚   β”β”€β”€ ECDSA (secp256r1, secp384r1)                          β”‚
β”‚  β”‚   β”‚   β””β”€β”€ Ed25519 / Ed448                                       β”‚
β”‚  β”‚   β””β”€β”€ Key Exchange                                                β”‚
β”‚  β”‚       β”β”€β”€ Diffie-Hellman (DH)                                    β”‚
β”‚  β”‚       β”β”€β”€ ECDH (X25519, P-256)                                   β”‚
β”‚  β”‚       β””β”€β”€ Post-quantum: ML-KEM (CRYSTALS-Kyber)                 β”‚
β”‚  β”‚                                                                   β”‚
β”‚  β”β”€β”€ Hash Functions (λ μ¨ 03μ—μ„ λ‹¤λ£Έ)                               β”‚
β”‚  β”‚   β”β”€β”€ SHA-2 (SHA-256, SHA-512)                                   β”‚
β”‚  β”‚   β”β”€β”€ SHA-3 (Keccak)                                             β”‚
β”‚  β”‚   β””β”€β”€ BLAKE2/BLAKE3                                              β”‚
β”‚  β”‚                                                                   β”‚
β”‚  β””β”€β”€ Key Derivation Functions                                        β”‚
β”‚      β”β”€β”€ HKDF                                                        β”‚
β”‚      β”β”€β”€ PBKDF2                                                      β”‚
β”‚      β””β”€β”€ scrypt / Argon2 (λΉ„λ°€λ²νΈ κΈ°λ°)                            β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="12">1.2 ν•µμ‹¬ κ°λ…<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    ν•µμ‹¬ μ•”νΈν•™ κ°λ…                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ©μ–΄               β”‚ μ •μ                                           β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ Plaintext          β”‚ μ›λ³Έ, μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°                   β”‚
β”‚ Ciphertext         β”‚ μ•”νΈν™”λ (μ½μ„ μ μ—†λ”) μ¶λ ¥                   β”‚
β”‚ Key                β”‚ μ•”νΈν™”/λ³µνΈν™”μ— μ‚¬μ©λλ” λΉ„λ°€ κ°’               β”‚
β”‚ Nonce / IV         β”‚ ν• λ²λ§ μ‚¬μ©λλ” μ«μ; λ™μΌν• ν‰λ¬Έμ΄           β”‚
β”‚                    β”‚ λ™μΌν• μ•”νΈλ¬Έμ„ μƒμ„±ν•λ” κ²ƒμ„ λ°©μ§€             β”‚
β”‚ Authenticated enc. β”‚ λ¬΄κ²°μ„±λ„ κ²€μ¦ν•λ” μ•”νΈν™” (AEAD)               β”‚
β”‚ Key derivation     β”‚ λΉ„λ°€λ²νΈλ‚ λ‹¤λ¥Έ ν‚¤λ΅λ¶€ν„°                       β”‚
β”‚                    β”‚ μ•”νΈν™” ν‚¤λ¥Ό μ λ„                               β”‚
β”‚ Forward secrecy    β”‚ μ¥κΈ° ν‚¤μ μΉ¨ν•΄κ°€ κ³Όκ±°                          β”‚
β”‚                    β”‚ μ„Έμ… ν‚¤λ¥Ό μΉ¨ν•΄ν•μ§€ μ•μ                        β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="13-python-cryptography">1.3 Python Cryptography λΌμ΄λΈλ¬λ¦¬ μ„¤μ •<a class="header-link" href="#13-python-cryptography" title="Permanent link">&para;</a></h3>
<p>μ΄ λ μ¨μ λ¨λ“  μ½”λ“ μμ λ” λ†’μ€ μμ¤€μ λ μ‹ν”Όμ™€ λ‚®μ€ μμ¤€μ κΈ°λ³Έ μ”μ†λ¥Ό μ κ³µν•λ” <code>cryptography</code> λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>cryptography
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Verify installation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cryptography</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cryptography version: </span><span class="si">{</span><span class="n">cryptography</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># The library has two main layers:</span>
<span class="c1"># 1. High-level (recipes): cryptography.fernet, cryptography.hazmat.primitives.kdf</span>
<span class="c1"># 2. Low-level (hazmat): cryptography.hazmat.primitives.ciphers, asymmetric, etc.</span>
<span class="c1">#</span>
<span class="c1"># &quot;hazmat&quot; stands for &quot;hazardous materials&quot; - these primitives can be</span>
<span class="c1"># misused. Always prefer high-level APIs when available.</span>
</code></pre></div>

<hr />
<h2 id="2">2. λ€μΉ­ μ•”νΈν™”<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<p>λ€μΉ­ μ•”νΈν™”λ” μ•”νΈν™”μ™€ λ³µνΈν™” λ¨λ‘μ— λ™μΌν• ν‚¤λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. λΉ λ¥΄κ³  λ€λ‰μ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ” λ° μ ν•©ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚Plaintext β”‚β”€β”€Keyβ”€β”€β–¶β”‚ Encrypt  β”‚β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚Ciphertextβ”‚
β”‚ &quot;Hello&quot;  β”‚         β”‚ (AES)    β”‚         β”‚ 0xA3F1.. β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚Ciphertextβ”‚β”€β”€Keyβ”€β”€β–¶β”‚ Decrypt  β”‚β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚Plaintext β”‚
β”‚ 0xA3F1.. β”‚         β”‚ (AES)    β”‚         β”‚ &quot;Hello&quot;  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

         λ‘ μ‘μ—… λ¨λ‘ λ™μΌν• ν‚¤ μ‚¬μ©!
</code></pre></div>

<h3 id="21-aes-advanced-encryption-standard">2.1 AES (Advanced Encryption Standard)<a class="header-link" href="#21-aes-advanced-encryption-standard" title="Permanent link">&para;</a></h3>
<p>AESλ” κ°€μ¥ λ„λ¦¬ μ‚¬μ©λλ” λ€μΉ­ μ•”νΈμ…λ‹λ‹¤. 128λΉ„νΈ λΈ”λ΅μ—μ„ μ‘λ™ν•λ©° 128, 192 λλ” 256λΉ„νΈμ ν‚¤ ν¬κΈ°λ¥Ό μ§€μ›ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                         AES ν‚¤ ν¬κΈ°                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν‚¤ ν¬κΈ°  β”‚ λΌμ΄λ“   β”‚ λ³΄μ•     β”‚ μ‚¬μ© μ‚¬λ΅€                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 128-bit  β”‚ 10       β”‚ ~128 bit β”‚ λ²”μ©, λΉ λ¦„                         β”‚
β”‚ 192-bit  β”‚ 12       β”‚ ~192 bit β”‚ μ‹¤μ λ΅ κ±°μ μ‚¬μ©λμ§€ μ•μ          β”‚
β”‚ 256-bit  β”‚ 14       β”‚ ~256 bit β”‚ μ •λ¶€/κµ°μ‚¬, μ–‘μ μ΄ν›„               β”‚
β”‚          β”‚          β”‚          β”‚ μ €ν•­ λ§μ§„                          β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="22-fernet">2.2 Fernet: λ†’μ€ μμ¤€μ λ€μΉ­ μ•”νΈν™”<a class="header-link" href="#22-fernet" title="Permanent link">&para;</a></h3>
<p>κ°„λ‹¨ν• μ‚¬μ© μ‚¬λ΅€μ κ²½μ° <code>Fernet</code> ν΄λμ¤λ” κ°„λ‹¨ν• APIλ΅ μΈμ¦λ μ•”νΈν™”λ¥Ό μ κ³µν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.fernet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

<span class="c1"># Generate a random key (URL-safe base64 encoded)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key: </span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="si">}</span><span class="s2"> bytes = &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>

<span class="c1"># Create cipher</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Encrypt</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Sensitive financial data: account balance $50,000&quot;</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plaintext:  </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="p">[:</span><span class="mi">60</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">decrypted</span> <span class="o">==</span> <span class="n">plaintext</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted:  </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fernet includes a timestamp - you can set a TTL (time-to-live)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;temporary secret&quot;</span><span class="p">)</span>
<span class="c1"># time.sleep(2)  # Uncomment to test expiration</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># Valid for 60 seconds</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Token is still valid&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Token expired: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Fernetμ΄ λ‚΄λ¶€μ μΌλ΅ ν•λ” μΌ:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">λλ¤</span><span class="w"> </span><span class="mf">128</span><span class="n">λΉ„νΈ</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="n">μƒμ„±</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">AES</span><span class="o">-</span><span class="mf">128</span><span class="o">-</span><span class="n">CBCλ΅</span><span class="w"> </span><span class="n">μ•”νΈν™”</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">HMAC</span><span class="o">-</span><span class="n">SHA256μΌλ΅</span><span class="w"> </span><span class="n">μΈμ¦</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">μ—°κ²°</span><span class="p">:</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="err">||</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="err">||</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="err">||</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="err">||</span><span class="w"> </span><span class="n">HMAC</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">κ²°κ³Όλ¥Ό</span><span class="w"> </span><span class="n">Base64</span><span class="w"> </span><span class="n">μΈμ½”λ”©</span>
</code></pre></div>

<hr />
<h2 id="3">3. λΈ”λ΅ μ•”νΈ μ΄μ λ¨λ“<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<p>λΈ”λ΅ μ•”νΈ(AES κ°™μ€)λ” κ³ μ • ν¬κΈ° λΈ”λ΅μ„ μ•”νΈν™”ν•©λ‹λ‹¤. μ΄μ λ¨λ“λ” ν• λΈ”λ΅λ³΄λ‹¤ κΈ΄ λ©”μ‹μ§€λ¥Ό μ²λ¦¬ν•λ” λ°©λ²•μ„ μ •μν•©λ‹λ‹¤.</p>
<h3 id="31-ecb">3.1 ECB λ¨λ“ (μ λ€ μ‚¬μ©ν•μ§€ λ§μ„Έμ”)<a class="header-link" href="#31-ecb" title="Permanent link">&para;</a></h3>
<p>ECB(Electronic Codebook)λ” κ° λΈ”λ΅μ„ λ…λ¦½μ μΌλ΅ μ•”νΈν™”ν•©λ‹λ‹¤. λ™μΌν• ν‰λ¬Έ λΈ”λ΅μ€ λ™μΌν• μ•”νΈλ¬Έ λΈ”λ΅μ„ μƒμ„±ν•μ—¬ ν¨ν„΄μ„ λ…Έμ¶ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">                    </span><span class="n">ECB</span><span class="w"> </span><span class="n">λ¨λ“</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">μ™</span><span class="w"> </span><span class="n">κΉ¨μ΅λ”κ°€</span><span class="w">                         </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">ν‰λ¬Έ</span><span class="w"> </span><span class="nl">λΈ”λ΅</span><span class="p">:</span><span class="w">       </span><span class="o">[</span><span class="n">AAAA</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">BBBB</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">AAAA</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">CCCC</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">AAAA</span><span class="o">]</span><span class="w">            </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">              </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                     </span><span class="n">AES</span><span class="w">    </span><span class="n">AES</span><span class="w">    </span><span class="n">AES</span><span class="w">    </span><span class="n">AES</span><span class="w">    </span><span class="n">AES</span><span class="w">             </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">      </span><span class="err">β”‚</span><span class="w">              </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μ•”νΈλ¬Έ</span><span class="w"> </span><span class="nl">λΈ”λ΅</span><span class="p">:</span><span class="w">     </span><span class="o">[</span><span class="n">X1X1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Y2Y2</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">X1X1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Z3Z3</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">X1X1</span><span class="o">]</span><span class="w">           </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="nl">λ¬Έμ </span><span class="p">:</span><span class="w"> </span><span class="n">λ™μΌν•</span><span class="w"> </span><span class="n">ν‰λ¬Έ</span><span class="w"> </span><span class="n">λΈ”λ΅</span><span class="w"> </span><span class="err">β†’</span><span class="w"> </span><span class="n">λ™μΌν•</span><span class="w"> </span><span class="n">μ•”νΈλ¬Έ</span><span class="err">!</span><span class="w">                        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">κ³µκ²©μλ”</span><span class="w"> </span><span class="n">λ³µνΈν™”</span><span class="w"> </span><span class="n">μ—†μ΄</span><span class="w"> </span><span class="n">ν¨ν„΄μ„</span><span class="w"> </span><span class="n">λ³Ό</span><span class="w"> </span><span class="n">μ</span><span class="w"> </span><span class="n">μμµλ‹λ‹¤</span><span class="p">.</span><span class="w">                    </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">κ³ μ „μ </span><span class="w"> </span><span class="nl">μ</span><span class="p">:</span><span class="w"> </span><span class="n">ECB</span><span class="w"> </span><span class="n">μ•”νΈν™”λ</span><span class="w"> </span><span class="n">λΉ„νΈλ§µ</span><span class="w"> </span><span class="n">μ΄λ―Έμ§€λ”</span><span class="w"> </span><span class="n">λ¨μ–‘μ„</span><span class="w"> </span><span class="n">λ³΄μ΅΄ν•©λ‹λ‹¤</span><span class="w">       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μΈμ ‘ν•</span><span class="w"> </span><span class="n">λ™μΌν•</span><span class="w"> </span><span class="n">ν”½μ…€μ΄</span><span class="w"> </span><span class="n">λ™μΌν•</span><span class="w"> </span><span class="n">μ•”νΈλ¬Έμ„</span><span class="w"> </span><span class="n">μƒμ„±ν•κΈ°</span><span class="w"> </span><span class="n">λ•λ¬Έμ…λ‹λ‹¤</span><span class="p">.</span><span class="w">       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Demonstration: ECB leaks patterns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># AES-256</span>

<span class="c1"># ECB mode (DO NOT USE in production - for demonstration only)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ecb_encrypt_block</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encrypt a single block with AES-ECB. For demonstration only!&quot;&quot;&quot;</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">modes</span><span class="o">.</span><span class="n">ECB</span><span class="p">())</span>
    <span class="n">encryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encryptor</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">+</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="c1"># Same plaintext block produces same ciphertext</span>
<span class="n">block1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;AAAAAAAAAAAAAAAA&quot;</span>  <span class="c1"># 16 bytes = 1 AES block</span>
<span class="n">block2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;BBBBBBBBBBBBBBBB&quot;</span>

<span class="n">ct1a</span> <span class="o">=</span> <span class="n">ecb_encrypt_block</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">block1</span><span class="p">)</span>
<span class="n">ct1b</span> <span class="o">=</span> <span class="n">ecb_encrypt_block</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">block1</span><span class="p">)</span>  <span class="c1"># Same input</span>
<span class="n">ct2</span>  <span class="o">=</span> <span class="n">ecb_encrypt_block</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">block2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ECB Pattern Leak Demonstration:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Block &#39;AAA...&#39; β†’ </span><span class="si">{</span><span class="n">ct1a</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Block &#39;AAA...&#39; β†’ </span><span class="si">{</span><span class="n">ct1b</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">... (SAME ciphertext!)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Block &#39;BBB...&#39; β†’ </span><span class="si">{</span><span class="n">ct2</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">... (different)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ct1a == ct1b: </span><span class="si">{</span><span class="n">ct1a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ct1b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># True - this is the problem</span>
</code></pre></div>

<h3 id="32-cbc">3.2 CBC λ¨λ“ (λ κ±°μ‹, μ£Όμν•΄μ„ μ‚¬μ©)<a class="header-link" href="#32-cbc" title="Permanent link">&para;</a></h3>
<p>CBC(Cipher Block Chaining)λ” μ•”νΈν™”ν•κΈ° μ „μ— κ° ν‰λ¬Έ λΈ”λ΅μ„ μ΄μ „ μ•”νΈλ¬Έ λΈ”λ΅κ³Ό XORν•©λ‹λ‹¤. λλ¤ IVκ°€ ν•„μ”ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        CBC λ¨λ“                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                  β”‚
β”‚     IV β”€β”€β”                                                      β”‚
β”‚          β–Ό                                                      β”‚
β”‚  P1 β”€β”€β–¶ XOR β”€β”€β–¶ AES β”€β”€β–¶ C1                                    β”‚
β”‚                          β”‚                                      β”‚
β”‚                          β–Ό                                      β”‚
β”‚  P2 β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶ XOR β”€β”€β–¶ AES β”€β”€β–¶ C2                            β”‚
β”‚                                  β”‚                              β”‚
β”‚                                  β–Ό                              β”‚
β”‚  P3 β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶ XOR β”€β”€β–¶ AES β”€β”€β–¶ C3                    β”‚
β”‚                                                                  β”‚
β”‚  κ° μ•”νΈλ¬Έ λΈ”λ΅μ€ λ¨λ“  μ΄μ „ λΈ”λ΅μ— μμ΅΄ν•©λ‹λ‹¤.                   β”‚
β”‚  λλ¤ IVλ” λ™μΌν• ν‰λ¬Έμ΄ λ‹¤λ¥΄κ² μ•”νΈν™”λλ„λ΅ λ³΄μ¥ν•©λ‹λ‹¤.         β”‚
β”‚                                                                  β”‚
β”‚  β  ν¨λ”© ν•„μ” (μ: PKCS#7)                                      β”‚
β”‚  β  μΈμ¦λμ§€ μ•μΌλ©΄ ν¨λ”© μ¤λΌν΄ κ³µκ²©μ— μ·¨μ•½                      β”‚
β”‚  β  μ•”νΈν™”λ¥Ό λ³‘λ ¬ν™”ν•  μ μ—†μ                                    β”‚
β”‚                                                                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">padding</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="k">def</span><span class="w"> </span><span class="nf">aes_cbc_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;AES-CBC encryption with PKCS7 padding. Returns (iv, ciphertext).&quot;&quot;&quot;</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># Random 128-bit IV</span>

    <span class="c1"># Pad plaintext to block size</span>
    <span class="n">padder</span> <span class="o">=</span> <span class="n">padding</span><span class="o">.</span><span class="n">PKCS7</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">.</span><span class="n">padder</span><span class="p">()</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">padder</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">+</span> <span class="n">padder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="c1"># Encrypt</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">modes</span><span class="o">.</span><span class="n">CBC</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span>
    <span class="n">encryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encryptor</span><span class="p">()</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span> <span class="o">+</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">iv</span><span class="p">,</span> <span class="n">ciphertext</span>

<span class="k">def</span><span class="w"> </span><span class="nf">aes_cbc_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">iv</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;AES-CBC decryption with PKCS7 unpadding.&quot;&quot;&quot;</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">modes</span><span class="o">.</span><span class="n">CBC</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span>
    <span class="n">decryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decryptor</span><span class="p">()</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span> <span class="o">+</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="c1"># Remove padding</span>
    <span class="n">unpadder</span> <span class="o">=</span> <span class="n">padding</span><span class="o">.</span><span class="n">PKCS7</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">.</span><span class="n">unpadder</span><span class="p">()</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpadder</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span> <span class="o">+</span> <span class="n">unpadder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">plaintext</span>

<span class="c1"># Usage</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># AES-256</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;CBC mode requires padding and a random IV for each message&quot;</span>

<span class="n">iv</span><span class="p">,</span> <span class="n">ct</span> <span class="o">=</span> <span class="n">aes_cbc_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IV:         </span><span class="si">{</span><span class="n">iv</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">ct</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="n">pt</span> <span class="o">=</span> <span class="n">aes_cbc_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted:  </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Same plaintext, different IV β†’ different ciphertext</span>
<span class="n">iv2</span><span class="p">,</span> <span class="n">ct2</span> <span class="o">=</span> <span class="n">aes_cbc_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Same message, new IV:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ct1: </span><span class="si">{</span><span class="n">ct</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ct2: </span><span class="si">{</span><span class="n">ct2</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Same? </span><span class="si">{</span><span class="n">ct</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ct2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False - good!</span>
</code></pre></div>

<h3 id="33-ctr">3.3 CTR λ¨λ“<a class="header-link" href="#33-ctr" title="Permanent link">&para;</a></h3>
<p>CTR(Counter) λ¨λ“λ” λΈ”λ΅ μ•”νΈλ¥Ό μ¤νΈλ¦Ό μ•”νΈλ΅ λ³€ν™ν•©λ‹λ‹¤. λ³‘λ ¬ν™” κ°€λ¥ν•λ©° ν¨λ”©μ΄ ν•„μ”ν•μ§€ μ•μµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        CTR λ¨λ“                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                  β”‚
β”‚  Nonce|Counter=0 β”€β”€β–¶ AES β”€β”€β–¶ Keystream0 β”€β”€XORβ”€β”€β–¶ C0            β”‚
β”‚                                               β–²                  β”‚
β”‚                                               β”‚                  β”‚
β”‚                                              P0                  β”‚
β”‚                                                                  β”‚
β”‚  Nonce|Counter=1 β”€β”€β–¶ AES β”€β”€β–¶ Keystream1 β”€β”€XORβ”€β”€β–¶ C1            β”‚
β”‚                                               β–²                  β”‚
β”‚                                               β”‚                  β”‚
β”‚                                              P1                  β”‚
β”‚                                                                  β”‚
β”‚  β“ λ³‘λ ¬ν™” κ°€λ¥ (μ•”νΈν™” λ° λ³µνΈν™”)                               β”‚
β”‚  β“ ν¨λ”© ν•„μ” μ—†μ                                               β”‚
β”‚  β“ λ¨λ“  λΈ”λ΅μΌλ΅ μ‹ν¬ κ°€λ¥                                      β”‚
β”‚  β  Nonce μ¬μ‚¬μ©μ€ μΉλ…μ  (λ‘ ν‰λ¬Έμ XOR λ„μ¶)                  β”‚
β”‚  β  μΈμ¦ μ—†μ (λ€μ‹  GCM μ‚¬μ©)                                    β”‚
β”‚                                                                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="4-aes-gcm">4. AES-GCM: ν„λ€ ν‘μ¤€<a class="header-link" href="#4-aes-gcm" title="Permanent link">&para;</a></h2>
<p>GCM(Galois/Counter Mode)μ€ CTR λ¨λ“ μ•”νΈν™”μ™€ GMAC μΈμ¦μ„ κ²°ν•©ν•©λ‹λ‹¤. λ‹¨μΌ μ‘μ—…μΌλ΅ κΈ°λ°€μ„±κ³Ό λ¬΄κ²°μ„±μ„ λ¨λ‘ μ κ³µν•©λ‹λ‹¤. μ΄λ¥Ό Authenticated Encryption with Associated Data(AEAD)λΌκ³  ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        AES-GCM (AEAD)                                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  μ…λ ¥:  Key, Nonce (96-bit), Plaintext, AAD (μ„ νƒ)                  β”‚
β”‚  μ¶λ ¥: Ciphertext, Authentication Tag (128-bit)                     β”‚
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                β”‚
β”‚  β”‚  Nonce   β”‚β”€β”€β”€β”€β–¶β”‚  AES-CTR    β”‚β”€β”€β”€β”€β–¶β”‚ Ciphertext β”‚                β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”‚  Encryption β”‚     β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”                β”‚
β”‚                  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”            β”‚                       β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                               β”‚                       β”‚
β”‚  β”‚  AAD    β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                    β”‚                       β”‚
β”‚  β”‚(header) β”‚          β–Ό                    β–Ό                       β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                  β”‚
β”‚                  β”‚   GHASH     β”‚β”€β”€β”€β”€β–¶β”‚   Auth   β”‚                  β”‚
β”‚                  β”‚  (GMAC)    β”‚     β”‚   Tag    β”‚                  β”‚
β”‚                  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                  β”‚
β”‚                                                                      β”‚
β”‚  AAD = Associated Authenticated Data                                β”‚
β”‚  - μΈμ¦λμ§€λ§ μ•”νΈν™”λμ§€ μ•μ                                        β”‚
β”‚  - μ: λ©”μ‹μ§€ ν—¤λ”, ν¨ν‚· μ‹ν€€μ¤ λ²νΈ                                β”‚
β”‚  - AAD λ³€μ΅°λ” μΈμ¦ μ‹¤ν¨λ¥Ό μ λ°                                      β”‚
β”‚                                                                      β”‚
β”‚  β“ AEAD: κΈ°λ°€μ„± + λ¬΄κ²°μ„± + μ§„μ •μ„±                                  β”‚
β”‚  β“ λ³‘λ ¬ν™” κ°€λ¥                                                      β”‚
β”‚  β“ ν•λ“μ›¨μ–΄ κ°€μ† (AES-NI)                                          β”‚
β”‚  β  Nonceλ” ν‚¤λ‹Ή κ³ μ ν•΄μ•Ό ν•¨ (μ λ€ μ¬μ‚¬μ© κΈμ§€!)                    β”‚
β”‚  β  96λΉ„νΈ nonceλ” ν‚¤λ‹Ή ~2^32 μ•”νΈν™”λ΅ μ ν•                        β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="41-aes-gcm">4.1 AES-GCM κµ¬ν„<a class="header-link" href="#41-aes-gcm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers.aead</span><span class="w"> </span><span class="kn">import</span> <span class="n">AESGCM</span>

<span class="k">def</span><span class="w"> </span><span class="nf">aes_gcm_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                     <span class="n">aad</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encrypt with AES-GCM.</span>
<span class="sd">    Returns (nonce, ciphertext_with_tag).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aesgcm</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># 96-bit nonce (NIST recommended)</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">aesgcm</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span>

<span class="k">def</span><span class="w"> </span><span class="nf">aes_gcm_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                     <span class="n">aad</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decrypt with AES-GCM.</span>
<span class="sd">    Raises InvalidTag if authentication fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aesgcm</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aesgcm</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>

<span class="c1"># Generate a 256-bit key</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">bit_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key: </span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits)&quot;</span><span class="p">)</span>

<span class="c1"># Encrypt a message</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Top secret: The missile codes are 12345&quot;</span>
<span class="n">aad</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;message-id: 42, timestamp: 2026-01-15&quot;</span>  <span class="c1"># Authenticated but not encrypted</span>

<span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">aes_gcm_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nonce:      </span><span class="si">{</span><span class="n">nonce</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CT length:  </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;(plaintext: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="si">}</span><span class="s2"> + tag: 16)&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="n">aes_gcm_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted:  </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tamper with ciphertext β†’ authentication fails</span>
<span class="n">tampered_ct</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<span class="n">tampered_ct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0xFF</span>  <span class="c1"># Flip bits in first byte</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">aes_gcm_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">tampered_ct</span><span class="p">),</span> <span class="n">aad</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Should have failed!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tamper detected: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tamper with AAD β†’ authentication fails</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">aes_gcm_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;tampered AAD&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Should have failed!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AAD tamper detected: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="42-aes-gcm">4.2 AES-GCMμ„ μ‚¬μ©ν• νμΌ μ•”νΈν™”<a class="header-link" href="#42-aes-gcm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers.aead</span><span class="w"> </span><span class="kn">import</span> <span class="n">AESGCM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FileEncryptor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encrypt/decrypt files using AES-256-GCM.&quot;&quot;&quot;</span>

    <span class="n">CHUNK_SIZE</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 64 KB chunks</span>
    <span class="n">NONCE_SIZE</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">TAG_SIZE</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Key must be 256 bits (32 bytes)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aesgcm</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Encrypt a file chunk by chunk.</span>
<span class="sd">        Format: [nonce (12B)][chunk_count (4B)][encrypted_chunk1][encrypted_chunk2]...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">input_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input file not found: </span><span class="si">{</span><span class="n">input_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">file_size</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
        <span class="n">chunks_written</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
            <span class="c1"># Write file nonce (used as base; each chunk gets nonce + counter)</span>
            <span class="n">base_nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="p">)</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">base_nonce</span><span class="p">)</span>

            <span class="c1"># Placeholder for chunk count</span>
            <span class="n">chunk_count_pos</span> <span class="o">=</span> <span class="n">fout</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Will update later</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHUNK_SIZE</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="c1"># Derive unique nonce for this chunk</span>
                <span class="n">chunk_nonce</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_derive_chunk_nonce</span><span class="p">(</span><span class="n">base_nonce</span><span class="p">,</span> <span class="n">chunks_written</span><span class="p">)</span>

                <span class="c1"># AAD includes chunk index to prevent reordering</span>
                <span class="n">aad</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">chunks_written</span><span class="p">)</span>

                <span class="n">encrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aesgcm</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">chunk_nonce</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>

                <span class="c1"># Write: [length (4B)][encrypted_data]</span>
                <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)))</span>
                <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
                <span class="n">chunks_written</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Update chunk count</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">chunk_count_pos</span><span class="p">)</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">chunks_written</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;input_size&quot;</span><span class="p">:</span> <span class="n">file_size</span><span class="p">,</span>
            <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="n">chunks_written</span><span class="p">,</span>
            <span class="s2">&quot;output_size&quot;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt a file encrypted with encrypt_file.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
            <span class="n">base_nonce</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="p">)</span>
            <span class="n">chunk_count</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chunk_count</span><span class="p">):</span>
                <span class="n">chunk_nonce</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_derive_chunk_nonce</span><span class="p">(</span><span class="n">base_nonce</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">aad</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

                <span class="n">enc_len</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">encrypted</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">enc_len</span><span class="p">)</span>

                <span class="n">decrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aesgcm</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">chunk_nonce</span><span class="p">,</span> <span class="n">encrypted</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
                <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;chunks_decrypted&quot;</span><span class="p">:</span> <span class="n">chunk_count</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_derive_chunk_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_nonce</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">chunk_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Derive a unique nonce for each chunk by XORing with chunk index.&quot;&quot;&quot;</span>
        <span class="n">nonce_int</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">base_nonce</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="n">chunk_index</span>
        <span class="k">return</span> <span class="n">nonce_int</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>

<span class="c1"># Usage example</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">bit_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">encryptor</span> <span class="o">=</span> <span class="n">FileEncryptor</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Create a test file</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, encrypted world! &quot;</span> <span class="o">*</span> <span class="mi">10000</span>  <span class="c1"># ~240 KB</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/test_plain.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Encrypt</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt_file</span><span class="p">(</span><span class="s2">&quot;/tmp/test_plain.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/test_encrypted.bin&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted: </span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">decrypt_file</span><span class="p">(</span><span class="s2">&quot;/tmp/test_encrypted.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/test_decrypted.bin&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/test_decrypted.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">decrypted_data</span> <span class="o">==</span> <span class="n">test_data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Verification: OK - decrypted data matches original&quot;</span><span class="p">)</span>

<span class="c1"># Clean up</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;/tmp/test_plain.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/test_encrypted.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/test_decrypted.bin&quot;</span><span class="p">]:</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-chacha20-poly1305">5. ChaCha20-Poly1305<a class="header-link" href="#5-chacha20-poly1305" title="Permanent link">&para;</a></h2>
<p>ChaCha20-Poly1305λ” ChaCha20 μ¤νΈλ¦Ό μ•”νΈμ™€ Poly1305 MACμ„ κ²°ν•©ν• AEAD μ•”νΈμ…λ‹λ‹¤. AES-GCMμ μ£Όμ” λ€μ•μ…λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                  AES-GCM vs ChaCha20-Poly1305                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                  β”‚ AES-256-GCM          β”‚ ChaCha20-Poly1305          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν‚¤ ν¬κΈ°          β”‚ 256 bits             β”‚ 256 bits                   β”‚
β”‚ Nonce ν¬κΈ°       β”‚ 96 bits              β”‚ 96 bits                    β”‚
β”‚ Tag ν¬κΈ°         β”‚ 128 bits             β”‚ 128 bits                   β”‚
β”‚ μ†λ„ (HW κ°€μ†)   β”‚ λ§¤μ° λΉ λ¦„ (AES-NI)   β”‚ AES-NIλ΅ λλ¦Ό              β”‚
β”‚ μ†λ„ (μ†ν”„νΈμ›¨μ–΄)β”‚ λλ¦Ό                 β”‚ λΉ λ¦„ (νΉμ HW λ¶ν•„μ”)      β”‚
β”‚ λ¨λ°”μΌ/μ„λ² λ””λ“  β”‚ HW μ§€μ› ν•„μ”         β”‚ μ°μ (μμ μ†ν”„νΈμ›¨μ–΄)     β”‚
β”‚ μ‚¬μ΄λ“ μ±„λ„      β”‚ μ£Όμ ν•„μ” (T-ν…μ΄λΈ”) β”‚ λ³Έμ§μ μΌλ΅ μƒμ μ‹κ°„       β”‚
β”‚ μ‚¬μ©μ²           β”‚ TLS, IPsec, λ””μ¤ν¬ μ•”β”‚ TLS (Google/CF), WireGuardβ”‚
β”‚ Nonce μ¤μ©       β”‚ μΉλ…μ                β”‚ μΉλ…μ                      β”‚
β”‚ μ–‘μ μ΄ν›„        β”‚ PQ μ €ν•­ μ—†μ         β”‚ PQ μ €ν•­ μ—†μ               β”‚
β”‚                  β”‚ (λ‹¨λ…μΌλ΅)           β”‚ (λ‹¨λ…μΌλ΅)                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="51-chacha20-poly1305">5.1 ChaCha20-Poly1305 κµ¬ν„<a class="header-link" href="#51-chacha20-poly1305" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers.aead</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChaCha20Poly1305</span>

<span class="c1"># Generate a 256-bit key</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">ChaCha20Poly1305</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">chacha</span> <span class="o">=</span> <span class="n">ChaCha20Poly1305</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Encrypt</span>
<span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># 96-bit nonce</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;ChaCha20-Poly1305 is great for mobile and embedded devices&quot;</span>
<span class="n">aad</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;metadata: device=mobile, version=1&quot;</span>

<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">chacha</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plaintext:  </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CT length:  </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s2"> (plaintext </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="si">}</span><span class="s2"> + tag 16)&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="n">chacha</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">aad</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">plaintext</span> <span class="o">==</span> <span class="n">message</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted:  </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tamper detection</span>
<span class="n">tampered</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<span class="n">tampered</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x01</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">chacha</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">tampered</span><span class="p">),</span> <span class="n">aad</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamper detected: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="52-xchacha20-poly1305-nonce">5.2 XChaCha20-Poly1305 (ν™•μ¥ Nonce)<a class="header-link" href="#52-xchacha20-poly1305-nonce" title="Permanent link">&para;</a></h3>
<p>XChaCha20μ€ 192λΉ„νΈ nonceλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤(96λΉ„νΈ λ€λΉ„). μ΄λ” ν„μ‹¤μ μΈ μ¶©λ μ„ν— μ—†μ΄ λ¬΄μ‘μ„λ΅ μƒμ„±λ  μ μμ„ λ§νΌ μ¶©λ¶„ν ν½λ‹λ‹¤. μ΄λ” nonce κ΄€λ¦¬ λ¶€λ‹΄μ„ μ κ±°ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># XChaCha20 is available through libsodium bindings (PyNaCl)</span>
<span class="c1"># pip install pynacl</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">nacl.secret</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nacl.utils</span>

<span class="c1"># XChaCha20-Poly1305 with 192-bit random nonce</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">nacl</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">nacl</span><span class="o">.</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="o">.</span><span class="n">KEY_SIZE</span><span class="p">)</span>  <span class="c1"># 256-bit</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">nacl</span><span class="o">.</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Encrypt - nonce is generated automatically (192-bit, random-safe)</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;With XChaCha20, random nonces are always safe&quot;</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nonce size: </span><span class="si">{</span><span class="n">box</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="si">}</span><span class="s2"> bytes = </span><span class="si">{</span><span class="n">box</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6">6. λΉ„λ€μΉ­ μ•”νΈν™”<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<p>λΉ„λ€μΉ­(κ³µκ°ν‚¤) μ•”νΈν™”λ” ν‚¤ μμ„ μ‚¬μ©ν•©λ‹λ‹¤: μ•”νΈν™”(λλ” κ²€μ¦)λ¥Ό μ„ν• κ³µκ° ν‚¤μ™€ λ³µνΈν™”(λλ” μ„λ…)λ¥Ό μ„ν• κ°μΈ ν‚¤μ…λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    λΉ„λ€μΉ­ μ•”νΈν•™                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  ν‚¤ μƒμ„±                                                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                       β”‚
β”‚  β”‚ KeyGen() β”‚β”€β”€β–¶ Private Key (λΉ„λ°€λ΅ μ μ§€!)                         β”‚
β”‚  β”‚          β”‚β”€β”€β–¶ Public Key  (μμ λ΅­κ² κ³µμ )                        β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                       β”‚
β”‚                                                                      β”‚
β”‚  μ•”νΈν™” (λ„κµ¬λ‚ β†’ ν‚¤ μ†μ μ)                                        β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   Public Key   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚  β”‚ Plaintext β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚ Encrypt  β”‚β”€β”€β–¶ Ciphertext            β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”               β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚                                                                      β”‚
β”‚  λ³µνΈν™” (ν‚¤ μ†μ μλ§)                                               β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   Private Key  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚  β”‚Ciphertext β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚ Decrypt  β”‚β”€β”€β–¶ Plaintext             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”               β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚                                                                      β”‚
β”‚  μ„λ… (ν‚¤ μ†μ μ β†’ λ„κµ¬λ‚ κ²€μ¦ κ°€λ¥)                               β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   Private Key  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚  β”‚ Message   β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚  Sign    β”‚β”€β”€β–¶ Signature             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”               β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚                                                                      β”‚
β”‚  κ²€μ¦ (κ³µκ° ν‚¤λ¥Ό κ°€μ§„ λ„κµ¬λ‚)                                       β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   Public Key   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚  β”‚ Message + β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚ Verify   β”‚β”€β”€β–¶ Valid / Invalid       β”‚
β”‚  β”‚ Signature β”‚               β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                      β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="61">6.1 ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>λΉ„λ€μΉ­ μ•”νΈν™”λ” λλ¦¬κ³  μ•”νΈν™”ν•  μ μλ” λ°μ΄ν„° μ–‘μ΄ μ ν•λ©λ‹λ‹¤. μ‹¤μ λ΅λ” <strong>ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”</strong>λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤: λ€μΉ­ ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν• λ‹¤μ μμ‹ μμ κ³µκ° ν‚¤λ΅ λ€μΉ­ ν‚¤λ¥Ό μ•”νΈν™”ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">                    </span><span class="n">ν•μ΄λΈλ¦¬λ“</span><span class="w"> </span><span class="n">μ•”νΈν™”</span><span class="w">                              </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="nl">λ°μ‹ μ</span><span class="p">:</span><span class="w">                                                         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">λλ¤</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">ν‚¤</span><span class="w"> </span><span class="n">μƒμ„±</span><span class="w"> </span><span class="p">(</span><span class="nl">μ</span><span class="p">:</span><span class="w"> </span><span class="n">AES</span><span class="o">-</span><span class="mi">256</span><span class="p">)</span><span class="w">                             </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">ν‚¤λ΅</span><span class="w"> </span><span class="n">λ°μ΄ν„°</span><span class="w"> </span><span class="n">μ•”νΈν™”</span><span class="w"> </span><span class="p">(</span><span class="n">AES</span><span class="o">-</span><span class="n">GCM</span><span class="p">)</span><span class="w">                           </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">μμ‹ μμ</span><span class="w"> </span><span class="n">κ³µκ°</span><span class="w"> </span><span class="n">ν‚¤λ΅</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">ν‚¤</span><span class="w"> </span><span class="n">μ•”νΈν™”</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">                     </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="nl">μ „μ†΅</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">encrypted_key</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">[</span><span class="n">encrypted_data</span><span class="o">]</span><span class="w">                    </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="nl">μμ‹ μ</span><span class="p">:</span><span class="w">                                                         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">κ°μΈ</span><span class="w"> </span><span class="n">ν‚¤λ΅</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">ν‚¤</span><span class="w"> </span><span class="n">λ³µνΈν™”</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">                              </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">ν‚¤λ΅</span><span class="w"> </span><span class="n">λ°μ΄ν„°</span><span class="w"> </span><span class="n">λ³µνΈν™”</span><span class="w"> </span><span class="p">(</span><span class="n">AES</span><span class="o">-</span><span class="n">GCM</span><span class="p">)</span><span class="w">                           </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μ΄κ²ƒμ€</span><span class="w"> </span><span class="n">λ‹¤μμ„</span><span class="w"> </span><span class="nl">μ κ³µν•©λ‹λ‹¤</span><span class="p">:</span><span class="w">                                       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">λ€λ‰</span><span class="w"> </span><span class="n">λ°μ΄ν„°λ¥Ό</span><span class="w"> </span><span class="n">μ„ν•</span><span class="w"> </span><span class="n">λ€μΉ­</span><span class="w"> </span><span class="n">μ•”νΈν™”μ</span><span class="w"> </span><span class="n">μ†λ„</span><span class="w">                        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">ν‚¤</span><span class="w"> </span><span class="n">λ°°ν¬λ¥Ό</span><span class="w"> </span><span class="n">μ„ν•</span><span class="w"> </span><span class="n">κ³µκ°</span><span class="w"> </span><span class="n">ν‚¤</span><span class="w"> </span><span class="n">μ•”νΈν™”μ</span><span class="w"> </span><span class="n">νΈλ¦¬ν•¨</span><span class="w">                       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                  </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<hr />
<h2 id="7-rsa">7. RSA<a class="header-link" href="#7-rsa" title="Permanent link">&para;</a></h2>
<p>RSA(Rivest-Shamir-Adleman)λ” κ°€μ¥ λ„λ¦¬ λ°°ν¬λ λΉ„λ€μΉ­ μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. λ³΄μ•μ€ ν° μ •μλ¥Ό μΈμλ¶„ν•΄ν•λ” μ–΄λ ¤μ›€μ— κΈ°λ°ν•©λ‹λ‹¤.</p>
<h3 id="71-rsa">7.1 RSA ν‚¤ μƒμ„± λ° μ•”νΈν™”<a class="header-link" href="#71-rsa" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span><span class="p">,</span> <span class="n">serialization</span>

<span class="c1"># Generate RSA key pair</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
    <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
    <span class="n">key_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>  <span class="c1"># 2048 minimum, 4096 recommended</span>
<span class="p">)</span>
<span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="c1"># Display key info</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key size: </span><span class="si">{</span><span class="n">private_key</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Public exponent: </span><span class="si">{</span><span class="n">private_key</span><span class="o">.</span><span class="n">private_numbers</span><span class="p">()</span><span class="o">.</span><span class="n">public_numbers</span><span class="o">.</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Serialize keys (PEM format)</span>
<span class="n">private_pem</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span>
    <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">PrivateFormat</span><span class="o">.</span><span class="n">PKCS8</span><span class="p">,</span>
    <span class="n">encryption_algorithm</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">BestAvailableEncryption</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;my-password&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">public_pem</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span>
    <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">PublicFormat</span><span class="o">.</span><span class="n">SubjectPublicKeyInfo</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Public key (first 80 chars):</span><span class="se">\n</span><span class="si">{</span><span class="n">public_pem</span><span class="o">.</span><span class="n">decode</span><span class="p">()[:</span><span class="mi">80</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Encrypt with public key (using OAEP padding - ALWAYS use OAEP, never PKCS1v15)</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Secret message for RSA encryption&quot;</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span>
    <span class="n">message</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
        <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CT length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt with private key</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span>
    <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
        <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="72-rsa">7.2 RSA ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”<a class="header-link" href="#72-rsa" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers.aead</span><span class="w"> </span><span class="kn">import</span> <span class="n">AESGCM</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HybridEncryptor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RSA + AES-GCM hybrid encryption.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">public_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">private_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">public_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_keypair</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a new RSA key pair and return an encryptor.&quot;&quot;&quot;</span>
        <span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
            <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
            <span class="n">key_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">public_key</span><span class="o">=</span><span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">(),</span>
            <span class="n">private_key</span><span class="o">=</span><span class="n">private_key</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Encrypt data using hybrid encryption.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Public key required for encryption&quot;</span><span class="p">)</span>

        <span class="c1"># 1. Generate random AES-256 key</span>
        <span class="n">aes_key</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">bit_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>

        <span class="c1"># 2. Encrypt data with AES-GCM</span>
        <span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">aesgcm</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="n">aes_key</span><span class="p">)</span>
        <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">aesgcm</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># 3. Encrypt AES key with RSA public key</span>
        <span class="n">encrypted_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span>
            <span class="n">aes_key</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
                <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
                <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
                <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 4. Package everything together</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;encrypted_key&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">encrypted_key</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
            <span class="s2">&quot;nonce&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
            <span class="s2">&quot;ciphertext&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt hybrid-encrypted data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Private key required for decryption&quot;</span><span class="p">)</span>

        <span class="c1"># 1. Decrypt AES key with RSA private key</span>
        <span class="n">encrypted_key</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">package</span><span class="p">[</span><span class="s2">&quot;encrypted_key&quot;</span><span class="p">])</span>
        <span class="n">aes_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span>
            <span class="n">encrypted_key</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
                <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
                <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
                <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 2. Decrypt data with AES-GCM</span>
        <span class="n">nonce</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">package</span><span class="p">[</span><span class="s2">&quot;nonce&quot;</span><span class="p">])</span>
        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">package</span><span class="p">[</span><span class="s2">&quot;ciphertext&quot;</span><span class="p">])</span>
        <span class="n">aesgcm</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="n">aes_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aesgcm</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">encryptor</span> <span class="o">=</span> <span class="n">HybridEncryptor</span><span class="o">.</span><span class="n">generate_keypair</span><span class="p">()</span>

<span class="c1"># Encrypt a large message</span>
<span class="n">large_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="mi">100000</span>  <span class="c1"># 100 KB - too large for raw RSA</span>
<span class="n">package</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">large_message</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hybrid Encryption Package:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Encrypted key length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">package</span><span class="p">[</span><span class="s1">&#39;encrypted_key&#39;</span><span class="p">]))</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Nonce: </span><span class="si">{</span><span class="n">package</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ciphertext length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">package</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">]))</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">decrypted</span> <span class="o">==</span> <span class="n">large_message</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Decrypted successfully: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes match original&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. νƒ€μ› κ³΅μ„  μ•”νΈν•™<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p>ECCλ” ν›¨μ”¬ μ‘μ€ ν‚¤ ν¬κΈ°λ΅ RSAμ™€ λ™μΌν• λ³΄μ•μ„ μ κ³µν•μ—¬ λ” λΉ λ¥΄κ³  ν¨μ¨μ μ…λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              RSA vs νƒ€μ› κ³΅μ„  ν‚¤ ν¬κΈ°                                β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ³΄μ• μμ¤€        β”‚ RSA ν‚¤ ν¬κΈ°      β”‚ ECC ν‚¤ ν¬κΈ°                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 128-bit          β”‚ 3072 bits        β”‚ 256 bits (P-256/secp256r1)     β”‚
β”‚ 192-bit          β”‚ 7680 bits        β”‚ 384 bits (P-384/secp384r1)     β”‚
β”‚ 256-bit          β”‚ 15360 bits       β”‚ 521 bits (P-521/secp521r1)     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ECCλ” λ™λ“±ν• λ³΄μ•μ„ μ„ν•΄ ~10-15λ°° μ‘μµλ‹λ‹¤!                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="81-ecdsa">8.1 ECDSA (νƒ€μ› κ³΅μ„  λ””μ§€ν„Έ μ„λ… μ•κ³ λ¦¬μ¦)<a class="header-link" href="#81-ecdsa" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">ec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>

<span class="c1"># Generate key pair using P-256 curve (NIST recommended)</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">SECP256R1</span><span class="p">())</span>
<span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curve: </span><span class="si">{</span><span class="n">private_key</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key size: </span><span class="si">{</span><span class="n">private_key</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>

<span class="c1"># Sign a message</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This message is signed with ECDSA&quot;</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
    <span class="n">message</span><span class="p">,</span>
    <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Signature: </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>  <span class="c1"># ~70-72 bytes for P-256</span>

<span class="c1"># Verify</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signature valid!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signature invalid!&quot;</span><span class="p">)</span>

<span class="c1"># Tampered message fails</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;tampered message&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Should have failed!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tampered message: signature verification failed (expected)&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="82-ed25519">8.2 Ed25519 (ν„λ€ μ„λ… μ•κ³ λ¦¬μ¦)<a class="header-link" href="#82-ed25519" title="Permanent link">&para;</a></h3>
<p>Ed25519λ” Curve25519λ¥Ό μ‚¬μ©ν•λ” ν„λ€ EdDSA μ„λ… μ¤ν‚΄μ…λ‹λ‹¤. κ²°μ •λ΅ μ μ΄κ³ (μ„λ… μ¤‘ λλ¤ nonce λ¶ν•„μ”), λΉ λ¥΄λ©°, μ‚¬μ΄λ“ μ±„λ„ κ³µκ²©μ— κ°•ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric.ed25519</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ed25519PrivateKey</span>

<span class="c1"># Generate Ed25519 key pair</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">Ed25519PrivateKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="c1"># Sign (no hash algorithm parameter needed - it uses SHA-512 internally)</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Ed25519 is the recommended signature algorithm for new systems&quot;</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature: </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>  <span class="c1"># Always 64 bytes</span>

<span class="c1"># Verify</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ed25519 signature valid!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Key sizes are small</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.serialization</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Encoding</span><span class="p">,</span> <span class="n">PublicFormat</span><span class="p">,</span> <span class="n">PrivateFormat</span><span class="p">,</span> <span class="n">NoEncryption</span>
<span class="p">)</span>

<span class="n">pub_bytes</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">Encoding</span><span class="o">.</span><span class="n">Raw</span><span class="p">,</span> <span class="n">PublicFormat</span><span class="o">.</span><span class="n">Raw</span><span class="p">)</span>
<span class="n">priv_bytes</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span><span class="n">Encoding</span><span class="o">.</span><span class="n">Raw</span><span class="p">,</span> <span class="n">PrivateFormat</span><span class="o">.</span><span class="n">Raw</span><span class="p">,</span> <span class="n">NoEncryption</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Public key:  </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pub_bytes</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pub_bytes</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Private key: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">priv_bytes</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">priv_bytes</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature:   </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits)&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μ„λ… μ•κ³ λ¦¬μ¦ λΉ„κµ                                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚              β”‚ RSA-2048 β”‚ECDSA P256β”‚ Ed25519  β”‚ Ed448               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ κ³µκ° ν‚¤ ν¬κΈ° β”‚ 256 B    β”‚ 64 B     β”‚ 32 B     β”‚ 57 B                β”‚
β”‚ μ„λ… ν¬κΈ°    β”‚ 256 B    β”‚ ~72 B    β”‚ 64 B     β”‚ 114 B               β”‚
β”‚ μ„λ… μ†λ„    β”‚ λλ¦Ό     β”‚ λΉ λ¦„     β”‚ λ§¤μ° λΉ λ¦„β”‚ λΉ λ¦„                β”‚
β”‚ κ²€μ¦ μ†λ„    β”‚ λΉ λ¦„     β”‚ λ³΄ν†µ     β”‚ λΉ λ¦„     β”‚ λΉ λ¦„                β”‚
β”‚ κ²°μ •λ΅ μ      β”‚ No       β”‚ No*      β”‚ Yes      β”‚ Yes                 β”‚
β”‚ μ‚¬μ΄λ“ μ±„λ„  β”‚ μ£Όμ     β”‚ μ£Όμ     β”‚ λ³Έμ§μ    β”‚ λ³Έμ§μ               β”‚
β”‚ μ €ν•­         β”‚ ν•„μ”     β”‚ ν•„μ”     β”‚          β”‚                     β”‚
β”‚ ν‘μ¤€         β”‚ PKCS#1   β”‚ FIPS     β”‚ RFC 8032 β”‚ RFC 8032            β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ * RFC 6979λ” κ²°μ •λ΅ μ  ECDSAλ¥Ό μ κ³µν•μ§€λ§ λ¨λ“  κµ¬ν„μ΄ μ‚¬μ©ν•μ§€ μ•μ β”‚
β”‚ κ¶μ¥ μ‚¬ν•­: μƒ μ‹μ¤ν…μ—λ” Ed25519 μ‚¬μ©                              β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="9">9. ν‚¤ κµν™<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<p>ν‚¤ κµν™ ν”„λ΅ν† μ½μ€ λ‘ λ‹Ήμ‚¬μκ°€ μ•μ „ν•μ§€ μ•μ€ μ±„λ„μ„ ν†µν•΄ κ³µμ  λΉ„λ°€μ„ μ„¤μ •ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.</p>
<h3 id="91-diffie-hellman">9.1 Diffie-Hellman ν‚¤ κµν™<a class="header-link" href="#91-diffie-hellman" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚               Diffie-Hellman ν‚¤ κµν™                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚   Alice                                        Bob                   β”‚
β”‚   β”€β”€β”€β”€β”€                                        β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚   1. κ°μΈ ν‚¤ μ„ νƒ: a                           1. κ°μΈ ν‚¤ μ„ νƒ: b    β”‚
β”‚   2. κ³„μ‚°: A = g^a mod p                       2. κ³„μ‚°: B = g^b      β”‚
β”‚                                                    mod p             β”‚
β”‚                                                                      β”‚
β”‚   3. A μ „μ†΅ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶ A μμ‹                β”‚
β”‚      B μμ‹  β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ 4. B μ „μ†΅            β”‚
β”‚                                                                      β”‚
β”‚   5. κ³„μ‚°:                                     5. κ³„μ‚°:              β”‚
β”‚      shared = B^a mod p                           shared = A^b mod pβ”‚
β”‚             = (g^b)^a mod p                              = (g^a)^b  β”‚
β”‚             = g^(ab) mod p                                  mod p   β”‚
β”‚                                                          = g^(ab)   β”‚
β”‚                                                            mod p    β”‚
β”‚                                                                      β”‚
β”‚   λ‘ λ‹Ήμ‚¬μ λ¨λ‘ λ™μΌν• κ³µμ  λΉ„λ°€μ— λ„λ‹¬: g^(ab) mod p              β”‚
β”‚                                                                      β”‚
β”‚   Eveκ°€ λ³΄λ” κ²ƒ: g, p, A=g^a, B=g^b                                β”‚
β”‚   Aλ΅λ¶€ν„° aλ¥Ό κ³„μ‚°ν•λ ¤λ©΄ μ΄μ‚° λ΅κ·Έ λ¬Έμ λ¥Ό ν’€μ–΄μ•Ό ν•λ©°               β”‚
β”‚   ν° μ†μμ— λ€ν•΄ κ³„μ‚°μ μΌλ΅ λ¶κ°€λ¥ν•λ‹¤κ³  λ―Ώμ–΄μ§‘λ‹λ‹¤.                β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="92-ecdh-diffie-hellman">9.2 ECDH (νƒ€μ› κ³΅μ„  Diffie-Hellman)<a class="header-link" href="#92-ecdh-diffie-hellman" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">ec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.hkdf</span><span class="w"> </span><span class="kn">import</span> <span class="n">HKDF</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ecdh_key_exchange</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstrate ECDH key exchange between Alice and Bob.</span>
<span class="sd">    Uses X25519-equivalent (P-256 shown here for compatibility).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Alice generates her key pair</span>
    <span class="n">alice_private</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">SECP256R1</span><span class="p">())</span>
    <span class="n">alice_public</span> <span class="o">=</span> <span class="n">alice_private</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

    <span class="c1"># Bob generates his key pair</span>
    <span class="n">bob_private</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">SECP256R1</span><span class="p">())</span>
    <span class="n">bob_public</span> <span class="o">=</span> <span class="n">bob_private</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

    <span class="c1"># Alice computes shared secret using her private key + Bob&#39;s public key</span>
    <span class="n">alice_shared</span> <span class="o">=</span> <span class="n">alice_private</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">ECDH</span><span class="p">(),</span> <span class="n">bob_public</span><span class="p">)</span>

    <span class="c1"># Bob computes shared secret using his private key + Alice&#39;s public key</span>
    <span class="n">bob_shared</span> <span class="o">=</span> <span class="n">bob_private</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">ECDH</span><span class="p">(),</span> <span class="n">alice_public</span><span class="p">)</span>

    <span class="c1"># Both shared secrets are identical</span>
    <span class="k">assert</span> <span class="n">alice_shared</span> <span class="o">==</span> <span class="n">bob_shared</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ECDH shared secret: </span><span class="si">{</span><span class="n">alice_shared</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shared secret length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">alice_shared</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

    <span class="c1"># Derive actual encryption key from shared secret using HKDF</span>
    <span class="c1"># (raw ECDH output should NOT be used directly as an encryption key)</span>
    <span class="n">alice_key</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>  <span class="c1"># 256-bit key for AES-256</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">info</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;ecdh-derived-key-v1&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">alice_shared</span><span class="p">)</span>

    <span class="n">bob_key</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">info</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;ecdh-derived-key-v1&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">bob_shared</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">alice_key</span> <span class="o">==</span> <span class="n">bob_key</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Derived AES key: </span><span class="si">{</span><span class="n">alice_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">alice_key</span>

<span class="n">derived_key</span> <span class="o">=</span> <span class="n">ecdh_key_exchange</span><span class="p">()</span>
</code></pre></div>

<h3 id="93-x25519">9.3 X25519 ν‚¤ κµν™<a class="header-link" href="#93-x25519" title="Permanent link">&para;</a></h3>
<p>X25519λ” ν„λ€ μ• ν”λ¦¬μΌ€μ΄μ…μ— κ¶μ¥λλ” ECDH κ³΅μ„ μ…λ‹λ‹¤(TLS 1.3, WireGuard, Signalμ—μ„ μ‚¬μ©).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric.x25519</span><span class="w"> </span><span class="kn">import</span> <span class="n">X25519PrivateKey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.hkdf</span><span class="w"> </span><span class="kn">import</span> <span class="n">HKDF</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>

<span class="c1"># Alice</span>
<span class="n">alice_private</span> <span class="o">=</span> <span class="n">X25519PrivateKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">alice_public</span> <span class="o">=</span> <span class="n">alice_private</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="c1"># Bob</span>
<span class="n">bob_private</span> <span class="o">=</span> <span class="n">X25519PrivateKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">bob_public</span> <span class="o">=</span> <span class="n">bob_private</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="c1"># Exchange</span>
<span class="n">alice_shared</span> <span class="o">=</span> <span class="n">alice_private</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">bob_public</span><span class="p">)</span>
<span class="n">bob_shared</span> <span class="o">=</span> <span class="n">bob_private</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">alice_public</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">alice_shared</span> <span class="o">==</span> <span class="n">bob_shared</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X25519 shared secret: </span><span class="si">{</span><span class="n">alice_shared</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Derive keys using HKDF</span>
<span class="k">def</span><span class="w"> </span><span class="nf">derive_keys</span><span class="p">(</span><span class="n">shared_secret</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Derive separate keys for encryption and MAC from shared secret.&quot;&quot;&quot;</span>
    <span class="c1"># Encryption key</span>
    <span class="n">enc_key</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">info</span><span class="o">=</span><span class="n">context</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;-enc&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">shared_secret</span><span class="p">)</span>

    <span class="c1"># MAC key (for additional message authentication if needed)</span>
    <span class="n">mac_key</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
        <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">info</span><span class="o">=</span><span class="n">context</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;-mac&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">shared_secret</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;encryption_key&quot;</span><span class="p">:</span> <span class="n">enc_key</span><span class="p">,</span> <span class="s2">&quot;mac_key&quot;</span><span class="p">:</span> <span class="n">mac_key</span><span class="p">}</span>

<span class="n">keys</span> <span class="o">=</span> <span class="n">derive_keys</span><span class="p">(</span><span class="n">alice_shared</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;session-2026-01-15&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encryption key: </span><span class="si">{</span><span class="n">keys</span><span class="p">[</span><span class="s1">&#39;encryption_key&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAC key:        </span><span class="si">{</span><span class="n">keys</span><span class="p">[</span><span class="s1">&#39;mac_key&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="10">10. λ””μ§€ν„Έ μ„λ…<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<p>λ””μ§€ν„Έ μ„λ…μ€ μΈμ¦, λ¬΄κ²°μ„± λ° λ¶€μΈ λ°©μ§€λ¥Ό μ κ³µν•©λ‹λ‹¤. λ„κµ¬λ‚ λ©”μ‹μ§€κ°€ νΉμ • κ°μΈ ν‚¤μ μ†μ μμ— μν•΄ μƒμ„±λμ—μΌλ©° μμ •λμ§€ μ•μ•μμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.</p>
<h3 id="101">10.1 λ””μ§€ν„Έ μ„λ… μ‘λ™ λ°©μ‹<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    λ””μ§€ν„Έ μ„λ… ν”„λ΅μ„Έμ¤                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  μ„λ… (μ‘μ„±μκ°€ κ°μΈ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬):                                β”‚
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚  β”‚ Message  β”‚β”€β”€β”€β”€β–¶β”‚  Hash    β”‚β”€β”€β”€β”€β–¶β”‚  Sign    β”‚β”€β”€β”€β”€β–¶β”‚ Signature β”‚  β”‚
β”‚  β”‚          β”‚     β”‚ (SHA-256)β”‚     β”‚(Private  β”‚     β”‚           β”‚  β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”‚  Key)    β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚                                    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                     β”‚
β”‚                                                                      β”‚
β”‚  κ²€μ¦ (μ‘μ„±μμ κ³µκ° ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ„κµ¬λ‚):                         β”‚
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                      β”‚
β”‚  β”‚ Message  β”‚β”€β”€β”€β”€β–¶β”‚  Hash    β”‚β”€β”€β”€β”€β”€β”                                β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”‚ (SHA-256)β”‚     β”‚                                β”‚
β”‚                   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β–Ό                                β”‚
β”‚                                β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β”‚  Verify  β”‚β”€β”€β”€β”€β–¶β”‚ Valid /  β”‚       β”‚
β”‚  β”‚ Signature β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚(Public   β”‚     β”‚ Invalid  β”‚       β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β”‚  Key)    β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚                                β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                         β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="102">10.2 μ‹¤μµ: λ¬Έμ„ μ„λ… μ‹μ¤ν…<a class="header-link" href="#102" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric.ed25519</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ed25519PrivateKey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.serialization</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Encoding</span><span class="p">,</span> <span class="n">PublicFormat</span><span class="p">,</span> <span class="n">PrivateFormat</span><span class="p">,</span> <span class="n">NoEncryption</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">asdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SignedDocument</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A document with a digital signature.&quot;&quot;&quot;</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">author</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">public_key</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Base64-encoded public key</span>
    <span class="n">signature</span><span class="p">:</span> <span class="nb">str</span>   <span class="c1"># Base64-encoded signature</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DocumentSigner</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sign and verify documents using Ed25519.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">Ed25519PrivateKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_public_key_b64</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get base64-encoded public key for sharing.&quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">Encoding</span><span class="o">.</span><span class="n">Raw</span><span class="p">,</span> <span class="n">PublicFormat</span><span class="o">.</span><span class="n">Raw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sign_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">author</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignedDocument</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sign a document and return it with the signature.&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Create canonical message to sign</span>
        <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_canonical_message</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>

        <span class="c1"># Sign</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">SignedDocument</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="n">public_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_public_key_b64</span><span class="p">(),</span>
            <span class="n">signature</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_document</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">SignedDocument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify a signed document. Returns verification result.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric.ed25519</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ed25519PublicKey</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Reconstruct the canonical message</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="o">.</span><span class="n">_canonical_message</span><span class="p">(</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">timestamp</span>
            <span class="p">)</span>

            <span class="c1"># Decode public key and signature</span>
            <span class="n">pub_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
            <span class="n">signature</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">signature</span><span class="p">)</span>

            <span class="c1"># Load public key</span>
            <span class="n">public_key</span> <span class="o">=</span> <span class="n">Ed25519PublicKey</span><span class="o">.</span><span class="n">from_public_bytes</span><span class="p">(</span><span class="n">pub_bytes</span><span class="p">)</span>

            <span class="c1"># Verify</span>
            <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">author</span><span class="p">,</span>
                <span class="s2">&quot;signed_at&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">timestamp</span><span class="p">),</span>
                <span class="s2">&quot;public_key&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">public_key</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_canonical_message</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a canonical byte representation for signing.&quot;&quot;&quot;</span>
        <span class="n">canonical</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
            <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">author</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
        <span class="p">},</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">canonical</span>

<span class="c1"># Create signers for Alice and Bob</span>
<span class="n">alice_signer</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="p">()</span>
<span class="n">bob_signer</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="p">()</span>

<span class="c1"># Alice signs a document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">alice_signer</span><span class="o">.</span><span class="n">sign_document</span><span class="p">(</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;I, Alice, hereby agree to pay Bob $100.&quot;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signed Document:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Content:   </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Author:    </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">author</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Timestamp: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Signature: </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">signature</span><span class="p">[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Anyone can verify using Alice&#39;s public key (embedded in document)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="o">.</span><span class="n">verify_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Verification: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tamper with the document</span>
<span class="n">tampered_doc</span> <span class="o">=</span> <span class="n">SignedDocument</span><span class="p">(</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;I, Alice, hereby agree to pay Bob $10000.&quot;</span><span class="p">,</span>  <span class="c1"># Changed!</span>
    <span class="n">author</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">author</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
    <span class="n">public_key</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span>
    <span class="n">signature</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">signature</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tamper_result</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="o">.</span><span class="n">verify_document</span><span class="p">(</span><span class="n">tampered_doc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tampered verification: </span><span class="si">{</span><span class="n">tamper_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="11_1">11. μΌλ°μ μΈ ν•¨μ •κ³Ό ν”Όν•λ” λ°©λ²•<a class="header-link" href="#11_1" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 μ•”νΈν•™μ μΉλ…μ μΈ μ£„μ•…<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚          μ£Όμ” μ•”νΈν•™μ  ν•¨μ • (λ° ν”Όν•λ” λ°©λ²•)                         β”‚
β”β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ #  β”‚ ν•¨μ •               β”‚ μ¬λ°”λ¥Έ μ ‘κ·Όλ²•                             β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 1  β”‚ ECB λ¨λ“ μ‚¬μ©      β”‚ AES-GCM λλ” ChaCha20-Poly1305 μ‚¬μ©      β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 2  β”‚ λ™μΌν• ν‚¤λ΅        β”‚ λ©”μ‹μ§€λ‹Ή λλ¤ nonce (λλ” μΉ΄μ΄ν„°)        β”‚
β”‚    β”‚ nonces/IV μ¬μ‚¬μ©   β”‚ λλ¤ μ•μ „ nonceλ¥Ό μ„ν•΄ XChaCha20 μ‚¬μ©    β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 3  β”‚ μΈμ¦ μ—†μ΄ μ•”νΈν™”   β”‚ ν•­μƒ AEAD μ‚¬μ© (GCM, Poly1305)           β”‚
β”‚    β”‚                    β”‚ μ›μ‹ CBC/CTR μ‚¬μ© κΈμ§€                   β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 4  β”‚ μμ²΄ μ•”νΈν™” κµ¬ν„   β”‚ ν™•λ¦½λ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ© (cryptography,    β”‚
β”‚    β”‚                    β”‚ libsodium/NaCl, OpenSSL)                  β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 5  β”‚ μ•½ν•κ±°λ‚ μμΈ΅      β”‚ os.urandom() λλ” secrets λ¨λ“ μ‚¬μ©     β”‚
β”‚    β”‚ κ°€λ¥ν• λ‚μ        β”‚ μ•”νΈν™”μ— random.random() μ λ€ μ‚¬μ© κΈμ§€  β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 6  β”‚ μ†μ¤ μ½”λ“μ—        β”‚ ν‚¤ κ΄€λ¦¬ μ‚¬μ© (AWS KMS, Vault)            β”‚
β”‚    β”‚ ν•λ“μ½”λ”©λ ν‚¤      β”‚ μµμ†ν• ν™κ²½ λ³€μ                         β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 7  β”‚ λΉ„λ°€λ²νΈμ—         β”‚ ν•΄μ‹μ—λ” SHA-256+, λΉ„λ°€λ²νΈμ—λ”          β”‚
β”‚    β”‚ MD5/SHA-1 μ‚¬μ©     β”‚ bcrypt/argon2 μ‚¬μ©                       β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 8  β”‚ PKCS#1 v1.5        β”‚ μ•”νΈν™”μ—λ” RSA-OAEP μ‚¬μ©                 β”‚
β”‚    β”‚ ν¨λ”©μΌλ΅ RSA μ‚¬μ©  β”‚ μ„λ…μ—λ” RSA-PSS μ‚¬μ©                    β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 9  β”‚ ==λ΅ MAC λΉ„κµ      β”‚ μƒμ μ‹κ°„ λΉ„κµλ¥Ό μ„ν•΄                    β”‚
β”‚    β”‚                    β”‚ hmac.compare_digest() μ‚¬μ©               β”‚
β”β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ 10 β”‚ ν‚¤ λ΅ν…μ΄μ… μ—†μ   β”‚ ν‚¤ λ΅ν…μ΄μ… μΌμ • κµ¬ν„                    β”‚
β”‚    β”‚                    β”‚ ν‚¤ λ²„μ „ κ΄€λ¦¬ μ‚¬μ©                        β”‚
β””β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="112-nonce">11.2 Nonce μ¬μ‚¬μ© μ¬μ•™<a class="header-link" href="#112-nonce" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>

<span class="c1"># Demonstration: Why nonce reuse with CTR/GCM is catastrophic</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># Same nonce used twice - BAD!</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ctr_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">):</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">modes</span><span class="o">.</span><span class="n">CTR</span><span class="p">(</span><span class="n">nonce</span><span class="p">))</span>
    <span class="n">encryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encryptor</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">+</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="c1"># Two messages encrypted with the SAME key and nonce</span>
<span class="n">msg1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Attack at dawn!!!&quot;</span>  <span class="c1"># 17 bytes</span>
<span class="n">msg2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Retreat at night!&quot;</span>  <span class="c1"># 17 bytes</span>

<span class="n">ct1</span> <span class="o">=</span> <span class="n">ctr_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">msg1</span><span class="p">)</span>
<span class="n">ct2</span> <span class="o">=</span> <span class="n">ctr_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">msg2</span><span class="p">)</span>

<span class="c1"># XOR of two ciphertexts = XOR of two plaintexts!</span>
<span class="c1"># In CTR mode: ct = plaintext XOR keystream</span>
<span class="c1"># So: ct1 XOR ct2 = (msg1 XOR keystream) XOR (msg2 XOR keystream)</span>
<span class="c1">#                  = msg1 XOR msg2  (keystream cancels out!)</span>

<span class="n">xor_result</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ct1</span><span class="p">,</span> <span class="n">ct2</span><span class="p">))</span>
<span class="n">expected</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">msg1</span><span class="p">,</span> <span class="n">msg2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nonce Reuse Attack Demonstration:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ct1 XOR ct2:  </span><span class="si">{</span><span class="n">xor_result</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  msg1 XOR msg2: </span><span class="si">{</span><span class="n">expected</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Match: </span><span class="si">{</span><span class="n">xor_result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  An attacker who knows msg1 can recover msg2:&quot;</span><span class="p">)</span>
<span class="n">recovered</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xor_result</span><span class="p">,</span> <span class="n">msg1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recovered msg2: </span><span class="si">{</span><span class="n">recovered</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  LESSON: Never reuse a nonce with the same key!&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="113-vs">11.3 μ•μ „ν• λ‚μ vs μ•μ „ν•μ§€ μ•μ€ λ‚μ<a class="header-link" href="#113-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># INSECURE - never use for cryptography</span>
<span class="c1"># random.random() uses Mersenne Twister (MT19937)</span>
<span class="c1"># It is deterministic and predictable if you observe enough outputs</span>
<span class="n">insecure_key</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INSECURE key: </span><span class="si">{</span><span class="n">insecure_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Source: random.random() - Mersenne Twister (PREDICTABLE)&quot;</span><span class="p">)</span>

<span class="c1"># SECURE - use for cryptography</span>
<span class="n">secure_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SECURE key:   </span><span class="si">{</span><span class="n">secure_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Source: os.urandom() - OS CSPRNG (/dev/urandom)&quot;</span><span class="p">)</span>

<span class="c1"># ALSO SECURE - Python 3.6+ secrets module</span>
<span class="n">secure_token</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SECURE key:   </span><span class="si">{</span><span class="n">secure_token</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Source: secrets.token_bytes() - wraps os.urandom()&quot;</span><span class="p">)</span>

<span class="c1"># For URL-safe tokens</span>
<span class="n">url_token</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">URL-safe token: </span><span class="si">{</span><span class="n">url_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># For comparison tokens (timing-safe)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Constant-time comparison: </span><span class="si">{</span><span class="n">secrets</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. ν„λ€ κ¶μ¥ μ‚¬ν•­<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="121-2025">12.1 μ•κ³ λ¦¬μ¦ μ„ νƒ κ°€μ΄λ“ (2025+)<a class="header-link" href="#121-2025" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚               ν„λ€ μ•”νΈν•™ κ¶μ¥ μ‚¬ν•­                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ‚¬μ© μ‚¬λ΅€       β”‚ κ¶μ¥ μ•κ³ λ¦¬μ¦                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ€μΉ­ μ•”νΈν™”     β”‚ AES-256-GCM (ν•λ“μ›¨μ–΄ μ‚¬μ©) λλ”                 β”‚
β”‚                 β”‚ ChaCha20-Poly1305 (ν•λ“μ›¨μ–΄ μ—†μ / λ¨λ°”μΌ)       β”‚
β”‚                 β”‚ λλ¤ nonce ν•„μ” μ‹ XChaCha20-Poly1305            β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν‚¤ κµν™         β”‚ X25519 (Curve25519μ™€ ECDH)                       β”‚
β”‚                 β”‚ ML-KEM (μ–‘μ μ΄ν›„, X25519μ™€ ν•μ΄λΈλ¦¬λ“)          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ””μ§€ν„Έ μ„λ…     β”‚ Ed25519 (λ²”μ©)                                   β”‚
β”‚                 β”‚ Ed448 (λ” λ†’μ€ λ³΄μ• λ§μ§„)                        β”‚
β”‚                 β”‚ ECDSA P-256 (λ κ±°μ‹ νΈν™μ„±)                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν•΄μ‹±            β”‚ SHA-256 / SHA-3-256 (λ²”μ©)                       β”‚
β”‚                 β”‚ BLAKE3 (μ†λ„ μ¤‘μ”)                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λΉ„λ°€λ²νΈ ν•΄μ‹   β”‚ Argon2id (μ„ νΈ)                                  β”‚
β”‚                 β”‚ bcrypt (λ„λ¦¬ μ§€μ›λ¨)                             β”‚
β”‚                 β”‚ scrypt (λ©”λ¨λ¦¬ ν•λ“ λ€μ•)                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν‚¤ μ λ„         β”‚ HKDF-SHA256 (κ³  μ—”νΈλ΅ν”Ό μ…λ ¥μ—μ„)               β”‚
β”‚                 β”‚ Argon2id (λΉ„λ°€λ²νΈμ—μ„)                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ TLS             β”‚ TLS 1.3 with X25519 + AES-256-GCM                β”‚
β”‚                 β”‚ λλ” ChaCha20-Poly1305                           β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν”Όν•΄μ•Ό ν•  κ²ƒ    β”‚ MD5, SHA-1, DES, 3DES, RC4, RSA-1024,           β”‚
β”‚                 β”‚ ECB λ¨λ“, PKCS#1 v1.5, μ‚¬μ©μ μ •μ μ•κ³ λ¦¬μ¦      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="122">12.2 ν‚¤ ν¬κΈ° κ¶μ¥ μ‚¬ν•­<a class="header-link" href="#122" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μµμ† ν‚¤ ν¬κΈ° (NIST / ANSSI 2025+)                       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ•κ³ λ¦¬μ¦            β”‚ μµμ† ν‚¤ ν¬κΈ°                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ AES                 β”‚ 128-bit (μ–‘μ μ΄ν›„ λ§μ§„μ„ μ„ν•΄ 256-bit)      β”‚
β”‚ RSA (ν•„μ” μ‹)       β”‚ 3072-bit (4096 κ¶μ¥)                         β”‚
β”‚ ECDSA / ECDH        β”‚ P-256 / Curve25519 (256-bit)                β”‚
β”‚ EdDSA               β”‚ Ed25519 (256-bit)                            β”‚
β”‚ ν•΄μ‹ μ¶λ ¥           β”‚ 256-bit (SHA-256, SHA-3-256, BLAKE2b-256)   β”‚
β”‚ HMAC ν‚¤             β”‚ ν•΄μ‹ μ¶λ ¥ ν¬κΈ°μ™€ λ™μΌ (256-bit)              β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="123">12.3 μ–‘μ μ΄ν›„ μ•”νΈν•™<a class="header-link" href="#123" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μ–‘μ μ΄ν›„ μ•”νΈν•™ (PQC)                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  λ¬Έμ : μ–‘μ μ»΄ν“¨ν„° (Shor μ•κ³ λ¦¬μ¦)λ” λ‹¤μμ„ κΉ¨λ¨λ¦΄ κ²ƒμ…λ‹λ‹¤:        β”‚
β”‚  - RSA (μΈμλ¶„ν•΄)                                                   β”‚
β”‚  - ECDSA/ECDH (νƒ€μ› κ³΅μ„  μ΄μ‚° λ΅κ·Έ)                                β”‚
β”‚  - DH (μ΄μ‚° λ΅κ·Έ)                                                   β”‚
β”‚                                                                      β”‚
β”‚  μ–‘μμ— μν–¥λ°›μ§€ μ•μ:                                              β”‚
β”‚  - AES (Grover μ•κ³ λ¦¬μ¦μ΄ μ ν¨ ν‚¤ ν¬κΈ°λ¥Ό μ λ°μΌλ΅:                 β”‚
β”‚    AES-256 β†’ ~128λΉ„νΈ λ³΄μ•, μ—¬μ „ν μ•μ „)                          β”‚
β”‚  - SHA-256 (μ μ‚¬ν• μ λ°, μ—¬μ „ν μ μ ν•¨)                            β”‚
β”‚                                                                      β”‚
β”‚  NIST PQC ν‘μ¤€ (2024 ν™•μ •):                                        β”‚
β”‚  β”β”€β”€ ML-KEM (CRYSTALS-Kyber) β€” ν‚¤ μΊ΅μν™”                          β”‚
β”‚  β”β”€β”€ ML-DSA (CRYSTALS-Dilithium) β€” λ””μ§€ν„Έ μ„λ…                    β”‚
β”‚  β”β”€β”€ SLH-DSA (SPHINCS+) β€” ν•΄μ‹ κΈ°λ° μ„λ…                         β”‚
β”‚  β””β”€β”€ FN-DSA (FALCON) β€” κ²©μ κΈ°λ° μ„λ…                            β”‚
β”‚                                                                      β”‚
β”‚  ν„μ¬ κ¶μ¥ μ‚¬ν•­: ν•μ΄λΈλ¦¬λ“ λ¨λ“                                    β”‚
β”‚  - ν‚¤ κµν™μ— X25519 + ML-KEMμ„ ν•¨κ» μ‚¬μ©                          β”‚
β”‚  - κ³ μ „ λλ” PQ μ•κ³ λ¦¬μ¦μ΄ κΉ¨μ Έλ„ μ—¬μ „ν μ•μ „                      β”‚
β”‚  - Chrome, Firefox, Cloudflareκ°€ μ΄λ―Έ ν•μ΄λΈλ¦¬λ“ PQ μ§€μ›          β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="13">13. μ—°μµ λ¬Έμ <a class="header-link" href="#13" title="Permanent link">&para;</a></h2>
<h3 id="1_1">μ—°μµ λ¬Έμ  1: λ€μΉ­ μ•”νΈν™” (μ΄κΈ‰)<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>λ‹¤μμ„ μν–‰ν•λ” Python ν•¨μλ¥Ό μ‘μ„±ν•μ„Έμ”:
1. ν‰λ¬Έ λ¬Έμμ—΄κ³Ό λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥μΌλ΅ λ°›κΈ°
2. PBKDF2λ¥Ό μ‚¬μ©ν•μ—¬ λΉ„λ°€λ²νΈλ΅λ¶€ν„° AES-256 ν‚¤ μ λ„ (λλ¤ salt μ‚¬μ©)
3. AES-GCMμΌλ΅ ν‰λ¬Έ μ•”νΈν™”
4. salt + nonce + ciphertextλ¥Ό ν¬ν•¨ν•λ” λ‹¨μΌ base64 μΈμ½”λ”© λ¬Έμμ—΄ λ°ν™
5. ν•΄λ‹Ήν•λ” λ³µνΈν™” ν•¨μ μ‘μ„±</p>
<p>ννΈ:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.pbkdf2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PBKDF2HMAC</span>
<span class="c1"># Use iterations=600000, salt_size=16, nonce_size=12</span>
</code></pre></div>

<h3 id="2_1">μ—°μµ λ¬Έμ  2: ν•μ΄λΈλ¦¬λ“ μ•”νΈν™” (μ¤‘κΈ‰)<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>PGPμ™€ μ μ‚¬ν• μ•”νΈν™”μ κ°„λ‹¨ν• λ²„μ „μ„ κµ¬ν„ν•μ„Έμ”:
1. Aliceκ°€ RSA-4096 ν‚¤ μ μƒμ„±
2. Bobμ΄ RSA-4096 ν‚¤ μ μƒμ„±
3. Aliceκ°€ Bobμ—κ² μ„λ…λκ³  μ•”νΈν™”λ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄λ ¤κ³  ν•¨:
   - Aliceμ κ°μΈ ν‚¤λ΅ λ©”μ‹μ§€ μ„λ…
   - λλ¤ AES-256 ν‚¤ μƒμ„±
   - AES-GCMμΌλ΅ λ©”μ‹μ§€ μ•”νΈν™”
   - Bobμ κ³µκ° RSA ν‚¤λ΅ AES ν‚¤ μ•”νΈν™”
   - ν¨ν‚¤μ§€: encrypted_key + nonce + ciphertext + signature + alice_public_key
4. Bobμ΄ ν¨ν‚¤μ§€λ¥Ό λ°›μ•„μ„:
   - μμ‹ μ κ°μΈ RSA ν‚¤λ΅ AES ν‚¤ λ³µνΈν™”
   - AES-GCMμΌλ΅ λ©”μ‹μ§€ λ³µνΈν™”
   - Aliceμ κ³µκ° ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ„λ… κ²€μ¦</p>
<h3 id="3_1">μ—°μµ λ¬Έμ  3: ν‚¤ κµν™ ν”„λ΅ν† μ½ (μ¤‘κΈ‰)<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>Aliceμ™€ Bob κ°„μ μ•μ „ν• μ±„ν… μ‹λ®¬λ μ΄μ…:
1. λ‘ λ‹Ήμ‚¬μ λ¨λ‘ X25519 ν‚¤ κµν™ μν–‰
2. HKDFλ¥Ό μ‚¬μ©ν•μ—¬ κ° λ°©ν–¥μ— λ€ν• λ³„λ„ ν‚¤ μ λ„ (Alice-to-Bob, Bob-to-Alice)
3. κ° λ©”μ‹μ§€λ” κ³ μ ν• nonceλ¥Ό λ°›μ (μΉ΄μ΄ν„° μ‚¬μ©)
4. λ©”μ‹μ§€λ” ChaCha20-Poly1305λ΅ μ•”νΈν™”λ¨
5. μ¬μƒ κ³µκ²©μ„ κ°μ§€ν•κΈ° μ„ν• λ©”μ‹μ§€ μΉ΄μ΄ν„° ν¬ν•¨</p>
<h3 id="4-nonce">μ—°μµ λ¬Έμ  4: Nonce μ¬μ‚¬μ© κ³µκ²© (κ³ κΈ‰)<a class="header-link" href="#4-nonce" title="Permanent link">&para;</a></h3>
<p>λ™μΌν• ν‚¤μ™€ nonceλ¥Ό μ‚¬μ©ν•μ—¬ AES-CTRλ΅ μ•”νΈν™”λ λ‘ κ°μ μ•”νΈλ¬Έμ΄ μ£Όμ–΄μ΅μ„ λ•:</p>
<div class="highlight"><pre><span></span><code>ct1 = bytes.fromhex(&quot;a1b2c3d4e5f6071829&quot;)
ct2 = bytes.fromhex(&quot;b4a3d2c5f4e7162738&quot;)
</code></pre></div>

<p>κ·Έλ¦¬κ³  plaintext1μ΄ <code>b"plaintext"</code>μ„μ„ μ• λ•:
1. plaintext2 λ³µκµ¬
2. μ΄ κ³µκ²©μ΄ μν•™μ μΌλ΅ μ™ μ‘λ™ν•λ”μ§€ μ„¤λ…
3. μ΄ μ·¨μ•½μ μ„ λ°©μ§€ν•λ” λ°©λ²• μ„¤λ…</p>
<h3 id="5">μ—°μµ λ¬Έμ  5: λ””μ§€ν„Έ μ„λ… κ²€μ¦ (κ³ κΈ‰)<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>κ°„λ‹¨ν• μ½”λ“ μ„λ… μ‹μ¤ν… κµ¬μ¶•:
1. "λ°ν–‰μ"κ°€ Ed25519λ΅ Python μ¤ν¬λ¦½νΈ μ„λ…
2. "μ‹¤ν–‰μ"κ°€ μ¤ν¬λ¦½νΈ μ‹¤ν–‰ μ „μ— μ„λ… κ²€μ¦
3. μ‹ λΆ°ν•  μ μλ” κ³µκ° ν‚¤ λ μ§€μ¤νΈλ¦¬ μ μ§€
4. ν‚¤ λ΅ν…μ΄μ… μ²λ¦¬ (μ΄μ „ μ„λ…μ€ μ΄μ „ ν‚¤λ΅ μ—¬μ „ν μ ν¨ν•΄μ•Ό ν•¨)
5. νƒ€μ„μ¤νƒ¬ν”„ κ²€μ¦ μ¶”κ°€ (30μΌ μ΄μƒ λ μ„λ… κ±°λ¶€)</p>
<h3 id="6_1">μ—°μµ λ¬Έμ  6: μ•”νΈν•™μ  κ°μ‚¬ (κ³ κΈ‰)<a class="header-link" href="#6_1" title="Permanent link">&para;</a></h3>
<p>λ‹¤μ μ½”λ“λ¥Ό κ²€ν† ν•κ³  λ¨λ“  μ•”νΈν•™μ  μ·¨μ•½μ μ„ μ‹λ³„ν•μ„Έμ”. μµμ† 8κ°μ λ¬Έμ κ°€ μμµλ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>  <span class="c1"># PyCryptodome</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_message</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>  <span class="c1"># 128-bit key from MD5</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mi">16</span>  <span class="c1"># Static IV</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>

    <span class="c1"># Manual padding</span>
    <span class="n">pad_len</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">message</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">pad_len</span><span class="p">)</span> <span class="o">*</span> <span class="n">pad_len</span>

    <span class="n">encrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">padded</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">verify_password</span><span class="p">(</span><span class="n">stored_hash</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">stored_hash</span>
</code></pre></div>

<p>κ° μ·¨μ•½μ μ— λ€ν•΄ λ‹¤μμ„ μ„¤λ…ν•μ„Έμ”:
- λ¬΄μ—‡μ΄ μλ»λμ—λ”μ§€
- μ™ μ„ν—ν•μ§€
- μ–΄λ–»κ² μμ •ν•λ”μ§€</p>
<hr />
<h2 id="14">14. μ°Έκ³  μλ£<a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<ul>
<li>Ferguson, Schneier, Kohno. <em>Cryptography Engineering</em>. Wiley, 2010.</li>
<li>Bernstein, D.J. "Curve25519: New Diffie-Hellman Speed Records". 2006.</li>
<li>NIST SP 800-175B: Guideline for Using Cryptographic Standards</li>
<li>NIST Post-Quantum Cryptography - https://csrc.nist.gov/projects/post-quantum-cryptography</li>
<li>Python <code>cryptography</code> library docs - https://cryptography.io/</li>
<li>Latacora, "Cryptographic Right Answers" (2018, updated regularly)</li>
<li>RFC 8032: Edwards-Curve Digital Signature Algorithm (EdDSA)</li>
<li>RFC 8439: ChaCha20 and Poly1305 for IETF Protocols</li>
</ul>
<hr />
<p><strong>μ΄μ „</strong>: <a href="./01_Security_Fundamentals.md">01. Security κΈ°μ΄</a> | <strong>λ‹¤μ</strong>: <a href="./03_Hashing_and_Integrity.md">03. Hashingκ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/01_Security_Fundamentals.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security κΈ°μ΄μ™€ Threat Modeling</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/03_Hashing_and_Integrity.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">β†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}