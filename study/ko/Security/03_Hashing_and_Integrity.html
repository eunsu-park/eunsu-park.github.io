{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„± - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">π </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">π’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        ν•κµ­μ–΄
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">β€οΈ</span>
                    <span class="theme-icon dark">π™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/02_Cryptography_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Cryptography κΈ°μ΄</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/04_TLS_and_PKI.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">λ©μ°¨</a></li>
<li><a href="#1">1. ν•΄μ‹ ν•¨μλ€ λ¬΄μ—‡μΈκ°€?</a><ul>
<li><a href="#11-vs">1.1 λΉ„μ•”νΈν•™μ  vs μ•”νΈν•™μ  ν•΄μ‹</a></li>
</ul>
</li>
<li><a href="#2">2. μ•”νΈν•™μ  ν•΄μ‹ μ†μ„±</a><ul>
<li><a href="#21">2.1 λμ‚¬νƒ ν¨κ³Ό</a></li>
</ul>
</li>
<li><a href="#3">3. ν•΄μ‹ ν•¨μ μ΅°μ‚¬</a><ul>
<li><a href="#31">3.1 ν•΄μ‹ ν•¨μ λΉ„κµ</a></li>
<li><a href="#32-sha-2">3.2 SHA-2 ν¨λ°€λ¦¬</a></li>
<li><a href="#33-sha-3-keccak">3.3 SHA-3 (Keccak)</a></li>
<li><a href="#34-blake2-blake3">3.4 BLAKE2μ™€ BLAKE3</a></li>
</ul>
</li>
<li><a href="#4-hashlib-python">4. hashlibλ¥Ό μ‚¬μ©ν• Python ν•΄μ‹±</a><ul>
<li><a href="#41">4.1 κΈ°λ³Έ ν•΄μ‹±</a></li>
<li><a href="#42">4.2 μ¦λ¶„ ν•΄μ‹± (μ¤νΈλ¦¬λ°)</a></li>
<li><a href="#43-blake2">4.3 ν‚¤λ¥Ό μ‚¬μ©ν• BLAKE2 (ν‚¤ ν•΄μ‹±)</a></li>
<li><a href="#44-blake3">4.4 BLAKE3</a></li>
</ul>
</li>
<li><a href="#5">5. ν¨μ¤μ›λ“ ν•΄μ‹±</a><ul>
<li><a href="#51-bcrypt">5.1 bcrypt</a></li>
<li><a href="#52-scrypt">5.2 scrypt</a></li>
<li><a href="#53-argon2">5.3 Argon2 (κ¶μ¥)</a></li>
<li><a href="#54">5.4 ν¨μ¤μ›λ“ ν•΄μ‹± λΉ„κµ</a></li>
<li><a href="#55">5.5 μ™„μ „ν• ν¨μ¤μ›λ“ μ €μ¥ μ‹μ¤ν…</a></li>
</ul>
</li>
<li><a href="#6-hmac">6. HMAC: λ©”μ‹μ§€ μΈμ¦</a><ul>
<li><a href="#61-python-hmac">6.1 Pythonμ—μ„ HMAC</a></li>
<li><a href="#62-api">6.2 μ‹¤μ©: API μ”μ²­ μ„λ…</a></li>
<li><a href="#63">6.3 μ›Ήν›… μ„λ… κ²€μ¦</a></li>
</ul>
</li>
<li><a href="#7-merkle">7. Merkle νΈλ¦¬</a><ul>
<li><a href="#71-merkle">7.1 Merkle νΈλ¦¬ κµ¬ν„</a></li>
</ul>
</li>
<li><a href="#8">8. λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ†</a><ul>
<li><a href="#81-cas">8.1 CAS κµ¬ν„</a></li>
<li><a href="#82-git">8.2 Git μ¤νƒ€μΌ κ°μ²΄ μ €μ¥μ†</a></li>
</ul>
</li>
<li><a href="#9">9. νƒ€μ΄λ° κ³µκ²©κ³Ό μƒμ μ‹κ°„ λΉ„κµ</a><ul>
<li><a href="#91">9.1 λ¬Έμ </a></li>
<li><a href="#92-vs">9.2 μ·¨μ•½ν• vs μ•μ „ν• λΉ„κµ</a></li>
<li><a href="#93">9.3 νƒ€μ΄λ° μ•μ „ μ½”λ“λ¥Ό μ„ν• κ·μΉ™</a></li>
</ul>
</li>
<li><a href="#10">10. ν•΄μ‹ ν•¨μ κ³µκ²©κ³Ό μ™„ν™”</a><ul>
<li><a href="#101">10.1 μ•λ ¤μ§„ κ³µκ²©</a></li>
<li><a href="#102">10.2 κΈΈμ΄ ν™•μ¥ κ³µκ²©</a></li>
</ul>
</li>
<li><a href="#11">11. μ—°μµ λ¬Έμ </a><ul>
<li><a href="#1_1">μ—°μµ 1: ν•΄μ‹ νƒμƒ‰κΈ° (μ΄κΈ‰)</a></li>
<li><a href="#2_1">μ—°μµ 2: ν¨μ¤μ›λ“ ν¬λμ»¤ λ°©μ–΄ (μ¤‘κΈ‰)</a></li>
<li><a href="#3-merkle">μ—°μµ 3: Merkle νΈλ¦¬ νμΌ κ²€μ¦κΈ° (μ¤‘κΈ‰)</a></li>
<li><a href="#4-hmac-api">μ—°μµ 4: HMAC κΈ°λ° API μΈμ¦ (μ¤‘κΈ‰)</a></li>
<li><a href="#5_1">μ—°μµ 5: λ‚΄μ© μ£Όμ† μ§€μ • νμΌ λ™κΈ°ν™” (κ³ κΈ‰)</a></li>
<li><a href="#6">μ—°μµ 6: νƒ€μ΄λ° κ³µκ²© μ‹¤ν—μ‹¤ (κ³ κΈ‰)</a></li>
</ul>
</li>
<li><a href="#12">12. μ°Έκ³  λ¬Έν—</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>μ΄μ „</strong>: <a href="./02_Cryptography_Basics.md">02. μ•”νΈν•™ κΈ°μ΄</a> | <strong>λ‹¤μ</strong>: <a href="./04_TLS_and_PKI.md">04. TLS/SSLκ³Ό κ³µκ°ν‚¤ μΈν”„λΌ</a></p>
<hr />
<p>ν•΄μ‹ ν•¨μλ” ν„λ€ λ³΄μ•μ ν•µμ‹¬ λ„κµ¬μ…λ‹λ‹¤. ν¨μ¤μ›λ“ μ €μ¥, λ””μ§€ν„Έ μ„λ…, λ©”μ‹μ§€ μΈμ¦, λΈ”λ΅μ²΄μΈ, μ†ν”„νΈμ›¨μ–΄ λ°°ν¬, λ°μ΄ν„° μ¤‘λ³µ μ κ±° λ“± λ¨λ“  κ³³μ—μ„ μ‚¬μ©λ©λ‹λ‹¤. μ΄ λ μ¨μ€ ν•΄μ‹ ν•¨μμ μ μ©ν•¨μ„ λ§λ“λ” μν•™μ  μ†μ„±λ¶€ν„° ν¨μ¤μ›λ“ ν•΄μ‹±, HMAC, Merkle νΈλ¦¬μ μ‹¤μ©μ  κµ¬ν„κΉμ§€ ν•΄μ‹ ν•¨μλ¥Ό μ‹¬λ„ μκ² λ‹¤λ£Ήλ‹λ‹¤.</p>
<p><strong>λ‚μ΄λ„</strong>: β­β­β­</p>
<p><strong>ν•™μµ λ©ν‘</strong>:
- μ•”νΈν•™μ  ν•΄μ‹ ν•¨μμ μ†μ„± μ΄ν•΄
- SHA-256, SHA-3, BLAKE2, BLAKE3λ¥Ό μ‚¬μ©ν• ν•΄μ‹± κµ¬ν„
- bcrypt, scrypt, Argon2λ¥Ό μ‚¬μ©ν• μ•μ „ν• ν¨μ¤μ›λ“ μ €μ¥
- λ©”μ‹μ§€ μΈμ¦μ„ μ„ν• HMAC κµ¬μ„± λ° κ²€μ¦
- Merkle νΈλ¦¬ κµ¬μ¶• λ° μ΄ν•΄
- λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ† κµ¬ν„
- μƒμ μ‹κ°„ λΉ„κµλ¥Ό μ‚¬μ©ν• νƒ€μ΄λ° κ³µκ²© μΈμ‹ λ° λ°©μ§€</p>
<hr />
<h2 id="_2">λ©μ°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ν•΄μ‹-ν•¨μλ€-λ¬΄μ—‡μΈκ°€">ν•΄μ‹ ν•¨μλ€ λ¬΄μ—‡μΈκ°€?</a></li>
<li><a href="#2-μ•”νΈν•™μ -ν•΄μ‹-μ†μ„±">μ•”νΈν•™μ  ν•΄μ‹ μ†μ„±</a></li>
<li><a href="#3-ν•΄μ‹-ν•¨μ-μ΅°μ‚¬">ν•΄μ‹ ν•¨μ μ΅°μ‚¬</a></li>
<li><a href="#4-hashlibλ¥Ό-μ‚¬μ©ν•-python-ν•΄μ‹±">hashlibλ¥Ό μ‚¬μ©ν• Python ν•΄μ‹±</a></li>
<li><a href="#5-ν¨μ¤μ›λ“-ν•΄μ‹±">ν¨μ¤μ›λ“ ν•΄μ‹±</a></li>
<li><a href="#6-hmac-λ©”μ‹μ§€-μΈμ¦">HMAC: λ©”μ‹μ§€ μΈμ¦</a></li>
<li><a href="#7-merkle-νΈλ¦¬">Merkle νΈλ¦¬</a></li>
<li><a href="#8-λ‚΄μ©-μ£Όμ†-μ§€μ •-μ €μ¥μ†">λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ†</a></li>
<li><a href="#9-νƒ€μ΄λ°-κ³µκ²©κ³Ό-μƒμ-μ‹κ°„-λΉ„κµ">νƒ€μ΄λ° κ³µκ²©κ³Ό μƒμ μ‹κ°„ λΉ„κµ</a></li>
<li><a href="#10-ν•΄μ‹-ν•¨μ-κ³µκ²©κ³Ό-μ™„ν™”">ν•΄μ‹ ν•¨μ κ³µκ²©κ³Ό μ™„ν™”</a></li>
<li><a href="#11-μ—°μµ-λ¬Έμ ">μ—°μµ λ¬Έμ </a></li>
<li><a href="#12-μ°Έκ³ -λ¬Έν—">μ°Έκ³  λ¬Έν—</a></li>
</ol>
<hr />
<h2 id="1">1. ν•΄μ‹ ν•¨μλ€ λ¬΄μ—‡μΈκ°€?<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<p>ν•΄μ‹ ν•¨μλ” μ„μ κΈΈμ΄μ μ…λ ¥μ„ λ°›μ•„ κ³ μ • κΈΈμ΄μ μ¶λ ¥("ν•΄μ‹" λλ” "λ‹¤μ΄μ μ¤νΈ")μ„ μƒμ„±ν•©λ‹λ‹¤. <strong>μ•”νΈν•™μ </strong> ν•΄μ‹ ν•¨μλ” λ³΄μ• μ• ν”λ¦¬μΌ€μ΄μ…μ— μ ν•©ν•κ² λ§λ“λ” μ¶”κ°€μ μΈ λ³΄μ• μ†μ„±μ„ κ°€μ§€κ³  μμµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                       ν•΄μ‹ ν•¨μ                                       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚   μ…λ ¥ (μ„μ ν¬κΈ°)        ν•΄μ‹ ν•¨μ             μ¶λ ¥ (κ³ μ •)           β”‚
β”‚   β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€        β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€         β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€        β”‚
β”‚                                                                      β”‚
β”‚   &quot;Hello&quot;           β”€β”€β”€β”€β”€β”€β–¶  SHA-256  β”€β”€β”€β”€β”€β”€β–¶  2cf24dba5fb0...      β”‚
β”‚   (5 bytes)                                    (32 bytes / 256 bits) β”‚
β”‚                                                                      β”‚
β”‚   &quot;Hello World&quot;     β”€β”€β”€β”€β”€β”€β–¶  SHA-256  β”€β”€β”€β”€β”€β”€β–¶  a591a6d40bf4...      β”‚
β”‚   (11 bytes)                                   (32 bytes / 256 bits) β”‚
β”‚                                                                      β”‚
β”‚   μ „μκ³Ό ν‰ν™”         β”€β”€β”€β”€β”€β”€β–¶  SHA-256  β”€β”€β”€β”€β”€β”€β–¶  b28f8b893c45...      β”‚
β”‚   (~3.2 MB)                                    (32 bytes / 256 bits) β”‚
β”‚                                                                      β”‚
β”‚   ν•µμ‹¬ ν†µμ°°: μ…λ ¥ ν¬κΈ°μ— κ΄€κ³„μ—†μ΄ μ¶λ ¥μ€ ν•­μƒ λ™μΌν• κ³ μ • ν¬κΈ°μ…λ‹λ‹¤.  β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="11-vs">1.1 λΉ„μ•”νΈν•™μ  vs μ•”νΈν•™μ  ν•΄μ‹<a class="header-link" href="#11-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚<span class="w">        </span>λΉ„μ•”νΈν•™μ <span class="w"> </span><span class="nv">vs</span><span class="w"> </span>μ•”νΈν•™μ <span class="w"> </span>ν•΄μ‹<span class="w"> </span>ν•¨μ<span class="w">                                </span>β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚<span class="w">                  </span>β”‚<span class="w"> </span>λΉ„μ•”νΈν•™μ <span class="w">            </span>β”‚<span class="w"> </span>μ•”νΈν•™μ <span class="w">                   </span>β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚<span class="w"> </span>λ©μ <span class="w">             </span>β”‚<span class="w"> </span>ν•΄μ‹<span class="w"> </span>ν…μ΄λΈ”,<span class="w"> </span>μ²΄ν¬μ„¬<span class="w">   </span>β”‚<span class="w"> </span>λ³΄μ•<span class="w"> </span>μ• ν”λ¦¬μΌ€μ΄μ…<span class="w">          </span>β”‚
β”‚<span class="w"> </span>μ†λ„<span class="w">             </span>β”‚<span class="w"> </span>λ§¤μ°<span class="w"> </span>λΉ λ¦„<span class="w">             </span>β”‚<span class="w"> </span>μλ„μ μΌλ΅<span class="w"> </span>λλ¦Ό<span class="w">            </span>β”‚
β”‚<span class="w"> </span>μ¶©λ<span class="w"> </span>μ €ν•­μ„±<span class="w">       </span>β”‚<span class="w"> </span>μ•½ν•¨<span class="w"> </span><span class="o">/</span><span class="w"> </span>μ—†μ<span class="w">           </span>β”‚<span class="w"> </span>κ°•ν•¨<span class="w"> </span><span class="ss">(</span>ν•„μ<span class="ss">)</span><span class="w">                </span>β”‚
β”‚<span class="w"> </span>μ›μƒ<span class="w"> </span>μ €ν•­μ„±<span class="w">       </span>β”‚<span class="w"> </span>λ³΄μ¥λμ§€<span class="w"> </span>μ•μ<span class="w">         </span>β”‚<span class="w"> </span>κ°•ν•¨<span class="w"> </span><span class="ss">(</span>ν•„μ<span class="ss">)</span><span class="w">                </span>β”‚
β”‚<span class="w"> </span>μμ‹<span class="w">             </span>β”‚<span class="w"> </span><span class="k">CRC32</span>,<span class="w"> </span><span class="nv">MurmurHash</span>,<span class="w">   </span>β”‚<span class="w"> </span><span class="nv">SHA</span><span class="o">-</span><span class="mi">256</span>,<span class="w"> </span><span class="nv">SHA</span><span class="o">-</span><span class="mi">3</span>,<span class="w"> </span><span class="nv">BLAKE2</span>,<span class="w">   </span>β”‚
β”‚<span class="w">                  </span>β”‚<span class="w"> </span><span class="nv">xxHash</span>,<span class="w"> </span><span class="nv">FNV</span><span class="w">          </span>β”‚<span class="w"> </span><span class="nv">BLAKE3</span><span class="w">                    </span>β”‚
β”‚<span class="w"> </span>μ‚¬μ©<span class="w"> </span>μ‚¬λ΅€<span class="w">         </span>β”‚<span class="w"> </span>ν•΄μ‹<span class="w"> </span>λ§µ,<span class="w"> </span>μ²΄ν¬μ„¬,<span class="w">      </span>β”‚<span class="w"> </span>ν¨μ¤μ›λ“,<span class="w"> </span>μ„λ…,<span class="w">            </span>β”‚
β”‚<span class="w">                  </span>β”‚<span class="w"> </span>μ¤‘λ³µ<span class="w"> </span>μ κ±°<span class="w">             </span>β”‚<span class="w"> </span>μΈμ¦μ„,<span class="w"> </span><span class="nv">HMAC</span><span class="w">              </span>β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚<span class="w"> </span>κ·μΉ™:<span class="w"> </span>λ³΄μ•<span class="w"> </span>λ©μ μΌλ΅<span class="w"> </span>λΉ„μ•”νΈν•™μ <span class="w"> </span>ν•΄μ‹λ¥Ό<span class="w"> </span>μ λ€<span class="w"> </span>μ‚¬μ©ν•μ§€<span class="w"> </span>λ§μ‹­μ‹μ¤.<span class="w">         </span>β”‚
β”‚<span class="w"> </span>μ†λ„κ°€<span class="w"> </span>μ¤‘μ”ν•κ³ <span class="w"> </span>λ³΄μ•μ΄<span class="w"> </span>μ¤‘μ”ν•μ§€<span class="w"> </span>μ•μ€<span class="w"> </span>κ²½μ°<span class="w"> </span>μ•”νΈν•™μ <span class="w"> </span>ν•΄μ‹λ¥Ό<span class="w"> </span>μ λ€<span class="w">        </span>β”‚
β”‚<span class="w"> </span>μ‚¬μ©ν•μ§€<span class="w"> </span>λ§μ‹­μ‹μ¤<span class="w"> </span><span class="ss">(</span>μ:<span class="w"> </span>ν•΄μ‹<span class="w"> </span>ν…μ΄λΈ”<span class="ss">)</span>.<span class="w">                                 </span>β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="2">2. μ•”νΈν•™μ  ν•΄μ‹ μ†μ„±<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<p>μ•μ „ν• μ•”νΈν•™μ  ν•΄μ‹ ν•¨μλ” μ„Έ κ°€μ§€ μ†μ„±μ„ λ§μ΅±ν•΄μ•Ό ν•©λ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚             μ•”νΈν•™μ  ν•΄μ‹μ μ„Έ κ°€μ§€ μ†μ„±                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  1. μ›μƒ μ €ν•­μ„± (λ‹¨λ°©ν–¥)                                              β”‚
β”‚     ν•΄μ‹ hκ°€ μ£Όμ–΄μ΅μ„ λ•, H(m) = hλ¥Ό λ§μ΅±ν•λ” mμ„ μ°Ύλ” κ²ƒμ΄            β”‚
β”‚     λ¶κ°€λ¥ν•©λ‹λ‹¤.                                                     β”‚
β”‚                                                                      β”‚
β”‚     ν•΄μ‹ β”€β”€β•³β”€β”€β–¶ μ›λ³Έ μ…λ ¥                                           β”‚
β”‚     (ν•΄μ‹λ¥Ό μ—­μΌλ΅ κ³„μ‚°ν•μ—¬ μ…λ ¥μ„ μ–»μ„ μ μ—†μµλ‹λ‹¤)                   β”‚
β”‚                                                                      β”‚
β”‚  2. μ 2 μ›μƒ μ €ν•­μ„± (μ•½ν• μ¶©λ μ €ν•­μ„±)                                β”‚
β”‚     mβ‚μ΄ μ£Όμ–΄μ΅μ„ λ•, H(mβ‚) = H(mβ‚‚)λ¥Ό λ§μ΅±ν•λ” mβ‚‚ β‰  mβ‚μ„            β”‚
β”‚     μ°Ύλ” κ²ƒμ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.                                           β”‚
β”‚                                                                      β”‚
β”‚     &quot;Hello&quot; β†’ abc123    λ‹¤λ¥Έ μ…λ ¥ β†’ abc123μ„ μ°Ύμ„ μ μ—†μ            β”‚
β”‚     (λ™μΌν• ν•΄μ‹λ¥Ό κ°€μ§„ λ‘ λ²μ§Έ μ…λ ¥μ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤)               β”‚
β”‚                                                                      β”‚
β”‚  3. μ¶©λ μ €ν•­μ„± (κ°•ν• μ¶©λ μ €ν•­μ„±)                                    β”‚
β”‚     H(mβ‚) = H(mβ‚‚)λ¥Ό λ§μ΅±ν•λ” μ„λ΅ λ‹¤λ¥Έ λ‘ λ©”μ‹μ§€ mβ‚ β‰  mβ‚‚λ¥Ό           β”‚
β”‚     μ°Ύλ” κ²ƒμ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.                                           β”‚
β”‚                                                                      β”‚
β”‚     λ™μΌν• ν•΄μ‹λ¥Ό κ°€μ§„ μ…λ ¥ μμ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤                      β”‚
β”‚     (μ΄κ²ƒμ€ μ 2 μ›μƒ μ €ν•­μ„±λ³΄λ‹¤ μ—„κ²©ν•κ² κ°•ν•©λ‹λ‹¤)                     β”‚
β”‚                                                                      β”‚
β”‚  λ³΄μ• μμ¤€ (nλΉ„νΈ ν•΄μ‹μ κ²½μ°):                                       β”‚
β”‚  β€Ά μ›μƒ:         O(2^n) μ‘μ—… (μƒμΌ μ—­μ„¤μ΄ μ μ©λμ§€ μ•μ)              β”‚
β”‚  β€Ά μ 2 μ›μƒ:     O(2^n) μ‘μ—…                                         β”‚
β”‚  β€Ά μ¶©λ:         O(2^(n/2)) μ‘μ—… (μƒμΌ μ—­μ„¤)                         β”‚
β”‚                                                                      β”‚
β”‚  μ΄κ²ƒμ΄ SHA-256μ΄ 128λΉ„νΈ μ¶©λ μ €ν•­μ„±μ„ μ κ³µν•λ” μ΄μ μ…λ‹λ‹¤            β”‚
β”‚  (2^128 β‰ 3.4 Γ— 10^38 μ—°μ‚°).                                        β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="21">2.1 λμ‚¬νƒ ν¨κ³Ό<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>μΆ‹μ€ ν•΄μ‹ ν•¨μλ” <strong>λμ‚¬νƒ ν¨κ³Ό</strong>λ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤: μ…λ ¥μ μ‘μ€ λ³€ν™”κ°€ μ „ν€ λ‹¤λ¥Έ μ¶λ ¥μ„ μƒμ„±ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>

<span class="c1"># λμ‚¬νƒ ν¨κ³Ό μ‹μ—°</span>
<span class="n">msg1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">msg2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, World?&quot;</span>  <span class="c1"># &#39;!&#39;λ¥Ό &#39;?&#39;λ΅ λ³€κ²½</span>
<span class="n">msg3</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, World! &quot;</span> <span class="c1"># κ³µλ°± μ¶”κ°€</span>

<span class="n">hash1</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">msg1</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="n">hash2</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="n">hash3</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">msg3</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Avalanche Effect Demonstration (SHA-256):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">msg1</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; β†’ </span><span class="si">{</span><span class="n">hash1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">msg2</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; β†’ </span><span class="si">{</span><span class="n">hash2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">msg3</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;β†’ </span><span class="si">{</span><span class="n">hash3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ‹¤λ¥Έ λΉ„νΈ μ κ³„μ‚°</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bit_difference</span><span class="p">(</span><span class="n">hex1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hex2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;λ‘ 16μ§„μ λ¬Έμμ—΄ κ°„μ λ‹¤λ¥Έ λΉ„νΈ μλ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hex1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hex2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">xor</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">^</span> <span class="n">b2</span>
    <span class="n">diff_bits</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">xor</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">total_bits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hex1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="k">return</span> <span class="n">diff_bits</span><span class="p">,</span> <span class="n">total_bits</span>

<span class="n">diff</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">bit_difference</span><span class="p">(</span><span class="n">hash1</span><span class="p">,</span> <span class="n">hash2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  λ³€κ²½λ λΉ„νΈ (1μ μ°¨μ΄): </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">diff</span><span class="o">/</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="n">diff2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">bit_difference</span><span class="p">(</span><span class="n">hash1</span><span class="p">,</span> <span class="n">hash3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  λ³€κ²½λ λΉ„νΈ (κ³µλ°± μ¶”κ°€): </span><span class="si">{</span><span class="n">diff2</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">diff2</span><span class="o">/</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="c1"># μ΄μƒμ : λ¨λ“  λ³€κ²½μ— λ€ν•΄ μ•½ 50%μ λΉ„νΈκ°€ λ‹¤λ¦„</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  λ¬΄μ‘μ„ μμƒ: ~</span><span class="si">{</span><span class="n">total</span><span class="o">//</span><span class="mi">2</span><span class="si">}</span><span class="s2"> λΉ„νΈ (</span><span class="si">{</span><span class="mf">50.0</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ν•΄μ‹ ν•¨μ μ΅°μ‚¬<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ν•΄μ‹ ν•¨μ λΉ„κµ<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                ν•΄μ‹ ν•¨μ λΉ„κµ ν‘                                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ•κ³ λ¦¬μ¦    β”‚ μ¶λ ¥   β”‚ μ†λ„      β”‚ μƒνƒ     β”‚ μ°Έκ³                    β”‚
β”‚            β”‚ (λΉ„νΈ) β”‚ (GB/s)*   β”‚          β”‚                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ MD5        β”‚ 128    β”‚ ~5.0      β”‚ μ†μƒλ¨   β”‚ 2004λ…„ μ¶©λ λ°κ²¬       β”‚
β”‚ SHA-1      β”‚ 160    β”‚ ~3.0      β”‚ μ†μƒλ¨   β”‚ 2017λ…„ SHAttered κ³µκ²©  β”‚
β”‚ SHA-256    β”‚ 256    β”‚ ~1.5      β”‚ μ•μ „     β”‚ κ°€μ¥ λ„λ¦¬ μ‚¬μ©λ¨       β”‚
β”‚ SHA-512    β”‚ 512    β”‚ ~2.0β€      β”‚ μ•μ „     β”‚ 64λΉ„νΈ CPUμ—μ„ λ” λΉ λ¦„ β”‚
β”‚ SHA-3-256  β”‚ 256    β”‚ ~0.5      β”‚ μ•μ „     β”‚ λ‹¤λ¥Έ κµ¬μ΅°              β”‚
β”‚ BLAKE2b    β”‚ 256    β”‚ ~3.5      β”‚ μ•μ „     β”‚ SHA-256λ³΄λ‹¤ λΉ λ¦„       β”‚
β”‚ BLAKE2s    β”‚ 256    β”‚ ~2.0      β”‚ μ•μ „     β”‚ 32λΉ„νΈ μµμ ν™”          β”‚
β”‚ BLAKE3     β”‚ 256    β”‚ ~10.0     β”‚ μ•μ „     β”‚ λ³‘λ ¬ν™” κ°€λ¥, μµμ‹       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ * ν•λ“μ›¨μ–΄ μ§€μ›μ΄ μλ” μµμ‹  x86-64μ—μ„μ λ€λµμ μΈ μ²λ¦¬λ‰              β”‚
β”‚ β€  SHA-512λ” 64λΉ„νΈ ν”„λ΅μ„Έμ„μ—μ„ SHA-256λ³΄λ‹¤ λΉ λ¦„                     β”‚
β”‚                                                                      β”‚
β”‚ κ¶μ¥ μ‚¬ν•­: μƒνΈ μ΄μ©μ„±μ„ μ„ν•΄ SHA-256, μ„±λ¥μ— λ―Όκ°ν• μ• ν”λ¦¬μΌ€μ΄μ…μ„   β”‚
β”‚ μ„ν•΄ BLAKE2b/BLAKE3                                                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="32-sha-2">3.2 SHA-2 ν¨λ°€λ¦¬<a class="header-link" href="#32-sha-2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        SHA-2 ν¨λ°€λ¦¬                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ³€ν•         β”‚ μ¶λ ¥     β”‚ λΈ”λ΅     β”‚ μ›λ“     β”‚ λΌμ΄λ“              β”‚
β”‚              β”‚ (λΉ„νΈ)   β”‚ (λΉ„νΈ)   β”‚ (λΉ„νΈ)   β”‚                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ SHA-224      β”‚ 224      β”‚ 512      β”‚ 32       β”‚ 64                  β”‚
β”‚ SHA-256      β”‚ 256      β”‚ 512      β”‚ 32       β”‚ 64                  β”‚
β”‚ SHA-384      β”‚ 384      β”‚ 1024     β”‚ 64       β”‚ 80                  β”‚
β”‚ SHA-512      β”‚ 512      β”‚ 1024     β”‚ 64       β”‚ 80                  β”‚
β”‚ SHA-512/256  β”‚ 256      β”‚ 1024     β”‚ 64       β”‚ 80                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ SHA-256κ³Ό SHA-512κ°€ κ°€μ¥ μΌλ°μ μΌλ΅ μ‚¬μ©λ©λ‹λ‹¤.                      β”‚
β”‚ SHA-512/256μ€ 64λΉ„νΈ ν”„λ΅μ„Έμ„μ—μ„ SHA-512μ μ†λ„λ΅ SHA-256 μ¶λ ¥       β”‚
β”‚ ν¬κΈ°λ¥Ό μ κ³µν•λ©° κΈΈμ΄ ν™•μ¥μ— μ·¨μ•½ν•μ§€ μ•μµλ‹λ‹¤.                        β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="33-sha-3-keccak">3.3 SHA-3 (Keccak)<a class="header-link" href="#33-sha-3-keccak" title="Permanent link">&para;</a></h3>
<p>SHA-3μ€ SHA-2μ Merkle-Damgard κµ¬μ΅°μ™€ κ·Όλ³Έμ μΌλ΅ λ‹¤λ¥Έ <strong>μ¤ν€μ§€ κµ¬μ΅°</strong>λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. μ΄λ¬ν• λ‹¤μ–‘μ„±μ€ κ°€μΉκ°€ μμµλ‹λ‹¤: SHA-2κ°€ μ†μƒλλ”λΌλ„ SHA-3μ€ μ•μ „ν•κ² μ μ§€λ  κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">              </span><span class="n">SHA</span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="n">μ¤ν€μ§€</span><span class="w"> </span><span class="n">κµ¬μ΅°</span><span class="w"> </span><span class="p">(</span><span class="n">λ‹¨μν™”λ¨</span><span class="p">)</span><span class="w">                             </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="k">State</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">0...0</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">Keccakμ</span><span class="w"> </span><span class="n">κ²½μ°</span><span class="w"> </span><span class="mi">1600</span><span class="n">λΉ„νΈ</span><span class="p">)</span><span class="w">                          </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">ν΅μ</span><span class="w"> </span><span class="nl">λ‹¨κ³„</span><span class="p">:</span><span class="w">                                                          </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">   </span><span class="n">XOR</span><span class="w">    </span><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">   </span><span class="n">XOR</span><span class="w">    </span><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">                   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β”‚</span><span class="w"> </span><span class="n">msgβ‚</span><span class="w">  </span><span class="err">β”‚β”€β”€β”€β”€β”€β”€β–¶</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="err">β”€β”€β”€β”€β”€β”€β–¶β”‚</span><span class="w"> </span><span class="n">msgβ‚‚</span><span class="w">  </span><span class="err">β”‚β”€β”€β”€β”€β”€β”€β–¶</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="err">β”€β”€β”€β”€β”€β”€β–¶</span><span class="w"> </span><span class="p">...</span><span class="w">        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">   </span><span class="k">State</span><span class="w">  </span><span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">   </span><span class="k">State</span><span class="w">  </span><span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”</span><span class="w">                   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μ••μ°©</span><span class="w"> </span><span class="nl">λ‹¨κ³„</span><span class="p">:</span><span class="w">                                                          </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="p">...</span><span class="w"> </span><span class="err">β”€β”€β–¶</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="err">β”€β”€β–¶</span><span class="w"> </span><span class="o">[</span><span class="n">outputβ‚</span><span class="o">]</span><span class="w"> </span><span class="err">β”€β”€β–¶</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="err">β”€β”€β–¶</span><span class="w"> </span><span class="o">[</span><span class="n">outputβ‚‚</span><span class="o">]</span><span class="w"> </span><span class="err">β”€β”€β–¶</span><span class="w"> </span><span class="p">...</span><span class="w">             </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Keccak</span><span class="w"> </span><span class="n">μμ—΄</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="n">κ°</span><span class="w"> </span><span class="n">ν•μ„</span><span class="w"> </span><span class="n">λΌμ΄λ“</span><span class="w"> </span><span class="err">Γ—</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="n">λΌμ΄λ“</span><span class="p">)</span><span class="w">                       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μ£Όμ”</span><span class="w"> </span><span class="nl">μ¥μ </span><span class="p">:</span><span class="w"> </span><span class="n">κΈΈμ΄</span><span class="w"> </span><span class="n">ν™•μ¥</span><span class="w"> </span><span class="n">κ³µκ²©μ—</span><span class="w"> </span><span class="n">μ·¨μ•½ν•μ§€</span><span class="w"> </span><span class="n">μ•μ</span><span class="w">                            </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="p">(</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">SHA</span><span class="o">-</span><span class="mi">512</span><span class="n">μ™€</span><span class="w"> </span><span class="n">λ‹¬λ¦¬</span><span class="p">)</span><span class="w">                                         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<h3 id="34-blake2-blake3">3.4 BLAKE2μ™€ BLAKE3<a class="header-link" href="#34-blake2-blake3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                   BLAKE2μ™€ BLAKE3                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  BLAKE2 (RFC 7693):                                                 β”‚
β”‚  β”β”€β”€ BLAKE2b: 64λΉ„νΈ ν”λ«νΌ μµμ ν™” (μµλ€ 64λ°”μ΄νΈ)                   β”‚
β”‚  β”β”€β”€ BLAKE2s: 32λΉ„νΈ ν”λ«νΌ μµμ ν™” (μµλ€ 32λ°”μ΄νΈ)                   β”‚
β”‚  β”β”€β”€ λ‚΄μ¥ ν‚¤μ‰ (HMAC μ—†μ΄ MACλ΅ μ‘λ™ κ°€λ¥)                          β”‚
β”‚  β”β”€β”€ λ‚΄μ¥ κ°μΈν™” λ° μ†”νΈ μ§€μ›                                        β”‚
β”‚  β”β”€β”€ λ³‘λ ¬ν™”λ¥Ό μ„ν• νΈλ¦¬ ν•΄μ‹± λ¨λ“                                    β”‚
β”‚  β””β”€β”€ μ‚¬μ©μ²: Argon2 ν¨μ¤μ›λ“ ν•΄μ‹, WireGuard, libsodium             β”‚
β”‚                                                                      β”‚
β”‚  BLAKE3 (2020):                                                     β”‚
β”‚  β”β”€β”€ BLAKE2 κΈ°λ°μ΄μ§€λ§ μ†λ„λ¥Ό μ„ν•΄ μ¬μ„¤κ³„λ¨                          β”‚
β”‚  β”β”€β”€ Merkle νΈλ¦¬ κµ¬μ΅° (λ³Έμ§μ μΌλ΅ λ³‘λ ¬ν™” κ°€λ¥)                       β”‚
β”‚  β”β”€β”€ ν•΄μ‹, MAC, KDF, XOFλ¥Ό μ„ν• λ‹¨μΌ μ•κ³ λ¦¬μ¦                       β”‚
β”‚  β”β”€β”€ 256λΉ„νΈ μ¶λ ¥ (ν™•μ¥ κ°€λ¥)                                       β”‚
β”‚  β”β”€β”€ μµμ‹  CPUμ—μ„ SHA-256λ³΄λ‹¤ μ•½ 10λ°° λΉ λ¦„                          β”‚
β”‚  β””β”€β”€ μ‚¬μ©μ²: Bao (κ²€μ¦λ μ¤νΈλ¦¬λ°), λ§μ€ μƒλ΅μ΄ ν”„λ΅μ νΈ             β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="4-hashlib-python">4. hashlibλ¥Ό μ‚¬μ©ν• Python ν•΄μ‹±<a class="header-link" href="#4-hashlib-python" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 κΈ°λ³Έ ν•΄μ‹±<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>

<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;The quick brown fox jumps over the lazy dog&quot;</span>

<span class="c1"># SHA-256 (κ°€μ¥ μΌλ°μ )</span>
<span class="n">sha256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SHA-256:   </span><span class="si">{</span><span class="n">sha256</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># SHA-512</span>
<span class="n">sha512</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SHA-512:   </span><span class="si">{</span><span class="n">sha512</span><span class="p">[:</span><span class="mi">64</span><span class="p">]</span><span class="si">}</span><span class="s2">...</span><span class="si">{</span><span class="n">sha512</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># SHA-3-256</span>
<span class="n">sha3_256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha3_256</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SHA-3-256: </span><span class="si">{</span><span class="n">sha3_256</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># BLAKE2b (μµλ€ 64λ°”μ΄νΈκΉμ§€ κ°€λ³€ μ¶λ ¥ ν¬κΈ°)</span>
<span class="n">blake2b</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE2b:   </span><span class="si">{</span><span class="n">blake2b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># BLAKE2s (μµλ€ 32λ°”μ΄νΈκΉμ§€ κ°€λ³€ μ¶λ ¥ ν¬κΈ°)</span>
<span class="n">blake2s</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2s</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE2s:   </span><span class="si">{</span><span class="n">blake2s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ‚¬μ© κ°€λ¥ν• λ¨λ“  μ•κ³ λ¦¬μ¦ λ‚μ—΄</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Available: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">algorithms_available</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="42">4.2 μ¦λ¶„ ν•΄μ‹± (μ¤νΈλ¦¬λ°)<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p>ν° νμΌμ κ²½μ° λ¨λ“  κ²ƒμ„ λ©”λ¨λ¦¬μ— λ΅λ“ν•λ” λ€μ‹  λ°μ΄ν„°λ¥Ό μ¦λ¶„μ μΌλ΅ ν•΄μ‹ν•΄μ•Ό ν•©λ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hash_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sha256&quot;</span><span class="p">,</span>
              <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;λ¨λ“  κ²ƒμ„ λ©”λ¨λ¦¬μ— λ΅λ“ν•μ§€ μ•κ³  νμΌμ„ μ¦λ¶„μ μΌλ΅ ν•΄μ‹ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">hasher</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="c1"># ν…μ¤νΈ νμΌ μƒμ„±</span>
<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;/tmp/test_hash_file.bin&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: some data for hashing</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

<span class="c1"># ν•΄μ‹ κ³„μ‚°</span>
<span class="n">sha256_hash</span> <span class="o">=</span> <span class="n">hash_file</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="s2">&quot;sha256&quot;</span><span class="p">)</span>
<span class="n">sha3_hash</span> <span class="o">=</span> <span class="n">hash_file</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="s2">&quot;sha3_256&quot;</span><span class="p">)</span>
<span class="n">blake2_hash</span> <span class="o">=</span> <span class="n">hash_file</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="s2">&quot;blake2b&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File size: </span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SHA-256:   </span><span class="si">{</span><span class="n">sha256_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SHA-3-256: </span><span class="si">{</span><span class="n">sha3_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE2b:   </span><span class="si">{</span><span class="n">blake2_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν• λ²μ— λ¨λ‘ μ½λ” κ²ƒκ³Ό λ™μΌ (κ·Έλ¬λ‚ λ©”λ¨λ¦¬ ν¨μ¨μ )</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">sha256_hash</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Incremental hash matches full-read hash: OK&quot;</span><span class="p">)</span>

<span class="c1"># μ •λ¦¬</span>
<span class="n">Path</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-blake2">4.3 ν‚¤λ¥Ό μ‚¬μ©ν• BLAKE2 (ν‚¤ ν•΄μ‹±)<a class="header-link" href="#43-blake2" title="Permanent link">&para;</a></h3>
<p>BLAKE2λ” ν‚¤ ν•΄μ‹±μ„ μ„ν• λ‚΄μ¥ μ§€μ›μ΄ μμ–΄ HMAC κµ¬μ΅° μ—†μ΄ MACλ΅ μ‚¬μ©ν•  μ μμµλ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># ν‚¤κ°€ μλ” BLAKE2b (MACλ΅ μ‘λ™)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 256λΉ„νΈ ν‚¤</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Authenticate this message&quot;</span>

<span class="c1"># ν‚¤ ν•΄μ‹</span>
<span class="n">mac</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE2b keyed hash: </span><span class="si">{</span><span class="n">mac</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># κ²€μ¦</span>
<span class="n">verification</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verification match: </span><span class="si">{</span><span class="n">mac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">verification</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># κ°μΈν™”μ™€ ν•¨κ» (λ„λ©”μΈ λ¶„λ¦¬)</span>
<span class="n">mac1</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span>
    <span class="sa">b</span><span class="s2">&quot;shared data&quot;</span><span class="p">,</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">person</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;payment-v1&quot;</span><span class="p">,</span>  <span class="c1"># μµλ€ 16λ°”μ΄νΈ</span>
    <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span>
<span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="n">mac2</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span>
    <span class="sa">b</span><span class="s2">&quot;shared data&quot;</span><span class="p">,</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">person</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;session-v1&quot;</span><span class="p">,</span>  <span class="c1"># λ‹¤λ¥Έ λ„λ©”μΈ</span>
    <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span>
<span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Same data, different personalization:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  payment context: </span><span class="si">{</span><span class="n">mac1</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  session context: </span><span class="si">{</span><span class="n">mac2</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Same? </span><span class="si">{</span><span class="n">mac1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">mac2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False - λ‹¤λ¥Έ λ„λ©”μΈ</span>
</code></pre></div>

<h3 id="44-blake3">4.4 BLAKE3<a class="header-link" href="#44-blake3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># pip install blake3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">blake3</span>

<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;BLAKE3 is extremely fast&quot;</span>

<span class="c1"># κΈ°λ³Έ ν•΄μ‹</span>
<span class="n">digest</span> <span class="o">=</span> <span class="n">blake3</span><span class="o">.</span><span class="n">blake3</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE3: </span><span class="si">{</span><span class="n">digest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν‚¤ ν•΄μ‹ (MACμ©)</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;0&quot;</span> <span class="o">*</span> <span class="mi">32</span>  <span class="c1"># 32λ°”μ΄νΈ ν‚¤ ν•„μ”</span>
<span class="n">keyed</span> <span class="o">=</span> <span class="n">blake3</span><span class="o">.</span><span class="n">blake3</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE3 keyed: </span><span class="si">{</span><span class="n">keyed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν‚¤ μ λ„</span>
<span class="n">derived</span> <span class="o">=</span> <span class="n">blake3</span><span class="o">.</span><span class="n">blake3</span><span class="p">(</span>
    <span class="sa">b</span><span class="s2">&quot;input key material&quot;</span><span class="p">,</span>
    <span class="n">derive_key_context</span><span class="o">=</span><span class="s2">&quot;my-app 2026-01-15 encryption key&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE3 KDF: </span><span class="si">{</span><span class="n">derived</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ¦λ¶„ ν•΄μ‹±</span>
<span class="n">hasher</span> <span class="o">=</span> <span class="n">blake3</span><span class="o">.</span><span class="n">blake3</span><span class="p">()</span>
<span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Hello, &quot;</span><span class="p">)</span>
<span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;World!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE3 incremental: </span><span class="si">{</span><span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν™•μ¥ κ°€λ¥ν• μ¶λ ¥ (XOF) - μ„μμ λ°”μ΄νΈ μ μ–»κΈ°</span>
<span class="n">digest_64</span> <span class="o">=</span> <span class="n">blake3</span><span class="o">.</span><span class="n">blake3</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BLAKE3 64-byte: </span><span class="si">{</span><span class="n">digest_64</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5">5. ν¨μ¤μ›λ“ ν•΄μ‹±<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<p>ν¨μ¤μ›λ“ ν•΄μ‹±μ€ λ²”μ© ν•΄μ‹±κ³Ό κ·Όλ³Έμ μΌλ΅ λ‹¤λ¦…λ‹λ‹¤. ν¨μ¤μ›λ“λ” μ—”νΈλ΅ν”Όκ°€ λ‚®μΌλ―€λ΅ (μΈκ°„μ€ μμΈ΅ κ°€λ¥ν• ν¨μ¤μ›λ“λ¥Ό μ„ νƒν•©λ‹λ‹¤) ν¨μ¤μ›λ“ ν•΄μ‹λ¥Ό μ–»μ€ κ³µκ²©μλ” λ¬΄μ°¨λ³„ λ€μ…μ„ μ‹λ„ν•  μ μμµλ‹λ‹¤. ν¨μ¤μ›λ“ ν•΄μ‹± μ•κ³ λ¦¬μ¦μ€ λ¬΄μ°¨λ³„ λ€μ… κ³µκ²©μ„ λΉ„μ‹¤μ©μ μΌλ΅ λ§λ“¤κΈ° μ„ν•΄ <strong>μλ„μ μΌλ΅ λλ¦¬κ²</strong> μ„¤κ³„λμ—μµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">        </span><span class="n">λ²”μ©</span><span class="w"> </span><span class="n">ν•΄μ‹κ°€</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“μ—</span><span class="w"> </span><span class="n">λ‚μ</span><span class="w"> </span><span class="n">μ΄μ </span><span class="w">                                </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μµμ‹ </span><span class="w"> </span><span class="n">GPUμ—μ„μ</span><span class="w"> </span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="nl">μ†λ„</span><span class="p">:</span><span class="w"> </span><span class="n">μ΄λ‹Ή</span><span class="w"> </span><span class="n">μ•½</span><span class="w"> </span><span class="mi">100</span><span class="n">μ–µ</span><span class="w"> </span><span class="n">ν•΄μ‹</span><span class="w">                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">ν¨μ¤μ›λ“</span><span class="w"> </span><span class="ss">&quot;P@ssw0rd&quot;</span><span class="err">:</span><span class="w">                                                </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">    </span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="err">β†’</span><span class="w"> </span><span class="n">d74ff0ee8da3b9806b18c877d</span><span class="p">...</span><span class="w">                           </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">    </span><span class="mi">8</span><span class="n">μ</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“</span><span class="w"> </span><span class="n">λ¬΄μ°¨λ³„</span><span class="w"> </span><span class="n">λ€μ…</span><span class="w"> </span><span class="nl">μ‹κ°„</span><span class="p">:</span><span class="w"> </span><span class="n">μ΄μ—μ„</span><span class="w"> </span><span class="n">λ¶„</span><span class="w">                            </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">bcrypt</span><span class="w"> </span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="err">:</span><span class="w">                                                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">    </span><span class="n">bcrypt</span><span class="w"> </span><span class="err">β†’</span><span class="w"> </span><span class="err">$</span><span class="mi">2</span><span class="n">b</span><span class="err">$</span><span class="mi">12</span><span class="err">$</span><span class="n">LJ3m4ys3Tdb2vNQhk9Oy</span><span class="p">...</span><span class="w">                        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">    </span><span class="n">λ¬΄μ°¨λ³„</span><span class="w"> </span><span class="n">λ€μ…</span><span class="w"> </span><span class="nl">μ‹κ°„</span><span class="p">:</span><span class="w"> </span><span class="n">μλ…„μ—μ„</span><span class="w"> </span><span class="n">μμ„ΈκΈ°</span><span class="w">                                   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">μ£Όμ”</span><span class="w"> </span><span class="nl">μ°¨μ΄μ </span><span class="p">:</span><span class="w">                                                         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β€Ά</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“</span><span class="w"> </span><span class="n">ν•΄μ‹μ—λ”</span><span class="w"> </span><span class="n">λ¬΄μ‘μ„</span><span class="w"> </span><span class="n">μ†”νΈκ°€</span><span class="w"> </span><span class="n">ν¬ν•¨λ¨</span><span class="w"> </span><span class="p">(</span><span class="n">λ μΈλ³΄μ°</span><span class="w"> </span><span class="n">ν…μ΄λΈ”</span><span class="w"> </span><span class="n">λ°©μ§€</span><span class="p">)</span><span class="w">       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β€Ά</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“</span><span class="w"> </span><span class="n">ν•΄μ‹μ—λ”</span><span class="w"> </span><span class="n">μ΅°μ •</span><span class="w"> </span><span class="n">κ°€λ¥ν•</span><span class="w"> </span><span class="n">μ‘μ—…</span><span class="w"> </span><span class="n">κ³„μκ°€</span><span class="w"> </span><span class="n">μμ</span><span class="w"> </span><span class="p">(</span><span class="n">ν•λ“μ›¨μ–΄μ—</span><span class="w"> </span><span class="n">μ μ‘</span><span class="p">)</span><span class="w">    </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="err">β€Ά</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“</span><span class="w"> </span><span class="n">ν•΄μ‹λ”</span><span class="w"> </span><span class="n">ν°</span><span class="w"> </span><span class="n">λ©”λ¨λ¦¬κ°€</span><span class="w"> </span><span class="n">ν•„μ”ν• </span><span class="w"> </span><span class="n">μ</span><span class="w"> </span><span class="n">μμ</span><span class="w"> </span><span class="p">(</span><span class="n">GPU</span><span class="w"> </span><span class="n">κ³µκ²©</span><span class="w"> </span><span class="n">λ°©μ–΄</span><span class="p">)</span><span class="w">         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="n">MD5</span><span class="w"> </span><span class="n">λλ”</span><span class="w"> </span><span class="n">λ‹¤λ¥Έ</span><span class="w"> </span><span class="n">λ²”μ©</span><span class="w"> </span><span class="n">ν•΄μ‹λ΅</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“λ¥Ό</span><span class="w"> </span><span class="n">μ λ€</span><span class="w"> </span><span class="n">ν•΄μ‹ν•μ§€</span><span class="w"> </span><span class="n">λ§μ‹­μ‹μ¤</span><span class="err">!</span><span class="w"> </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<h3 id="51-bcrypt">5.1 bcrypt<a class="header-link" href="#51-bcrypt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># pip install bcrypt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;correct-horse-battery-staple&quot;</span>

<span class="c1"># ν¨μ¤μ›λ“ ν•΄μ‹</span>
<span class="c1"># bcryptλ” μλ™μΌλ΅ λ¬΄μ‘μ„ 16λ°”μ΄νΈ μ†”νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤</span>
<span class="c1"># cost=12λ” 2^12 = 4096 λ°λ³µμ„ μλ―Έν•©λ‹λ‹¤</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">hashed</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Password:  </span><span class="si">{</span><span class="n">password</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hash:      </span><span class="si">{</span><span class="n">hashed</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time:      </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># bcrypt ν•΄μ‹μ κµ¬μ΅°:</span>
<span class="c1"># $2b$12$LJ3m4ys3Tdb2vNQhk9OyAeKK3b3eAGQjT5xKp2JFe5cF5NY5U/a2e</span>
<span class="c1"># β”β”€β”€β”¤β”β”€β”¤β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="c1"># μ•κ³  λΉ„μ©       μ†”νΈ (22μ)            ν•΄μ‹ (31μ)</span>
<span class="c1">#</span>
<span class="c1"># $2b = bcrypt λ²„μ „</span>
<span class="c1"># $12 = λΉ„μ© κ³„μ (2^12 λ°λ³µ)</span>

<span class="c1"># ν¨μ¤μ›λ“ κ²€μ¦</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">hashed</span><span class="p">)</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valid password: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>

<span class="c1"># μλ»λ ν¨μ¤μ›λ“</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;wrong-password&quot;</span><span class="p">,</span> <span class="n">hashed</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong password: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ™μΌν• ν¨μ¤μ›λ“μ— λ€ν•΄μ„λ„ κ° ν•΄μ‹λ” κ³ μ ν•©λ‹λ‹¤ (λ‹¤λ¥Έ μ†”νΈ)</span>
<span class="n">hash2</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hash 1: </span><span class="si">{</span><span class="n">hashed</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hash 2: </span><span class="si">{</span><span class="n">hash2</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Same?   </span><span class="si">{</span><span class="n">hashed</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hash2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False (λ‹¤λ¥Έ μ†”νΈ)</span>
<span class="c1"># κ·Έλ¬λ‚ λ‘ λ‹¤ λ™μΌν• ν¨μ¤μ›λ“λ¥Ό κ²€μ¦ν•©λ‹λ‹¤</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Both verify &#39;correct-horse-battery-staple&#39;: &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">hashed</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">hash2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="52-scrypt">5.2 scrypt<a class="header-link" href="#52-scrypt" title="Permanent link">&para;</a></h3>
<p>scryptλ” <strong>λ©”λ¨λ¦¬ ν•λ“</strong>μ…λ‹λ‹¤: λΉ„μ© λ§¤κ°λ³€μμ— λΉ„λ΅€ν•μ—¬ λ§μ€ μ–‘μ λ©”λ¨λ¦¬κ°€ ν•„μ”ν•λ―€λ΅ GPU λ° ASIC κ³µκ²©μ— μ €ν•­λ ¥μ΄ μμµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;my-secure-password&quot;</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># scrypt λ§¤κ°λ³€μ:</span>
<span class="c1"># n = CPU/λ©”λ¨λ¦¬ λΉ„μ© (2μ κ±°λ“­μ κ³±μ΄μ–΄μ•Ό ν•¨). λ†’μ„μλ΅ = λλ¦¬κ³  λ” λ§μ€ λ©”λ¨λ¦¬.</span>
<span class="c1"># r = λΈ”λ΅ ν¬κΈ° (8μ΄ ν‘μ¤€)</span>
<span class="c1"># p = λ³‘λ ¬μ„± (1μ΄ ν‘μ¤€)</span>
<span class="c1"># λ©”λ¨λ¦¬ μ‚¬μ©λ‰ β‰ 128 * n * r λ°”μ΄νΈ</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">derived</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">scrypt</span><span class="p">(</span>
    <span class="n">password</span><span class="p">,</span>
    <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span>    <span class="c1"># 16384 λ°λ³µ</span>
    <span class="n">r</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>        <span class="c1"># λΈ”λ΅ ν¬κΈ°</span>
    <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>        <span class="c1"># λ³‘λ ¬μ„±</span>
    <span class="n">dklen</span><span class="o">=</span><span class="mi">32</span>    <span class="c1"># μ¶λ ¥ 256λΉ„νΈ</span>
<span class="p">)</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;scrypt derived key: </span><span class="si">{</span><span class="n">derived</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Salt:              </span><span class="si">{</span><span class="n">salt</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time:              </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory used:       ~</span><span class="si">{</span><span class="mi">128</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># κ²€μ¦</span>
<span class="n">derived2</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">scrypt</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dklen</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verification:      </span><span class="si">{</span><span class="n">derived</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">derived2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="53-argon2">5.3 Argon2 (κ¶μ¥)<a class="header-link" href="#53-argon2" title="Permanent link">&para;</a></h3>
<p>Argon2λ” 2015λ…„ Password Hashing Competitionμ—μ„ μ°μΉν–μΌλ©° ν„μ¬ κ¶μ¥λλ” μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. μ„Έ κ°€μ§€ λ³€ν•μ΄ μμµλ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                      Argon2 λ³€ν•                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ³€ν•         β”‚ μ„¤λ…                                                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ Argon2d      β”‚ λ°μ΄ν„° μμ΅΄μ  λ©”λ¨λ¦¬ μ•΅μ„Έμ¤. λ” λΉ λ¥΄κ³ , GPU μ €ν•­μ„±μ΄ β”‚
β”‚              β”‚ λ” λ†’μ§€λ§ μ‚¬μ΄λ“ μ±„λ„ κ³µκ²©μ— μ·¨μ•½ν•©λ‹λ‹¤.             β”‚
β”‚              β”‚ μ•”νΈν™”ν λ§μ΄λ‹μ— μ ν•©, ν¨μ¤μ›λ“μ—λ” λ¶€μ ν•©ν•©λ‹λ‹¤.    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ Argon2i      β”‚ λ°μ΄ν„° λ…λ¦½μ  λ©”λ¨λ¦¬ μ•΅μ„Έμ¤. μ‚¬μ΄λ“ μ±„λ„ κ³µκ²©μ—      β”‚
β”‚              β”‚ μ €ν•­λ ¥μ΄ μμµλ‹λ‹¤. κ³µμ  ν™κ²½μ—μ„ ν¨μ¤μ›λ“ ν•΄μ‹±μ—     β”‚
β”‚              β”‚ λ” μΆ‹μµλ‹λ‹¤.                                         β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ Argon2id     β”‚ ν•μ΄λΈλ¦¬λ“: μ²« λ²μ§Έ ν¨μ¤λ” Argon2i, μ΄ν›„ ν¨μ¤λ”     β”‚
β”‚              β”‚ Argon2dμ…λ‹λ‹¤. ν¨μ¤μ›λ“ ν•΄μ‹±μ— κ¶μ¥λ©λ‹λ‹¤.           β”‚
β”‚              β”‚ λ‘ κ°€μ§€μ μ¥μ μ„ λ¨λ‘ κ°€μ§‘λ‹λ‹¤.                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># pip install argon2-cffi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">argon2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PasswordHasher</span><span class="p">,</span> <span class="n">Type</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># κ¶μ¥ λ§¤κ°λ³€μλ΅ ν•΄μ…” μƒμ„±</span>
<span class="c1"># μ„λ²„μ κΈ°λ¥μ— λ”°λΌ time_costμ™€ memory_cost μ΅°μ •</span>
<span class="c1"># λ©ν‘: ν•΄μ‹λ‹Ή μ•½ 0.5-1.0μ΄</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">PasswordHasher</span><span class="p">(</span>
    <span class="n">time_cost</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>          <span class="c1"># λ°λ³µ νμ</span>
    <span class="n">memory_cost</span><span class="o">=</span><span class="mi">65536</span><span class="p">,</span>    <span class="c1"># KB λ‹¨μ„ λ©”λ¨λ¦¬ (64 MB)</span>
    <span class="n">parallelism</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>        <span class="c1"># μ¤λ λ“ μ</span>
    <span class="n">hash_len</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>          <span class="c1"># μ¶λ ¥ ν•΄μ‹ κΈΈμ΄</span>
    <span class="n">salt_len</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>          <span class="c1"># μ†”νΈ κΈΈμ΄</span>
    <span class="nb">type</span><span class="o">=</span><span class="n">Type</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>         <span class="c1"># Argon2id (κ¶μ¥)</span>
<span class="p">)</span>

<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span>

<span class="c1"># ν•΄μ‹</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">hashed</span> <span class="o">=</span> <span class="n">ph</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argon2id hash: </span><span class="si">{</span><span class="n">hashed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Argon2 ν•΄μ‹ λ¬Έμμ—΄μ κµ¬μ΅°:</span>
<span class="c1"># $argon2id$v=19$m=65536,t=3,p=4$c2FsdDEyMzQ1Njc4$aXaShZ7S2X3yBqBvP5WF4w</span>
<span class="c1"># β”β”€β”€β”€β”€β”€β”€β”€β”¤β”β”€β”€β”€β”¤β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="c1">#   μ•κ³     λ²„μ „    λ§¤κ°λ³€μ            μ†”νΈ (b64)           ν•΄μ‹ (b64)</span>

<span class="c1"># κ²€μ¦</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">is_valid</span> <span class="o">=</span> <span class="n">ph</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valid password: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verification failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μλ»λ ν¨μ¤μ›λ“</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ph</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="s2">&quot;wrong-password&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong password: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ¬ν•΄μ‹κ°€ ν•„μ”ν•μ§€ ν™•μΈ (λ§¤κ°λ³€μκ°€ λ³€κ²½λ¨)</span>
<span class="k">if</span> <span class="n">ph</span><span class="o">.</span><span class="n">check_needs_rehash</span><span class="p">(</span><span class="n">hashed</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hash needs rehash with updated parameters&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hash parameters are current&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="54">5.4 ν¨μ¤μ›λ“ ν•΄μ‹± λΉ„κµ<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              ν¨μ¤μ›λ“ ν•΄μ‹± μ•κ³ λ¦¬μ¦ λΉ„κµ                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ•κ³ λ¦¬μ¦     β”‚ λ©”λ¨λ¦¬  β”‚ GPU/ASIC      β”‚ μ‚¬μ΄λ“   β”‚ κ¶μ¥ μ‚¬ν•­        β”‚
β”‚             β”‚ ν•λ“?   β”‚ μ €ν•­μ„±?       β”‚ μ±„λ„ μ•μ „β”‚                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ bcrypt      β”‚ μ•„λ‹μ¤  β”‚ λ³΄ν†µ          β”‚ μ       β”‚ μΆ‹μ (μ„±μ™ν•¨)    β”‚
β”‚ scrypt      β”‚ μ      β”‚ μΆ‹μ          β”‚ λ¶€λ¶„μ    β”‚ μΆ‹μ             β”‚
β”‚ Argon2id    β”‚ μ      β”‚ μµκ³           β”‚ μ       β”‚ μµκ³  (μ„ νΈλ¨)    β”‚
β”‚ PBKDF2      β”‚ μ•„λ‹μ¤  β”‚ λ‚μ¨          β”‚ μ       β”‚ λ κ±°μ‹λ§         β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚ κ¶μ¥ λ§¤κ°λ³€μ (2025+, μ„λ²„μ—μ„ μ•½ 0.5μ΄ λ©ν‘):                        β”‚
β”‚ β€Ά Argon2id: m=64MB, t=3, p=4                                       β”‚
β”‚ β€Ά bcrypt:   cost=12μ—μ„ 14                                          β”‚
β”‚ β€Ά scrypt:   N=2^15, r=8, p=1                                       β”‚
β”‚ β€Ά PBKDF2:   SHA-256μΌλ΅ 600,000+ λ°λ³µ                               β”‚
β”‚                                                                      β”‚
β”‚ OWASP κ¶μ¥: Argon2id μ²« λ²μ§Έ, bcrypt λ‘ λ²μ§Έ.                        β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="55">5.5 μ™„μ „ν• ν¨μ¤μ›λ“ μ €μ¥ μ‹μ¤ν…<a class="header-link" href="#55" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">argon2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PasswordHasher</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exceptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRecord</span><span class="p">:</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">password_hash</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">last_login</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">failed_attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">locked_until</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PasswordStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Argon2idλ¥Ό μ‚¬μ©ν• ν”„λ΅λ•μ… ν’μ§ ν¨μ¤μ›λ“ μ €μ¥μ†.&quot;&quot;&quot;</span>

    <span class="n">MAX_ATTEMPTS</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">LOCKOUT_SECONDS</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 5λ¶„</span>
    <span class="n">MIN_PASSWORD_LENGTH</span> <span class="o">=</span> <span class="mi">12</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span> <span class="o">=</span> <span class="n">PasswordHasher</span><span class="p">(</span>
            <span class="n">time_cost</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">memory_cost</span><span class="o">=</span><span class="mi">65536</span><span class="p">,</span>
            <span class="n">parallelism</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">hash_len</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">salt_len</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">Type</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">UserRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_password_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;κΈ°λ³Έ κ°•λ„ μ”κµ¬ μ‚¬ν•­μ— λ€ν•΄ ν¨μ¤μ›λ“λ¥Ό ν™•μΈν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">MIN_PASSWORD_LENGTH</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Password must be at least </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MIN_PASSWORD_LENGTH</span><span class="si">}</span><span class="s2"> chars&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Password must contain uppercase letters&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">password</span><span class="p">):</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Password must contain digits&quot;</span><span class="p">)</span>

        <span class="c1"># μΌλ°μ μΈ ν¨μ¤μ›λ“μ— λ€ν•΄ ν™•μΈ (μ¶•μ•½λ λ©λ΅)</span>
        <span class="n">common</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;123456&quot;</span><span class="p">,</span> <span class="s2">&quot;qwerty&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;letmein&quot;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">common</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Password is too common&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">issues</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μƒ μ‚¬μ©μλ¥Ό λ“±λ΅ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Username already exists&quot;</span><span class="p">}</span>

        <span class="n">issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_password_strength</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">issues</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Weak password&quot;</span><span class="p">,</span> <span class="s2">&quot;issues&quot;</span><span class="p">:</span> <span class="n">issues</span><span class="p">}</span>

        <span class="n">hashed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="n">UserRecord</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">password_hash</span><span class="o">=</span><span class="n">hashed</span><span class="p">,</span>
            <span class="n">created_at</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> registered&quot;</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μ‚¬μ©μλ¥Ό μΈμ¦ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="c1"># νƒ€μ΄λ° κΈ°λ° μ‚¬μ©μ μ—΄κ±°λ¥Ό λ°©μ§€ν•κΈ° μ„ν•΄ λ”λ―Έ ν•΄μ‹ μν–‰</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="s2">&quot;dummy-to-waste-time&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid credentials&quot;</span><span class="p">}</span>

        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>

        <span class="c1"># μ κΈ ν™•μΈ</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">locked_until</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">user</span><span class="o">.</span><span class="n">locked_until</span><span class="p">:</span>
            <span class="n">remaining</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">locked_until</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Account locked. Try in </span><span class="si">{</span><span class="n">remaining</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">password_hash</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

            <span class="c1"># μ¬ν•΄μ‹κ°€ ν•„μ”ν•μ§€ ν™•μΈ (λ§¤κ°λ³€μ μ—…κ·Έλ μ΄λ“λ¨)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span><span class="o">.</span><span class="n">check_needs_rehash</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">password_hash</span><span class="p">):</span>
                <span class="n">user</span><span class="o">.</span><span class="n">password_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasher</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

            <span class="n">user</span><span class="o">.</span><span class="n">failed_attempts</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">user</span><span class="o">.</span><span class="n">locked_until</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">user</span><span class="o">.</span><span class="n">last_login</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Welcome, </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">}</span>

        <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">VerifyMismatchError</span><span class="p">:</span>
            <span class="n">user</span><span class="o">.</span><span class="n">failed_attempts</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">failed_attempts</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAX_ATTEMPTS</span><span class="p">:</span>
                <span class="n">user</span><span class="o">.</span><span class="n">locked_until</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOCKOUT_SECONDS</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid credentials&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attempts_remaining&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAX_ATTEMPTS</span> <span class="o">-</span> <span class="n">user</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">)</span>
            <span class="p">}</span>

<span class="c1"># μ‚¬μ©</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">PasswordStore</span><span class="p">()</span>

<span class="c1"># λ“±λ΅</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;short&quot;</span><span class="p">))</span>  <span class="c1"># μ‹¤ν¨ - λ„λ¬΄ μ§§μ</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;MySecureP@ss123&quot;</span><span class="p">))</span>  <span class="c1"># μ„±κ³µ</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;AnotherPassword1&quot;</span><span class="p">))</span>  <span class="c1"># μ‹¤ν¨ - μ΄λ―Έ μ΅΄μ¬</span>

<span class="c1"># μΈμ¦</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;MySecureP@ss123&quot;</span><span class="p">))</span>  <span class="c1"># μ„±κ³µ</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;wrong-password&quot;</span><span class="p">))</span>    <span class="c1"># μ‹¤ν¨</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;bob&quot;</span><span class="p">,</span> <span class="s2">&quot;anything&quot;</span><span class="p">))</span>            <span class="c1"># μ‚¬μ©μλ¥Ό μ°Ύμ„ μ μ—†μ</span>
</code></pre></div>

<hr />
<h2 id="6-hmac">6. HMAC: λ©”μ‹μ§€ μΈμ¦<a class="header-link" href="#6-hmac" title="Permanent link">&para;</a></h2>
<p>HMAC (Hash-based Message Authentication Code)μ€ λ¬΄κ²°μ„±κ³Ό μ§„μ„μ„±μ„ λ¨λ‘ μ κ³µν•©λ‹λ‹¤. λΉ„λ°€ ν‚¤λ¥Ό ν•΄μ‹ ν•¨μμ™€ κ²°ν•©ν•μ—¬ ν‚¤λ¥Ό μ•„λ” μ‚¬λλ§ μƒμ„±ν•κ³  κ²€μ¦ν•  μ μλ” νƒκ·Έλ¥Ό μƒμ„±ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        HMAC κµ¬μ΅°                                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  HMAC(K, m) = H((K&#39; β• opad) || H((K&#39; β• ipad) || m))               β”‚
β”‚                                                                      β”‚
β”‚  μ—¬κΈ°μ„:                                                             β”‚
β”‚  K  = λΉ„λ°€ ν‚¤                                                        β”‚
β”‚  K&#39; = λΈ”λ΅ ν¬κΈ°λ΅ ν¨λ”©/ν•΄μ‹λ ν‚¤                                      β”‚
β”‚  opad = λΈ”λ΅ ν¬κΈ°κΉμ§€ λ°λ³µλ 0x5c                                     β”‚
β”‚  ipad = λΈ”λ΅ ν¬κΈ°κΉμ§€ λ°λ³µλ 0x36                                     β”‚
β”‚  H  = ν•΄μ‹ ν•¨μ (SHA-256 λ“±)                                         β”‚
β”‚  || = μ—°κ²°                                                           β”‚
β”‚  β•  = XOR                                                           β”‚
β”‚                                                                      β”‚
β”‚  λ‹¨κ³„λ³„:                                                             β”‚
β”‚  1. ν‚¤ &gt; λΈ”λ΅ ν¬κΈ°μΈ κ²½μ°: K&#39; = H(K)                                 β”‚
β”‚  2. κ·Έλ ‡μ§€ μ•μΌλ©΄: K&#39; = 0μΌλ΅ ν¨λ”©λ K                                β”‚
β”‚  3. λ‚΄λ¶€ ν•΄μ‹: H((K&#39; β• ipad) || λ©”μ‹μ§€)                             β”‚
β”‚  4. μ™Έλ¶€ ν•΄μ‹: H((K&#39; β• opad) || inner_hash)                         β”‚
β”‚                                                                      β”‚
β”‚  μ™ λ‹¨μν H(key || message)κ°€ μ•„λ‹κ°€?                               β”‚
β”‚  β†’ Merkle-Damgard ν•΄μ‹(SHA-256)λ΅ κΈΈμ΄ ν™•μ¥ κ³µκ²©μ— μ·¨μ•½ν•©λ‹λ‹¤.       β”‚
β”‚    HMACμ μ¤‘μ²© κµ¬μ΅°λ” μ΄λ¥Ό λ°©μ§€ν•©λ‹λ‹¤.                                β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="61-python-hmac">6.1 Pythonμ—μ„ HMAC<a class="header-link" href="#61-python-hmac" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># λΉ„λ°€ ν‚¤ μƒμ„±</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 256λΉ„νΈ ν‚¤</span>

<span class="c1"># HMAC μƒμ„±</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Transfer $1000 to account 12345&quot;</span>
<span class="n">mac</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HMAC:    </span><span class="si">{</span><span class="n">mac</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># HMAC κ²€μ¦ (μƒμ μ‹κ°„ λΉ„κµ)</span>
<span class="n">received_mac</span> <span class="o">=</span> <span class="n">mac</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span>
    <span class="n">mac</span><span class="p">,</span>
    <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valid:   </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ³€μ΅°λ λ©”μ‹μ§€</span>
<span class="n">tampered</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Transfer $9999 to account 12345&quot;</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span>
    <span class="n">mac</span><span class="p">,</span>
    <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">tampered</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tampered valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False</span>
</code></pre></div>

<h3 id="62-api">6.2 μ‹¤μ©: API μ”μ²­ μ„λ…<a class="header-link" href="#62-api" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlencode</span>

<span class="k">class</span><span class="w"> </span><span class="nc">APIRequestSigner</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    HMAC-SHA256μ„ μ‚¬μ©ν•μ—¬ API μ”μ²­μ— μ„λ…ν•©λ‹λ‹¤.</span>
<span class="sd">    AWS Signature V4, Stripe μ›Ήν›… μ„λ… λ“±κ³Ό μ μ‚¬ν•©λ‹λ‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span> <span class="o">=</span> <span class="n">api_secret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sign_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                      <span class="n">body</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;API μ”μ²­μ— μ„λ…ν•κ³  ν—¤λ”λ¥Ό λ°ν™ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="ow">or</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">ts_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">))</span>

        <span class="c1"># μ •κ· μ”μ²­ λ¬Έμμ—΄ κµ¬μ¶•</span>
        <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">canonical</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">ts_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">body_str</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># HMAC κ³„μ‚°</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span><span class="p">,</span>
            <span class="n">canonical</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;X-API-Key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s2">&quot;X-Timestamp&quot;</span><span class="p">:</span> <span class="n">ts_str</span><span class="p">,</span>
            <span class="s2">&quot;X-Signature&quot;</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">verify_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                        <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">max_age_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μ„λ…λ API μ”μ²­μ„ κ²€μ¦ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;X-API-Key&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;X-Timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;X-Signature&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># API ν‚¤ ν™•μΈ</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid API key&quot;</span><span class="p">}</span>

        <span class="c1"># νƒ€μ„μ¤νƒ¬ν”„ ν™•μΈ (μ¬μƒ κ³µκ²© λ°©μ§€)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="n">age</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">ts</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="n">max_age_seconds</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Request too old (</span><span class="si">{</span><span class="n">age</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">}</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid timestamp&quot;</span><span class="p">}</span>

        <span class="c1"># μ„λ… μ¬κ³„μ‚° λ° κ²€μ¦</span>
        <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">canonical</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">body_str</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span><span class="p">,</span>
            <span class="n">canonical</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid signature&quot;</span><span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">}</span>

<span class="c1"># μ‚¬μ©</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;ak_live_abc123&quot;</span>
<span class="n">api_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>

<span class="n">signer</span> <span class="o">=</span> <span class="n">APIRequestSigner</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>

<span class="c1"># μ”μ²­ μ„λ…</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">sign_request</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/api/v1/transfers&quot;</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;acct_xyz&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signed Request Headers:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ”μ²­ κ²€μ¦</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">verify_request</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/api/v1/transfers&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;acct_xyz&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Verification: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ³€μ΅°λ λ³Έλ¬Έ</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">verify_request</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/api/v1/transfers&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span> <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;acct_xyz&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tampered body: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="63">6.3 μ›Ήν›… μ„λ… κ²€μ¦<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>

<span class="k">def</span><span class="w"> </span><span class="nf">verify_webhook_signature</span><span class="p">(</span>
    <span class="n">payload</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="n">signature_header</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">secret</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="n">tolerance_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    μ›Ήν›… μ„λ…μ„ κ²€μ¦ν•©λ‹λ‹¤ (Stripe μ¤νƒ€μΌ).</span>
<span class="sd">    ν—¤λ” ν•μ‹: t=&lt;timestamp&gt;,v1=&lt;signature&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ν—¤λ” νμ‹±</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">signature_header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
        <span class="n">elements</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">received_sig</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">timestamp</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">received_sig</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># νƒ€μ„μ¤νƒ¬ν”„ μ‹ μ„ λ„ ν™•μΈ</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">ts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tolerance_seconds</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># μμƒ μ„λ… κ³„μ‚°</span>
    <span class="n">signed_payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">payload</span>
    <span class="n">expected_sig</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
        <span class="n">secret</span><span class="p">,</span> <span class="n">signed_payload</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
    <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="c1"># μƒμ μ‹κ°„ λΉ„κµ</span>
    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">expected_sig</span><span class="p">,</span> <span class="n">received_sig</span><span class="p">)</span>

<span class="c1"># μ›Ήν›… μ‹λ®¬λ μ΄μ…</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="n">webhook_secret</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;whsec_test_secret_key_123&quot;</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;{&quot;event&quot;:&quot;payment.success&quot;,&quot;amount&quot;:5000}&#39;</span>
<span class="n">ts</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
    <span class="n">webhook_secret</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ts</span><span class="si">}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span>
    <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
<span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;t=</span><span class="si">{</span><span class="n">ts</span><span class="si">}</span><span class="s2">,v1=</span><span class="si">{</span><span class="n">sig</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">is_valid</span> <span class="o">=</span> <span class="n">verify_webhook_signature</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">webhook_secret</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Webhook signature valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ³€μ΅°λ νμ΄λ΅λ“</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">verify_webhook_signature</span><span class="p">(</span>
    <span class="sa">b</span><span class="s1">&#39;{&quot;event&quot;:&quot;payment.success&quot;,&quot;amount&quot;:50000}&#39;</span><span class="p">,</span>  <span class="c1"># κΈμ•΅ λ³€κ²½</span>
    <span class="n">header</span><span class="p">,</span>
    <span class="n">webhook_secret</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tampered webhook valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-merkle">7. Merkle νΈλ¦¬<a class="header-link" href="#7-merkle" title="Permanent link">&para;</a></h2>
<p>Merkle νΈλ¦¬λ” κ° λ¦¬ν”„ λ…Έλ“κ°€ λ°μ΄ν„° λΈ”λ΅μ ν•΄μ‹μ΄κ³  κ° λ‚΄λ¶€ λ…Έλ“κ°€ μμ‹μ ν•΄μ‹μΈ μ΄μ§„ ν•΄μ‹ νΈλ¦¬μ…λ‹λ‹¤. λ£¨νΈ ν•΄μ‹ (Merkle λ£¨νΈ)λ” λ¨λ“  λ°μ΄ν„°λ¥Ό μ”μ•½ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                       Merkle νΈλ¦¬                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚                        λ£¨νΈ ν•΄μ‹                                      β”‚
β”‚                      H(H12 || H34)                                  β”‚
β”‚                       /        \                                     β”‚
β”‚                      /          \                                    β”‚
β”‚                   H12            H34                                 β”‚
β”‚                H(H1||H2)      H(H3||H4)                             β”‚
β”‚                /      \        /      \                              β”‚
β”‚              H1       H2     H3       H4                            β”‚
β”‚            H(D1)    H(D2)  H(D3)   H(D4)                           β”‚
β”‚              |        |      |        |                              β”‚
β”‚            Data1   Data2   Data3   Data4                            β”‚
β”‚                                                                      β”‚
β”‚  μ†μ„±:                                                               β”‚
β”‚  β€Ά λ£¨νΈ ν•΄μ‹λ” λ¨λ“  λ°μ΄ν„° λΈ”λ΅μ΄ λ³€κ²½λλ©΄ λ³€κ²½λ©λ‹λ‹¤                 β”‚
β”‚  β€Ά O(log n) ν•΄μ‹λ΅ λ‹¨μΌ λΈ”λ΅μ„ κ²€μ¦ν•  μ μμµλ‹λ‹¤ (Merkle μ¦λ…)      β”‚
β”‚  β€Ά μ‚¬μ©μ²: Git, Bitcoin, Certificate Transparency, IPFS            β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="71-merkle">7.1 Merkle νΈλ¦¬ κµ¬ν„<a class="header-link" href="#71-merkle" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sha256</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MerkleNode</span><span class="p">:</span>
    <span class="nb">hash</span><span class="p">:</span> <span class="nb">bytes</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;MerkleNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;MerkleNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MerkleTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μ¦λ… μƒμ„±/κ²€μ¦μ΄ ν¬ν•¨λ μ™„μ „ν• Merkle νΈλ¦¬ κµ¬ν„.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_blocks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot create Merkle tree from empty data&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">MerkleNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="n">sha256</span><span class="p">(</span><span class="n">block</span><span class="p">))</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">data_blocks</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MerkleNode</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">MerkleNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;νΈλ¦¬λ¥Ό μƒν–¥μ‹μΌλ΅ κµ¬μ¶•ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># ν™€μ κ°μ λ…Έλ“μΈ κ²½μ° λ§μ§€λ§‰ λ…Έλ“λ¥Ό λ³µμ ν•©λ‹λ‹¤</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">parent_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">combined</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span> <span class="o">+</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">MerkleNode</span><span class="p">(</span>
                <span class="nb">hash</span><span class="o">=</span><span class="n">sha256</span><span class="p">(</span><span class="n">combined</span><span class="p">),</span>
                <span class="n">left</span><span class="o">=</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">right</span><span class="o">=</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">parent_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_tree</span><span class="p">(</span><span class="n">parent_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">root_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_proof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        μ£Όμ–΄μ§„ μΈλ±μ¤μ λ¦¬ν”„μ— λ€ν• Merkle μ¦λ…μ„ μƒμ„±ν•©λ‹λ‹¤.</span>
<span class="sd">        μ„μΉκ°€ &#39;left&#39; λλ” &#39;right&#39;μΈ (hash, position) νν” λ©λ΅μ„ λ°ν™ν•©λ‹λ‹¤.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> out of range&quot;</span><span class="p">)</span>

        <span class="n">proof</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">[:]</span>

        <span class="c1"># ν™€μμΈ κ²½μ° λ§μ§€λ§‰ λ³µμ </span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">current_index</span> <span class="o">=</span> <span class="n">index</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">next_level</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">current_index</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">current_index</span><span class="p">:</span>
                    <span class="c1"># μ΄κ²ƒμ€ μ°λ¦¬ λ…Έλ“λ¥Ό ν¬ν•¨ν•λ” μμ…λ‹λ‹¤</span>
                    <span class="k">if</span> <span class="n">current_index</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># μ°λ¦¬ λ…Έλ“λ” μ™Όμ½μ— μκ³ , ν•μ λ” μ¤λ¥Έμ½μ— μμµλ‹λ‹¤</span>
                        <span class="n">proof</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># μ°λ¦¬ λ…Έλ“λ” μ¤λ¥Έμ½μ— μκ³ , ν•μ λ” μ™Όμ½μ— μμµλ‹λ‹¤</span>
                        <span class="n">proof</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">))</span>

                <span class="n">combined</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span> <span class="o">+</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hash</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">MerkleNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="n">sha256</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
                <span class="n">next_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

            <span class="n">current_index</span> <span class="o">=</span> <span class="n">current_index</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="n">next_level</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">proof</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_proof</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">proof</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span> <span class="n">root_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merkle μ¦λ…μ„ κ²€μ¦ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">current_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sibling_hash</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">proof</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                <span class="n">combined</span> <span class="o">=</span> <span class="n">sibling_hash</span> <span class="o">+</span> <span class="n">current_hash</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">combined</span> <span class="o">=</span> <span class="n">current_hash</span> <span class="o">+</span> <span class="n">sibling_hash</span>
            <span class="n">current_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">current_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span> <span class="o">==</span> <span class="n">root_hash</span>

<span class="c1"># Merkle νΈλ¦¬ κµ¬μ¶•</span>
<span class="n">data_blocks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">b</span><span class="s2">&quot;Transaction: Alice -&gt; Bob $100&quot;</span><span class="p">,</span>
    <span class="sa">b</span><span class="s2">&quot;Transaction: Bob -&gt; Charlie $50&quot;</span><span class="p">,</span>
    <span class="sa">b</span><span class="s2">&quot;Transaction: Charlie -&gt; Dave $25&quot;</span><span class="p">,</span>
    <span class="sa">b</span><span class="s2">&quot;Transaction: Dave -&gt; Alice $75&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">MerkleTree</span><span class="p">(</span><span class="n">data_blocks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merkle root: </span><span class="si">{</span><span class="n">tree</span><span class="o">.</span><span class="n">root_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Leaves: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μΈλ±μ¤ 1μ νΈλμ­μ…μ— λ€ν• μ¦λ… μƒμ„±</span>
<span class="n">proof</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_proof</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Proof for block 1 (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">proof</span><span class="p">)</span><span class="si">}</span><span class="s2"> nodes):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">proof</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">h</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># μ¦λ… κ²€μ¦</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">MerkleTree</span><span class="o">.</span><span class="n">verify_proof</span><span class="p">(</span>
    <span class="n">data_blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">proof</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root_hash</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Proof valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ³€μ΅°λ λ°μ΄ν„°λ” μ‹¤ν¨</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="n">MerkleTree</span><span class="o">.</span><span class="n">verify_proof</span><span class="p">(</span>
    <span class="sa">b</span><span class="s2">&quot;Transaction: Bob -&gt; Charlie $5000&quot;</span><span class="p">,</span>  <span class="c1"># λ³€μ΅°λ¨!</span>
    <span class="n">proof</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root_hash</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tampered proof valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν¨μ¨μ„± ν‘μ‹: 1M λΈ”λ΅ μ¤‘ 1κ°λ¥Ό κ²€μ¦ν•λ ¤λ©΄ μ•½ 20κ°μ ν•΄μ‹λ§ ν•„μ”</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="n">n_blocks</span> <span class="o">=</span> <span class="mi">1_000_000</span>
<span class="n">proof_size</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">n_blocks</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For </span><span class="si">{</span><span class="n">n_blocks</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> blocks:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Proof size: </span><span class="si">{</span><span class="n">proof_size</span><span class="si">}</span><span class="s2"> hashes (</span><span class="si">{</span><span class="n">proof_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">32</span><span class="si">}</span><span class="s2"> bytes)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  vs checking all: </span><span class="si">{</span><span class="n">n_blocks</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">32</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Efficiency: </span><span class="si">{</span><span class="n">n_blocks</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">proof_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">x smaller&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ†<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p>λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ† (CAS)λ” λ°μ΄ν„°μ ν•΄μ‹λ¥Ό μ£Όμ†/ν‚¤λ΅ μ‚¬μ©ν•©λ‹λ‹¤. μ΄κ²ƒμ€ Git, IPFS, Docker λ μ΄μ–΄ λ° λ§μ€ μ¤‘λ³µ μ κ±° μ‹μ¤ν…μ κΈ°λ°μ…λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ† (CAS)                              β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  κΈ°μ΅΄ μ €μ¥μ†:                                                        β”‚
β”‚    filename β†’ data                                                  β”‚
β”‚    /docs/report.pdf β†’ [νμΌ λ‚΄μ©]                                   β”‚
β”‚                                                                      β”‚
β”‚  λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ†:                                              β”‚
β”‚    hash(data) β†’ data                                                β”‚
β”‚    sha256:a3f2b8... β†’ [νμΌ λ‚΄μ©]                                   β”‚
β”‚                                                                      β”‚
β”‚  μ΄μ :                                                               β”‚
β”‚  β€Ά μλ™ μ¤‘λ³µ μ κ±° (λ™μΌν• λ‚΄μ© = λ™μΌν• ν•΄μ‹ = ν• λ²λ§ μ €μ¥)         β”‚
β”‚  β€Ά λ‚΄μ¥ λ¬΄κ²°μ„± κ²€μ¦ (ν•΄μ‹κ°€ μ£Όμ†μ…λ‹λ‹¤)                              β”‚
β”‚  β€Ά μ„¤κ³„μƒ λ¶λ³€ (λ‚΄μ©μ„ λ³€κ²½ν•λ©΄ μ£Όμ†κ°€ λ³€κ²½λ¨)                        β”‚
β”‚  β€Ά μΊμ‹ μΉν™”μ  (μ£Όμ–΄μ§„ μ£Όμ†μ— λ€ν•΄ λ‚΄μ©μ΄ μ λ€ λ³€κ²½λμ§€ μ•μ)         β”‚
β”‚                                                                      β”‚
β”‚  μ‚¬μ©μ²:                                                             β”‚
β”‚  β€Ά Git (SHA-1/SHA-256λ΅ μ£Όμ† μ§€μ •λ blob κ°μ²΄)                      β”‚
β”‚  β€Ά Docker (SHA-256λ΅ μ£Όμ† μ§€μ •λ μ΄λ―Έμ§€ λ μ΄μ–΄)                      β”‚
β”‚  β€Ά IPFS (multihashλ΅ μ£Όμ† μ§€μ •λ λΈ”λ΅)                               β”‚
β”‚  β€Ά Nix ν¨ν‚¤μ§€ λ§¤λ‹μ €                                                 β”‚
β”‚  β€Ά μ½ν…μΈ  μ „μ†΅ λ„¤νΈμ›ν¬                                              β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="81-cas">8.1 CAS κµ¬ν„<a class="header-link" href="#81-cas" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CASStats</span><span class="p">:</span>
    <span class="n">total_objects</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deduplicated_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ContentAddressableStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SHA-256μ„ μ‚¬μ©ν• κ°„λ‹¨ν• λ‚΄μ© μ£Όμ† μ§€μ • μ €μ¥μ†.</span>
<span class="sd">    Gitμ΄ κ°μ²΄λ¥Ό μ €μ¥ν•λ” λ°©λ²•κ³Ό μ μ‚¬ν•©λ‹λ‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">store_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_hash_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;λ‚΄μ©μ SHA-256 ν•΄μ‹λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_object_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        κ°μ²΄μ νμΌ μ‹μ¤ν… κ²½λ΅λ¥Ό κ°€μ Έμµλ‹λ‹¤.</span>
<span class="sd">        λ‹¨μΌ λ””λ ‰ν„°λ¦¬μ— λ„λ¬΄ λ§μ€ νμΌμ„ ν”Όν•κΈ° μ„ν•΄</span>
<span class="sd">        μ²μ 2μλ¥Ό λ””λ ‰ν„°λ¦¬λ΅ μ‚¬μ©ν•©λ‹λ‹¤ (Gitμ²λΌ).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_dir</span> <span class="o">/</span> <span class="n">content_hash</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">content_hash</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        λ°μ΄ν„°λ¥Ό μ €μ¥ν•κ³  λ‚΄μ© ν•΄μ‹λ¥Ό λ°ν™ν•©λ‹λ‹¤.</span>
<span class="sd">        λ°μ΄ν„°κ°€ μ΄λ―Έ μ΅΄μ¬ν•λ” κ²½μ° μ΄κ²ƒμ€ no-opμ…λ‹λ‹¤ (μ¤‘λ³µ μ κ±°).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">content_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash_content</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_path</span><span class="p">(</span><span class="n">content_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">obj_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">obj_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">content_hash</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;λ‚΄μ© ν•΄μ‹λ΅ λ°μ΄ν„°λ¥Ό κ²€μƒ‰ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">obj_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_path</span><span class="p">(</span><span class="n">content_hash</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>

        <span class="c1"># μ½κΈ° μ‹ λ¬΄κ²°μ„± κ²€μ¦</span>
        <span class="n">actual_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash_content</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_hash</span> <span class="o">!=</span> <span class="n">content_hash</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Integrity error! Expected </span><span class="si">{</span><span class="n">content_hash</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">actual_hash</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;κ°μ²΄κ°€ μ΅΄μ¬ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_path</span><span class="p">(</span><span class="n">content_hash</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;κ°μ²΄λ¥Ό μ‚­μ ν•©λ‹λ‹¤ (ν”„λ΅λ•μ…μ—μ„ μ£Όμν•΄μ„ μ‚¬μ©).&quot;&quot;&quot;</span>
        <span class="n">obj_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_path</span><span class="p">(</span><span class="n">content_hash</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">obj_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="c1"># λΉ λ””λ ‰ν„°λ¦¬ μ •λ¦¬</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rmdir</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CASStats</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μ €μ¥μ† ν†µκ³„λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">CASStats</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">subdir</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">subdir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">obj_file</span> <span class="ow">in</span> <span class="n">subdir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
                    <span class="n">stats</span><span class="o">.</span><span class="n">total_objects</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">stats</span><span class="o">.</span><span class="n">total_bytes</span> <span class="o">+=</span> <span class="n">obj_file</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
        <span class="k">return</span> <span class="n">stats</span>

<span class="c1"># μ‚¬μ©</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">ContentAddressableStore</span><span class="p">(</span><span class="s2">&quot;/tmp/cas_demo&quot;</span><span class="p">)</span>

<span class="c1"># μΌλ¶€ λ°μ΄ν„° μ €μ¥</span>
<span class="n">data1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, content-addressable world!&quot;</span>
<span class="n">data2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Another piece of data&quot;</span>
<span class="n">data3</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello, content-addressable world!&quot;</span>  <span class="c1"># data1μ μ¤‘λ³µ!</span>

<span class="n">hash1</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">hash2</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="n">hash3</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">data3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data 1 hash: </span><span class="si">{</span><span class="n">hash1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data 2 hash: </span><span class="si">{</span><span class="n">hash2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data 3 hash: </span><span class="si">{</span><span class="n">hash3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data 1 == Data 3 hash? </span><span class="si">{</span><span class="n">hash1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hash3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># True - μ¤‘λ³µ μ κ±°!</span>

<span class="c1"># ν•΄μ‹λ΅ κ²€μƒ‰</span>
<span class="n">retrieved</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hash1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieved: </span><span class="si">{</span><span class="n">retrieved</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integrity: </span><span class="si">{</span><span class="n">retrieved</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">data1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ν†µκ³„</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Store stats:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Objects: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">total_objects</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 2, 3μ΄ μ•„λ‹ (μ¤‘λ³µ μ κ±°!)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total bytes: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">total_bytes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ •λ¦¬</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;/tmp/cas_demo&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="82-git">8.2 Git μ¤νƒ€μΌ κ°μ²΄ μ €μ¥μ†<a class="header-link" href="#82-git" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GitObjectStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    λ‹¨μν™”λ Git κ°μ²΄ μ €μ¥μ†.</span>
<span class="sd">    Gitμ€ κ°μ²΄λ¥Ό λ‹¤μκ³Ό κ°™μ΄ μ €μ¥ν•©λ‹λ‹¤: ν—¤λ” + λ‚΄μ©, zlibλ΅ μ••μ¶•λ¨.</span>
<span class="sd">    ν—¤λ” ν•μ‹: &quot;&lt;type&gt; &lt;size&gt;\0&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">git_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">git_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;objects&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hash_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;blob&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;κ°μ²΄λ¥Ό ν•΄μ‹ν•©λ‹λ‹¤ (&#39;git hash-object&#39;μ²λΌ).&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj_type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="se">\0</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">full_content</span> <span class="o">=</span> <span class="n">header</span> <span class="o">+</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">full_content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>  <span class="c1"># Gitμ€ SHA-1 μ‚¬μ© (SHA-256μΌλ΅ μ „ν™ μ¤‘)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;blob&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μ €μ¥μ†μ— κ°μ²΄λ¥Ό μ‘μ„±ν•©λ‹λ‹¤ (&#39;git hash-object -w&#39;μ²λΌ).&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj_type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="se">\0</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">full_content</span> <span class="o">=</span> <span class="n">header</span> <span class="o">+</span> <span class="n">data</span>
        <span class="n">obj_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">full_content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="c1"># μ••μ¶•ν•μ—¬ μ €μ¥</span>
        <span class="n">obj_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects_dir</span> <span class="o">/</span> <span class="n">obj_hash</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj_hash</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">obj_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">full_content</span><span class="p">)</span>
            <span class="n">obj_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj_hash</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;κ°μ²΄λ¥Ό μ½μµλ‹λ‹¤ (&#39;git cat-file&#39;μ²λΌ).&quot;&quot;&quot;</span>
        <span class="n">obj_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects_dir</span> <span class="o">/</span> <span class="n">obj_hash</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj_hash</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object </span><span class="si">{</span><span class="n">obj_hash</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>

        <span class="n">compressed</span> <span class="o">=</span> <span class="n">obj_path</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
        <span class="n">full_content</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

        <span class="c1"># ν—¤λ” νμ‹±</span>
        <span class="n">null_pos</span> <span class="o">=</span> <span class="n">full_content</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">full_content</span><span class="p">[:</span><span class="n">null_pos</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="n">obj_type</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">full_content</span><span class="p">[</span><span class="n">null_pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="s2">&quot;Size mismatch&quot;</span>
        <span class="k">return</span> <span class="n">obj_type</span><span class="p">,</span> <span class="n">data</span>

<span class="c1"># μ‚¬μ©</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">GitObjectStore</span><span class="p">(</span><span class="s2">&quot;/tmp/git_demo/.git&quot;</span><span class="p">)</span>

<span class="c1"># blob μ €μ¥ (νμΌ λ‚΄μ©)</span>
<span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;print(&#39;Hello, World!&#39;)</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">blob_hash</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">write_object</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;blob&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Blob hash: </span><span class="si">{</span><span class="n">blob_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># λ‹¤μ‹ μ½κΈ°</span>
<span class="n">obj_type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">read_object</span><span class="p">(</span><span class="n">blob_hash</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type: </span><span class="si">{</span><span class="n">obj_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Content: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># νΈλ¦¬ μ €μ¥ (λ””λ ‰ν„°λ¦¬ λ©λ΅) - λ‹¨μν™”λ¨</span>
<span class="n">tree_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;100644 hello.py</span><span class="se">\0</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">blob_hash</span><span class="p">)</span>
<span class="n">tree_hash</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">write_object</span><span class="p">(</span><span class="n">tree_content</span><span class="p">,</span> <span class="s2">&quot;tree&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tree hash: </span><span class="si">{</span><span class="n">tree_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ •λ¦¬</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;/tmp/git_demo&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="9">9. νƒ€μ΄λ° κ³µκ²©κ³Ό μƒμ μ‹κ°„ λΉ„κµ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 λ¬Έμ <a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<p>λ‘ λ¬Έμμ—΄μ„ λ¬Έμλ³„λ΅ λΉ„κµν•  λ• μ†μ”λλ” μ‹κ°„μ€ μ²« λ²μ§Έ μ°¨μ΄κ°€ λ°μƒν•λ” μ„μΉμ— λ”°λΌ λ‹¬λΌμ§‘λ‹λ‹¤. κ³µκ²©μλ” μ‘λ‹µ μ‹κ°„μ„ μΈ΅μ •ν•μ—¬ λΉ„λ°€ κ°’μ λ‡ μλ¥Ό μ¬λ°”λ¥΄κ² μ¶”μΈ΅ν–λ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    λ¬Έμμ—΄ λΉ„κµμ— λ€ν• νƒ€μ΄λ° κ³µκ²©                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  λΉ„λ°€ MAC: &quot;a3f2b8c9d1e4&quot;                                           β”‚
β”‚                                                                      β”‚
β”‚  μ‹λ„ 1: &quot;x3f2b8c9d1e4&quot;  β†’ μ„μΉ 0μ—μ„ μ‹¤ν¨  β†’ ~100 ns              β”‚
β”‚  μ‹λ„ 2: &quot;a4f2b8c9d1e4&quot;  β†’ μ„μΉ 1μ—μ„ μ‹¤ν¨  β†’ ~110 ns              β”‚
β”‚  μ‹λ„ 3: &quot;a3g2b8c9d1e4&quot;  β†’ μ„μΉ 2μ—μ„ μ‹¤ν¨  β†’ ~120 ns              β”‚
β”‚                                                                      β”‚
β”‚  κ³µκ²©μλ” κ° μ¬λ°”λ¥Έ λ¬Έμκ°€ μ•½ 10 nsλ¥Ό μ¶”κ°€ν•λ‹¤λ” κ²ƒμ„ μ•μ•„μ±•λ‹λ‹¤.     β”‚
β”‚  κ° μ„μΉμ λ¨λ“  κ°’μ„ μ‹λ„ν•¨μΌλ΅μ¨ μ „μ²΄ MACμ„ ν• λ²μ— ν• λ¬Έμμ”©         β”‚
β”‚  λ³µκµ¬ν•  μ μμµλ‹λ‹¤: O(16^n) λ€μ‹  O(n Γ— 16).                         β”‚
β”‚                                                                      β”‚
β”‚  32μ 16μ§„μ MACμ κ²½μ°:                                             β”‚
β”‚  λ¬΄μ°¨λ³„ λ€μ…: 16^32 β‰ 3.4 Γ— 10^38 μ‹λ„                             β”‚
β”‚  νƒ€μ΄λ° κ³µκ²©: 32 Γ— 16 = 512 μ‹λ„ (!)                                β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="92-vs">9.2 μ·¨μ•½ν• vs μ•μ „ν• λΉ„κµ<a class="header-link" href="#92-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># μ·¨μ•½: μ΅°κΈ° μΆ…λ£ λ¬Έμμ—΄ λΉ„κµ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">insecure_compare</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    μ‚¬μ©ν•μ§€ λ§μ‹­μ‹μ¤! νƒ€μ΄λ° κ³µκ²©μ— μ·¨μ•½ν•©λ‹λ‹¤.</span>
<span class="sd">    λ¶μΌμΉκ°€ λ°κ²¬λλ” μ¦‰μ‹ Falseλ¥Ό λ°ν™ν•©λ‹λ‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># μ΅°κΈ° μΆ…λ£λ” μ •λ³΄λ¥Ό λ„μ¶ν•©λ‹λ‹¤!</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># μ•μ „: μƒμ μ‹κ°„ λΉ„κµ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">secure_compare</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    μƒμ μ‹κ°„ λΉ„κµ. λ¬Έμμ—΄μ΄ μ–΄λ””μ„ (λλ” λ§μ•½) λ‹¤λ¥Έμ§€μ— κ΄€κ³„μ—†μ΄</span>
<span class="sd">    λ™μΌν• μ‹κ°„μ΄ κ±Έλ¦½λ‹λ‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># νƒ€μ΄λ° μ°¨μ΄ μ‹μ—°</span>
<span class="n">secret_mac</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;secret-key&quot;</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;message&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="c1"># μ¬λ°”λ¥Έ μ ‘λ‘μ‚¬ κΈΈμ΄κ°€ μ¦κ°€ν•λ” ν…μ¤νΈ MAC μƒμ„±</span>
<span class="n">test_macs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">secret_mac</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">correct_prefix</span> <span class="o">=</span> <span class="n">secret_mac</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
    <span class="n">wrong_suffix</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secret_mac</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">test_macs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correct_prefix</span> <span class="o">+</span> <span class="n">wrong_suffix</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Timing Attack Demonstration&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Secret MAC: </span><span class="si">{</span><span class="n">secret_mac</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># μ•μ „ν•μ§€ μ•μ€ λΉ„κµ μ‹κ°„ μΈ΅μ •</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSECURE comparison (early exit):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mac</span> <span class="ow">in</span> <span class="n">test_macs</span><span class="p">[:</span><span class="mi">8</span><span class="p">]:</span>
    <span class="n">correct_chars</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mac</span><span class="p">,</span> <span class="n">secret_mac</span><span class="p">))</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>
        <span class="n">insecure_compare</span><span class="p">(</span><span class="n">mac</span><span class="p">,</span> <span class="n">secret_mac</span><span class="p">)</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span>
    <span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">correct_chars</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> correct chars β†’ avg </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">6.0f</span><span class="si">}</span><span class="s2"> ns&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># μ•μ „ν• λΉ„κµ μ‹κ°„ μΈ΅μ •</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SECURE comparison (constant-time):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mac</span> <span class="ow">in</span> <span class="n">test_macs</span><span class="p">[:</span><span class="mi">8</span><span class="p">]:</span>
    <span class="n">correct_chars</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mac</span><span class="p">,</span> <span class="n">secret_mac</span><span class="p">))</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>
        <span class="n">secure_compare</span><span class="p">(</span><span class="n">mac</span><span class="p">,</span> <span class="n">secret_mac</span><span class="p">)</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span>
    <span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">correct_chars</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> correct chars β†’ avg </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">6.0f</span><span class="si">}</span><span class="s2"> ns&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: Secure comparison time should be roughly constant&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;regardless of how many characters match.&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="93">9.3 νƒ€μ΄λ° μ•μ „ μ½”λ“λ¥Ό μ„ν• κ·μΉ™<a class="header-link" href="#93" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">               </span><span class="n">μƒμ</span><span class="w"> </span><span class="n">μ‹κ°„</span><span class="w"> </span><span class="n">μ‘μ—…μ„</span><span class="w"> </span><span class="n">μ„ν•</span><span class="w"> </span><span class="n">κ·μΉ™</span><span class="w">                              </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">λΉ„λ°€</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">,</span><span class="w"> </span><span class="n">ν† ν°</span><span class="p">,</span><span class="w"> </span><span class="n">ν¨μ¤μ›λ“</span><span class="p">)</span><span class="n">μ„</span><span class="w"> </span><span class="n">λΉ„κµν• </span><span class="w"> </span><span class="n">λ•</span><span class="w"> </span><span class="o">==</span><span class="n">λ¥Ό</span><span class="w"> </span><span class="n">μ λ€</span><span class="w"> </span><span class="n">μ‚¬μ©ν•μ§€</span><span class="w"> </span><span class="n">λ§μ‹­μ‹μ¤</span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">μ‚¬μ©</span><span class="p">:</span><span class="w"> </span><span class="n">hmac</span><span class="p">.</span><span class="n">compare_digest</span><span class="p">()</span><span class="w"> </span><span class="n">λλ”</span><span class="w"> </span><span class="n">secrets</span><span class="p">.</span><span class="n">compare_digest</span><span class="p">()</span><span class="w">       </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">λΉ„λ°€</span><span class="w"> </span><span class="n">λ°μ΄ν„°λ¥Ό</span><span class="w"> </span><span class="n">κΈ°λ°μΌλ΅</span><span class="w"> </span><span class="n">μ΅°κΈ°μ—</span><span class="w"> </span><span class="n">λ°ν™ν•μ§€</span><span class="w"> </span><span class="n">λ§μ‹­μ‹μ¤</span><span class="w">                   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">λ‚μ¨</span><span class="p">:</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">mac</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">expected</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w">                   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">μΆ‹μ</span><span class="p">:</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="n">mac</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">expected</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">μ°¨μ΄</span><span class="w"> </span><span class="n">λ„μ </span><span class="w">            </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">λΉ„λ°€</span><span class="w"> </span><span class="n">λ°μ΄ν„°μ—</span><span class="w"> </span><span class="n">λ€ν•΄</span><span class="w"> </span><span class="n">λ¶„κΈ°ν•μ§€</span><span class="w"> </span><span class="n">λ§μ‹­μ‹μ¤</span><span class="w">                              </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">λ‚μ¨</span><span class="p">:</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">secret_key</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="err">:</span><span class="w"> </span><span class="p">...</span><span class="w">                             </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">μΆ‹μ</span><span class="p">:</span><span class="w"> </span><span class="n">μƒμ</span><span class="w"> </span><span class="n">μ‹κ°„</span><span class="w"> </span><span class="n">μ„ νƒ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">λ§μ¤ν‚Ή</span><span class="w"> </span><span class="n">μ‚¬μ©</span><span class="w">                               </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">λΉ„λ°€</span><span class="w"> </span><span class="n">κ°’μΌλ΅</span><span class="w"> </span><span class="n">λ°°μ—΄μ„</span><span class="w"> </span><span class="n">μΈλ±μ‹±ν•μ§€</span><span class="w"> </span><span class="n">λ§μ‹­μ‹μ¤</span><span class="w">                            </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">λ‚μ¨</span><span class="p">:</span><span class="w">  </span><span class="nc">table</span><span class="o">[</span><span class="n">secret_byte</span><span class="o">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">μΊμ‹</span><span class="w"> </span><span class="n">νƒ€μ΄λ°</span><span class="w"> </span><span class="n">λ„μ¶</span><span class="w">                  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="nl">μΆ‹μ</span><span class="p">:</span><span class="w"> </span><span class="n">μƒμ</span><span class="w"> </span><span class="n">μ‹κ°„</span><span class="w"> </span><span class="n">λ£©μ—…</span><span class="w"> </span><span class="n">ν…μ΄λΈ”</span><span class="w"> </span><span class="n">μ‚¬μ©</span><span class="w">                                 </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">  </span><span class="mf">5.</span><span class="w"> </span><span class="n">λ³µνΈν™”ν•κΈ°</span><span class="w"> </span><span class="n">μ „μ—</span><span class="w"> </span><span class="n">ν•­μƒ</span><span class="w"> </span><span class="n">MACμ„</span><span class="w"> </span><span class="n">κ²€μ¦ν•μ‹­μ‹μ¤</span><span class="w">                          </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">     </span><span class="n">μ΄κ²ƒμ€</span><span class="w"> </span><span class="n">ν¨λ”©</span><span class="w"> </span><span class="n">μ¤λΌν΄</span><span class="w"> </span><span class="n">κ³µκ²©μ„</span><span class="w"> </span><span class="n">λ°©μ§€ν•©λ‹λ‹¤</span><span class="w"> </span><span class="p">(</span><span class="n">Encrypt</span><span class="o">-</span><span class="k">then</span><span class="o">-</span><span class="n">MAC</span><span class="p">)</span><span class="w">         </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">                                                                      </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<hr />
<h2 id="10">10. ν•΄μ‹ ν•¨μ κ³µκ²©κ³Ό μ™„ν™”<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 μ•λ ¤μ§„ κ³µκ²©<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                ν•΄μ‹ ν•¨μ κ³µκ²© μ”μ•½                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ κ³µκ²©               β”‚ μ„¤λ… λ° μƒνƒ                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μƒμΌ κ³µκ²©          β”‚ O(2^(n/2))λ΅ λ¨λ“  μ¶©λ μ°ΎκΈ°                    β”‚
β”‚                    β”‚ SHA-256: 2^128 (μ•μ „), MD5: 2^64 (μ†μƒλ¨)     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ κΈΈμ΄ ν™•μ¥          β”‚ H(m)μ΄ μ£Όμ–΄μ§€λ©΄ mμ„ λ¨λ¥΄κ³                      β”‚
β”‚                    β”‚ H(m||pad||suffix)λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.                β”‚
β”‚                    β”‚ SHA-256, SHA-512μ— μν–¥μ„ λ―ΈμΉ©λ‹λ‹¤.            β”‚
β”‚                    β”‚ ν•΄λ‹Ή μ—†μ: SHA-3, BLAKE2, HMAC, SHA-512/256   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ μΈλ³΄μ° ν…μ΄λΈ”    β”‚ μ‚¬μ „ κ³„μ‚°λ ν•΄μ‹-ν¨μ¤μ›λ“ λ£©μ—… ν…μ΄λΈ”.         β”‚
β”‚                    β”‚ ν¨μ¤μ›λ“ μ†”ν…μΌλ΅ λ°©μ–΄λ©λ‹λ‹¤.                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ‚¬μ „ κ³µκ²©          β”‚ ν•΄μ‹μ— λ€ν•΄ μΌλ°μ μΈ ν¨μ¤μ›λ“λ¥Ό μ‹λ„ν•©λ‹λ‹¤.    β”‚
β”‚                    β”‚ λλ¦° ν¨μ¤μ›λ“ ν•΄μ‹(Argon2)λ΅ μ™„ν™”λ©λ‹λ‹¤.       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ GPU λ¬΄μ°¨λ³„ λ€μ…    β”‚ GPUλ” μ΄λ‹Ή μμ‹­μ–µ κ°μ ν•΄μ‹λ¥Ό κ³„μ‚°ν•  μ        β”‚
β”‚                    β”‚ μμµλ‹λ‹¤. λ©”λ¨λ¦¬ ν•λ“ ν•΄μ‹(Argon2id)λ΅         β”‚
β”‚                    β”‚ μ™„ν™”λ©λ‹λ‹¤.                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ SHAttered (2017)   β”‚ Googleμ΄ λ°κ²¬ν• μ‹¤μ©μ μΈ SHA-1 μ¶©λ.          β”‚
β”‚                    β”‚ λ™μΌν• SHA-1μ΄μ§€λ§ λ‹¤λ¥Έ λ‚΄μ©μ λ‘ PDF         β”‚
β”‚                    β”‚ SHA-1μ€ μ΄μ  λ³΄μ•μ— μ†μƒλ κ²ƒμΌλ΅ κ°„μ£Όλ©λ‹λ‹¤.  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ‹¤μ¤‘ μ¶©λ          β”‚ λ™μΌν• ν•΄μ‹λ¥Ό κ°€μ§„ λ§μ€ λ©”μ‹μ§€λ¥Ό μ°Ύμµλ‹λ‹¤.     β”‚
β”‚                    β”‚ λ°λ³µ ν•΄μ‹μ— λ€ν•΄ μμƒλ³΄λ‹¤ μ‰½μµλ‹λ‹¤.            β”‚
β”‚                    β”‚ SHA-3μ μ¤ν€μ§€ κµ¬μ΅°λ” λ” μ €ν•­λ ¥μ΄ μμµλ‹λ‹¤.    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="102">10.2 κΈΈμ΄ ν™•μ¥ κ³µκ²©<a class="header-link" href="#102" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># κΈΈμ΄ ν™•μ¥ κ³µκ²© μ‹μ—°</span>
<span class="c1"># μ΄κ²ƒμ΄ H(key || message) λ€μ‹  HMACμ„ μ‚¬μ©ν•΄μ•Ό ν•λ” μ΄μ μ…λ‹λ‹¤</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sha256_pad</span><span class="p">(</span><span class="n">message_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μ£Όμ–΄μ§„ κΈΈμ΄μ λ©”μ‹μ§€μ— λ€ν• SHA-256 ν¨λ”©μ„ κ³„μ‚°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">bit_len</span> <span class="o">=</span> <span class="n">message_len</span> <span class="o">*</span> <span class="mi">8</span>
    <span class="c1"># ν¨λ”©: 1λΉ„νΈ, κ·Έ λ‹¤μ 0, κ·Έ λ‹¤μ 64λΉ„νΈ κΈΈμ΄</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x80</span><span class="s1">&#39;</span>
    <span class="n">padding</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="p">((</span><span class="mi">56</span> <span class="o">-</span> <span class="p">(</span><span class="n">message_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">padding</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span> <span class="n">bit_len</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">padding</span>

<span class="c1"># μ·¨μ•½μ : H(secret || message)λ” μ•μ „ν• MACμ΄ μ•„λ‹™λ‹λ‹¤</span>
<span class="c1">#</span>
<span class="c1"># κ³µκ²©μκ°€ λ‹¤μμ„ μ•κ³  μλ” κ²½μ°:</span>
<span class="c1">#   - H(secret || message)  (MAC)</span>
<span class="c1">#   - len(secret)           (λλ” μ¶”μΈ΅ν•  μ μμ)</span>
<span class="c1">#   - message               (μ›λ³Έ λ©”μ‹μ§€)</span>
<span class="c1">#</span>
<span class="c1"># λΉ„λ°€μ„ λ¨λ¥΄κ³ λ„ H(secret || message || padding || extension)μ„</span>
<span class="c1"># κ³„μ‚°ν•  μ μμµλ‹λ‹¤!</span>
<span class="c1">#</span>
<span class="c1"># μ΄κ²ƒμ€ SHA-256μ΄ λΈ”λ΅ λ‹¨μ„λ΅ λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•κ³ </span>
<span class="c1"># (secret || message || padding) μ²λ¦¬ ν›„μ ν•΄μ‹ μƒνƒκ°€</span>
<span class="c1"># μ •ν™•ν κ³µκ° ν•΄μ‹ κ°’μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤. κ³µκ²©μλ” κ±°κΈ°μ„λ¶€ν„°</span>
<span class="c1"># ν•΄μ‹±μ„ μ¬κ°ν•  μ μμµλ‹λ‹¤.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Length-Extension Attack Concept:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VULNERABLE construction: MAC = SHA-256(secret || message)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An attacker who knows MAC and len(secret) can extend the message.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SAFE alternatives:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  1. HMAC-SHA256(key, message)     β€” HMAC construction&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  2. SHA-3-256(key || message)      β€” SHA-3 is not vulnerable&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  3. BLAKE2b(message, key=key)      β€” Built-in keying&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  4. SHA-512/256(key || message)    β€” Truncated hash&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="11">11. μ—°μµ λ¬Έμ <a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<h3 id="1_1">μ—°μµ 1: ν•΄μ‹ νƒμƒ‰κΈ° (μ΄κΈ‰)<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>λ‹¤μμ„ μν–‰ν•λ” Python ν”„λ΅κ·Έλ¨μ„ μ‘μ„±ν•μ‹­μ‹μ¤:
1. νμΌ μ΄λ¦„μ„ μ…λ ¥μΌλ΅ λ°›μµλ‹λ‹¤
2. SHA-256, SHA-3-256, BLAKE2b-256, BLAKE3 ν•΄μ‹λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤
3. λ¨λ“  ν•΄μ‹μ™€ κ°κ°μ— μ†μ”λ μ‹κ°„μ„ ν‘μ‹ν•©λ‹λ‹¤
4. 100 MB νμΌμ—μ„ κ° μ•κ³ λ¦¬μ¦μ μ†λ„λ¥Ό λΉ„κµν•©λ‹λ‹¤
5. ν•΄μ‹λ¥Ό λΉ„κµν•μ—¬ νμΌμ΄ μμ •λμ§€ μ•μ•λ”μ§€ ν™•μΈν•©λ‹λ‹¤</p>
<h3 id="2_1">μ—°μµ 2: ν¨μ¤μ›λ“ ν¬λμ»¤ λ°©μ–΄ (μ¤‘κΈ‰)<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ν¨μ¤μ›λ“ ν¬λν‚Ή μ‹λ®¬λ μ΄μ…μ„ κµ¬ν„ν•μ‹­μ‹μ¤:
1. λ‹¤μμ„ μ‚¬μ©ν•μ—¬ ν•΄μ‹λ ν¨μ¤μ›λ“κ°€ μλ” 1000κ°μ "μ‚¬μ©μ κ³„μ •" λ©λ΅μ„ λ§λ“­λ‹λ‹¤:
   a. μΌλ° SHA-256 (μ†”νΈ μ—†μ)
   b. κ³ μ ν• μ†”νΈκ°€ μλ” SHA-256
   c. bcrypt (cost=10)
   d. Argon2id (κΈ°λ³Έ λ§¤κ°λ³€μ)
2. 10,000κ°μ μΌλ°μ μΈ ν¨μ¤μ›λ“ μ‚¬μ „μ„ μ‚¬μ©ν•μ—¬ λ¨λ“  ν¨μ¤μ›λ“ ν¬λν‚Ήμ„ μ‹λ„ν•©λ‹λ‹¤
3. κ° ν•΄μ‹± λ°©λ²•μ— ν•„μ”ν• μ‹κ°„μ„ μΈ΅μ •ν•κ³  λΉ„κµν•©λ‹λ‹¤
4. ν¬λν‚Ήλ κ²ƒκ³Ό ν¬λν‚Ήλμ§€ μ•μ€ κ²ƒμ λ°±λ¶„μ¨μ„ λ³΄μ—¬μ£Όλ” λ³΄κ³ μ„λ¥Ό μƒμ„±ν•©λ‹λ‹¤</p>
<h3 id="3-merkle">μ—°μµ 3: Merkle νΈλ¦¬ νμΌ κ²€μ¦κΈ° (μ¤‘κΈ‰)<a class="header-link" href="#3-merkle" title="Permanent link">&para;</a></h3>
<p>Merkle νΈλ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ νμΌ λ¬΄κ²°μ„± κ²€μ¦ μ‹μ¤ν…μ„ κµ¬μ¶•ν•μ‹­μ‹μ¤:
1. λ””λ ‰ν„°λ¦¬κ°€ μ£Όμ–΄μ§€λ©΄ λ¨λ“  νμΌμ— λ€ν• Merkle νΈλ¦¬λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤ (κ²½λ΅λ³„λ΅ μ •λ ¬)
2. Merkle λ£¨νΈμ™€ νΈλ¦¬ κµ¬μ΅°λ¥Ό μ €μ¥ν•©λ‹λ‹¤
3. λ‚μ¤‘μ— O(log n) ν•΄μ‹λ§ λ‹¤μ‹ κ³„μ‚°ν•μ—¬ κ°λ³„ νμΌμ„ κ²€μ¦ν•©λ‹λ‹¤
4. λ…λ¦½μ μΌλ΅ κ²€μ¦ν•  μ μλ” Merkle μ¦λ…μ„ μƒμ„±ν•©λ‹λ‹¤
5. νμΌ μ¶”κ°€ λ° μ‚­μ λ¥Ό ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤</p>
<h3 id="4-hmac-api">μ—°μµ 4: HMAC κΈ°λ° API μΈμ¦ (μ¤‘κΈ‰)<a class="header-link" href="#4-hmac-api" title="Permanent link">&para;</a></h3>
<p>μ™„μ „ν• API μΈμ¦ μ‹μ¤ν…μ„ κµ¬ν„ν•μ‹­μ‹μ¤:
1. μ„λ²„λ” κ° ν΄λΌμ΄μ–ΈνΈμ—κ² API ν‚¤ + λΉ„λ°€μ„ λ°κΈ‰ν•©λ‹λ‹¤
2. ν΄λΌμ΄μ–ΈνΈλ” HMAC-SHA256μΌλ΅ κ° μ”μ²­μ— μ„λ…ν•©λ‹λ‹¤:
   - ν¬ν•¨: λ©”μ„λ“, κ²½λ΅, νƒ€μ„μ¤νƒ¬ν”„, λ³Έλ¬Έ ν•΄μ‹, nonce
3. μ„λ²„ κ²€μ¦: μ ν¨ν• μ„λ…, μ‹ μ„ ν• νƒ€μ„μ¤νƒ¬ν”„ (5λ¶„ μ΄λ‚΄), μ‚¬μ©λμ§€ μ•μ€ nonce
4. nonce μΊμ‹λ¥Ό μ‚¬μ©ν•μ—¬ μ¬μƒ κ³µκ²© λ°©μ§€ κµ¬ν„
5. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μ‹κ³„ μ°¨μ΄ μ²λ¦¬</p>
<h3 id="5_1">μ—°μµ 5: λ‚΄μ© μ£Όμ† μ§€μ • νμΌ λ™κΈ°ν™” (κ³ κΈ‰)<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>λ‹¨μν™”λ νμΌ λ™κΈ°ν™” μ‹μ¤ν…μ„ κµ¬μ¶•ν•μ‹­μ‹μ¤ (λ‚΄μ© μ£Όμ† μ§€μ •μ΄ μλ” rsyncμ²λΌ):
1. μ–‘μ½ λ¨λ‘ νμΌμ CASλ¥Ό μ μ§€ν•©λ‹λ‹¤
2. λ™κΈ°ν™”ν•λ ¤λ©΄ λ‚΄μ© ν•΄μ‹ λ©λ΅λ§ κµν™ν•©λ‹λ‹¤
3. μƒλ€λ°©μ΄ λ„λ½ν• λΈ”λ΅λ§ μ „μ†΅ν•©λ‹λ‹¤
4. μμ‹ λ λ¨λ“  λΈ”λ΅μ λ¬΄κ²°μ„±μ„ κ²€μ¦ν•©λ‹λ‹¤
5. Merkle νΈλ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ ν° νμΌμ μ–΄λ λ¶€λ¶„μ΄ λ‹¤λ¥Έμ§€ ν¨μ¨μ μΌλ΅ κ°μ§€ν•©λ‹λ‹¤</p>
<h3 id="6">μ—°μµ 6: νƒ€μ΄λ° κ³µκ²© μ‹¤ν—μ‹¤ (κ³ κΈ‰)<a class="header-link" href="#6" title="Permanent link">&para;</a></h3>
<p>μ μ–΄λ νƒ€μ΄λ° κ³µκ²©μ„ κµ¬μ¶•ν•μ‹­μ‹μ¤:
1. μ•μ „ν•μ§€ μ•μ€ λΉ„κµ (<code>==</code>)λ¥Ό μ‚¬μ©ν•μ—¬ API ν† ν°μ„ κ²€μ¦ν•λ” μ„λ²„λ¥Ό λ§λ“­λ‹λ‹¤
2. μ‘λ‹µ μ‹κ°„μ„ μΈ΅μ •ν•μ—¬ ν† ν°μ„ ν• λ²μ— ν• λ¬Έμμ”© μ¶”μΈ΅ν•λ” ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‘μ„±ν•©λ‹λ‹¤
3. κ³µκ²©μ΄ μ „μ²΄ ν† ν°μ„ λ³µκµ¬ν•λ‹¤λ” κ²ƒμ„ μ‹μ—°ν•©λ‹λ‹¤
4. <code>hmac.compare_digest()</code>λ¥Ό μ‚¬μ©ν•λ„λ΅ μ„λ²„λ¥Ό μμ •ν•©λ‹λ‹¤
5. κ³µκ²©μ΄ λ” μ΄μƒ μ‘λ™ν•μ§€ μ•μμ„ λ³΄μ—¬μ¤λ‹λ‹¤
6. λ‹¤λ¥Έ νƒ€μ΄λ° μ‚¬μ΄λ“ μ±„λ„ (μΊμ‹ νƒ€μ΄λ°, μ „λ ¥ λ¶„μ„) λ…Όμ</p>
<hr />
<h2 id="12">12. μ°Έκ³  λ¬Έν—<a class="header-link" href="#12" title="Permanent link">&para;</a></h2>
<ul>
<li>Aumasson, J.P. (2017). <em>Serious Cryptography</em>. No Starch Press.</li>
<li>NIST FIPS 180-4: Secure Hash Standard (SHA-2)</li>
<li>NIST FIPS 202: SHA-3 Standard</li>
<li>RFC 7693: The BLAKE2 Cryptographic Hash</li>
<li>BLAKE3 Specification - https://github.com/BLAKE3-team/BLAKE3-specs</li>
<li>RFC 2104: HMAC: Keyed-Hashing for Message Authentication</li>
<li>OWASP Password Storage Cheat Sheet - https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html</li>
<li>Argon2 Reference - https://github.com/P-H-C/phc-winner-argon2</li>
<li>Merkle, R.C. (1979). "A Certified Digital Signature"</li>
</ul>
<hr />
<p><strong>μ΄μ „</strong>: <a href="./02_Cryptography_Basics.md">02. μ•”νΈν•™ κΈ°μ΄</a> | <strong>λ‹¤μ</strong>: <a href="./04_TLS_and_PKI.md">04. TLS/SSLκ³Ό κ³µκ°ν‚¤ μΈν”„λΌ</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/02_Cryptography_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Cryptography κΈ°μ΄</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/04_TLS_and_PKI.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">β†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}