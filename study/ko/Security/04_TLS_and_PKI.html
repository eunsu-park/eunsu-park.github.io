{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">π </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">π’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        ν•κµ­μ–΄
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">β€οΈ</span>
                    <span class="theme-icon dark">π™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/03_Hashing_and_Integrity.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/05_Authentication.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">05. μΈμ¦ μ‹μ¤ν…</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">λ©μ°¨</a></li>
<li><a href="#1-tls">1. TLS κ°μ”μ™€ μ—­μ‚¬</a><ul>
<li><a href="#11">1.1 ν”„λ΅ν† μ½ μ§„ν™”</a></li>
<li><a href="#12-tls">1.2 μ¤νƒμ—μ„ TLSμ μ„μΉ</a></li>
<li><a href="#13-tls">1.3 TLSκ°€ μ κ³µν•λ” κ²ƒ</a></li>
</ul>
</li>
<li><a href="#2-tls-13">2. TLS 1.3 ν•Έλ“μ…°μ΄ν¬ μƒμ„Έ</a><ul>
<li><a href="#21-1-rtt">2.1 μ „μ²΄ ν•Έλ“μ…°μ΄ν¬ (1-RTT)</a></li>
<li><a href="#22-tls-13">2.2 TLS 1.3μ ν‚¤ νμƒ</a></li>
<li><a href="#23-tls-13-vs-tls-12">2.3 TLS 1.3 vs TLS 1.2</a></li>
<li><a href="#24-0-rtt">2.4 0-RTT (μ λ΅ λΌμ΄λ“ νΈλ¦½ νƒ€μ„) μ¬κ°</a></li>
</ul>
</li>
<li><a href="#3">3. μ•”νΈν™” μ¤μ„νΈ</a><ul>
<li><a href="#31-tls-13">3.1 TLS 1.3 μ•”νΈν™” μ¤μ„νΈ</a></li>
<li><a href="#32-tls-12">3.2 TLS 1.2 μ•”νΈν™” μ¤μ„νΈ μ΄λ¦„ μ΄ν•΄ν•κΈ°</a></li>
</ul>
</li>
<li><a href="#4-x509">4. X.509 μΈμ¦μ„</a><ul>
<li><a href="#41">4.1 μΈμ¦μ„ κµ¬μ΅°</a></li>
<li><a href="#42-python">4.2 Pythonμ—μ„ μΈμ¦μ„ μ½κΈ°</a></li>
</ul>
</li>
<li><a href="#5">5. μΈμ¦μ„ μ²΄μΈκ³Ό μ‹ λΆ°</a><ul>
<li><a href="#51">5.1 μ‹ λΆ° μ²΄μΈ</a></li>
<li><a href="#52-python">5.2 Pythonμ—μ„ μΈμ¦μ„ μ²΄μΈ κ²€μ¦</a></li>
</ul>
</li>
<li><a href="#6-ca">6. μΈμ¦ κΈ°κ΄€(CA)</a><ul>
<li><a href="#61-ca">6.1 CA μ‘λ™ λ°©μ‹</a></li>
<li><a href="#62">6.2 μΈμ¦μ„ νκΈ°</a></li>
<li><a href="#63-ct">6.3 μΈμ¦μ„ ν¬λ…μ„±(CT)</a></li>
</ul>
</li>
<li><a href="#7-lets-encrypt-acme">7. Let's Encryptμ™€ ACME</a><ul>
<li><a href="#71-acme">7.1 ACME ν”„λ΅ν† μ½ κ°μ”</a></li>
<li><a href="#72-certbot">7.2 Certbot λ…λ Ήμ–΄</a></li>
<li><a href="#73">7.3 μΈμ¦μ„ νμΌ</a></li>
</ul>
</li>
<li><a href="#8">8. μΈμ¦μ„ ν”Όλ‹</a><ul>
<li><a href="#81-python">8.1 Pythonμ—μ„ μΈμ¦μ„ ν”Όλ‹</a></li>
</ul>
</li>
<li><a href="#9-tlsmtls">9. μƒνΈ TLS(mTLS)</a><ul>
<li><a href="#91-mtls">9.1 mTLS κµ¬ν„</a></li>
</ul>
</li>
<li><a href="#10-python-tls">10. Python TLS ν”„λ΅κ·Έλλ°</a><ul>
<li><a href="#101-https">10.1 μ•μ „ν• HTTPS ν΄λΌμ΄μ–ΈνΈ</a></li>
<li><a href="#102-python-tls">10.2 Python TLS μ„λ²„</a></li>
</ul>
</li>
<li><a href="#11-openssl">11. OpenSSLλ΅ μΈμ¦μ„ μƒμ„±ν•κΈ°</a><ul>
<li><a href="#111">11.1 μμ²΄ μ„λ… μΈμ¦μ„ (κ°λ°μ©)</a></li>
<li><a href="#112-ca">11.2 CA + μ„λ²„ μΈμ¦μ„ (μ „μ²΄ ν”„λ΅μ„Έμ¤)</a></li>
<li><a href="#113-ecdsa">11.3 ECDSA μΈμ¦μ„ (λ” μ‘κ³ , λ” λΉ λ¦„)</a></li>
<li><a href="#114-mtls">11.4 mTLSμ© ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„</a></li>
</ul>
</li>
<li><a href="#12">12. μΌλ°μ μΈ μλ»λ κµ¬μ„±</a><ul>
<li><a href="#121">12.1 λ³΄μ• ν—¤λ” μ²΄ν¬λ¦¬μ¤νΈ</a></li>
</ul>
</li>
<li><a href="#13-tls_1">13. TLS κµ¬μ„± ν…μ¤νΈ</a><ul>
<li><a href="#131">13.1 λ…λ Ήμ¤„ λ„κµ¬</a></li>
<li><a href="#132-python-tls">13.2 Python TLS μ¤μΊλ„</a></li>
<li><a href="#133">13.3 μ§€μ†μ μΈ μΈμ¦μ„ λ¨λ‹ν„°λ§</a></li>
</ul>
</li>
<li><a href="#14">14. μ—°μµ λ¬Έμ </a><ul>
<li><a href="#1-tls_1">μ—°μµ λ¬Έμ  1: TLS ν•Έλ“μ…°μ΄ν¬ μ¶”μ  (μ΄κΈ‰)</a></li>
<li><a href="#2">μ—°μµ λ¬Έμ  2: μΈμ¦μ„ μƒμ„± μ‹¤μµ (μ¤‘κΈ‰)</a></li>
<li><a href="#3-mtls">μ—°μµ λ¬Έμ  3: mTLS μ„λΉ„μ¤ (μ¤‘κΈ‰)</a></li>
<li><a href="#4-tls">μ—°μµ λ¬Έμ  4: TLS κµ¬μ„± κ°μ‚¬κΈ° (κ³ κΈ‰)</a></li>
<li><a href="#5_1">μ—°μµ λ¬Έμ  5: μΈμ¦μ„ λ¨λ‹ν„°λ§ μ‹μ¤ν… (κ³ κΈ‰)</a></li>
<li><a href="#6-tls">μ—°μµ λ¬Έμ  6: λ‹¨μν™”λ TLS κµ¬ν„ (κµμ΅μ©)</a></li>
</ul>
</li>
<li><a href="#15">15. μ°Έκ³  μλ£</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="tlsssl">TLS/SSLκ³Ό κ³µκ° ν‚¤ μΈν”„λΌ<a class="header-link" href="#tlsssl" title="Permanent link">&para;</a></h1>
<p><strong>μ΄μ „</strong>: <a href="./03_Hashing_and_Integrity.md">03. ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</a> | <strong>λ‹¤μ</strong>: <a href="./05_Authentication.md">05. μΈμ¦ μ‹μ¤ν…</a></p>
<hr />
<p>μ „μ†΅ κ³„μΈµ λ³΄μ•(TLS)μ€ HTTPSλ¥Ό κ°€λ¥ν•κ² ν•λ” ν”„λ΅ν† μ½μ…λ‹λ‹¤. μ΄κ²ƒμ€ μ‚¬μ‹¤μƒ λ¨λ“  μ›Ή νΈλν”½, μ΄λ©”μΌ, λ©”μ‹μ§•, VPN, API ν†µμ‹ μ„ λ³΄νΈν•©λ‹λ‹¤. μ΄ λ μ¨μ€ TLS 1.3, μΈμ¦μ„ μ‹ λΆ° λ¨λΈ(PKI), μ‹¤μ©μ μΈ OpenSSL λ° Python μ‚¬μ©, μƒνΈ TLS, λ³΄μ•μ„ μ•½ν™”μ‹ν‚¤λ” μΌλ°μ μΈ μλ»λ κµ¬μ„±μ— λ€ν• κΉμ΄ μλ” κΈ°μ μ  μ•λ‚΄λ¥Ό μ κ³µν•©λ‹λ‹¤.</p>
<p><strong>λ‚μ΄λ„</strong>: β­β­β­β­</p>
<p><strong>ν•™μµ λ©ν‘</strong>:
- TLS 1.3 ν•Έλ“μ…°μ΄ν¬λ¥Ό λ‹¨κ³„λ³„λ΅ μ™„μ „ν μ΄ν•΄ν•κΈ°
- μΈμ¦μ„ μ²΄μΈκ³Ό μ‹ λΆ° μ›Ή μ„¤λ…ν•κΈ°
- OpenSSLκ³Ό Pythonμ„ μ‚¬μ©ν•μ—¬ X.509 μΈμ¦μ„ μ‘μ—…ν•κΈ°
- μΈμ¦ κΈ°κ΄€κ³Ό μΈμ¦μ„ λ°κΈ‰ μ΄ν•΄ν•κΈ°
- ACME ν”„λ΅ν† μ½λ΅ Let's Encrypt κµ¬μ„±ν•κΈ°
- μΈμ¦μ„ ν”Όλ‹κ³Ό μƒνΈ TLS(mTLS) κµ¬ν„ν•κΈ°
- κ°λ°μ© μμ²΄ μ„λ… μΈμ¦μ„ μƒμ„±ν•κΈ°
- μΌλ°μ μΈ TLS μλ»λ κµ¬μ„± μ‹λ³„ λ° μμ •ν•κΈ°
- ν‘μ¤€ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ TLS κµ¬μ„± ν…μ¤νΈν•κΈ°</p>
<hr />
<h2 id="_1">λ©μ°¨<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-tls-κ°μ”μ™€-μ—­μ‚¬">TLS κ°μ”μ™€ μ—­μ‚¬</a></li>
<li><a href="#2-tls-13-ν•Έλ“μ…°μ΄ν¬-μƒμ„Έ">TLS 1.3 ν•Έλ“μ…°μ΄ν¬ μƒμ„Έ</a></li>
<li><a href="#3-μ•”νΈν™”-μ¤μ„νΈ">μ•”νΈν™” μ¤μ„νΈ</a></li>
<li><a href="#4-x509-μΈμ¦μ„">X.509 μΈμ¦μ„</a></li>
<li><a href="#5-μΈμ¦μ„-μ²΄μΈκ³Ό-μ‹ λΆ°">μΈμ¦μ„ μ²΄μΈκ³Ό μ‹ λΆ°</a></li>
<li><a href="#6-μΈμ¦-κΈ°κ΄€ca">μΈμ¦ κΈ°κ΄€(CA)</a></li>
<li><a href="#7-lets-encryptμ™€-acme">Let's Encryptμ™€ ACME</a></li>
<li><a href="#8-μΈμ¦μ„-ν”Όλ‹">μΈμ¦μ„ ν”Όλ‹</a></li>
<li><a href="#9-μƒνΈ-tlsmtls">μƒνΈ TLS(mTLS)</a></li>
<li><a href="#10-python-tls-ν”„λ΅κ·Έλλ°">Python TLS ν”„λ΅κ·Έλλ°</a></li>
<li><a href="#11-opensslλ΅-μΈμ¦μ„-μƒμ„±ν•κΈ°">OpenSSLλ΅ μΈμ¦μ„ μƒμ„±ν•κΈ°</a></li>
<li><a href="#12-μΌλ°μ μΈ-μλ»λ-κµ¬μ„±">μΌλ°μ μΈ μλ»λ κµ¬μ„±</a></li>
<li><a href="#13-tls-κµ¬μ„±-ν…μ¤νΈ">TLS κµ¬μ„± ν…μ¤νΈ</a></li>
<li><a href="#14-μ—°μµ-λ¬Έμ ">μ—°μµ λ¬Έμ </a></li>
<li><a href="#15-μ°Έκ³ -μλ£">μ°Έκ³  μλ£</a></li>
</ol>
<hr />
<h2 id="1-tls">1. TLS κ°μ”μ™€ μ—­μ‚¬<a class="header-link" href="#1-tls" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ν”„λ΅ν† μ½ μ§„ν™”<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                  TLS/SSL λ²„μ „ μ—­μ‚¬                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν”„λ΅ν† μ½  β”‚ μ—°λ„ β”‚ μƒνƒ      β”‚ μ°Έκ³ μ‚¬ν•­                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ SSL 1.0  β”‚ 1994 β”‚ λ―Έμ¶μ‹    β”‚ μ¶μ‹λμ§€ μ•μ (μ‹¬κ°ν• κ²°ν•¨)            β”‚
β”‚ SSL 2.0  β”‚ 1995 β”‚ νκΈ°λ¨    β”‚ μ™„μ „ν μ†μƒλ¨, λ¨λ“  κ³³μ—μ„ λΉ„ν™μ„±ν™”   β”‚
β”‚ SSL 3.0  β”‚ 1996 β”‚ νκΈ°λ¨    β”‚ POODLE κ³µκ²© (2014), μ†μƒλ¨             β”‚
β”‚ TLS 1.0  β”‚ 1999 β”‚ νκΈ°λ¨    β”‚ BEAST κ³µκ²© (2011), 2020λ…„ μλ… μΆ…λ£   β”‚
β”‚ TLS 1.1  β”‚ 2006 β”‚ νκΈ°λ¨    β”‚ μ•λ ¤μ§„ κ³µκ²© μ—†μ, ν•μ§€λ§ μ•½ν• μ•”νΈν™”  β”‚
β”‚ TLS 1.2  β”‚ 2008 β”‚ μ§€μ›λ¨    β”‚ μ—¬μ „ν λ„λ¦¬ μ‚¬μ©λ¨, μ¬λ°”λ¥΄κ² κµ¬μ„±    β”‚
β”‚          β”‚      β”‚           β”‚ μ‹ μ•μ „ν•¨                              β”‚
β”‚ TLS 1.3  β”‚ 2018 β”‚ κ¶μ¥λ¨    β”‚ μ£Όμ” μ¬μ„¤κ³„: λ” λΉ λ¥΄κ³ , λ” μ•μ „ν•¨    β”‚
β”‚          β”‚      β”‚           β”‚ λ¨λ“  μ•½ν• μ•κ³ λ¦¬μ¦ μ κ±°               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚ ν„μ¬ κ¶μ¥ μ‚¬ν•­ (2025+):                                             β”‚
β”‚ β€Ά TLS 1.3 ν™μ„±ν™” (κ¶μ¥) λ° TLS 1.2 (λ€μ²΄)                          β”‚
β”‚ β€Ά TLS 1.2 λ―Έλ§μ λ¨λ“  λ²„μ „ λΉ„ν™μ„±ν™”                                β”‚
β”‚ β€Ά κ°•λ ¥ν• μ•”νΈν™” μ¤μ„νΈλ§ μ‚¬μ©                                      β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="12-tls">1.2 μ¤νƒμ—μ„ TLSμ μ„μΉ<a class="header-link" href="#12-tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    TLSλ¥Ό ν¬ν•¨ν• ν”„λ΅ν† μ½ μ¤νƒ                         β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚  β”‚  μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ                                           β”‚    β”‚
β”‚  β”‚  HTTP, SMTP, IMAP, FTP, MQTT, gRPC, WebSocket              β”‚    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                               β”‚                                     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚  β”‚  TLS (μ „μ†΅ κ³„μΈµ λ³΄μ•)                                        β”‚    β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚    β”‚
β”‚  β”‚  β”‚  ν•Έλ“μ…°μ΄ν¬  β”‚  β”‚ λ μ½”λ“        β”‚  β”‚  μ•λ¦Ό           β”‚   β”‚    β”‚
β”‚  β”‚  β”‚  ν”„λ΅ν† μ½    β”‚  β”‚ ν”„λ΅ν† μ½      β”‚  β”‚  ν”„λ΅ν† μ½       β”‚   β”‚    β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                               β”‚                                     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚  β”‚  μ „μ†΅ κ³„μΈµ (TCP)                                             β”‚    β”‚
β”‚  β”‚  ν¬νΈ 443 (HTTPS), 465 (SMTPS), 993 (IMAPS), λ“±            β”‚    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                               β”‚                                     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚  β”‚  μΈν„°λ„· κ³„μΈµ (IP)                                            β”‚    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="13-tls">1.3 TLSκ°€ μ κ³µν•λ” κ²ƒ<a class="header-link" href="#13-tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    TLS λ³΄μ• μ†μ„±                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  1. κΈ°λ°€μ„±                                                          β”‚
β”‚     β”β”€β”€ μ „μ†΅ μ¤‘ λ°μ΄ν„° μ•”νΈν™” (AES-GCM, ChaCha20-Poly1305)         β”‚
β”‚     β””β”€β”€ λ„μ²­μλ” μ•”νΈν™”λ λ°μ΄ν„°λ§ λ³Ό μ μμ                       β”‚
β”‚                                                                      β”‚
β”‚  2. λ¬΄κ²°μ„±                                                          β”‚
β”‚     β”β”€β”€ AEAD μ•”νΈν™”λ” λ¨λ“  λ μ½”λ“λ¥Ό μΈμ¦ν•¨                         β”‚
β”‚     β””β”€β”€ λ¨λ“  λ³€μ΅°κ°€ μ¦‰μ‹ κ°μ§€λ¨                                    β”‚
β”‚                                                                      β”‚
β”‚  3. μΈμ¦                                                            β”‚
β”‚     β”β”€β”€ μ„λ²„λ” X.509 μΈμ¦μ„λ¥Ό ν†µν•΄ μ‹ μ›μ„ μ¦λ…ν•¨                   β”‚
β”‚     β”β”€β”€ μ„ νƒμ‚¬ν•­: ν΄λΌμ΄μ–ΈνΈ μΈμ¦ (mTLS)                           β”‚
β”‚     β””β”€β”€ μ¤‘κ°„μ κ³µκ²© λ°©μ§€                                           β”‚
β”‚                                                                      β”‚
β”‚  4. μ „λ°©ν–¥ μ•μ „μ„± (TLS 1.3μ—μ„ ν•„μ)                               β”‚
β”‚     β”β”€β”€ μ„μ‹ ν‚¤ κµν™ (ECDHE)                                       β”‚
β”‚     β””β”€β”€ μ¥κΈ° κ°μΈ ν‚¤κ°€ λ‚μ¤‘μ— μ†μƒλλ”λΌλ„ κ³Όκ±° μ„Έμ…μ€             β”‚
β”‚         λ³µνΈν™”ν•  μ μ—†μ                                           β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="2-tls-13">2. TLS 1.3 ν•Έλ“μ…°μ΄ν¬ μƒμ„Έ<a class="header-link" href="#2-tls-13" title="Permanent link">&para;</a></h2>
<p>TLS 1.3λ” TLS 1.2μ— λΉ„ν•΄ ν•Έλ“μ…°μ΄ν¬λ¥Ό ν¬κ² λ‹¨μν™”ν•μ—¬ 2λ²μ μ™•λ³µμ—μ„ 1λ²(λλ” 0-RTTλ΅ 0λ²)μΌλ΅ μ¤„μ€μµλ‹λ‹¤.</p>
<h3 id="21-1-rtt">2.1 μ „μ²΄ ν•Έλ“μ…°μ΄ν¬ (1-RTT)<a class="header-link" href="#21-1-rtt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    TLS 1.3 μ „μ²΄ ν•Έλ“μ…°μ΄ν¬ (1-RTT)                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚   ν΄λΌμ΄μ–ΈνΈ                                      μ„λ²„               β”‚
β”‚   β”€β”€β”€β”€β”€β”€β”€β”€                                        β”€β”€β”€β”€               β”‚
β”‚                                                                      β”‚
β”‚   β”β”€ ClientHello β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                   β”‚
β”‚   β”‚  β€Ά μ§€μ›λλ” TLS λ²„μ „ (1.3)                                      β”‚
β”‚   β”‚  β€Ά μ•”νΈν™” μ¤μ„νΈ (μ: TLS_AES_256_GCM_SHA384)                  β”‚
β”‚   β”‚  β€Ά ν‚¤ κ³µμ  (X25519 κ³µκ° ν‚¤)  β†β”€β”€ 1.3μ μƒλ΅μ΄ κΈ°λ¥             β”‚
β”‚   β”‚  β€Ά μ§€μ›λλ” κ·Έλ£Ή (X25519, P-256)                               β”‚
β”‚   β”‚  β€Ά μ„λ… μ•κ³ λ¦¬μ¦ (Ed25519, ECDSA-P256-SHA256)                  β”‚
β”‚   β”‚  β€Ά λ‚μ (32 λ°”μ΄νΈ)                                            β”‚
β”‚   β”‚  β€Ά SNI (μ„λ²„ μ΄λ¦„ ν‘μ‹)                                        β”‚
β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚           β”β”€ ServerHello β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                β”‚
β”‚           β”‚  β€Ά μ„ νƒλ TLS λ²„μ „ (1.3)                                β”‚
β”‚           β”‚  β€Ά μ„ νƒλ μ•”νΈν™” μ¤μ„νΈ                                 β”‚
β”‚           β”‚  β€Ά μ„λ²„ ν‚¤ κ³µμ  (X25519 κ³µκ° ν‚¤)                        β”‚
β”‚           β”‚  β€Ά λ‚μ (32 λ°”μ΄νΈ)                                     β”‚
β”‚           β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚           β”β”€ {EncryptedExtensions} β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ (μ•”νΈν™”λ¨)    β”‚
β”‚           β”‚  β€Ά μ„λ²„ ν™•μ¥                                            β”‚
β”‚           β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚           β”β”€ {Certificate} β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ (μ•”νΈν™”λ¨)    β”‚
β”‚           β”‚  β€Ά μ„λ²„μ X.509 μΈμ¦μ„ μ²΄μΈ                            β”‚
β”‚           β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚           β”β”€ {CertificateVerify} β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ (μ•”νΈν™”λ¨)    β”‚
β”‚           β”‚  β€Ά ν•Έλ“μ…°μ΄ν¬ μ „μ‚¬λ³Έμ— λ€ν• λ””μ§€ν„Έ μ„λ…                β”‚
β”‚           β”‚  β€Ά μ„λ²„κ°€ κ°μΈ ν‚¤λ¥Ό μ†μ ν•κ³  μμμ„ μ¦λ…               β”‚
β”‚           β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚           β”β”€ {Finished} β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ (μ•”νΈν™”λ¨)   β”‚
β”‚           β”‚  β€Ά μ „μ²΄ ν•Έλ“μ…°μ΄ν¬ μ „μ‚¬λ³Έμ— λ€ν• MAC                   β”‚
β”‚           β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚   β”β”€ {Finished} β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶ (μ•”νΈν™”λ¨)     β”‚
β”‚   β”‚  β€Ά ν΄λΌμ΄μ–ΈνΈμ ν•Έλ“μ…°μ΄ν¬ μ „μ‚¬λ³Έμ— λ€ν• MAC                   β”‚
β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚   β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•                β”‚
β”‚   μ• ν”λ¦¬μΌ€μ΄μ… λ°μ΄ν„°κ°€ μ–‘λ°©ν–¥μΌλ΅ νλ¦„ (μ•”νΈν™”λ¨)                  β”‚
β”‚   β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•                β”‚
β”‚                                                                      β”‚
β”‚   ν•µμ‹¬ μΈμ‚¬μ΄νΈ: TLS 1.3μ—μ„ ν‚¤ κµν™μ€ μ²« λ²μ§Έ λ©”μ‹μ§€                β”‚
β”‚   (ClientHelloκ°€ ν‚¤ κ³µμ  ν¬ν•¨)μ—μ„ λ°μƒν•λ―€λ΅, ServerHello μ΄ν›„μ    β”‚
β”‚   λ¨λ“  ν›„μ† λ©”μ‹μ§€κ°€ μ•”νΈν™”λ©λ‹λ‹¤.                                   β”‚
β”‚                                                                      β”‚
β”‚   TLS 1.2μ™€ λΉ„κµ: 2-RTT ν•Έλ“μ…°μ΄ν¬, μΈμ¦μ„κ°€ ν‰λ¬ΈμΌλ΅ μ „μ†΅λ¨,       β”‚
β”‚   ν•„μ μ „λ°©ν–¥ μ•μ „μ„± μ—†μ.                                           β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="22-tls-13">2.2 TLS 1.3μ ν‚¤ νμƒ<a class="header-link" href="#22-tls-13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              TLS 1.3 ν‚¤ μ¤μΌ€μ¤„ (λ‹¨μν™”)                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  ECDHE κ³µμ  λΉ„λ°€ (X25519 ν‚¤ κµν™μ—μ„)                               β”‚
β”‚            β”‚                                                        β”‚
β”‚            β–Ό                                                        β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚  β”‚  HKDF-Extract   β”‚ β† IKM = ECDHE κ³µμ  λΉ„λ°€                       β”‚
β”‚  β”‚  (Early Secret) β”‚    Salt = 0                                    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚           β”‚                                                         β”‚
β”‚           β–Ό                                                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚  β”‚  HKDF-Extract   β”‚ β† IKM = ECDHE κ³µμ  λΉ„λ°€                       β”‚
β”‚  β”‚(Handshake Secret)β”‚   Salt = early secretμ—μ„ νμƒ                β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚           β”‚                                                         β”‚
β”‚      β”β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”                                                    β”‚
β”‚      β”‚         β”‚                                                    β”‚
β”‚      β–Ό         β–Ό                                                    β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β” β”β”€β”€β”€β”€β”€β”€β”€β”€β”                                              β”‚
β”‚  β”‚Client  β”‚ β”‚Server  β”‚ β† HKDF-Expand-Label                         β”‚
β”‚  β”‚Handshk β”‚ β”‚Handshk β”‚   (handshake secret + μ „μ‚¬λ³Έ ν•΄μ‹μ—μ„        β”‚
β”‚  β”‚Traffic β”‚ β”‚Traffic β”‚    νΈλν”½ ν‚¤ νμƒ)                           β”‚
β”‚  β”‚Key/IV  β”‚ β”‚Key/IV  β”‚                                              β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β” β””β”€β”€β”€β”€β”€β”€β”€β”€β”                                              β”‚
β”‚           β”‚                                                         β”‚
β”‚           β–Ό                                                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚  β”‚  HKDF-Extract   β”‚ β† IKM = 0                                     β”‚
β”‚  β”‚ (Master Secret) β”‚    Salt = handshake secretμ—μ„ νμƒ            β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”                                                β”‚
β”‚           β”‚                                                         β”‚
β”‚      β”β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”                                                    β”‚
β”‚      β”‚         β”‚                                                    β”‚
β”‚      β–Ό         β–Ό                                                    β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β” β”β”€β”€β”€β”€β”€β”€β”€β”€β”                                              β”‚
β”‚  β”‚Client  β”‚ β”‚Server  β”‚ β† HKDF-Expand-Label                         β”‚
β”‚  β”‚App     β”‚ β”‚App     β”‚   (μ• ν”λ¦¬μΌ€μ΄μ… νΈλν”½ ν‚¤ νμƒ)              β”‚
β”‚  β”‚Traffic β”‚ β”‚Traffic β”‚                                              β”‚
β”‚  β”‚Key/IV  β”‚ β”‚Key/IV  β”‚                                              β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β” β””β”€β”€β”€β”€β”€β”€β”€β”€β”                                              β”‚
β”‚                                                                      β”‚
β”‚  κ° λ°©ν–¥μ€ μμ²΄ ν‚¤μ™€ IVλ¥Ό κ°€μ§.                                     β”‚
β”‚  ν‚¤λ” κ³µμ  λΉ„λ°€κ³Ό ν•Έλ“μ…°μ΄ν¬ μ „μ‚¬λ³Έμ—μ„ νμƒλμ–΄,                   β”‚
β”‚  μ΄ νΉμ • μ„Έμ…μ— λ°”μΈλ”©λ¨.                                           β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="23-tls-13-vs-tls-12">2.3 TLS 1.3 vs TLS 1.2<a class="header-link" href="#23-tls-13-vs-tls-12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              TLS 1.3 vs TLS 1.2 κ°μ„  μ‚¬ν•­                           β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ κΈ°λ¥                β”‚ TLS 1.2             β”‚ TLS 1.3                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ ν•Έλ“μ…°μ΄ν¬ RTT      β”‚ 2 μ™•λ³µ              β”‚ 1 μ™•λ³µ                  β”‚
β”‚ 0-RTT μ¬κ°          β”‚ μ—†μ                β”‚ μμ (μ„ νƒμ‚¬ν•­)         β”‚
β”‚ μ „λ°©ν–¥ μ•μ „μ„±       β”‚ μ„ νƒμ‚¬ν•­ (ECDHE)    β”‚ ν•„μ (ν•­μƒ)             β”‚
β”‚ RSA ν‚¤ κµν™         β”‚ μ§€μ›λ¨              β”‚ μ κ±°λ¨ (FS μ—†μ)        β”‚
β”‚ μ •μ  DH             β”‚ μ§€μ›λ¨              β”‚ μ κ±°λ¨ (FS μ—†μ)        β”‚
β”‚ CBC λ¨λ“ μ•”νΈν™”     β”‚ μ§€μ›λ¨              β”‚ μ κ±°λ¨ (ν¨λ”© μ¤λΌν΄)    β”‚
β”‚ RC4                 β”‚ μ§€μ›λ¨ (μ•½ν•¨)       β”‚ μ κ±°λ¨ (μ†μƒλ¨)         β”‚
β”‚ μ••μ¶•                β”‚ μ§€μ›λ¨              β”‚ μ κ±°λ¨ (CRIME κ³µκ²©)     β”‚
β”‚ μ¬ν‘μƒ              β”‚ μ§€μ›λ¨              β”‚ μ κ±°λ¨ (λ³µμ΅μ„±)         β”‚
β”‚ μΈμ¦μ„ μ•”νΈν™”?      β”‚ μ•„λ‹μ¤ (ν‰λ¬Έ)       β”‚ μ (μ•”νΈν™”λ¨)           β”‚
β”‚ μ•”νΈν™” μ¤μ„νΈ       β”‚ 300+ (λ§μ€ μ•½ν• κ²ƒ) β”‚ 5 (λ¨λ‘ κ°•ν•¨)           β”‚
β”‚ Change Cipher Spec  β”‚ λ³„λ„ λ©”μ‹μ§€         β”‚ μ κ±°λ¨                  β”‚
β”‚ ν‚¤ νμƒ             β”‚ PRF (TLS 1.2 PRF)   β”‚ HKDF (λ” κ°•ν•¨)          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ TLS 1.3λ” λ” κ°„λ‹¨ν•κ³ , λ” λΉ λ¥΄λ©°, μ•λ ¤μ§„ μ•½ν• κµ¬μ„±μ΄ μ—†μµλ‹λ‹¤.     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="24-0-rtt">2.4 0-RTT (μ λ΅ λΌμ΄λ“ νΈλ¦½ νƒ€μ„) μ¬κ°<a class="header-link" href="#24-0-rtt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                 TLS 1.3 0-RTT μ¬κ°                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  μ „μ²΄ ν•Έλ“μ…°μ΄ν¬ ν›„ μ„λ²„λ” μ„Έμ… ν‹°μΌ“μ„ λ³΄λƒ…λ‹λ‹¤.                    β”‚
β”‚  μ¬μ—°κ²° μ‹ ν΄λΌμ΄μ–ΈνΈλ” μ¦‰μ‹ λ°μ΄ν„°λ¥Ό λ³΄λ‚Ό μ μμµλ‹λ‹¤:              β”‚
β”‚                                                                      β”‚
β”‚   ν΄λΌμ΄μ–ΈνΈ                                      μ„λ²„               β”‚
β”‚   β”€β”€β”€β”€β”€β”€β”€β”€                                        β”€β”€β”€β”€               β”‚
β”‚                                                                      β”‚
β”‚   β”β”€ ClientHello + EarlyData β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                  β”‚
β”‚   β”‚  β€Ά μ„Έμ… ν‹°μΌ“ (μ΄μ „ μ—°κ²°μ—μ„)                                    β”‚
β”‚   β”‚  β€Ά 0-RTT μ• ν”λ¦¬μΌ€μ΄μ… λ°μ΄ν„° (PSKλ΅ μ•”νΈν™”λ¨)                  β”‚
β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                   β”‚
β”‚                                                                      β”‚
β”‚   β  κ²½κ³ : 0-RTT λ°μ΄ν„°λ” μ¬μƒ μ•μ „ν•μ§€ μ•μµλ‹λ‹¤!                   β”‚
β”‚   κ³µκ²©μλ” ClientHello + EarlyDataλ¥Ό μ¬μƒν•  μ μμµλ‹λ‹¤.            β”‚
β”‚                                                                      β”‚
β”‚   0-RTT κ·μΉ™:                                                       β”‚
β”‚   β€Ά λ©±λ“±μ„± μ”μ²­μ—λ§ μ‚¬μ© (GET, POST μ•„λ‹)                          β”‚
β”‚   β€Ά μ„λ²„λ” μ¬μƒ λ³΄νΈλ¥Ό κµ¬ν„ν•΄μ•Ό ν•¨                                 β”‚
β”‚   β€Ά 0-RTT λ°μ΄ν„° ν¬κΈ° μ ν•                                         β”‚
β”‚   β€Ά λ§μ€ λ°°ν¬κ°€ 0-RTTλ¥Ό μ™„μ „ν λΉ„ν™μ„±ν™”ν•¨                          β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="3">3. μ•”νΈν™” μ¤μ„νΈ<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-tls-13">3.1 TLS 1.3 μ•”νΈν™” μ¤μ„νΈ<a class="header-link" href="#31-tls-13" title="Permanent link">&para;</a></h3>
<p>TLS 1.3μ—λ” 5κ°μ μ•”νΈν™” μ¤μ„νΈλ§ μμΌλ©°, λ¨λ‘ AEADμ…λ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                  TLS 1.3 μ•”νΈν™” μ¤μ„νΈ                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ μ•”νΈν™” μ¤μ„νΈ                           β”‚ μ°Έκ³ μ‚¬ν•­                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ TLS_AES_256_GCM_SHA384                  β”‚ κ°•λ ¥ν•¨, λ„λ¦¬ μ§€μ›λ¨       β”‚
β”‚ TLS_AES_128_GCM_SHA256                  β”‚ κΈ°λ³Έκ°’, HWλ΅ λ§¤μ° λΉ λ¦„   β”‚
β”‚ TLS_CHACHA20_POLY1305_SHA256            β”‚ λ¨λ°”μΌ/AES-NI μ—†μ„ λ• μµμ β”‚
β”‚ TLS_AES_128_CCM_SHA256                  β”‚ μ μ•½λ μ¥μΉμ©             β”‚
β”‚ TLS_AES_128_CCM_8_SHA256                β”‚ μ§§μ€ νƒκ·Έ, IoT μ „μ©       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚ TLS 1.3μ—μ„ μ•”νΈν™” μ¤μ„νΈλ” λ‹¤μλ§ μ§€μ •ν•©λ‹λ‹¤:                     β”‚
β”‚  β€Ά AEAD μ•κ³ λ¦¬μ¦ (AES-GCM, ChaCha20-Poly1305, AES-CCM)            β”‚
β”‚  β€Ά HKDFμ© ν•΄μ‹ (SHA-256, SHA-384)                                  β”‚
β”‚                                                                      β”‚
β”‚ ν‚¤ κµν™ λ° μ„λ… μ•κ³ λ¦¬μ¦μ€ ν™•μ¥μ„ ν†µν•΄ λ³„λ„λ΅ ν‘μƒλ©λ‹λ‹¤            β”‚
β”‚ (supported_groups, signature_algorithms).                           β”‚
β”‚                                                                      β”‚
β”‚ κ¶μ¥ μ°μ„ μμ„:                                                      β”‚
β”‚  1. TLS_AES_256_GCM_SHA384                                         β”‚
β”‚  2. TLS_CHACHA20_POLY1305_SHA256                                   β”‚
β”‚  3. TLS_AES_128_GCM_SHA256                                         β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="32-tls-12">3.2 TLS 1.2 μ•”νΈν™” μ¤μ„νΈ μ΄λ¦„ μ΄ν•΄ν•κΈ°<a class="header-link" href="#32-tls-12" title="Permanent link">&para;</a></h3>
<p>λ κ±°μ‹ νΈν™μ„±μ„ μ„ν•΄ TLS 1.2 μ•”νΈν™” μ¤μ„νΈ λ…λ… μ΄ν•΄κ°€ μ¤‘μ”ν•©λ‹λ‹¤:</p>
<div class="highlight"><pre><span></span><code>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
β”‚    β”‚      β”‚        β”‚   β”‚    β”‚    β”‚
β”‚    β”‚      β”‚        β”‚   β”‚    β”‚    β””β”€β”€ PRF ν•΄μ‹ (SHA-384)
β”‚    β”‚      β”‚        β”‚   β”‚    β””β”€β”€β”€β”€β”€β”€β”€ AEAD λ¨λ“ (GCM)
β”‚    β”‚      β”‚        β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν‚¤ ν¬κΈ° (256λΉ„νΈ)
β”‚    β”‚      β”‚        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ μ•”νΈν™” (AES)
β”‚    β”‚      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ μΈμ¦ (RSA μΈμ¦μ„)
β”‚    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν‚¤ κµν™ (ECDHE = μ „λ°©ν–¥ μ•μ „μ„±)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν”„λ΅ν† μ½ (TLS)

μΆ‹μ€ TLS 1.2 μ•”νΈν™” μ¤μ„νΈ (λ¨λ‘ μ „λ°©ν–¥ μ•μ „μ„±μ„ μ„ν• ECDHE ν¬ν•¨):
  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
  TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256

λ‚μ TLS 1.2 μ•”νΈν™” μ¤μ„νΈ (μ΄κ²ƒλ“¤μ„ λΉ„ν™μ„±ν™”ν•μ„Έμ”):
  TLS_RSA_WITH_AES_256_CBC_SHA256        (μ „λ°©ν–¥ μ•μ „μ„± μ—†μ, CBC)
  TLS_RSA_WITH_3DES_EDE_CBC_SHA          (FS μ—†μ, 3DES, CBC)
  TLS_RSA_WITH_RC4_128_SHA               (FS μ—†μ, RC4 μ†μƒλ¨)
  TLS_DHE_RSA_WITH_AES_256_CBC_SHA       (CBC, μ•½ν• DH κ°€λ¥)
</code></pre></div>

<hr />
<h2 id="4-x509">4. X.509 μΈμ¦μ„<a class="header-link" href="#4-x509" title="Permanent link">&para;</a></h2>
<p>X.509 μΈμ¦μ„λ” κ³µκ° ν‚¤λ¥Ό μ‹ μ›(λ„λ©”μΈ μ΄λ¦„, μ΅°μ§)μ— λ°”μΈλ”©ν•©λ‹λ‹¤. μ΄κ²ƒμ€ TLS μΈμ¦μ κΈ°μ΄μ…λ‹λ‹¤.</p>
<h3 id="41">4.1 μΈμ¦μ„ κµ¬μ΅°<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    X.509 v3 μΈμ¦μ„ κµ¬μ΅°                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  tbsCertificate (μ„λ… λ€μƒ):                                        β”‚
β”‚  β”β”€β”€ Version: v3 (κ°€μ¥ μΌλ°μ )                                      β”‚
β”‚  β”β”€β”€ Serial Number: CAμ κ³ μ  μ‹λ³„μ                                β”‚
β”‚  β”β”€β”€ Signature Algorithm: μ: SHA256withRSA, Ed25519               β”‚
β”‚  β”β”€β”€ Issuer: μ΄ μΈμ¦μ„μ— μ„λ…ν• CAμ DN                             β”‚
β”‚  β”‚   β””β”€β”€ CN=Let&#39;s Encrypt Authority X3, O=Let&#39;s Encrypt, C=US     β”‚
β”‚  β”β”€β”€ Validity:                                                      β”‚
β”‚  β”‚   β”β”€β”€ Not Before: 2026-01-01 00:00:00 UTC                      β”‚
β”‚  β”‚   β””β”€β”€ Not After:  2026-03-31 23:59:59 UTC                      β”‚
β”‚  β”β”€β”€ Subject: μΈμ¦μ„ μ†μ μμ DN                                    β”‚
β”‚  β”‚   β””β”€β”€ CN=www.example.com                                        β”‚
β”‚  β”β”€β”€ Subject Public Key Info:                                       β”‚
β”‚  β”‚   β”β”€β”€ Algorithm: RSA (2048λΉ„νΈ) λλ” ECDSA (P-256)             β”‚
β”‚  β”‚   β””β”€β”€ Public Key: [μ‹¤μ  κ³µκ° ν‚¤ λ°”μ΄νΈ]                        β”‚
β”‚  β””β”€β”€ Extensions (v3):                                               β”‚
β”‚      β”β”€β”€ Subject Alternative Names (SAN):                           β”‚
β”‚      β”‚   β”β”€β”€ DNS: example.com                                      β”‚
β”‚      β”‚   β”β”€β”€ DNS: www.example.com                                  β”‚
β”‚      β”‚   β””β”€β”€ DNS: api.example.com                                  β”‚
β”‚      β”β”€β”€ Key Usage:                                                 β”‚
β”‚      β”‚   β”β”€β”€ Digital Signature                                     β”‚
β”‚      β”‚   β””β”€β”€ Key Encipherment                                      β”‚
β”‚      β”β”€β”€ Extended Key Usage:                                        β”‚
β”‚      β”‚   β””β”€β”€ TLS Web Server Authentication                         β”‚
β”‚      β”β”€β”€ Basic Constraints:                                         β”‚
β”‚      β”‚   β””β”€β”€ CA: FALSE (μ΄κ²ƒμ€ λ¦¬ν”„/μµμΆ… μ—”ν‹°ν‹° μΈμ¦μ„)            β”‚
β”‚      β”β”€β”€ Authority Key Identifier: [CAμ ν‚¤ ID]                    β”‚
β”‚      β”β”€β”€ CRL Distribution Points: http://crl.example.com/ca.crl   β”‚
β”‚      β””β”€β”€ Authority Information Access:                              β”‚
β”‚          β”β”€β”€ OCSP: http://ocsp.example.com                         β”‚
β”‚          β””β”€β”€ CA Issuers: http://crt.example.com/ca.crt             β”‚
β”‚                                                                      β”‚
β”‚  Signature Algorithm: SHA256withRSA                                  β”‚
β”‚  Signature Value: [tbsCertificateμ— λ€ν• CAμ λ””μ§€ν„Έ μ„λ…]          β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="42-python">4.2 Pythonμ—μ„ μΈμ¦μ„ μ½κΈ°<a class="header-link" href="#42-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.x509.oid</span><span class="w"> </span><span class="kn">import</span> <span class="n">NameOID</span><span class="p">,</span> <span class="n">ExtensionOID</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_server_certificate</span><span class="p">(</span><span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">443</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μ„λ²„μ TLS μΈμ¦μ„λ¥Ό κ²€μƒ‰ν•κ³  νμ‹±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="c1"># μ—°κ²°ν•κ³  DER ν•μ‹μΌλ΅ μΈμ¦μ„ κ°€μ Έμ¤κΈ°</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
            <span class="n">der_cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x509</span><span class="o">.</span><span class="n">load_der_x509_certificate</span><span class="p">(</span><span class="n">der_cert</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_certificate_info</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μƒμ„Έν• μΈμ¦μ„ μ •λ³΄λ¥Ό ν‘μ‹ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X.509 μΈμ¦μ„ μƒμ„Έ μ •λ³΄&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="c1"># Subject</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Subject:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">attr</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">attr</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Issuer</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Issuer:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">attr</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">attr</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Validity</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validity:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Not Before: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_before_utc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Not After:  </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">days_remaining</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span> <span class="o">-</span> <span class="n">now</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;VALID&quot;</span> <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_before_utc</span> <span class="o">&lt;=</span> <span class="n">now</span> <span class="o">&lt;=</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span> <span class="k">else</span> <span class="s2">&quot;EXPIRED&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Status:     </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">days_remaining</span><span class="si">}</span><span class="s2">μΌ λ‚¨μ)&quot;</span><span class="p">)</span>

    <span class="c1"># Serial and Version</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Serial Number: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">serial_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Version:       v</span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Public Key</span>
    <span class="n">pub_key</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
    <span class="n">key_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">pub_key</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Public Key:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Algorithm: </span><span class="si">{</span><span class="n">key_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pub_key</span><span class="p">,</span> <span class="s1">&#39;key_size&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Key Size:  </span><span class="si">{</span><span class="n">pub_key</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>

    <span class="c1"># Signature</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Signature Algorithm: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm_oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Fingerprints</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fingerprints:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SHA-256: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SHA-1:   </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA1</span><span class="p">())</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extensions</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Extensions:&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">san</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">get_extension_for_oid</span><span class="p">(</span><span class="n">ExtensionOID</span><span class="o">.</span><span class="n">SUBJECT_ALTERNATIVE_NAME</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">get_attributes_for_oid</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">ExtensionOID</span><span class="o">.</span><span class="n">SUBJECT_ALTERNATIVE_NAME</span><span class="p">)</span>
        <span class="n">dns_names</span> <span class="o">=</span> <span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">get_attributes_for_oid</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;get_attributes_for_oid&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="c1"># SANμ λ€μ²΄ μ ‘κ·Ό λ°©μ‹</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SAN: </span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">x509</span><span class="o">.</span><span class="n">ExtensionNotFound</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  SAN ν™•μ¥ μ—†μ&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">basic</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">get_extension_for_oid</span><span class="p">(</span><span class="n">ExtensionOID</span><span class="o">.</span><span class="n">BASIC_CONSTRAINTS</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Basic Constraints: CA=</span><span class="si">{</span><span class="n">basic</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">ca</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">x509</span><span class="o">.</span><span class="n">ExtensionNotFound</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="c1"># μμ : μ‹¤μ  μΈμ¦μ„ κ²€μ‚¬</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cert</span> <span class="o">=</span> <span class="n">get_server_certificate</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
    <span class="n">print_certificate_info</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μΈμ¦μ„λ¥Ό κ°€μ Έμ¬ μ μ—†μµλ‹λ‹¤: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(λ„¤νΈμ›ν¬ μ ‘κ·Ό ν•„μ”)&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5">5. μΈμ¦μ„ μ²΄μΈκ³Ό μ‹ λΆ°<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 μ‹ λΆ° μ²΄μΈ<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    μΈμ¦μ„ μ‹ λΆ° μ²΄μΈ                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚  β”‚  ROOT CA μΈμ¦μ„ (μμ²΄ μ„λ…)                              β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Issuer: &quot;Root CA&quot;                                    β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Subject: &quot;Root CA&quot;  (Issuer == Subject β†’ μμ²΄ μ„λ…) β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Valid: 20-30λ…„                                       β”‚       β”‚
β”‚  β”‚  β”β”€β”€ OS/λΈλΌμ°μ € μ‹ λΆ° μ €μ¥μ†μ— μ €μ¥λ¨                     β”‚       β”‚
β”‚  β”‚  β””β”€β”€ μ„λ…: μ¤‘κ°„ CA μΈμ¦μ„                                 β”‚       β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚                           β”‚ μ„λ…                                    β”‚
β”‚                           β–Ό                                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚  β”‚  μ¤‘κ°„ CA μΈμ¦μ„                                           β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Issuer: &quot;Root CA&quot;                                    β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Subject: &quot;Intermediate CA&quot;                           β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Valid: 5-10λ…„                                        β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Basic Constraints: CA=TRUE                           β”‚       β”‚
β”‚  β”‚  β””β”€β”€ μ„λ…: μµμΆ… μ—”ν‹°ν‹°(λ¦¬ν”„) μΈμ¦μ„                       β”‚       β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚                           β”‚ μ„λ…                                    β”‚
β”‚                           β–Ό                                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚  β”‚  μµμΆ… μ—”ν‹°ν‹°(λ¦¬ν”„) μΈμ¦μ„                                 β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Issuer: &quot;Intermediate CA&quot;                            β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Subject: &quot;www.example.com&quot;                           β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Valid: 90μΌ (Let&#39;s Encrypt) ~ 1λ…„                    β”‚       β”‚
β”‚  β”‚  β”β”€β”€ Basic Constraints: CA=FALSE                          β”‚       β”‚
β”‚  β”‚  β””β”€β”€ μ΄κ²ƒμ΄ μ„λ²„μ μΈμ¦μ„μ…λ‹λ‹¤                           β”‚       β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”‚
β”‚                                                                      β”‚
β”‚  κ²€μ¦ ν”„λ΅μ„Έμ¤:                                                     β”‚
β”‚  1. μ„λ²„λ΅λ¶€ν„° λ¦¬ν”„ μΈμ¦μ„ + μ¤‘κ°„ μΈμ¦μ„ μμ‹                        β”‚
β”‚  2. μ¤‘κ°„ μΈμ¦μ„μ κ³µκ° ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ¦¬ν”„ μΈμ¦μ„ μ„λ… κ²€μ¦          β”‚
β”‚  3. λ£¨νΈμ κ³µκ° ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ¤‘κ°„ μΈμ¦μ„ μ„λ… κ²€μ¦                 β”‚
β”‚  4. λ£¨νΈ μΈμ¦μ„κ°€ λ΅μ»¬ μ‹ λΆ° μ €μ¥μ†μ— μλ”μ§€ ν™•μΈ                    β”‚
β”‚  5. λ¨λ“  μΈμ¦μ„κ°€ μ ν¨ κΈ°κ°„ λ‚΄μ— μλ”μ§€ ν™•μΈ                        β”‚
β”‚  6. νκΈ° μƒνƒ ν™•μΈ (CRL λλ” OCSP)                                 β”‚
β”‚  7. λ¦¬ν”„ μΈμ¦μ„μ SANμ΄ μ”μ²­λ νΈμ¤νΈλ…κ³Ό μΌμΉν•λ”μ§€ ν™•μΈ           β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="52-python">5.2 Pythonμ—μ„ μΈμ¦μ„ μ²΄μΈ κ²€μ¦<a class="header-link" href="#52-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">ec</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span><span class="p">,</span> <span class="n">serialization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.x509.oid</span><span class="w"> </span><span class="kn">import</span> <span class="n">NameOID</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipaddress</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_ca_certificate</span><span class="p">(</span>
    <span class="n">subject_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">key_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">,</span>
    <span class="n">valid_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3650</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μμ²΄ μ„λ…λ CA μΈμ¦μ„λ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="c1"># CA ν‚¤ μ μƒμ„±</span>
    <span class="n">ca_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
        <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
        <span class="n">key_size</span><span class="o">=</span><span class="n">key_size</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">subject</span> <span class="o">=</span> <span class="n">issuer</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COUNTRY_NAME</span><span class="p">,</span> <span class="s2">&quot;US&quot;</span><span class="p">),</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">ORGANIZATION_NAME</span><span class="p">,</span> <span class="s2">&quot;Demo CA&quot;</span><span class="p">),</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="n">subject_name</span><span class="p">),</span>
    <span class="p">])</span>

    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="n">ca_cert</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">subject_name</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
        <span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span><span class="n">issuer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">ca_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">())</span>
        <span class="o">.</span><span class="n">serial_number</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">())</span>
        <span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">valid_days</span><span class="p">))</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">BasicConstraints</span><span class="p">(</span><span class="n">ca</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">path_length</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">KeyUsage</span><span class="p">(</span>
                <span class="n">digital_signature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">key_cert_sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">crl_sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">content_commitment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">key_encipherment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">data_encipherment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">key_agreement</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">encipher_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">decipher_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">ca_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ca_key</span><span class="p">,</span> <span class="n">ca_cert</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_server_certificate</span><span class="p">(</span>
    <span class="n">ca_key</span><span class="p">,</span>
    <span class="n">ca_cert</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">valid_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CAκ°€ μ„λ…ν• μ„λ²„ μΈμ¦μ„λ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="c1"># μ„λ²„ ν‚¤ μ μƒμ„±</span>
    <span class="n">server_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
        <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
        <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="n">server_cert</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">subject_name</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="n">hostname</span><span class="p">),</span>
        <span class="p">]))</span>
        <span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span><span class="n">ca_cert</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
        <span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">server_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">())</span>
        <span class="o">.</span><span class="n">serial_number</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">())</span>
        <span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">valid_days</span><span class="p">))</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">SubjectAlternativeName</span><span class="p">([</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">(</span><span class="n">hostname</span><span class="p">),</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">BasicConstraints</span><span class="p">(</span><span class="n">ca</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_length</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">KeyUsage</span><span class="p">(</span>
                <span class="n">digital_signature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">key_encipherment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">content_commitment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">data_encipherment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">key_agreement</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">key_cert_sign</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">crl_sign</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">encipher_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">decipher_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">ExtendedKeyUsage</span><span class="p">([</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">ExtendedKeyUsageOID</span><span class="o">.</span><span class="n">SERVER_AUTH</span><span class="p">,</span>
            <span class="p">]),</span>
            <span class="n">critical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">ca_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">server_key</span><span class="p">,</span> <span class="n">server_cert</span>

<span class="k">def</span><span class="w"> </span><span class="nf">verify_certificate_chain</span><span class="p">(</span>
    <span class="n">leaf_cert</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span>
    <span class="n">intermediate_certs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">trusted_roots</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    μΈμ¦μ„ μ²΄μΈμ„ μλ™μΌλ΅ κ²€μ¦ν•©λ‹λ‹¤.</span>
<span class="sd">    ν”„λ΅λ•μ…μ—μ„λ” μ΄λ¥Ό μλ™μΌλ΅ μ²λ¦¬ν•λ” ssl.SSLContextλ¥Ό μ‚¬μ©ν•μ„Έμ”.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;checks&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="c1"># μ²΄μΈ κµ¬μ¶•: λ¦¬ν”„ β†’ μ¤‘κ°„ β†’ λ£¨νΈ</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf_cert</span><span class="p">]</span> <span class="o">+</span> <span class="n">intermediate_certs</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cert</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chain</span><span class="p">):</span>
        <span class="n">cert_name</span> <span class="o">=</span> <span class="s2">&quot;Leaf&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Intermediate </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># μ ν¨ κΈ°κ°„ ν™•μΈ</span>
        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_before_utc</span> <span class="o">&gt;</span> <span class="n">now</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: μ•„μ§ μ ν¨ν•μ§€ μ•μ&quot;</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: λ§λ£λ¨&quot;</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">days_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span> <span class="o">-</span> <span class="n">now</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;checks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: μ ν¨ν•¨ (</span><span class="si">{</span><span class="n">days_left</span><span class="si">}</span><span class="s2">μΌ λ‚¨μ)&quot;</span><span class="p">)</span>

        <span class="c1"># μ„λ… κ²€μ¦ (λ°κΈ‰μκ°€ μ΄ μΈμ¦μ„μ— μ„λ…ν•¨)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># μ²΄μΈμ λ‹¤μ μΈμ¦μ„κ°€ λ°κΈ‰μμ—¬μ•Ό ν•¨</span>
            <span class="n">issuer_cert</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># λ§μ§€λ§‰ μΈμ¦μ„λ” μ‹ λΆ°ν•  μ μλ” λ£¨νΈμ— μν•΄ μ„λ…λμ–΄μ•Ό ν•¨</span>
            <span class="n">issuer_cert</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">trusted_roots</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span><span class="o">.</span><span class="n">subject</span> <span class="o">==</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer</span><span class="p">:</span>
                    <span class="n">issuer_cert</span> <span class="o">=</span> <span class="n">root</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">issuer_cert</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: μ‹ λΆ° μ €μ¥μ†μ—μ„ λ°κΈ‰μλ¥Ό μ°Ύμ„ μ μ—†μ&quot;</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>

        <span class="c1"># λ””μ§€ν„Έ μ„λ… κ²€μ¦</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">issuer_pub</span> <span class="o">=</span> <span class="n">issuer_cert</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
            <span class="n">issuer_pub</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
                <span class="n">cert</span><span class="o">.</span><span class="n">signature</span><span class="p">,</span>
                <span class="n">cert</span><span class="o">.</span><span class="n">tbs_certificate_bytes</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">.</span><span class="n">PKCS1v15</span><span class="p">(),</span>
                <span class="n">cert</span><span class="o">.</span><span class="n">signature_hash_algorithm</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;checks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: μ„λ… μ ν¨ (</span><span class="si">{</span><span class="n">issuer_cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">rfc4514_string</span><span class="p">()</span><span class="si">}</span><span class="s2">κ°€ μ„λ…ν•¨)&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cert_name</span><span class="si">}</span><span class="s2">: μ„λ… κ²€μ¦ μ‹¤ν¨: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># SANμ— λ€ν• νΈμ¤νΈλ… ν™•μΈ</span>
    <span class="k">if</span> <span class="n">hostname</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">san</span> <span class="o">=</span> <span class="n">leaf_cert</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">get_extension_for_class</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">SubjectAlternativeName</span><span class="p">)</span>
            <span class="n">dns_names</span> <span class="o">=</span> <span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">get_attributes_for_oid</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;get_attributes_for_oid&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">san</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">hostname</span> <span class="ow">in</span> <span class="n">names</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;*.&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">hostname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span>
            <span class="p">):</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;checks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;νΈμ¤νΈλ… &#39;</span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">&#39;μ΄ SANκ³Ό μΌμΉν•¨&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;νΈμ¤νΈλ… &#39;</span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">&#39;μ΄ SANμ— μ—†μ: </span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="n">x509</span><span class="o">.</span><span class="n">ExtensionNotFound</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SAN ν™•μ¥μ„ μ°Ύμ„ μ μ—†μ&quot;</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># μ™„μ „ν• μΈμ¦μ„ μ²΄μΈ μƒμ„±</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;μΈμ¦μ„ μ²΄μΈ μƒμ„±&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># 1. λ£¨νΈ CA μƒμ„±</span>
<span class="n">ca_key</span><span class="p">,</span> <span class="n">ca_cert</span> <span class="o">=</span> <span class="n">create_ca_certificate</span><span class="p">(</span><span class="s2">&quot;Demo Root CA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root CA: </span><span class="si">{</span><span class="n">ca_cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">rfc4514_string</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2. μ„λ²„ μΈμ¦μ„ μƒμ„±</span>
<span class="n">server_key</span><span class="p">,</span> <span class="n">server_cert</span> <span class="o">=</span> <span class="n">create_server_certificate</span><span class="p">(</span>
    <span class="n">ca_key</span><span class="p">,</span> <span class="n">ca_cert</span><span class="p">,</span> <span class="s2">&quot;example.com&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server:  </span><span class="si">{</span><span class="n">server_cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">rfc4514_string</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. μ²΄μΈ κ²€μ¦</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">verify_certificate_chain</span><span class="p">(</span>
    <span class="n">leaf_cert</span><span class="o">=</span><span class="n">server_cert</span><span class="p">,</span>
    <span class="n">intermediate_certs</span><span class="o">=</span><span class="p">[],</span>  <span class="c1"># μ§μ ‘ CA μ„λ… (μ¤‘κ°„ μ—†μ)</span>
    <span class="n">trusted_roots</span><span class="o">=</span><span class="p">[</span><span class="n">ca_cert</span><span class="p">],</span>
    <span class="n">hostname</span><span class="o">=</span><span class="s2">&quot;example.com&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">μ²΄μΈ κ²€μ¦: </span><span class="si">{</span><span class="s1">&#39;μ ν¨&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;λ¬΄ν¨&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;checks&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [OK] </span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!!] </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μλ»λ νΈμ¤νΈλ…μΌλ΅ ν…μ¤νΈ</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">verify_certificate_chain</span><span class="p">(</span>
    <span class="n">leaf_cert</span><span class="o">=</span><span class="n">server_cert</span><span class="p">,</span>
    <span class="n">intermediate_certs</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">trusted_roots</span><span class="o">=</span><span class="p">[</span><span class="n">ca_cert</span><span class="p">],</span>
    <span class="n">hostname</span><span class="o">=</span><span class="s2">&quot;evil.com&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">μλ»λ νΈμ¤νΈλ…: </span><span class="si">{</span><span class="s1">&#39;μ ν¨&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">result2</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;λ¬΄ν¨&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">result2</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!!] </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-ca">6. μΈμ¦ κΈ°κ΄€(CA)<a class="header-link" href="#6-ca" title="Permanent link">&para;</a></h2>
<h3 id="61-ca">6.1 CA μ‘λ™ λ°©μ‹<a class="header-link" href="#61-ca" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μΈμ¦ κΈ°κ΄€ ν”„λ΅μ„Έμ¤                                       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  1. λ„λ©”μΈ μ†μ μκ°€ ν‚¤ μκ³Ό CSR μƒμ„±                                 β”‚
β”‚     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                 β”‚
β”‚     β”‚ Private Key  β”‚ (λΉ„λ°€ μ μ§€!)                                    β”‚
β”‚     β”‚ Public Key   β”‚ β†’ CSRμ— ν¬ν•¨λ¨                                  β”‚
β”‚     β”‚ CSR          β”‚ β†’ CAμ— μ „μ†΅λ¨                                   β”‚
β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                 β”‚
β”‚            β”‚                                                        β”‚
β”‚            β–Ό                                                        β”‚
β”‚  2. CAκ°€ λ„λ©”μΈ μ†μ κ¶ κ²€μ¦                                         β”‚
β”‚     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                β”‚
β”‚     β”‚  DV (λ„λ©”μΈ κ²€μ¦):                           β”‚                β”‚
β”‚     β”‚    HTTP μ±λ¦°μ§€, DNS μ±λ¦°μ§€, λλ” μ΄λ©”μΌ      β”‚                β”‚
β”‚     β”‚                                               β”‚                β”‚
β”‚     β”‚  OV (μ΅°μ§ κ²€μ¦):                             β”‚                β”‚
β”‚     β”‚    DV + μ΅°μ§ μ‹ μ› ν™•μΈ                       β”‚                β”‚
β”‚     β”‚                                               β”‚                β”‚
β”‚     β”‚  EV (ν™•μ¥ κ²€μ¦):                             β”‚                β”‚
β”‚     β”‚    OV + κ΄‘λ²”μ„ν• λ²•μ /λ¬Όλ¦¬μ  κ²€μ¦            β”‚                β”‚
β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                β”‚
β”‚            β”‚                                                        β”‚
β”‚            β–Ό                                                        β”‚
β”‚  3. CAκ°€ μΈμ¦μ„μ— μ„λ…                                              β”‚
β”‚     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                 β”‚
β”‚     β”‚ CAκ°€ X.509  β”‚                                                 β”‚
β”‚     β”‚ μΈμ¦μ„ μƒμ„± β”‚ β†’ CAμ κ°μΈ ν‚¤λ΅ μ„λ…λ¨                         β”‚
β”‚     β”‚ (μ†μ μμ   β”‚                                                 β”‚
β”‚     β”‚ κ³µκ° ν‚¤ ν¬ν•¨)β”‚                                                 β”‚
β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                 β”‚
β”‚            β”‚                                                        β”‚
β”‚            β–Ό                                                        β”‚
β”‚  4. λ„λ©”μΈ μ†μ μκ°€ μ„λ²„μ— μΈμ¦μ„ μ„¤μΉ                              β”‚
β”‚     TLS ν•Έλ“μ…°μ΄ν¬ μ¤‘ μ„λ²„κ°€ μΈμ¦μ„ μ²΄μΈ μ „μ†΅                       β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="62">6.2 μΈμ¦μ„ νκΈ°<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μΈμ¦μ„ νκΈ° λ°©λ²•                                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ°©λ²•             β”‚ μ„¤λ…                                             β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ CRL              β”‚ μΈμ¦μ„ νκΈ° λ©λ΅                                 β”‚
β”‚ (RFC 5280)       β”‚ β€Ά CAκ°€ νκΈ°λ μΈμ¦μ„μ μ„λ…λ λ©λ΅μ„ κ²μ‹       β”‚
β”‚                  β”‚ β€Ά ν΄λΌμ΄μ–ΈνΈκ°€ λ©λ΅μ„ λ‹¤μ΄λ΅λ“ν•κ³  ν™•μΈ         β”‚
β”‚                  β”‚ β€Ά λ¬Έμ : λ©λ΅μ΄ μ»¤μ§€κ³ , μ¤λλ λ°μ΄ν„°            β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ OCSP             β”‚ μ¨λΌμΈ μΈμ¦μ„ μƒνƒ ν”„λ΅ν† μ½                     β”‚
β”‚ (RFC 6960)       β”‚ β€Ά ν΄λΌμ΄μ–ΈνΈκ°€ CAμ—κ² μ§λ¬Έ: &quot;μ΄ μΈμ¦μ„ νκΈ°λ¨?&quot;β”‚
β”‚                  β”‚ β€Ά μ‹¤μ‹κ°„ μ‘λ‹µ                                   β”‚
β”‚                  β”‚ β€Ά λ¬Έμ : κ°μΈμ •λ³΄ (CAκ°€ λ°©λ¬Έ μ‚¬μ΄νΈ λ³Ό μ μμ),β”‚
β”‚                  β”‚   κ°€μ©μ„± μμ΅΄μ„±                                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ OCSP Stapling    β”‚ μ„λ²„κ°€ OCSP μ‘λ‹µμ„ κ°€μ Έμ™€μ„ TLS ν•Έλ“μ…°μ΄ν¬μ—   β”‚
β”‚ (RFC 6066)       β”‚ μ²¨λ¶€                                             β”‚
β”‚                  β”‚ β€Ά ν΄λΌμ΄μ–ΈνΈκ°€ CAμ— μ—°κ²°ν•μ§€ μ•κ³  κ²€μ¦         β”‚
β”‚                  β”‚ β€Ά λ¨λ²” μ‚¬λ΅€! μ„λ²„μ—μ„ κµ¬μ„±ν•μ„Έμ”               β”‚
β”‚                  β”‚ β€Ά μ‘λ‹µμ€ CAκ°€ μ„λ…ν•κ³ , μ‹κ°„ μ ν•μ΄ μμ       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ CRLite           β”‚ μ••μ¶•λ νκΈ° λ°μ΄ν„°λ¥Ό λΈλΌμ°μ €λ΅ ν‘Έμ‹            β”‚
β”‚ (Firefox)        β”‚ β€Ά μ™„μ „ν• νκΈ° μ •λ³΄, λ„¤νΈμ›ν¬ λ¶ν•„μ”            β”‚
β”‚                  β”‚ β€Ά λ§¤μ° ν¨μ¨μ  (λ¨λ“  νκΈ°μ— λ€ν•΄ &lt; 1 MB)        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚ λ‹¨κΈ° μΈμ¦μ„      β”‚ λ©°μΉ λ§ μ ν¨ν• μΈμ¦μ„                            β”‚
β”‚                  β”‚ β€Ά νκΈ° λ¶ν•„μ” (νκΈ°κ°€ ν¨λ ¥μ„ λ°νν•κΈ° μ „μ—     β”‚
β”‚                  β”‚   μΈμ¦μ„κ°€ λ§λ£λ¨)                              β”‚
β”‚                  β”‚ β€Ά Let&#39;s Encrypt μΈμ¦μ„: 90μΌ                    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="63-ct">6.3 μΈμ¦μ„ ν¬λ…μ„±(CT)<a class="header-link" href="#63-ct" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μΈμ¦μ„ ν¬λ…μ„± (RFC 6962)                                β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  λ¬Έμ : λ¶λ‰ν•κ±°λ‚ μ†μƒλ CAκ°€ λ¨λ“  λ„λ©”μΈμ— λ€ν•΄ μ‚¬κΈ°μ„± μΈμ¦μ„λ¥Ό    β”‚
β”‚  λ°κΈ‰ν•  μ μμµλ‹λ‹¤.                                                β”‚
β”‚                                                                      β”‚
β”‚  μ†”λ£¨μ…: λ¨λ“  μΈμ¦μ„κ°€ κ³µκ°μ μΌλ΅ λ΅κ·Έλμ–΄μ•Ό ν•©λ‹λ‹¤.                β”‚
β”‚                                                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”  μΈμ¦μ„ λ°κΈ‰  β”β”€β”€β”€β”€β”€β”  μ μ¶   β”β”€β”€β”€β”€β”€β”€β”€β”                β”‚
β”‚  β”‚ λ„λ©”μΈ β”‚ β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€  β”‚ CA  β”‚ β”€β”€β”€β”€β”€β”€β”€β–¶β”‚  CT   β”‚                β”‚
β”‚  β”‚ μ†μ μ β”‚               β”‚     β”‚         β”‚  λ΅κ·Έ β”‚                β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”               β””β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”¬β”€β”€β”€β”                β”‚
β”‚                                               β”‚                     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”  TLSμ SCT  β”β”€β”€β”€β”€β”€β”  ν™•μΈ      β”‚                     β”‚
β”‚  β”‚λΈλΌμ°μ €β”‚ β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ β”‚μ„λ²„ β”‚            β”‚                     β”‚
β”‚  β”‚        β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶β”‚     β”‚β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                     β”‚
β”‚  β”‚        β”‚   SCT κ²€μ¦   β””β”€β”€β”€β”€β”€β”  SCT λ°ν™                        β”‚
β”‚  β””β”€β”€β”€β”€β”¬β”€β”€β”€β”                                                       β”‚
β”‚       β”‚                                                            β”‚
β”‚       β–Ό                                                            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                    β”‚
β”‚  β”‚  λ¨λ‹ν„°λ§  β”‚  λ¬΄λ‹¨ μΈμ¦μ„μ— λ€ν• CT λ΅κ·Έ κ°μ‹                   β”‚
β”‚  β”‚  μ„λΉ„μ¤    β”‚  λ„λ©”μΈ μ†μ μκ°€ λ¶λ‰ μΈμ¦μ„ κ°μ§€ κ°€λ¥             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                                    β”‚
β”‚                                                                      β”‚
β”‚  SCT = μ„λ…λ μΈμ¦μ„ νƒ€μ„μ¤νƒ¬ν”„ (λ΅κΉ… μ¦λ…)                         β”‚
β”‚  Chrome/Firefoxλ” λ¨λ“  κ³µκ°μ μΌλ΅ μ‹ λΆ°ν•  μ μλ” μΈμ¦μ„μ— λ€ν•΄      β”‚
β”‚  CTλ¥Ό μ”κµ¬ν•©λ‹λ‹¤.                                                   β”‚
β”‚                                                                      β”‚
β”‚  CT λ΅κ·Έ κ²€μƒ‰: https://crt.sh/                                      β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<hr />
<h2 id="7-lets-encrypt-acme">7. Let's Encryptμ™€ ACME<a class="header-link" href="#7-lets-encrypt-acme" title="Permanent link">&para;</a></h2>
<h3 id="71-acme">7.1 ACME ν”„λ΅ν† μ½ κ°μ”<a class="header-link" href="#71-acme" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚         ACME ν”„λ΅ν† μ½ (μλ™ μΈμ¦μ„ κ΄€λ¦¬)                             β”‚
β”‚                       RFC 8555                                       β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚   ν΄λΌμ΄μ–ΈνΈ (certbot)                      Let&#39;s Encrypt            β”‚
β”‚   β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€                          β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€            β”‚
β”‚                                                                      β”‚
β”‚   1. κ³„μ • μƒμ„±                                                      β”‚
β”‚      POST /acme/new-acct β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                        β”‚
β”‚                           β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ κ³„μ • URL              β”‚
β”‚                                                                      β”‚
β”‚   2. μ£Όλ¬Έ μ μ¶                                                      β”‚
β”‚      POST /acme/new-order β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                        β”‚
β”‚      { identifiers: [&quot;example.com&quot;] }                               β”‚
β”‚                           β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ μΈμ¦ URLλ“¤            β”‚
β”‚                                                                      β”‚
β”‚   3. μ±λ¦°μ§€ μ™„λ£ (λ„λ©”μΈ μ†μ κ¶ μ¦λ…)                               β”‚
β”‚                                                                      β”‚
β”‚      HTTP-01 μ±λ¦°μ§€:                                                β”‚
β”‚      PUT /.well-known/acme-challenge/{token}                        β”‚
β”‚      β†’ Let&#39;s Encryptκ°€ μ΄ URLμ„ GETν•μ—¬ κ²€μ¦                       β”‚
β”‚                                                                      β”‚
β”‚      DNS-01 μ±λ¦°μ§€:                                                 β”‚
β”‚      TXT λ μ½”λ“ μƒμ„±: _acme-challenge.example.com                   β”‚
β”‚      β†’ Let&#39;s Encryptκ°€ DNSλ¥Ό μΏΌλ¦¬ν•μ—¬ κ²€μ¦                          β”‚
β”‚                                                                      β”‚
β”‚   4. μ£Όλ¬Έ μ™„λ£ (CSR μ μ¶)                                           β”‚
β”‚      POST /acme/finalize β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                        β”‚
β”‚      { csr: &quot;MIIBkTCB...&quot; }                                        β”‚
β”‚                           β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ μΈμ¦μ„ URL            β”‚
β”‚                                                                      β”‚
β”‚   5. μΈμ¦μ„ λ‹¤μ΄λ΅λ“                                                β”‚
β”‚      GET /acme/cert/abc123 β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–¶                       β”‚
β”‚                           β—€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ PEM μΈμ¦μ„ μ²΄μΈ       β”‚
β”‚                                                                      β”‚
β”‚   6. μλ™ κ°±μ‹  (λ§λ£ μ „, μΌλ°μ μΌλ΅ 60μΌμ—)                         β”‚
β”‚      2-5λ‹¨κ³„λ¥Ό μλ™μΌλ΅ λ°λ³µ                                        β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="72-certbot">7.2 Certbot λ…λ Ήμ–΄<a class="header-link" href="#72-certbot" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># certbot μ„¤μΉ</span>
<span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>certbot<span class="w"> </span>python3-certbot-nginx

<span class="c1"># macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>certbot

<span class="c1"># μΈμ¦μ„ νλ“ (λ…λ¦½ μ‹¤ν–‰ λ¨λ“ - μ›Ή μ„λ²„λ¥Ό μ„μ‹λ΅ μ¤‘μ§€)</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>certonly<span class="w"> </span>--standalone<span class="w"> </span>-d<span class="w"> </span>example.com<span class="w"> </span>-d<span class="w"> </span>www.example.com

<span class="c1"># Nginx ν”λ¬κ·ΈμΈμΌλ΅ νλ“ (λ‹¤μ΄νƒ€μ„ μ—†μ)</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>--nginx<span class="w"> </span>-d<span class="w"> </span>example.com<span class="w"> </span>-d<span class="w"> </span>www.example.com

<span class="c1"># DNS μ±λ¦°μ§€λ΅ νλ“ (μ™€μΌλ“μΉ΄λ“μ©)</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>certonly<span class="w"> </span>--manual<span class="w"> </span>--preferred-challenges<span class="w"> </span>dns<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;*.example.com&quot;</span>

<span class="c1"># κ°±μ‹  ν…μ¤νΈ</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>renew<span class="w"> </span>--dry-run

<span class="c1"># μ‹¤μ  κ°±μ‹  (μΌλ°μ μΌλ΅ cron/systemd νƒ€μ΄λ¨Έλ¥Ό ν†µν•΄)</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>renew

<span class="c1"># μΈμ¦μ„ λ³΄κΈ°</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>certificates

<span class="c1"># μΈμ¦μ„ νκΈ°</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>revoke<span class="w"> </span>--cert-path<span class="w"> </span>/etc/letsencrypt/live/example.com/cert.pem
</code></pre></div>

<h3 id="73">7.3 μΈμ¦μ„ νμΌ<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>
<span class="err">β”β”€β”€</span><span class="w"> </span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span><span class="w">       </span><span class="c1"># λ„λ©”μΈμ μΈμ¦μ„ (λ¦¬ν”„λ§)</span>
<span class="err">β”β”€β”€</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="n">pem</span><span class="w">      </span><span class="c1"># μ¤‘κ°„ CA μΈμ¦μ„</span>
<span class="err">β”β”€β”€</span><span class="w"> </span><span class="n">fullchain</span><span class="o">.</span><span class="n">pem</span><span class="w">  </span><span class="c1"># cert.pem + chain.pem (λ€λ¶€λ¶„μ μ„λ²„κ°€ ν•„μ”λ΅ ν•¨)</span>
<span class="err">β”β”€β”€</span><span class="w"> </span><span class="n">privkey</span><span class="o">.</span><span class="n">pem</span><span class="w">    </span><span class="c1"># κ°μΈ ν‚¤ (λΉ„λ°€ μ μ§€!)</span>
<span class="err">β””β”€β”€</span><span class="w"> </span><span class="n">README</span>

<span class="c1"># Nginx κµ¬μ„±</span>
<span class="n">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">ssl</span><span class="w"> </span><span class="n">http2</span><span class="p">;</span>
<span class="w">    </span><span class="n">server_name</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">;</span>

<span class="w">    </span><span class="n">ssl_certificate</span><span class="w">     </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">fullchain</span><span class="o">.</span><span class="n">pem</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_certificate_key</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">privkey</span><span class="o">.</span><span class="n">pem</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># ν„λ€μ μΈ TLS κµ¬μ„±</span>
<span class="w">    </span><span class="n">ssl_protocols</span><span class="w"> </span><span class="n">TLSv1</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="n">TLSv1</span><span class="o">.</span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_ciphers</span><span class="w"> </span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">CHACHA20</span><span class="o">-</span><span class="n">POLY1305</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">CHACHA20</span><span class="o">-</span><span class="n">POLY1305</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="n">off</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># HSTS</span>
<span class="w">    </span><span class="n">add_header</span><span class="w"> </span><span class="n">Strict</span><span class="o">-</span><span class="n">Transport</span><span class="o">-</span><span class="n">Security</span><span class="w"> </span><span class="s2">&quot;max-age=63072000; includeSubDomains; preload&quot;</span><span class="w"> </span><span class="n">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># OCSP Stapling</span>
<span class="w">    </span><span class="n">ssl_stapling</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_stapling_verify</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_trusted_certificate</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">chain</span><span class="o">.</span><span class="n">pem</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="8">8. μΈμ¦μ„ ν”Όλ‹<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p>μΈμ¦μ„ ν”Όλ‹μ€ μ£Όμ–΄μ§„ λ„λ©”μΈμ— λ€ν•΄ ν—μ©λλ” μΈμ¦μ„λ¥Ό μ ν•ν•μ—¬, CAκ°€ μ†μƒλλ”λΌλ„ κ³µκ²©μ„ λ°©μ§€ν•©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              μΈμ¦μ„ ν”Όλ‹ μ „λµ                                         β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  1. κ³µκ° ν‚¤ ν”Όλ‹ (κ¶μ¥)                                             β”‚
β”‚     κ³µκ° ν‚¤μ ν•΄μ‹λ¥Ό κ³ μ •ν•©λ‹λ‹¤ (μ „μ²΄ μΈμ¦μ„κ°€ μ•„λ‹).               β”‚
β”‚     μΈμ¦μ„ κ°±μ‹  μ‹μ—λ„ μ μ§€λ©λ‹λ‹¤ (ν‚¤λ” λ™μΌν•κ² μ μ§€).             β”‚
β”‚                                                                      β”‚
β”‚  2. μΈμ¦μ„ ν”Όλ‹                                                     β”‚
β”‚     μ „μ²΄ μΈμ¦μ„μ ν•΄μ‹λ¥Ό κ³ μ •ν•©λ‹λ‹¤.                                β”‚
β”‚     μΈμ¦μ„κ°€ κ°±μ‹ λ  λ• ν•€μ„ μ—…λ°μ΄νΈν•΄μ•Ό ν•©λ‹λ‹¤.                    β”‚
β”‚                                                                      β”‚
β”‚  3. μ¤‘κ°„ CA ν”Όλ‹                                                    β”‚
β”‚     μ¤‘κ°„ CAμ κ³µκ° ν‚¤λ¥Ό κ³ μ •ν•©λ‹λ‹¤.                                 β”‚
β”‚     λ¦¬ν”„ ν”Όλ‹λ³΄λ‹¤ λ” μ μ—°ν•©λ‹λ‹¤.                                    β”‚
β”‚                                                                      β”‚
β”‚  μ¤‘μ”ν• κ²½κ³ :                                                       β”‚
β”‚  β€Ά HPKP (HTTP κ³µκ° ν‚¤ ν”Όλ‹)λ” λΈλΌμ°μ €μ—μ„ νκΈ°λμ—μµλ‹λ‹¤          β”‚
β”‚    (λ„λ©”μΈμ„ μκµ¬μ μΌλ΅ μ†μƒμ‹ν‚¤κΈ° λ„λ¬΄ μ‰¬μ›€)                       β”‚
β”‚  β€Ά μ£Όλ΅ λ¨λ°”μΌ μ•±κ³Ό API ν΄λΌμ΄μ–ΈνΈμ—μ„ ν”Όλ‹ μ‚¬μ©                   β”‚
β”‚  β€Ά ν•­μƒ λ°±μ—… ν•€μ„ ν¬ν•¨ν•μ„Έμ”                                       β”‚
β”‚  β€Ά μ›Ή λΈλΌμ°μ €μ κ²½μ° μ΄μ  ν”Όλ‹ λ€μ‹  μΈμ¦μ„ ν¬λ…μ„±μ΄ μ„ νΈλ©λ‹λ‹¤    β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="81-python">8.1 Pythonμ—μ„ μΈμ¦μ„ ν”Όλ‹<a class="header-link" href="#81-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.serialization</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Encoding</span><span class="p">,</span> <span class="n">PublicFormat</span>
<span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PinnedHTTPSConnection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μΈμ¦μ„ ν”Όλ‹μ„ μ‚¬μ©ν•λ” HTTPS μ—°κ²°.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">443</span><span class="p">,</span>
                 <span class="n">pinned_hashes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            hostname: μ„λ²„ νΈμ¤νΈλ…</span>
<span class="sd">            port: μ„λ²„ ν¬νΈ</span>
<span class="sd">            pinned_hashes: ν—μ©λλ” κ³µκ° ν‚¤μ SHA-256 ν•΄μ‹ λ©λ΅</span>
<span class="sd">                           (base64λ΅ μΈμ½”λ”©λ¨)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="n">hostname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinned_hashes</span> <span class="o">=</span> <span class="n">pinned_hashes</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pubkey_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert_der</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μΈμ¦μ„μ κ³µκ° ν‚¤μ SHA-256 ν•΄μ‹λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">load_der_x509_certificate</span><span class="p">(</span><span class="n">cert_der</span><span class="p">)</span>
        <span class="n">pub_key_bytes</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span>
            <span class="n">Encoding</span><span class="o">.</span><span class="n">DER</span><span class="p">,</span>
            <span class="n">PublicFormat</span><span class="o">.</span><span class="n">SubjectPublicKeyInfo</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">pub_key_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;μΈμ¦μ„ ν•€ κ²€μ¦μΌλ΅ μ—°κ²°ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
                <span class="c1"># μΈμ¦μ„ μ²΄μΈ κ°€μ Έμ¤κΈ°</span>
                <span class="n">cert_der</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">cert_info</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>

                <span class="c1"># κ³µκ° ν‚¤ ν•΄μ‹ κ³„μ‚°</span>
                <span class="n">actual_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pubkey_hash</span><span class="p">(</span><span class="n">cert_der</span><span class="p">)</span>

                <span class="c1"># ν•€ ν™•μΈ</span>
                <span class="n">pin_valid</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pinned_hashes</span><span class="p">:</span>
                    <span class="n">pin_valid</span> <span class="o">=</span> <span class="n">actual_hash</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pinned_hashes</span>

                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span>
                    <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">ssock</span><span class="o">.</span><span class="n">version</span><span class="p">(),</span>
                    <span class="s2">&quot;cipher&quot;</span><span class="p">:</span> <span class="n">ssock</span><span class="o">.</span><span class="n">cipher</span><span class="p">(),</span>
                    <span class="s2">&quot;cert_subject&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert_info</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]),</span>
                    <span class="s2">&quot;cert_issuer&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert_info</span><span class="p">[</span><span class="s2">&quot;issuer&quot;</span><span class="p">]),</span>
                    <span class="s2">&quot;pubkey_hash&quot;</span><span class="p">:</span> <span class="n">actual_hash</span><span class="p">,</span>
                    <span class="s2">&quot;pin_valid&quot;</span><span class="p">:</span> <span class="n">pin_valid</span><span class="p">,</span>
                    <span class="s2">&quot;pinned_hashes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pinned_hashes</span><span class="p">,</span>
                <span class="p">}</span>

<span class="c1"># λ¨Όμ € μ„λ²„μ ν•€ μ°ΎκΈ°</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">discovery</span> <span class="o">=</span> <span class="n">PinnedHTTPSConnection</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">discovery</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;μΈμ¦μ„ ν•€ μ°ΎκΈ°:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  νΈμ¤νΈ:       </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ν”„λ΅ν† μ½:     </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  μ•”νΈν™”:       </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;cipher&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Subject:      </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;cert_subject&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pubkey Hash:  </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;pubkey_hash&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># μ΄μ  ν•€μΌλ΅ μ—°κ²°</span>
    <span class="n">pinned</span> <span class="o">=</span> <span class="n">PinnedHTTPSConnection</span><span class="p">(</span>
        <span class="s2">&quot;www.google.com&quot;</span><span class="p">,</span>
        <span class="n">pinned_hashes</span><span class="o">=</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;pubkey_hash&quot;</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">pinned_result</span> <span class="o">=</span> <span class="n">pinned</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  ν•€ μ ν¨:      </span><span class="si">{</span><span class="n">pinned_result</span><span class="p">[</span><span class="s1">&#39;pin_valid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># μλ»λ ν•€</span>
    <span class="n">wrong</span> <span class="o">=</span> <span class="n">PinnedHTTPSConnection</span><span class="p">(</span>
        <span class="s2">&quot;www.google.com&quot;</span><span class="p">,</span>
        <span class="n">pinned_hashes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">wrong_result</span> <span class="o">=</span> <span class="n">wrong</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  μλ»λ ν•€:    </span><span class="si">{</span><span class="n">wrong_result</span><span class="p">[</span><span class="s1">&#39;pin_valid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;λ„¤νΈμ›ν¬ μ¤λ¥ (μ¤ν”„λΌμΈ ν™κ²½μ—μ„ μμƒλ¨): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="9-tlsmtls">9. μƒνΈ TLS(mTLS)<a class="header-link" href="#9-tlsmtls" title="Permanent link">&para;</a></h2>
<p>ν‘μ¤€ TLSμ—μ„λ” μ„λ²„λ§ μΈμ¦μ„λ¥Ό μ μ‹ν•©λ‹λ‹¤. μƒνΈ TLSμ—μ„λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ μΈμ¦μ„λ¥Ό μ μ‹ν•κ³  μ„λ΅λ¥Ό κ²€μ¦ν•©λ‹λ‹¤. μ΄κ²ƒμ€ μ„λΉ„μ¤ κ°„ ν†µμ‹ , API μΈμ¦, μ λ΅ νΈλ¬μ¤νΈ μ•„ν‚¤ν…μ²μ— μ‚¬μ©λ©λ‹λ‹¤.</p>
<div class="highlight"><pre><span></span><code>β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              ν‘μ¤€ TLS vs μƒνΈ TLS                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                      β”‚
β”‚  ν‘μ¤€ TLS (λ‹¨λ°©ν–¥):                                                 β”‚
β”‚                                                                      β”‚
β”‚  ν΄λΌμ΄μ–ΈνΈ β”€β”€β”€β”€ &quot;λ‹Ήμ‹ μ€ λ„κµ¬μ…λ‹κΉ?&quot; β”€β”€β”€β”€ μ„λ²„                     β”‚
β”‚         β—€β”€β”€β”€ [μ„λ²„ μΈμ¦μ„] β”€β”€β”€                                      β”‚
β”‚         β”€β”€β”€β”€ &quot;μΆ‹μ•„μ”, μ‹ λΆ°ν•©λ‹λ‹¤&quot; β”€β”€β”€β”€β–¶                             β”‚
β”‚                                                                      β”‚
β”‚  μ„λ²„λ§ μΈμ¦λ©λ‹λ‹¤.                                                 β”‚
β”‚  ν΄λΌμ΄μ–ΈνΈ μ‹ μ›μ€ λ‹¤λ¥Έ μλ‹¨μΌλ΅ κ²€μ¦λ©λ‹λ‹¤ (JWT, API ν‚¤ λ“±)       β”‚
β”‚                                                                      β”‚
β”‚  β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€  β”‚
β”‚                                                                      β”‚
β”‚  μƒνΈ TLS (μ–‘λ°©ν–¥):                                                 β”‚
β”‚                                                                      β”‚
β”‚  ν΄λΌμ΄μ–ΈνΈ β”€β”€β”€β”€ &quot;λ‹Ήμ‹ μ€ λ„κµ¬μ…λ‹κΉ?&quot; β”€β”€β”€β”€ μ„λ²„                     β”‚
β”‚         β—€β”€β”€β”€ [μ„λ²„ μΈμ¦μ„] β”€β”€β”€                                      β”‚
β”‚         β—€β”€β”€β”€ &quot;λ‹Ήμ‹ μ€ λ„κµ¬μ…λ‹κΉ?&quot; β”€β”€β”€β”€β”€β”€β”€β”€β”€                         β”‚
β”‚         β”€β”€β”€β”€ [ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„] β”€β”€β”€β”€β–¶                              β”‚
β”‚         β—€β”€β”€β”€ &quot;μΆ‹μ•„μ”, μ‹ λΆ°ν•©λ‹λ‹¤&quot; β”€β”€β”€β”€β”€β”€                            β”‚
β”‚         β”€β”€β”€β”€ &quot;μΆ‹μ•„μ”, μ €λ„ μ‹ λΆ°ν•©λ‹λ‹¤&quot; β”€β”€β–¶                          β”‚
β”‚                                                                      β”‚
β”‚  ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ μΈμ¦λ©λ‹λ‹¤.                                 β”‚
β”‚  λΉ„λ°€λ²νΈ, ν† ν°, API ν‚¤κ°€ ν•„μ” μ—†μµλ‹λ‹¤.                            β”‚
β”‚                                                                      β”‚
β”‚  μ‚¬μ© μ‚¬λ΅€:                                                         β”‚
β”‚  β€Ά λ§μ΄ν¬λ΅μ„λΉ„μ¤ κ°„ (Istio, Linkerd μ„λΉ„μ¤ λ©”μ‹)                  β”‚
β”‚  β€Ά ννΈλ„/κΈ°κ³„μ© API μΈμ¦                                          β”‚
β”‚  β€Ά IoT μ¥μΉ μΈμ¦                                                   β”‚
β”‚  β€Ά μ λ΅ νΈλ¬μ¤νΈ λ„¤νΈμ›ν¬                                          β”‚
β”‚  β€Ά λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°                                               β”‚
β”‚                                                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
</code></pre></div>

<h3 id="91-mtls">9.1 mTLS κµ¬ν„<a class="header-link" href="#91-mtls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span><span class="p">,</span> <span class="n">serialization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.x509.oid</span><span class="w"> </span><span class="kn">import</span> <span class="n">NameOID</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">timezone</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_mtls_certificates</span><span class="p">(</span><span class="n">base_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;mTLSμ© CA, μ„λ²„, ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„λ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
    <span class="n">base</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="c1"># 1. CA μƒμ„±</span>
    <span class="n">ca_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
    <span class="n">ca_cert</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">subject_name</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="s2">&quot;mTLS Demo CA&quot;</span><span class="p">),</span>
        <span class="p">]))</span>
        <span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="s2">&quot;mTLS Demo CA&quot;</span><span class="p">),</span>
        <span class="p">]))</span>
        <span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">ca_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">())</span>
        <span class="o">.</span><span class="n">serial_number</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">())</span>
        <span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">))</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">BasicConstraints</span><span class="p">(</span><span class="n">ca</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">path_length</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">critical</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">ca_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="c1"># 2. μ„λ²„ μΈμ¦μ„ μƒμ„±</span>
    <span class="n">server_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
    <span class="n">server_cert</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">subject_name</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="s2">&quot;localhost&quot;</span><span class="p">),</span>
        <span class="p">]))</span>
        <span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span><span class="n">ca_cert</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
        <span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">server_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">())</span>
        <span class="o">.</span><span class="n">serial_number</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">())</span>
        <span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">))</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">SubjectAlternativeName</span><span class="p">([</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">),</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">IPAddress</span><span class="p">(</span><span class="n">ipaddress</span><span class="o">.</span><span class="n">ip_address</span><span class="p">(</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)),</span>
            <span class="p">]),</span> <span class="n">critical</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">ExtendedKeyUsage</span><span class="p">([</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">ExtendedKeyUsageOID</span><span class="o">.</span><span class="n">SERVER_AUTH</span><span class="p">,</span>
            <span class="p">]),</span> <span class="n">critical</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">ca_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="c1"># 3. ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ μƒμ„±</span>
    <span class="n">client_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
    <span class="n">client_cert</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span>
        <span class="o">.</span><span class="n">subject_name</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="s2">&quot;api-client-1&quot;</span><span class="p">),</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">ORGANIZATION_NAME</span><span class="p">,</span> <span class="s2">&quot;My App&quot;</span><span class="p">),</span>
        <span class="p">]))</span>
        <span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span><span class="n">ca_cert</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
        <span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">client_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">())</span>
        <span class="o">.</span><span class="n">serial_number</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">())</span>
        <span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">))</span>
        <span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
            <span class="n">x509</span><span class="o">.</span><span class="n">ExtendedKeyUsage</span><span class="p">([</span>
                <span class="n">x509</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">ExtendedKeyUsageOID</span><span class="o">.</span><span class="n">CLIENT_AUTH</span><span class="p">,</span>
            <span class="p">]),</span> <span class="n">critical</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">ca_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="c1"># λ¨λ“  μΈμ¦μ„μ™€ ν‚¤ μ‘μ„±</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">cert</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">ca_key</span><span class="p">,</span> <span class="n">ca_cert</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;server&quot;</span><span class="p">,</span> <span class="n">server_key</span><span class="p">,</span> <span class="n">server_cert</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;client&quot;</span><span class="p">,</span> <span class="n">client_key</span><span class="p">,</span> <span class="n">client_cert</span><span class="p">),</span>
    <span class="p">]:</span>
        <span class="n">cert_path</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_cert.pem&quot;</span>
        <span class="n">key_path</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_key.pem&quot;</span>

        <span class="n">cert_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">))</span>
        <span class="n">key_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span>
            <span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
            <span class="n">serialization</span><span class="o">.</span><span class="n">PrivateFormat</span><span class="o">.</span><span class="n">TraditionalOpenSSL</span><span class="p">,</span>
            <span class="n">serialization</span><span class="o">.</span><span class="n">NoEncryption</span><span class="p">(),</span>
        <span class="p">))</span>

        <span class="n">files</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_cert&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cert_path</span><span class="p">)</span>
        <span class="n">files</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key_path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">files</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ipaddress</span>

<span class="c1"># μΈμ¦μ„ μƒμ„±</span>
<span class="n">certs</span> <span class="o">=</span> <span class="n">create_mtls_certificates</span><span class="p">(</span><span class="s2">&quot;/tmp/mtls_demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;μƒμ„±λ μΈμ¦μ„:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">certs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_mtls_server_context</span><span class="p">(</span><span class="n">certs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;mTLS μ„λ²„μ© SSL μ»¨ν…μ¤νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLS_SERVER</span><span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">minimum_version</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_2</span>

    <span class="c1"># μ„λ²„ μΈμ¦μ„μ™€ ν‚¤ λ΅λ“</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span>
        <span class="n">certfile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;server_cert&quot;</span><span class="p">],</span>
        <span class="n">keyfile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;server_key&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ μ”κµ¬ (μ΄κ²ƒμ΄ mTLSλ΅ λ§λ“­λ‹λ‹¤)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>

    <span class="c1"># ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„μ— λ€ν•΄ μ°λ¦¬ CAλ§ μ‹ λΆ°</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="n">cafile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;ca_cert&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ctx</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_mtls_client_context</span><span class="p">(</span><span class="n">certs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;mTLS ν΄λΌμ΄μ–ΈνΈμ© SSL μ»¨ν…μ¤νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLS_CLIENT</span><span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">minimum_version</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_2</span>

    <span class="c1"># ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„μ™€ ν‚¤ λ΅λ“</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span>
        <span class="n">certfile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;client_cert&quot;</span><span class="p">],</span>
        <span class="n">keyfile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;client_key&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># μ„λ²„ μΈμ¦μ„ κ²€μ¦μ„ μ„ν•΄ μ°λ¦¬ CA μ‹ λΆ°</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="n">cafile</span><span class="o">=</span><span class="n">certs</span><span class="p">[</span><span class="s2">&quot;ca_cert&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ctx</span>

<span class="c1"># κ°„λ‹¨ν• mTLS μ—μ½” μ„λ²„</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mtls_server</span><span class="p">(</span><span class="n">certs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;κ°„λ‹¨ν• mTLS μ„λ²„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">create_mtls_server_context</span><span class="p">(</span><span class="n">certs</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_side</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
            <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">conn</span><span class="p">:</span>
                <span class="c1"># ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ μ •λ³΄ κ°€μ Έμ¤κΈ°</span>
                <span class="n">client_cert</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>
                <span class="n">client_cn</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">client_cert</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">])[</span><span class="s2">&quot;commonName&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [μ„λ²„] ν΄λΌμ΄μ–ΈνΈ μΈμ¦λ¨: </span><span class="si">{</span><span class="n">client_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># μμ‹ ν• λ°μ΄ν„° μ—μ½”</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μ•λ…•ν•μ„Έμ” </span><span class="si">{</span><span class="n">client_cn</span><span class="si">}</span><span class="s2">! λ‹Ήμ‹ μ΄ λ§ν• κ²ƒ: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

<span class="c1"># mTLS ν…μ¤νΈ</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">8443</span>
<span class="n">server_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">mtls_server</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">certs</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
<span class="n">server_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">server_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># μ„λ²„ μ‹μ‘ λ€κΈ°</span>

<span class="c1"># ν΄λΌμ΄μ–ΈνΈλ΅ μ—°κ²°</span>
<span class="n">client_ctx</span> <span class="o">=</span> <span class="n">create_mtls_client_context</span><span class="p">(</span><span class="n">certs</span><span class="p">)</span>
<span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">client_ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [ν΄λΌμ΄μ–ΈνΈ] </span><span class="si">{</span><span class="n">ssock</span><span class="o">.</span><span class="n">version</span><span class="p">()</span><span class="si">}</span><span class="s2">λ΅ μ—°κ²°λ¨&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [ν΄λΌμ΄μ–ΈνΈ] μ„λ²„ μΈμ¦μ„: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()[</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">ssock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;mTLS ν΄λΌμ΄μ–ΈνΈμ—μ„ μ•λ…•ν•μ„Έμ”!&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [ν΄λΌμ΄μ–ΈνΈ] μ‘λ‹µ: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ •λ¦¬</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;/tmp/mtls_demo&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="10-python-tls">10. Python TLS ν”„λ΅κ·Έλλ°<a class="header-link" href="#10-python-tls" title="Permanent link">&para;</a></h2>
<h3 id="101-https">10.1 μ•μ „ν• HTTPS ν΄λΌμ΄μ–ΈνΈ<a class="header-link" href="#101-https" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">make_secure_request</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;λ³΄μ• λ¨λ²” μ‚¬λ΅€λ¥Ό μ‚¬μ©ν•μ—¬ HTTPS μ”μ²­μ„ ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="c1"># μ•μ „ν• SSL μ»¨ν…μ¤νΈ μƒμ„±</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>

    <span class="c1"># μµμ† TLS λ²„μ „ κ°•μ </span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">minimum_version</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_2</span>

    <span class="c1"># μ••μ¶• λΉ„ν™μ„±ν™” (CRIME κ³µκ²© λ°©μ§€)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">OP_NO_COMPRESSION</span>

    <span class="c1"># κ°•λ ¥ν• μ•”νΈν™” μ¤μ„νΈ μ„¤μ • (TLS 1.2 λ€μ²΄μ©)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">set_ciphers</span><span class="p">(</span>
        <span class="s2">&quot;ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20&quot;</span>
    <span class="p">)</span>

    <span class="c1"># μ”μ²­ μƒμ„±</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
            <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">),</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
        <span class="p">}</span>

<span class="c1"># μμ </span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">make_secure_request</span><span class="p">(</span><span class="s2">&quot;https://www.example.com&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;URL: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="102-python-tls">10.2 Python TLS μ„λ²„<a class="header-link" href="#102-python-tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_tls_server</span><span class="p">(</span><span class="n">certfile</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">keyfile</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8443</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ν„λ€μ μΈ κµ¬μ„±μΌλ΅ TLS μ„λ²„λ¥Ό μƒμ„±ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="c1"># SSL μ»¨ν…μ¤νΈ μƒμ„±</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLS_SERVER</span><span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">minimum_version</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_2</span>

    <span class="c1"># μΈμ¦μ„μ™€ ν‚¤ λ΅λ“</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="n">certfile</span><span class="o">=</span><span class="n">certfile</span><span class="p">,</span> <span class="n">keyfile</span><span class="o">=</span><span class="n">keyfile</span><span class="p">)</span>

    <span class="c1"># κ°•λ ¥ν• μ•”νΈν™”</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">set_ciphers</span><span class="p">(</span>
        <span class="s2">&quot;ECDHE+AESGCM:ECDHE+CHACHA20&quot;</span>
    <span class="p">)</span>

    <span class="c1"># λ³΄μ• μµμ…</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">OP_NO_COMPRESSION</span>    <span class="c1"># CRIME λ°©μ§€</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">OP_SINGLE_DH_USE</span>     <span class="c1"># μƒλ΅μ΄ DH νλΌλ―Έν„°</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">OP_SINGLE_ECDH_USE</span>   <span class="c1"># μƒλ΅μ΄ ECDH νλΌλ―Έν„°</span>

    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TLS μ„λ²„κ°€ </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">μ—μ„ μμ‹  λ€κΈ° μ¤‘&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_side</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">addr</span><span class="si">}</span><span class="s2">λ΅λ¶€ν„° μ—°κ²°&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ν”„λ΅ν† μ½: </span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">version</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  μ•”νΈν™”:   </span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">cipher</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># μ—°κ²° μ²λ¦¬</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;HTTP/1.1 200 OK</span><span class="se">\r\n</span><span class="s2">&quot;</span>
                                <span class="sa">b</span><span class="s2">&quot;Content-Type: text/plain</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span>
                                <span class="sa">b</span><span class="s2">&quot;Hello, TLS!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-openssl">11. OpenSSLλ΅ μΈμ¦μ„ μƒμ„±ν•κΈ°<a class="header-link" href="#11-openssl" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 μμ²΄ μ„λ… μΈμ¦μ„ (κ°λ°μ©)<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># κ°λ°μ© μμ²΄ μ„λ… μΈμ¦μ„ μƒμ„±</span>
<span class="c1"># (ν”„λ΅λ•μ…μ—μ„λ” μ‚¬μ©ν•μ§€ λ§μ„Έμ”!)</span>

<span class="c1"># ν• μ¤„λ΅: ν• λ…λ ΉμΌλ΅ ν‚¤ + μΈμ¦μ„ μƒμ„±</span>
openssl<span class="w"> </span>req<span class="w"> </span>-x509<span class="w"> </span>-newkey<span class="w"> </span>rsa:4096<span class="w"> </span>-sha256<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-nodes<span class="w"> </span>-keyout<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.crt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=localhost&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-addext<span class="w"> </span><span class="s2">&quot;subjectAltName=DNS:localhost,IP:127.0.0.1&quot;</span>

<span class="c1"># μΈμ¦μ„ ν™•μΈ</span>
openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>server.crt<span class="w"> </span>-text<span class="w"> </span>-noout

<span class="c1"># ν‚¤ ν™•μΈ</span>
openssl<span class="w"> </span>rsa<span class="w"> </span>-in<span class="w"> </span>server.key<span class="w"> </span>-check<span class="w"> </span>-noout
</code></pre></div>

<h3 id="112-ca">11.2 CA + μ„λ²„ μΈμ¦μ„ (μ „μ²΄ ν”„λ΅μ„Έμ¤)<a class="header-link" href="#112-ca" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1λ‹¨κ³„: CA κ°μΈ ν‚¤ μƒμ„±</span>
openssl<span class="w"> </span>genrsa<span class="w"> </span>-aes256<span class="w"> </span>-out<span class="w"> </span>ca.key<span class="w"> </span><span class="m">4096</span>
<span class="c1"># CA ν‚¤μ μ•”νΈ μ…λ ¥ (κΈ°μ–µν•μ„Έμ”!)</span>

<span class="c1"># 2λ‹¨κ³„: CA μΈμ¦μ„ μƒμ„± (μμ²΄ μ„λ…)</span>
openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-x509<span class="w"> </span>-sha256<span class="w"> </span>-days<span class="w"> </span><span class="m">3650</span><span class="w"> </span>-key<span class="w"> </span>ca.key<span class="w"> </span>-out<span class="w"> </span>ca.crt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/C=US/O=My Organization/CN=My Root CA&quot;</span>

<span class="c1"># 3λ‹¨κ³„: μ„λ²„ κ°μΈ ν‚¤ μƒμ„± (μλ™ν™”λ¥Ό μ„ν• μ•”νΈ μ—†μ)</span>
openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>server.key<span class="w"> </span><span class="m">2048</span>

<span class="c1"># 4λ‹¨κ³„: μΈμ¦μ„ μ„λ… μ”μ²­(CSR) μƒμ„±</span>
openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-sha256<span class="w"> </span>-key<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.csr<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=myserver.example.com&quot;</span>

<span class="c1"># 5λ‹¨κ³„: SAN (Subject Alternative Names)μ„ μ„ν• κµ¬μ„± νμΌ μƒμ„±</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>server_ext.cnf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">authorityKeyIdentifier=keyid,issuer</span>
<span class="s">basicConstraints=CA:FALSE</span>
<span class="s">keyUsage=digitalSignature,keyEncipherment</span>
<span class="s">extendedKeyUsage=serverAuth</span>
<span class="s">subjectAltName=@alt_names</span>

<span class="s">[alt_names]</span>
<span class="s">DNS.1 = myserver.example.com</span>
<span class="s">DNS.2 = *.myserver.example.com</span>
<span class="s">IP.1 = 192.168.1.100</span>
<span class="s">EOF</span>

<span class="c1"># 6λ‹¨κ³„: CA ν‚¤λ΅ CSR μ„λ…</span>
openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-sha256<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-in<span class="w"> </span>server.csr<span class="w"> </span>-CA<span class="w"> </span>ca.crt<span class="w"> </span>-CAkey<span class="w"> </span>ca.key<span class="w"> </span>-CAcreateserial<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-out<span class="w"> </span>server.crt<span class="w"> </span>-extfile<span class="w"> </span>server_ext.cnf

<span class="c1"># 7λ‹¨κ³„: μΈμ¦μ„ κ²€μ¦</span>
openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca.crt<span class="w"> </span>server.crt

<span class="c1"># 8λ‹¨κ³„: μΈμ¦μ„ μƒμ„Έ μ •λ³΄ λ³΄κΈ°</span>
openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>server.crt<span class="w"> </span>-text<span class="w"> </span>-noout<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-30

<span class="c1"># 9λ‹¨κ³„: fullchain μƒμ„± (μ„λ²„ μΈμ¦μ„ + CA μΈμ¦μ„)</span>
cat<span class="w"> </span>server.crt<span class="w"> </span>ca.crt<span class="w"> </span>&gt;<span class="w"> </span>fullchain.crt
</code></pre></div>

<h3 id="113-ecdsa">11.3 ECDSA μΈμ¦μ„ (λ” μ‘κ³ , λ” λΉ λ¦„)<a class="header-link" href="#113-ecdsa" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ECDSA ν‚¤ μƒμ„± (P-256 κ³΅μ„ )</span>
openssl<span class="w"> </span>ecparam<span class="w"> </span>-genkey<span class="w"> </span>-name<span class="w"> </span>prime256v1<span class="w"> </span>-out<span class="w"> </span>server_ec.key

<span class="c1"># λλ” Ed25519 (OpenSSL λ²„μ „μ΄ μ§€μ›ν•λ” κ²½μ°)</span>
openssl<span class="w"> </span>genpkey<span class="w"> </span>-algorithm<span class="w"> </span>Ed25519<span class="w"> </span>-out<span class="w"> </span>server_ed25519.key

<span class="c1"># ECDSA ν‚¤λ΅ CSR μƒμ„±</span>
openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-sha256<span class="w"> </span>-key<span class="w"> </span>server_ec.key<span class="w"> </span>-out<span class="w"> </span>server_ec.csr<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=myserver.example.com&quot;</span>

<span class="c1"># μμ²΄ μ„λ… ECDSA μΈμ¦μ„</span>
openssl<span class="w"> </span>req<span class="w"> </span>-x509<span class="w"> </span>-sha256<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-key<span class="w"> </span>server_ec.key<span class="w"> </span>-out<span class="w"> </span>server_ec.crt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=localhost&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-addext<span class="w"> </span><span class="s2">&quot;subjectAltName=DNS:localhost,IP:127.0.0.1&quot;</span>

<span class="c1"># ν¬κΈ° λΉ„κµ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;RSA-2048 μΈμ¦μ„ ν¬κΈ°:&quot;</span>
wc<span class="w"> </span>-c<span class="w"> </span>server.crt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ECDSA P-256 μΈμ¦μ„ ν¬κΈ°:&quot;</span>
wc<span class="w"> </span>-c<span class="w"> </span>server_ec.crt
</code></pre></div>

<h3 id="114-mtls">11.4 mTLSμ© ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„<a class="header-link" href="#114-mtls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ν΄λΌμ΄μ–ΈνΈ ν‚¤ μƒμ„±</span>
openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>client.key<span class="w"> </span><span class="m">2048</span>

<span class="c1"># ν΄λΌμ΄μ–ΈνΈ CSR μƒμ„±</span>
openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-sha256<span class="w"> </span>-key<span class="w"> </span>client.key<span class="w"> </span>-out<span class="w"> </span>client.csr<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=api-client-1/O=My App&quot;</span>

<span class="c1"># CAλ΅ μ„λ… (μ°Έκ³ : extendedKeyUsage = clientAuth)</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>client_ext.cnf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">basicConstraints=CA:FALSE</span>
<span class="s">keyUsage=digitalSignature</span>
<span class="s">extendedKeyUsage=clientAuth</span>
<span class="s">EOF</span>

openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-sha256<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-in<span class="w"> </span>client.csr<span class="w"> </span>-CA<span class="w"> </span>ca.crt<span class="w"> </span>-CAkey<span class="w"> </span>ca.key<span class="w"> </span>-CAcreateserial<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-out<span class="w"> </span>client.crt<span class="w"> </span>-extfile<span class="w"> </span>client_ext.cnf

<span class="c1"># PKCS12 λ²λ“¤ μƒμ„± (λΈλΌμ°μ €/μ•±μΌλ΅ κ°€μ Έμ¤κΈ°μ©)</span>
openssl<span class="w"> </span>pkcs12<span class="w"> </span>-export<span class="w"> </span>-out<span class="w"> </span>client.p12<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-inkey<span class="w"> </span>client.key<span class="w"> </span>-in<span class="w"> </span>client.crt<span class="w"> </span>-certfile<span class="w"> </span>ca.crt

<span class="c1"># ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ κ²€μ¦</span>
openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca.crt<span class="w"> </span>client.crt
</code></pre></div>

<hr />
<h2 id="12">12. μΌλ°μ μΈ μλ»λ κµ¬μ„±<a class="header-link" href="#12" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="err">β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
<span class="err">β”‚</span><span class="w">         </span><span class="err">μΌλ°μ μΈ</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="err">μλ»λ</span><span class="w"> </span><span class="err">κµ¬μ„±κ³Ό</span><span class="w"> </span><span class="err">μμ •</span><span class="w"> </span><span class="err">λ°©λ²•</span><span class="w">                         </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="c1"># β”‚ μλ»λ κµ¬μ„±                  β”‚ μμ • λ°©λ²•                        β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λ κ±°μ‹</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="err">λ²„μ „</span><span class="w"> </span><span class="err">ν™μ„±ν™”</span><span class="w">       </span><span class="err">β”‚</span><span class="w"> </span><span class="n">SSL</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="mf">1.0</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="err">λΉ„ν™μ„±ν™”</span><span class="w">   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="p">(</span><span class="n">TLS</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">SSL</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w">          </span><span class="err">β”‚</span><span class="w"> </span><span class="n">min_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TLSv1</span><span class="o">.</span><span class="mi">2</span><span class="w">           </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μ•½ν•</span><span class="w"> </span><span class="err">μ•”νΈν™”</span><span class="w"> </span><span class="err">μ¤μ„νΈ</span><span class="w">           </span><span class="err">β”‚</span><span class="w"> </span><span class="n">ECDHEλ¥Ό</span><span class="w"> </span><span class="err">μ‚¬μ©ν•λ”</span><span class="w"> </span><span class="n">AEADλ§</span><span class="w"> </span><span class="err">μ‚¬μ©</span><span class="w">    </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="p">(</span><span class="n">RC4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="n">DES</span><span class="p">,</span><span class="w"> </span><span class="n">CBC</span><span class="p">,</span><span class="w"> </span><span class="err">μ •μ </span><span class="w"> </span><span class="n">RSA</span><span class="p">)</span><span class="w">  </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λ¨λ“ </span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">FS</span><span class="w"> </span><span class="err">μ¤μ„νΈ</span><span class="w"> </span><span class="err">λΉ„ν™μ„±ν™”</span><span class="w">     </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">ν”„λ΅λ•μ…μ—μ„</span><span class="w"> </span><span class="err">μμ²΄</span><span class="w"> </span><span class="err">μ„λ…</span><span class="w"> </span><span class="err">μΈμ¦μ„β”‚</span><span class="w"> </span><span class="n">Let</span><span class="s1">&#39;s Encrypt μ‚¬μ© (λ¬΄λ£!)      β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μμ²΄</span><span class="w"> </span><span class="err">μ„λ…μ€</span><span class="w"> </span><span class="err">κ°λ°</span><span class="o">/</span><span class="err">ν…μ¤νΈμ©λ§</span><span class="w">     </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λ§λ£λ</span><span class="w"> </span><span class="err">μΈμ¦μ„</span><span class="w">                </span><span class="err">β”‚</span><span class="w"> </span><span class="n">certbotμΌλ΅</span><span class="w"> </span><span class="err">μλ™</span><span class="w"> </span><span class="err">κ°±μ‹ </span><span class="w">           </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μ™Έλ¶€</span><span class="w"> </span><span class="err">λ„κµ¬λ΅</span><span class="w"> </span><span class="err">λ¨λ‹ν„°λ§</span><span class="w">            </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μ¤‘κ°„</span><span class="w"> </span><span class="err">μΈμ¦μ„</span><span class="w"> </span><span class="err">λ„λ½</span><span class="w">             </span><span class="err">β”‚</span><span class="w"> </span><span class="err">ν•­μƒ</span><span class="w"> </span><span class="err">μ „μ²΄</span><span class="w"> </span><span class="err">μ²΄μΈ</span><span class="w"> </span><span class="err">μ „μ†΅</span><span class="w">             </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="p">(</span><span class="err">λ¶μ™„μ „ν•</span><span class="w"> </span><span class="err">μ²΄μΈ</span><span class="p">)</span><span class="w">              </span><span class="err">β”‚</span><span class="w"> </span><span class="p">(</span><span class="n">fullchain</span><span class="o">.</span><span class="n">pem</span><span class="p">,</span><span class="w"> </span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span><span class="w"> </span><span class="err">μ•„λ‹</span><span class="p">)</span><span class="w">  </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="n">HSTS</span><span class="w"> </span><span class="err">ν—¤λ”</span><span class="w"> </span><span class="err">μ—†μ</span><span class="w">               </span><span class="err">β”‚</span><span class="w"> </span><span class="n">Strict</span><span class="o">-</span><span class="n">Transport</span><span class="o">-</span><span class="n">Security</span><span class="w"> </span><span class="err">μ¶”κ°€</span><span class="w">  </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">κΈ΄</span><span class="w"> </span><span class="nb">max</span><span class="o">-</span><span class="n">ageμ™€</span><span class="w"> </span><span class="err">ν•¨κ»</span><span class="w">               </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="n">HTTPμ—μ„</span><span class="w"> </span><span class="n">HTTPSλ΅</span><span class="w"> </span><span class="err">λ¦¬λ‹¤μ΄λ ‰νΈ</span><span class="w">  </span><span class="err">β”‚</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="err">μκµ¬</span><span class="w"> </span><span class="err">λ¦¬λ‹¤μ΄λ ‰νΈ</span><span class="w"> </span><span class="err">μ‚¬μ©</span><span class="w">        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λ„λ½</span><span class="w">                         </span><span class="err">β”‚</span><span class="w"> </span><span class="n">HSTS</span><span class="w"> </span><span class="nb">preload</span><span class="w"> </span><span class="err">λ©λ΅</span><span class="w"> </span><span class="err">λ“±λ΅</span><span class="w">          </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">κ°μΈ</span><span class="w"> </span><span class="err">ν‚¤</span><span class="w"> </span><span class="err">κ¶ν•μ΄</span><span class="w"> </span><span class="err">λ„λ¬΄</span><span class="w"> </span><span class="err">λμ¨ν•¨</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="n">chmod</span><span class="w"> </span><span class="mi">600</span><span class="err">μΌλ΅</span><span class="w"> </span><span class="err">ν‚¤</span><span class="w"> </span><span class="err">νμΌ</span><span class="w"> </span><span class="err">μ„¤μ •</span><span class="w">      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="p">(</span><span class="n">world</span><span class="o">-</span><span class="n">readable</span><span class="p">)</span><span class="w">             </span><span class="err">β”‚</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="err">λλ”</span><span class="w"> </span><span class="n">www</span><span class="o">-</span><span class="n">dataλ§</span><span class="w"> </span><span class="err">μ†μ </span><span class="w">       </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="err">μ••μ¶•</span><span class="w"> </span><span class="err">ν™μ„±ν™”</span><span class="w">              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λΉ„ν™μ„±ν™”</span><span class="w"> </span><span class="p">(</span><span class="n">CRIME</span><span class="w"> </span><span class="err">κ³µκ²©</span><span class="w"> </span><span class="err">λ°©μ§€</span><span class="p">)</span><span class="w">      </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="n">ssl_options</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">OP_NO_COMPRESSION</span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="mi">10</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="n">OCSP</span><span class="w"> </span><span class="err">μ¤ν…μ΄ν”λ§</span><span class="w"> </span><span class="err">μ—†μ</span><span class="w">         </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μ„λ²„</span><span class="w"> </span><span class="err">κµ¬μ„±μ—μ„</span><span class="w"> </span><span class="n">OCSP</span><span class="w"> </span><span class="err">μ¤ν…μ΄ν”λ§</span><span class="w">   </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">ν™μ„±ν™”</span><span class="w"> </span><span class="p">(</span><span class="err">μ„±λ¥</span><span class="w"> </span><span class="err">ν–¥μƒ</span><span class="p">)</span><span class="w">              </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="mi">11</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">κ³µκ°</span><span class="w"> </span><span class="err">μ‚¬μ΄νΈμ—</span><span class="w"> </span><span class="err">μ™€μΌλ“μΉ΄λ“</span><span class="w">     </span><span class="err">β”‚</span><span class="w"> </span><span class="err">νΉμ •</span><span class="w"> </span><span class="err">λ„λ©”μΈμΌλ΅</span><span class="w"> </span><span class="n">SAN</span><span class="w"> </span><span class="err">μ‚¬μ©</span><span class="w">        </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μΈμ¦μ„</span><span class="w"> </span><span class="err">μ‚¬μ©</span><span class="w">                  </span><span class="err">β”‚</span><span class="w"> </span><span class="err">μ™€μΌλ“μΉ΄λ“λ”</span><span class="w"> </span><span class="err">λ‚΄λ¶€μ©λ§</span><span class="w">           </span><span class="err">β”‚</span>
<span class="err">β”β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤</span>
<span class="err">β”‚</span><span class="mi">12</span><span class="w"> </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λ°±μ—…</span><span class="w"> </span><span class="err">ν•€</span><span class="w"> </span><span class="err">μ—†λ”</span><span class="w"> </span><span class="err">μΈμ¦μ„</span><span class="w"> </span><span class="err">ν”Όλ‹</span><span class="w">     </span><span class="err">β”‚</span><span class="w"> </span><span class="err">ν•­μƒ</span><span class="w"> </span><span class="err">λ°±μ—…</span><span class="w"> </span><span class="err">ν•€</span><span class="w"> </span><span class="err">ν¬ν•¨</span><span class="w">               </span><span class="err">β”‚</span>
<span class="err">β”‚</span><span class="w">   </span><span class="err">β”‚</span><span class="w">                              </span><span class="err">β”‚</span><span class="w"> </span><span class="err">λλ”</span><span class="w"> </span><span class="err">ν”Όλ‹</span><span class="w"> </span><span class="err">λ€μ‹ </span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="err">μ‚¬μ©</span><span class="w">          </span><span class="err">β”‚</span>
<span class="err">β””β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”</span>
</code></pre></div>

<h3 id="121">12.1 λ³΄μ• ν—¤λ” μ²΄ν¬λ¦¬μ¤νΈ<a class="header-link" href="#121" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># HTTPS μ‚¬μ΄νΈμ— κ¶μ¥λλ” λ³΄μ• ν—¤λ”</span>

<span class="n">SECURITY_HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># 2λ…„κ°„ HTTPS κ°•μ , ν•μ„ λ„λ©”μΈ ν¬ν•¨</span>
    <span class="s2">&quot;Strict-Transport-Security&quot;</span><span class="p">:</span> <span class="s2">&quot;max-age=63072000; includeSubDomains; preload&quot;</span><span class="p">,</span>

    <span class="c1"># MIME νƒ€μ… μ¤λ‹ν•‘ λ°©μ§€</span>
    <span class="s2">&quot;X-Content-Type-Options&quot;</span><span class="p">:</span> <span class="s2">&quot;nosniff&quot;</span><span class="p">,</span>

    <span class="c1"># ν΄λ¦­μ¬ν‚Ή λ°©μ§€</span>
    <span class="s2">&quot;X-Frame-Options&quot;</span><span class="p">:</span> <span class="s2">&quot;DENY&quot;</span><span class="p">,</span>

    <span class="c1"># XSS ν•„ν„° ν™μ„±ν™” (λ κ±°μ‹ λΈλΌμ°μ €)</span>
    <span class="s2">&quot;X-XSS-Protection&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>  <span class="c1"># &quot;0&quot;μ΄ μ΄μ  κ¶μ¥λ¨ (CSPκ°€ λ” λ‚μ)</span>

    <span class="c1"># μ½ν…μΈ  λ³΄μ• μ •μ±…</span>
    <span class="s2">&quot;Content-Security-Policy&quot;</span><span class="p">:</span> <span class="s2">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;; style-src &#39;self&#39;&quot;</span><span class="p">,</span>

    <span class="c1"># λ¦¬νΌλ¬ μ •μ±…</span>
    <span class="s2">&quot;Referrer-Policy&quot;</span><span class="p">:</span> <span class="s2">&quot;strict-origin-when-cross-origin&quot;</span><span class="p">,</span>

    <span class="c1"># κ¶ν• μ •μ±… (μ΄μ „ Feature-Policy)</span>
    <span class="s2">&quot;Permissions-Policy&quot;</span><span class="p">:</span> <span class="s2">&quot;camera=(), microphone=(), geolocation=()&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Flask μμ </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">make_response</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">after_request</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_security_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">SECURITY_HEADERS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>

<hr />
<h2 id="13-tls_1">13. TLS κµ¬μ„± ν…μ¤νΈ<a class="header-link" href="#13-tls_1" title="Permanent link">&para;</a></h2>
<h3 id="131">13.1 λ…λ Ήμ¤„ λ„κµ¬<a class="header-link" href="#131" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># OpenSSL s_clientλ΅ TLS μ—°κ²° ν…μ¤νΈ</span>
openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com

<span class="c1"># μ „μ²΄ μΈμ¦μ„ μ²΄μΈ ν‘μ‹</span>
openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span>-showcerts

<span class="c1"># νΉμ • TLS λ²„μ „ ν…μ¤νΈ</span>
openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-tls1_3
openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-tls1_2

<span class="c1"># μΈμ¦μ„ λ§λ£ ν™•μΈ</span>
<span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-dates

<span class="c1"># μ§€μ›λλ” μ•”νΈν™” μ¤μ„νΈ ν™•μΈ</span>
nmap<span class="w"> </span>--script<span class="w"> </span>ssl-enum-ciphers<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span><span class="w"> </span>example.com

<span class="c1"># testssl.shλ΅ ν…μ¤νΈ (μΆ…ν•© μ¤μΊλ„)</span>
<span class="c1"># git clone https://github.com/drwetter/testssl.sh.git</span>
./testssl.sh<span class="w"> </span>example.com

<span class="c1"># sslyzeλ΅ ν…μ¤νΈ</span>
pip<span class="w"> </span>install<span class="w"> </span>sslyze
sslyze<span class="w"> </span>example.com
</code></pre></div>

<h3 id="132-python-tls">13.2 Python TLS μ¤μΊλ„<a class="header-link" href="#132-python-tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TLSScanResult</span><span class="p">:</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">supported_protocols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">certificate_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">cipher_suite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">issues</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">recommendations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">scan_tls</span><span class="p">(</span><span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">443</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TLSScanResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μ„λ²„μ TLS κµ¬μ„±μ„ μ¤μΊ”ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">TLSScanResult</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>

    <span class="c1"># μ§€μ›λλ” ν”„λ΅ν† μ½ ν…μ¤νΈ</span>
    <span class="n">protocols</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;TLSv1.0&quot;</span><span class="p">:</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1</span><span class="p">,</span>
        <span class="s2">&quot;TLSv1.1&quot;</span><span class="p">:</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_1</span><span class="p">,</span>
        <span class="s2">&quot;TLSv1.2&quot;</span><span class="p">:</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_2</span><span class="p">,</span>
        <span class="s2">&quot;TLSv1.3&quot;</span><span class="p">:</span> <span class="n">ssl</span><span class="o">.</span><span class="n">TLSVersion</span><span class="o">.</span><span class="n">TLSv1_3</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">protocols</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLS_CLIENT</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">minimum_version</span> <span class="o">=</span> <span class="n">version</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">maximum_version</span> <span class="o">=</span> <span class="n">version</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">check_hostname</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">load_default_certs</span><span class="p">()</span>

            <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">supported_protocols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;TLSv1.0&quot;</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TLS 1.0 μ§€μ›λ¨ (νκΈ°λ¨)&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;TLSv1.1&quot;</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TLS 1.1 μ§€μ›λ¨ (νκΈ°λ¨)&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">SSLError</span><span class="p">,</span> <span class="ne">ConnectionRefusedError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
            <span class="k">pass</span>

    <span class="c1"># μ‚¬μ© κ°€λ¥ν• μµμƒμ ν”„λ΅ν† μ½λ΅ μΈμ¦μ„ λ° μ•”νΈν™” μ •λ³΄ κ°€μ Έμ¤κΈ°</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
                <span class="c1"># ν”„λ΅ν† μ½ λ° μ•”νΈν™”</span>
                <span class="n">result</span><span class="o">.</span><span class="n">cipher_suite</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">cipher</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># μΈμ¦μ„ μ •λ³΄</span>
                <span class="n">cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>
                <span class="n">result</span><span class="o">.</span><span class="n">certificate_info</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="p">())),</span>
                    <span class="s2">&quot;issuer&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issuer&quot;</span><span class="p">,</span> <span class="p">())),</span>
                    <span class="s2">&quot;notAfter&quot;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;notAfter&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;notBefore&quot;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;notBefore&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;serialNumber&quot;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;serialNumber&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;san&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subjectAltName&quot;</span><span class="p">,</span> <span class="p">())</span>
                    <span class="p">],</span>
                <span class="p">}</span>

                <span class="c1"># λ§λ£ ν™•μΈ</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
                <span class="n">not_after</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">cert_time_to_seconds</span><span class="p">(</span><span class="n">cert</span><span class="p">[</span><span class="s2">&quot;notAfter&quot;</span><span class="p">])</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
                <span class="n">days_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">/</span> <span class="mi">86400</span>
                <span class="k">if</span> <span class="n">days_left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μΈμ¦μ„ λ§λ£λ¨ </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">days_left</span><span class="p">)</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">μΌ μ „!&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">days_left</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μΈμ¦μ„κ°€ </span><span class="si">{</span><span class="n">days_left</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">μΌ ν›„μ— λ§λ£λ¨!&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μ—°κ²° μ¤λ¥: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># κ¶μ¥ μ‚¬ν•­ μƒμ„±</span>
    <span class="k">if</span> <span class="s2">&quot;TLSv1.3&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">supported_protocols</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;λ” λ‚μ€ λ³΄μ•κ³Ό μ„±λ¥μ„ μ„ν•΄ TLS 1.3 ν™μ„±ν™”&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;TLSv1.0&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">supported_protocols</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TLS 1.0 λΉ„ν™μ„±ν™” (2020λ…„λ¶€ν„° νκΈ°λ¨)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;TLSv1.1&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">supported_protocols</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TLS 1.1 λΉ„ν™μ„±ν™” (2020λ…„λ¶€ν„° νκΈ°λ¨)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;κµ¬μ„±μ΄ μ–‘νΈν•©λ‹λ‹¤!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_scan_result</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">TLSScanResult</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TLS μ¤μΊ” κ²°κ³Όλ¥Ό λ³΄κΈ° μΆ‹κ² μ¶λ ¥ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">TLS μ¤μΊ”: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">hostname</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">μ§€μ›λλ” ν”„λ΅ν† μ½:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">proto</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">supported_protocols</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;[!!]&quot;</span> <span class="k">if</span> <span class="s2">&quot;1.0&quot;</span> <span class="ow">in</span> <span class="n">proto</span> <span class="ow">or</span> <span class="s2">&quot;1.1&quot;</span> <span class="ow">in</span> <span class="n">proto</span> <span class="k">else</span> <span class="s2">&quot;[OK]&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">proto</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">cipher_suite</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ν‘μƒλ μ•”νΈν™”: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">cipher_suite</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">certificate_info</span><span class="p">:</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">certificate_info</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">μΈμ¦μ„:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Subject: </span><span class="si">{</span><span class="n">ci</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;commonName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Issuer:  </span><span class="si">{</span><span class="n">ci</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;issuer&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;commonName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Valid:   </span><span class="si">{</span><span class="n">ci</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notBefore&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">ci</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notAfter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ci</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;san&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SANs:    </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ci</span><span class="p">[</span><span class="s1">&#39;san&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">λ¬Έμ μ  (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!!] </span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">κ¶μ¥ μ‚¬ν•­:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">recommendations</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  --&gt; </span><span class="si">{</span><span class="n">rec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># μ¤μΊ” μ‹¤ν–‰</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">scan_tls</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
    <span class="n">print_scan_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μ¤μΊ” μ‹¤ν¨ (λ„¤νΈμ›ν¬ ν•„μ”): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="133">13.3 μ§€μ†μ μΈ μΈμ¦μ„ λ¨λ‹ν„°λ§<a class="header-link" href="#133" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CertMonitorEntry</span><span class="p">:</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">443</span>
    <span class="n">warning_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>   <span class="c1"># μ΄λ³΄λ‹¤ μ μ€ μΌμ λ‚¨μΌλ©΄ κ²½κ³ </span>
    <span class="n">critical_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span>   <span class="c1"># μ΄λ³΄λ‹¤ μ μ€ μΌμ λ‚¨μΌλ©΄ μΉλ…μ </span>

<span class="k">class</span><span class="w"> </span><span class="nc">CertificateMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;μ—¬λ¬ λ„λ©”μΈμ μΈμ¦μ„ λ§λ£λ¥Ό λ¨λ‹ν„°λ§ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CertMonitorEntry</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">CertMonitorEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;λ‹¨μΌ μΈμ¦μ„μ λ§λ£λ¥Ό ν™•μΈν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
                <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span>
                    <span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">hostname</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
                    <span class="n">cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>
                    <span class="n">not_after</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">cert_time_to_seconds</span><span class="p">(</span><span class="n">cert</span><span class="p">[</span><span class="s2">&quot;notAfter&quot;</span><span class="p">])</span>
                    <span class="n">days_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">/</span> <span class="mi">86400</span>

                    <span class="k">if</span> <span class="n">days_left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;EXPIRED&quot;</span>
                    <span class="k">elif</span> <span class="n">days_left</span> <span class="o">&lt;</span> <span class="n">entry</span><span class="o">.</span><span class="n">critical_days</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;CRITICAL&quot;</span>
                    <span class="k">elif</span> <span class="n">days_left</span> <span class="o">&lt;</span> <span class="n">entry</span><span class="o">.</span><span class="n">warning_days</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;WARNING&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;OK&quot;</span>

                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
                        <span class="s2">&quot;days_remaining&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">days_left</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="s2">&quot;expires&quot;</span><span class="p">:</span> <span class="n">cert</span><span class="p">[</span><span class="s2">&quot;notAfter&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;issuer&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cert</span><span class="p">[</span><span class="s2">&quot;issuer&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="s2">&quot;commonName&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span>
                        <span class="p">),</span>
                        <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">ssock</span><span class="o">.</span><span class="n">version</span><span class="p">(),</span>
                    <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;λ¨λ“  λ¨λ‹ν„°λ§λλ” μΈμ¦μ„λ¥Ό ν™•μΈν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_certificate</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ν•μ‹ν™”λ λ¨λ‹ν„°λ§ λ³΄κ³ μ„λ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">μΈμ¦μ„ λ¨λ‹ν„°λ§ λ³΄κ³ μ„&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;μƒμ„± μ‹κ°: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

        <span class="n">status_icons</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;OK&quot;</span><span class="p">:</span> <span class="s2">&quot;[OK]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;WARNING&quot;</span><span class="p">:</span> <span class="s2">&quot;[!!]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;CRITICAL&quot;</span><span class="p">:</span> <span class="s2">&quot;[XX]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EXPIRED&quot;</span><span class="p">:</span> <span class="s2">&quot;[XX]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span> <span class="s2">&quot;[??]&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;days_remaining&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">)):</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="n">status_icons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">],</span> <span class="s2">&quot;[??]&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;days_remaining&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">30s</span><span class="si">}</span><span class="s2"> &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;days_remaining&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">6.0f</span><span class="si">}</span><span class="s2"> μΌ  &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">30s</span><span class="si">}</span><span class="s2"> &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;N/A&#39;</span><span class="si">:</span><span class="s2">&gt;6s</span><span class="si">}</span><span class="s2">       &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># μ‚¬μ©λ²•</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">CertificateMonitor</span><span class="p">([</span>
    <span class="n">CertMonitorEntry</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">),</span>
    <span class="n">CertMonitorEntry</span><span class="p">(</span><span class="s2">&quot;github.com&quot;</span><span class="p">),</span>
    <span class="n">CertMonitorEntry</span><span class="p">(</span><span class="s2">&quot;expired.badssl.com&quot;</span><span class="p">),</span>  <span class="c1"># ν…μ¤νΈμ© λ§λ£λ μΈμ¦μ„</span>
<span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">check_all</span><span class="p">()</span>
    <span class="n">monitor</span><span class="o">.</span><span class="n">print_report</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;λ¨λ‹ν„°λ§μ—λ” λ„¤νΈμ›ν¬ μ•΅μ„Έμ¤κ°€ ν•„μ”ν•©λ‹λ‹¤: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="14">14. μ—°μµ λ¬Έμ <a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<h3 id="1-tls_1">μ—°μµ λ¬Έμ  1: TLS ν•Έλ“μ…°μ΄ν¬ μ¶”μ  (μ΄κΈ‰)<a class="header-link" href="#1-tls_1" title="Permanent link">&para;</a></h3>
<p><code>openssl s_client</code>λ¥Ό μ‚¬μ©ν•μ—¬ μ„Έ κ°μ λ‹¤λ¥Έ μ›Ήμ‚¬μ΄νΈμ— μ—°κ²°ν•κ³  λ‹¤μ μ§λ¬Έμ— λ‹µν•μ„Έμ”:
1. μ–΄λ–¤ TLS λ²„μ „μ΄ ν‘μƒλμ—λ‚μ”?
2. μ–΄λ–¤ μ•”νΈν™” μ¤μ„νΈκ°€ μ„ νƒλμ—λ‚μ”?
3. μ²΄μΈμ— λ‡ κ°μ μΈμ¦μ„κ°€ μλ‚μ”?
4. λ£¨νΈ CAλ” λ¬΄μ—‡μΈκ°€μ”?
5. λ¦¬ν”„ μΈμ¦μ„λ” μ–Έμ  λ§λ£λλ‚μ”?</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ν…ν”λ¦Ώ λ…λ Ήμ–΄:</span>
<span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>&lt;host&gt;:443<span class="w"> </span>-servername<span class="w"> </span>&lt;host&gt;<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>

<p>google.com, github.com, letsencrypt.orgμ— λ€ν• κ²°κ³Όλ¥Ό λΉ„κµν•μ„Έμ”.</p>
<h3 id="2">μ—°μµ λ¬Έμ  2: μΈμ¦μ„ μƒμ„± μ‹¤μµ (μ¤‘κΈ‰)<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<p>Pythonμ <code>cryptography</code> λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬:
1. 4096λΉ„νΈ RSA ν‚¤λ΅ λ£¨νΈ CA μƒμ„± (10λ…„ μ ν¨)
2. λ£¨νΈκ°€ μ„λ…ν• μ¤‘κ°„ CA μƒμ„± (5λ…„ μ ν¨)
3. μ¤‘κ°„ CAκ°€ μ„λ…ν• μ„λ²„ μΈμ¦μ„ μƒμ„± (90μΌ μ ν¨)
4. λ¨λ“  μΈμ¦μ„μ™€ ν‚¤λ¥Ό PEM νμΌλ΅ μ‘μ„±
5. μ „μ²΄ μ²΄μΈμ„ ν”„λ΅κ·Έλλ° λ°©μ‹μΌλ΅ κ²€μ¦
6. <code>openssl verify</code>λ΅ μ²΄μΈ ν…μ¤νΈ</p>
<h3 id="3-mtls">μ—°μµ λ¬Έμ  3: mTLS μ„λΉ„μ¤ (μ¤‘κΈ‰)<a class="header-link" href="#3-mtls" title="Permanent link">&para;</a></h3>
<p>mTLSλ΅ λ³΄νΈλλ” κ°„λ‹¨ν• HTTP API κµ¬μ¶•:
1. CA, μ„λ²„, λ‘ κ°μ ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ μƒμ„±
2. ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„λ¥Ό μ”κµ¬ν•λ” Flask/HTTP μ„λ²„ μ‘μ„±
3. μΈμ¦μ„μ—μ„ ν΄λΌμ΄μ–ΈνΈμ Common Name μ¶”μ¶
4. ν΄λΌμ΄μ–ΈνΈ CN κΈ°λ° κ¶ν• λ¶€μ—¬ κµ¬ν„
5. μΈμ¦μ„λ¥Ό μ μ‹ν•λ” ν΄λΌμ΄μ–ΈνΈ μ‘μ„±
6. μ ν¨ν• ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„ μ—†λ” μ—°κ²°μ΄ κ±°λ¶€λ¨μ„ λ³΄μ—¬μ£ΌκΈ°</p>
<h3 id="4-tls">μ—°μµ λ¬Έμ  4: TLS κµ¬μ„± κ°μ‚¬κΈ° (κ³ κΈ‰)<a class="header-link" href="#4-tls" title="Permanent link">&para;</a></h3>
<p>λ‹¤μμ„ ν™•μΈν•λ” μΆ…ν•© TLS μ¤μΊλ„ κµ¬μ¶•:
1. μ§€μ›λλ” TLS λ²„μ „ (TLS 1.0/1.1μ„ νκΈ°λ κ²ƒμΌλ΅ ν”λκ·Έ)
2. μ§€μ›λλ” μ•”νΈν™” μ¤μ„νΈ (μ•½ν• κ²ƒ ν”λκ·Έ)
3. μΈμ¦μ„ μ²΄μΈ μ™„μ „μ„±
4. μΈμ¦μ„ λ§λ£ λ‚ μ§
5. HSTS ν—¤λ” μ΅΄μ¬ λ° max-age
6. OCSP μ¤ν…μ΄ν”λ§ μƒνƒ
7. ν‚¤ ν¬κΈ° (RSA &lt; 2048 λλ” ECDSA &lt; 256 ν”λκ·Έ)
8. μ „λ°©ν–¥ μ•μ „μ„± μ§€μ›
9. SSL Labsμ™€ μ μ‚¬ν• μ μ μ¶λ ¥ (A+μ—μ„ FκΉμ§€)</p>
<h3 id="5_1">μ—°μµ λ¬Έμ  5: μΈμ¦μ„ λ¨λ‹ν„°λ§ μ‹μ¤ν… (κ³ κΈ‰)<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>ν”„λ΅λ•μ… ν’μ§μ μΈμ¦μ„ λ¨λ‹ν„°λ§ μ‹μ¤ν… κµ¬μ¶•:
1. YAML/JSON κµ¬μ„± νμΌμ—μ„ λ„λ©”μΈ λ©λ΅ μλ½
2. μΌμ •μ— λ”°λΌ μΈμ¦μ„ λ§λ£ ν™•μΈ (cron νΈν™)
3. λ‹¤μκ³Ό κ°™μ€ κ²½μ° μ•λ¦Ό μ „μ†΅ (μ΄λ©”μΌ/Slack/webhook):
   - 30μΌ λ‚΄ λ§λ£ (κ²½κ³ )
   - 7μΌ λ‚΄ λ§λ£ (μΉλ…μ )
   - μ΄λ―Έ λ§λ£λ¨ (κΈ΄κΈ‰)
4. μΈμ¦μ„ λ³€κ²½ μ¶”μ  (λ°κΈ‰μ λ³€κ²½, ν‚¤ λ³€κ²½)
5. μ¶”μ„Έ λ¶„μ„μ„ μ„ν•΄ SQLiteμ— μ΄λ ¥ μ €μ¥
6. HTML λ³΄κ³ μ„ μƒμ„±</p>
<h3 id="6-tls">μ—°μµ λ¬Έμ  6: λ‹¨μν™”λ TLS κµ¬ν„ (κµμ΅μ©)<a class="header-link" href="#6-tls" title="Permanent link">&para;</a></h3>
<p>TLS ν•Έλ“μ…°μ΄ν¬μ λ‹¨μν™”λ λ²„μ „ κµ¬μ¶• (κµμ΅μ©, ν”„λ΅λ•μ…μ© μ•„λ‹):
1. ν΄λΌμ΄μ–ΈνΈ μ „μ†΅: μ§€μ›λλ” μ•”νΈν™” μ¤μ„νΈ, λ‚μ nonce, X25519 κ³µκ° ν‚¤
2. μ„λ²„ μ‘λ‹µ: μ„ νƒλ μ•”νΈν™”, λ‚μ nonce, X25519 κ³µκ° ν‚¤, μΈμ¦μ„
3. λ‘ λ‹¤ X25519λ¥Ό μ‚¬μ©ν•μ—¬ κ³µμ  λΉ„λ°€ νμƒ
4. λ‘ λ‹¤ HKDFλ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™” ν‚¤ νμƒ
5. μ„λ²„ μ „μ†΅: ν•Έλ“μ…°μ΄ν¬ μ „μ‚¬λ³Έμ— λ€ν• μ„λ…
6. ν΄λΌμ΄μ–ΈνΈκ°€ μΈμ¦μ„μ κ³µκ° ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ„λ… κ²€μ¦
7. λ‘ λ‹¤ AES-GCMμ„ μ‚¬μ©ν•μ—¬ μ•”νΈν™”λ λ©”μ‹μ§€ κµν™</p>
<p>μ΄ μ—°μµ λ¬Έμ λ” μ‹¤μ  ν”„λ΅ν† μ½μ μ „μ²΄ λ³µμ΅μ„± μ—†μ΄ TLS 1.3μ ν•µμ‹¬ λ©”μ»¤λ‹μ¦μ„ μ‹μ—°ν•©λ‹λ‹¤.</p>
<hr />
<h2 id="15">15. μ°Έκ³  μλ£<a class="header-link" href="#15" title="Permanent link">&para;</a></h2>
<ul>
<li>Rescorla, E. (2018). <em>The Transport Layer Security (TLS) Protocol Version 1.3</em> (RFC 8446).</li>
<li>Mozilla Server Side TLS - https://wiki.mozilla.org/Security/Server_Side_TLS</li>
<li>SSL Labs Best Practices - https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices</li>
<li>Let's Encrypt Documentation - https://letsencrypt.org/docs/</li>
<li>RFC 8555: Automatic Certificate Management Environment (ACME)</li>
<li>RFC 6125: Representation and Verification of Domain-Based Application Service Identity</li>
<li>Bulletproof TLS and PKI (Ivan Ristic, 2022) - https://www.feistyduck.com/books/bulletproof-tls-and-pki/</li>
<li>Certificate Transparency - https://certificate.transparency.dev/</li>
<li>testssl.sh - https://testssl.sh/</li>
<li>Python <code>cryptography</code> library - https://cryptography.io/</li>
<li>BadSSL.com - https://badssl.com/ (λ‹¤μ–‘ν• TLS μλ»λ κµ¬μ„± ν…μ¤νΈ)</li>
</ul>
<hr />
<p><strong>μ΄μ „</strong>: <a href="./03_Hashing_and_Integrity.md">03. ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</a> | <strong>λ‹¤μ</strong>: <a href="./05_Authentication.md">05. μΈμ¦ μ‹μ¤ν…</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/03_Hashing_and_Integrity.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ν•΄μ‹±κ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">π”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">π“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/05_Authentication.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">05. μΈμ¦ μ‹μ¤ν…</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">β†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}