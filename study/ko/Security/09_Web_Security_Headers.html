{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Security Headersì™€ CSP - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">Web Security Headersì™€ CSP</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Web Security Headersì™€ CSP</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/08_Injection_Attacks.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">08. ì¸ì ì…˜ ê³µê²©ê³¼ ë°©ì–´</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/10_API_Security.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">API ë³´ì•ˆ</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ë³´ì•ˆ í—¤ë” ê°œìš”</a><ul>
<li><a href="#11">1.1 ë³´ì•ˆ í—¤ë”ê°€ ì¤‘ìš”í•œ ì´ìœ </a></li>
<li><a href="#12">1.2 ì‹¬ì¸µ ë°©ì–´</a></li>
<li><a href="#13">1.3 ë¹ ë¥¸ ì°¸ì¡° í…Œì´ë¸”</a></li>
</ul>
</li>
<li><a href="#2-content-security-policy-csp">2. Content-Security-Policy (CSP)</a><ul>
<li><a href="#21-csp">2.1 CSPë€ ë¬´ì—‡ì¸ê°€?</a></li>
<li><a href="#22-csp">2.2 CSP ì§€ì‹œë¬¸</a></li>
<li><a href="#23">2.3 ì†ŒìŠ¤ ê°’</a></li>
<li><a href="#24-csp">2.4 CSP ì •ì±… ë‹¨ê³„ë³„ êµ¬ì¶•</a></li>
<li><a href="#25-csp">2.5 CSP ë³´ê³ </a></li>
<li><a href="#26-csp">2.6 ì¼ë°˜ì ì¸ CSP ì‹¤ìˆ˜</a></li>
</ul>
</li>
<li><a href="#3-strict-transport-security-hsts">3. Strict-Transport-Security (HSTS)</a><ul>
<li><a href="#31-hsts">3.1 HSTS ì‘ë™ ë°©ì‹</a></li>
<li><a href="#32-hsts">3.2 HSTS ì§€ì‹œë¬¸</a></li>
</ul>
</li>
<li><a href="#4-x-content-type-options">4. X-Content-Type-Options</a><ul>
<li><a href="#41-mime">4.1 MIME ìŠ¤ë‹ˆí•‘ ê³µê²©</a></li>
<li><a href="#42">4.2 êµ¬ì„±</a></li>
</ul>
</li>
<li><a href="#5-x-frame-options-frame-ancestors">5. X-Frame-Optionsì™€ frame-ancestors</a><ul>
<li><a href="#51">5.1 í´ë¦­ì¬í‚¹ ë°©ì§€</a></li>
<li><a href="#52-x-frame-options">5.2 X-Frame-Options ê°’</a></li>
<li><a href="#53-csp-frame-ancestors">5.3 CSP frame-ancestors (ìµœì‹  ëŒ€ì²´)</a></li>
</ul>
</li>
<li><a href="#6-referrer-policy">6. Referrer-Policy</a><ul>
<li><a href="#61-referrer">6.1 Referrer ì •ë³´ ìœ ì¶œ</a></li>
<li><a href="#62">6.2 ì •ì±… ê°’</a></li>
</ul>
</li>
<li><a href="#7-permissions-policy">7. Permissions-Policy</a><ul>
<li><a href="#71">7.1 ë¸Œë¼ìš°ì € ê¸°ëŠ¥ ì œí•œ</a></li>
<li><a href="#72">7.2 êµ¬ì„± ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#8-cross-origin-corp-coep-coop">8. Cross-Origin ì •ì±… (CORP, COEP, COOP)</a><ul>
<li><a href="#81">8.1 ê°œìš”</a></li>
<li><a href="#82-cross-origin-resource-policy-corp">8.2 Cross-Origin-Resource-Policy (CORP)</a></li>
<li><a href="#83-cross-origin-embedder-policy-coep">8.3 Cross-Origin-Embedder-Policy (COEP)</a></li>
<li><a href="#84-cross-origin-opener-policy-coop">8.4 Cross-Origin-Opener-Policy (COOP)</a></li>
</ul>
</li>
<li><a href="#9-subresource-integrity-sri">9. Subresource Integrity (SRI)</a><ul>
<li><a href="#91-sri">9.1 SRI ì‘ë™ ë°©ì‹</a></li>
<li><a href="#92-sri">9.2 SRI í•´ì‹œ ìƒì„±</a></li>
</ul>
</li>
<li><a href="#10-flask">10. Flask ë³´ì•ˆ í—¤ë” êµ¬ì„±</a><ul>
<li><a href="#101">10.1 ìˆ˜ë™ í—¤ë” ì„¤ì •</a></li>
<li><a href="#102">10.2 ë¼ìš°íŠ¸ë³„ í—¤ë” ì¬ì •ì˜</a></li>
</ul>
</li>
<li><a href="#11-django">11. Django ë³´ì•ˆ í—¤ë” êµ¬ì„±</a><ul>
<li><a href="#111-django">11.1 Django ì„¤ì •</a></li>
<li><a href="#112-django-csp-django-csp">11.2 django-cspë¥¼ ì‚¬ìš©í•œ Django CSP</a></li>
</ul>
</li>
<li><a href="#12_1">12. ë³´ì•ˆ í—¤ë” í…ŒìŠ¤íŠ¸</a><ul>
<li><a href="#121-curl">12.1 curlë¡œ í…ŒìŠ¤íŠ¸</a></li>
<li><a href="#122-python">12.2 Python ë³´ì•ˆ í—¤ë” ìŠ¤ìºë„ˆ</a></li>
<li><a href="#123">12.3 ì˜¨ë¼ì¸ ìŠ¤ìºë„ˆ</a></li>
</ul>
</li>
<li><a href="#13_1">13. ì™„ì „í•œ ë³´ì•ˆ í—¤ë” í…œí”Œë¦¿</a><ul>
<li><a href="#131-nginx">13.1 Nginx êµ¬ì„±</a></li>
<li><a href="#132-apache">13.2 Apache êµ¬ì„±</a></li>
</ul>
</li>
<li><a href="#14">14. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-csp">ì—°ìŠµ ë¬¸ì œ 1: CSP ì •ì±… ë¶„ì„</a></li>
<li><a href="#2-flask">ì—°ìŠµ ë¬¸ì œ 2: Flask ë³´ì•ˆ í—¤ë” ë¯¸ë“¤ì›¨ì–´</a></li>
<li><a href="#3">ì—°ìŠµ ë¬¸ì œ 3: í—¤ë” ìŠ¤ìºë„ˆ í–¥ìƒ</a></li>
<li><a href="#4-sri">ì—°ìŠµ ë¬¸ì œ 4: SRI í•´ì‹œ ìƒì„±ê¸°</a></li>
<li><a href="#5-hsts-preload">ì—°ìŠµ ë¬¸ì œ 5: HSTS Preload ì¤€ë¹„ í™•ì¸</a></li>
<li><a href="#6-cross-origin">ì—°ìŠµ ë¬¸ì œ 6: Cross-Origin ê²©ë¦¬ ê°ì‚¬</a></li>
</ul>
</li>
<li><a href="#_2">ìš”ì•½</a><ul>
<li><a href="#_3">í•µì‹¬ ìš”ì </a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="web-security-headers-csp">Web Security Headersì™€ CSP<a class="header-link" href="#web-security-headers-csp" title="Permanent link">&para;</a></h1>
<p><strong>ì´ì „</strong>: <a href="./08_Injection_Attacks.md">08. Injection ê³µê²©ê³¼ ë°©ì–´</a> | <strong>ë‹¤ìŒ</strong>: <a href="./10_API_Security.md">10_API_Security.md</a></p>
<hr />
<p>HTTP ë³´ì•ˆ í—¤ë”ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì²« ë²ˆì§¸ ë°©ì–´ì„ ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ë³´ì•ˆ ì •ì±…ì„ ì ìš©í•˜ë„ë¡ ì§€ì‹œí•˜ì—¬ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ í´ë¦­ì¬í‚¹ë¶€í„° í”„ë¡œí† ì½œ ë‹¤ìš´ê·¸ë ˆì´ë“œ ê³µê²© ë° ë°ì´í„° ìœ ì¶œê¹Œì§€ ì „ì²´ ê³µê²© ìœ í˜•ì„ ì™„í™”í•©ë‹ˆë‹¤. ë‹¨ì¼ í—¤ë”ê°€ ëˆ„ë½ë˜ë©´ ì˜ ì‘ì„±ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ë„ ì·¨ì•½í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë ˆìŠ¨ì€ Flaskì™€ Djangoì˜ ì‹¤ìš©ì ì¸ êµ¬ì„± ì˜ˆì œì™€ í•¨ê»˜ ëª¨ë“  ì£¼ìš” ë³´ì•ˆ í—¤ë”ì— ëŒ€í•œ í¬ê´„ì ì¸ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>Content-Security-Policy (CSP)ì˜ ëª©ì ê³¼ ì§€ì‹œë¬¸ ì´í•´</li>
<li>HTTPS ì—°ê²°ì„ ê°•ì œí•˜ëŠ” HSTS êµ¬ì„±</li>
<li>X-Content-Type-Options, X-Frame-Options, Referrer-Policy í—¤ë” ì ìš©</li>
<li>ë¸Œë¼ìš°ì € ê¸°ëŠ¥ì„ ì œí•œí•˜ëŠ” Permissions-Policy êµ¬í˜„</li>
<li>Cross-Origin ì •ì±… (CORP, COEP, COOP) êµ¬ì„±</li>
<li>Subresource Integrity (SRI)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ í™•ì¸</li>
<li>Flask ë° Django ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë³´ì•ˆ í—¤ë” ì„¤ì •</li>
<li>ëª…ë ¹ì¤„ ë„êµ¬ ë° ìŠ¤ìºë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ í—¤ë” í…ŒìŠ¤íŠ¸ ë° ê°ì‚¬</li>
</ul>
<hr />
<h2 id="1">1. ë³´ì•ˆ í—¤ë” ê°œìš”<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ë³´ì•ˆ í—¤ë”ê°€ ì¤‘ìš”í•œ ì´ìœ <a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  HTTP Response ë³´ì•ˆ í—¤ë”                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Server â”€â”€â”€â”€ HTTP Response â”€â”€â”€â”€â–¶ Browser                             â”‚
â”‚              â”‚                                                       â”‚
â”‚              â”œâ”€â”€ Content-Security-Policy                              â”‚
â”‚              â”œâ”€â”€ Strict-Transport-Security                            â”‚
â”‚              â”œâ”€â”€ X-Content-Type-Options                               â”‚
â”‚              â”œâ”€â”€ X-Frame-Options                                      â”‚
â”‚              â”œâ”€â”€ Referrer-Policy                                      â”‚
â”‚              â”œâ”€â”€ Permissions-Policy                                   â”‚
â”‚              â”œâ”€â”€ Cross-Origin-Resource-Policy                         â”‚
â”‚              â”œâ”€â”€ Cross-Origin-Embedder-Policy                         â”‚
â”‚              â””â”€â”€ Cross-Origin-Opener-Policy                           â”‚
â”‚                                                                      â”‚
â”‚  ì´ í—¤ë”ë“¤ì€ ë¸Œë¼ìš°ì €ì— ë‹¤ìŒì„ ì§€ì‹œí•©ë‹ˆë‹¤:                             â”‚
â”‚  â€¢ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ë° ë¬´ë‹¨ ë¦¬ì†ŒìŠ¤ ì°¨ë‹¨ (CSP)                          â”‚
â”‚  â€¢ í•­ìƒ HTTPS ì‚¬ìš© (HSTS)                                            â”‚
â”‚  â€¢ MIME íƒ€ì… ìŠ¤ë‹ˆí•‘ ë°©ì§€ (X-Content-Type-Options)                    â”‚
â”‚  â€¢ í”„ë ˆì´ë° / í´ë¦­ì¬í‚¹ ì°¨ë‹¨ (X-Frame-Options)                        â”‚
â”‚  â€¢ Referrer ì •ë³´ ìœ ì¶œ ì œì–´ (Referrer-Policy)                         â”‚
â”‚  â€¢ ë¸Œë¼ìš°ì € API ì ‘ê·¼ ì œí•œ (Permissions-Policy)                       â”‚
â”‚  â€¢ Cross-origin ë¦¬ì†ŒìŠ¤ ê²©ë¦¬ (CORP/COEP/COOP)                         â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12">1.2 ì‹¬ì¸µ ë°©ì–´<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>ë³´ì•ˆ í—¤ë”ëŠ” ì•ˆì „í•œ ì½”ë”© ê´€í–‰ì„ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¶”ê°€ ê³„ì¸µì…ë‹ˆë‹¤. ì™„ë²½í•˜ê²Œ ì½”ë”©ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¼ë„ ë³´ì•ˆ í—¤ë”ëŠ” ë‹¤ìŒì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì‹¬ì¸µ ë°©ì–´ ê³„ì¸µ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Layer 5:  ë³´ì•ˆ í—¤ë”             (ë¸Œë¼ìš°ì € ê°•ì œ ì •ì±…)                 â”‚
â”‚  Layer 4:  ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§      (ì…ë ¥ ê²€ì¦, ì¸ì¦)                   â”‚
â”‚  Layer 3:  í”„ë ˆì„ì›Œí¬ ë³´í˜¸        (CSRF í† í°, ORM)                    â”‚
â”‚  Layer 2:  ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ          (TLS, ë°©í™”ë²½, WAF)                  â”‚
â”‚  Layer 1:  ì¸í”„ë¼                (OS ê°•í™”, íŒ¨ì¹˜)                      â”‚
â”‚                                                                      â”‚
â”‚  ê° ê³„ì¸µì€ í•˜ìœ„ ê³„ì¸µì´ ë†“ì¹  ìˆ˜ ìˆëŠ” ê²ƒì„ í¬ì°©í•©ë‹ˆë‹¤.                   â”‚
â”‚  ë³´ì•ˆ í—¤ë”ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œê°€ ë†“ì¹  ìˆ˜ ìˆëŠ” ê²ƒì„ í¬ì°©í•©ë‹ˆë‹¤.         â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="13">1.3 ë¹ ë¥¸ ì°¸ì¡° í…Œì´ë¸”<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>í—¤ë”</th>
<th>ì™„í™” ëŒ€ìƒ</th>
<th>ì¼ë°˜ì ì¸ ê°’</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-Security-Policy</td>
<td>XSS, ë°ì´í„° ì£¼ì…</td>
<td><code>default-src 'self'</code></td>
</tr>
<tr>
<td>Strict-Transport-Security</td>
<td>í”„ë¡œí† ì½œ ë‹¤ìš´ê·¸ë ˆì´ë“œ, ì¿ í‚¤ ê°€ë¡œì±„ê¸°</td>
<td><code>max-age=31536000; includeSubDomains</code></td>
</tr>
<tr>
<td>X-Content-Type-Options</td>
<td>MIME íƒ€ì… í˜¼ë™</td>
<td><code>nosniff</code></td>
</tr>
<tr>
<td>X-Frame-Options</td>
<td>í´ë¦­ì¬í‚¹</td>
<td><code>DENY</code></td>
</tr>
<tr>
<td>Referrer-Policy</td>
<td>ì •ë³´ ìœ ì¶œ</td>
<td><code>strict-origin-when-cross-origin</code></td>
</tr>
<tr>
<td>Permissions-Policy</td>
<td>ë¬´ë‹¨ API ì ‘ê·¼</td>
<td><code>camera=(), microphone=()</code></td>
</tr>
<tr>
<td>Cross-Origin-Resource-Policy</td>
<td>Cross-origin ë°ì´í„° ìœ ì¶œ</td>
<td><code>same-origin</code></td>
</tr>
<tr>
<td>Cross-Origin-Embedder-Policy</td>
<td>Spectre ìŠ¤íƒ€ì¼ ê³µê²©</td>
<td><code>require-corp</code></td>
</tr>
<tr>
<td>Cross-Origin-Opener-Policy</td>
<td>Cross-window ê³µê²©</td>
<td><code>same-origin</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-content-security-policy-csp">2. Content-Security-Policy (CSP)<a class="header-link" href="#2-content-security-policy-csp" title="Permanent link">&para;</a></h2>
<h3 id="21-csp">2.1 CSPë€ ë¬´ì—‡ì¸ê°€?<a class="header-link" href="#21-csp" title="Permanent link">&para;</a></h3>
<p>Content-Security-PolicyëŠ” ê°€ì¥ ê°•ë ¥í•œ ë³´ì•ˆ í—¤ë”ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ì‹ ë¢°í•´ì•¼ í•˜ëŠ” ì½˜í…ì¸  ì†ŒìŠ¤ì˜ í—ˆìš© ëª©ë¡ì„ ì •ì˜í•˜ì—¬ ë¬´ë‹¨ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì„ ì°¨ë‹¨í•¨ìœ¼ë¡œì¨ XSS ê³µê²©ì„ íš¨ê³¼ì ìœ¼ë¡œ ë°©ì§€í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                    </span>CSP<span class="w"> </span>ê°•ì œ<span class="w"> </span>ëª¨ë¸<span class="w">                                      </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span>ë¸Œë¼ìš°ì €ê°€<span class="w"> </span>CSP<span class="w"> </span>í—¤ë”ë¥¼<span class="w"> </span>ìˆ˜ì‹ :<span class="w">                                          </span>â”‚
â”‚<span class="w">    </span>Content-Security-Policy:<span class="w"> </span>default-src<span class="w"> </span>&#39;self&#39;;<span class="w"> </span>script-src<span class="w"> </span>&#39;self&#39;<span class="w">    </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">     </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                       </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nt">&lt;script</span><span class="w"> </span><span class="na">src=</span><span class="w">      </span><span class="s">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">&lt;script</span><span class="nt">&gt;</span><span class="w">          </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>&quot;/app.js&quot;&gt;<span class="w">       </span>â”‚<span class="w">     </span>â”‚<span class="w">  </span>alert(&#39;XSS&#39;)<span class="w">     </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                   </span>â”‚<span class="w">     </span>â”‚<span class="w"> </span><span class="nt">&lt;/script&gt;</span><span class="w">          </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>ì¶œì²˜:<span class="w"> </span>self<span class="w">       </span>â”‚<span class="w">     </span>â”‚<span class="w">  </span>ì¶œì²˜:<span class="w"> </span>inline<span class="w">     </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>âœ“<span class="w"> </span>í—ˆìš©<span class="w">           </span>â”‚<span class="w">     </span>â”‚<span class="w">  </span>âœ—<span class="w"> </span>ì°¨ë‹¨<span class="w">           </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">     </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                       </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">     </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                       </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nt">&lt;script</span><span class="w"> </span><span class="na">src=</span><span class="w">      </span><span class="s">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">&lt;img</span><span class="w"> </span><span class="na">src=</span><span class="w">          </span><span class="s">â”‚</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">&quot;https://cdn</span><span class="w">     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="err">&quot;/logo.png&quot;</span><span class="nt">&gt;</span><span class="w">      </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>.example.com<span class="w">     </span>â”‚<span class="w">     </span>â”‚<span class="w">                    </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>/lib.js&quot;&gt;<span class="w">        </span>â”‚<span class="w">     </span>â”‚<span class="w">  </span>ì¶œì²˜:<span class="w"> </span>self<span class="w">        </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>ì¶œì²˜:<span class="w"> </span>cdn<span class="w">        </span>â”‚<span class="w">     </span>â”‚<span class="w">  </span>âœ“<span class="w"> </span>í—ˆìš©<span class="w">            </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>âœ—<span class="w"> </span>ì°¨ë‹¨<span class="w">           </span>â”‚<span class="w">     </span>â”‚<span class="w">                    </span>â”‚<span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">     </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                       </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22-csp">2.2 CSP ì§€ì‹œë¬¸<a class="header-link" href="#22-csp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">CSP</span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸</span><span class="w"> </span><span class="nx">ì¹´í…Œê³ ë¦¬</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Fetch</span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸</span><span class="w"> </span><span class="p">(</span><span class="nx">ë¦¬ì†ŒìŠ¤</span><span class="w"> </span><span class="nx">ë¡œë“œ</span><span class="w"> </span><span class="nx">ìœ„ì¹˜</span><span class="w"> </span><span class="nx">ì œì–´</span><span class="p">):</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="k">default</span><span class="o">-</span><span class="nx">src</span><span class="w">     </span><span class="nx">ë‹¤ë¥¸</span><span class="w"> </span><span class="nx">ëª¨ë“ </span><span class="w"> </span><span class="nx">fetch</span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸ì˜</span><span class="w"> </span><span class="nx">ëŒ€ì²´</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">script</span><span class="o">-</span><span class="nx">src</span><span class="w">      </span><span class="nx">JavaScript</span><span class="w"> </span><span class="nx">ì†ŒìŠ¤</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">style</span><span class="o">-</span><span class="nx">src</span><span class="w">       </span><span class="nx">CSS</span><span class="w"> </span><span class="nx">ì†ŒìŠ¤</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">img</span><span class="o">-</span><span class="nx">src</span><span class="w">         </span><span class="nx">ì´ë¯¸ì§€</span><span class="w"> </span><span class="nx">ì†ŒìŠ¤</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">font</span><span class="o">-</span><span class="nx">src</span><span class="w">        </span><span class="nx">ì›¹</span><span class="w"> </span><span class="nx">í°íŠ¸</span><span class="w"> </span><span class="nx">ì†ŒìŠ¤</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">connect</span><span class="o">-</span><span class="nx">src</span><span class="w">     </span><span class="nx">XHR</span><span class="p">,</span><span class="w"> </span><span class="nx">fetch</span><span class="p">,</span><span class="w"> </span><span class="nx">WebSocket</span><span class="p">,</span><span class="w"> </span><span class="nx">EventSource</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">media</span><span class="o">-</span><span class="nx">src</span><span class="w">       </span><span class="nx">ì˜¤ë””ì˜¤</span><span class="o">/</span><span class="nx">ë¹„ë””ì˜¤</span><span class="w"> </span><span class="nx">ì†ŒìŠ¤</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">object</span><span class="o">-</span><span class="nx">src</span><span class="w">      </span><span class="p">&lt;</span><span class="nx">object</span><span class="p">&gt;,</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">embed</span><span class="p">&gt;,</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">applet</span><span class="p">&gt;</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">child</span><span class="o">-</span><span class="nx">src</span><span class="w">       </span><span class="nx">ì›¹</span><span class="w"> </span><span class="nx">ì›Œì»¤</span><span class="w"> </span><span class="nx">ë°</span><span class="w"> </span><span class="nx">ì¤‘ì²©</span><span class="w"> </span><span class="nx">ì»¨í…ìŠ¤íŠ¸</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">worker</span><span class="o">-</span><span class="nx">src</span><span class="w">      </span><span class="nx">Worker</span><span class="p">,</span><span class="w"> </span><span class="nx">SharedWorker</span><span class="p">,</span><span class="w"> </span><span class="nx">ServiceWorker</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">manifest</span><span class="o">-</span><span class="nx">src</span><span class="w">    </span><span class="nx">ì•±</span><span class="w"> </span><span class="nx">ë§¤ë‹ˆí˜ìŠ¤íŠ¸</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">ë¬¸ì„œ</span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸</span><span class="p">:</span><span class="w">                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="kd">base</span><span class="o">-</span><span class="nx">uri</span><span class="w">        </span><span class="p">&lt;</span><span class="kd">base</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">ìš”ì†Œ</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">sandbox</span><span class="w">         </span><span class="nx">ìƒŒë“œë°•ìŠ¤</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w"> </span><span class="nx">ì ìš©</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">plugin</span><span class="o">-</span><span class="nx">types</span><span class="w">    </span><span class="nx">í”ŒëŸ¬ê·¸ì¸</span><span class="w"> </span><span class="nx">MIME</span><span class="w"> </span><span class="nx">íƒ€ì…</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w"> </span><span class="p">(</span><span class="nx">deprecated</span><span class="p">)</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">íƒìƒ‰</span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸</span><span class="p">:</span><span class="w">                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">form</span><span class="o">-</span><span class="nx">action</span><span class="w">     </span><span class="nx">í¼</span><span class="w"> </span><span class="nx">ì œì¶œ</span><span class="w"> </span><span class="nx">ëŒ€ìƒ</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">frame</span><span class="o">-</span><span class="nx">ancestors</span><span class="w"> </span><span class="nx">ì´</span><span class="w"> </span><span class="nx">í˜ì´ì§€ë¥¼</span><span class="w"> </span><span class="nx">ì„ë² ë“œí• </span><span class="w"> </span><span class="nx">ìˆ˜</span><span class="w"> </span><span class="nx">ìˆëŠ”</span><span class="w"> </span><span class="nx">ëŒ€ìƒ</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">navigate</span><span class="o">-</span><span class="nx">to</span><span class="w">     </span><span class="nx">íƒìƒ‰</span><span class="w"> </span><span class="nx">ëŒ€ìƒ</span><span class="w"> </span><span class="nx">ì œí•œ</span><span class="w"> </span><span class="p">(</span><span class="nx">ì œí•œì </span><span class="w"> </span><span class="nx">ì§€ì›</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">ë³´ê³ </span><span class="w"> </span><span class="nx">ì§€ì‹œë¬¸</span><span class="p">:</span><span class="w">                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="nx">report</span><span class="o">-</span><span class="nx">uri</span><span class="w">      </span><span class="nx">ìœ„ë°˜</span><span class="w"> </span><span class="nx">ë³´ê³ </span><span class="w"> </span><span class="nx">ì „ì†¡</span><span class="w"> </span><span class="p">(</span><span class="nx">deprecated</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">report</span><span class="o">-</span><span class="nx">to</span><span class="w">       </span><span class="nx">ìœ„ë°˜</span><span class="w"> </span><span class="nx">ë³´ê³ </span><span class="w"> </span><span class="nx">ì „ì†¡</span><span class="w"> </span><span class="p">(</span><span class="nx">ìµœì‹ </span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="23">2.3 ì†ŒìŠ¤ ê°’<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì†ŒìŠ¤</th>
<th>ì˜ë¯¸</th>
<th>ì˜ˆì œ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>'self'</code></td>
<td>ë™ì¼ ì¶œì²˜ (ìŠ¤í‚´ + í˜¸ìŠ¤íŠ¸ + í¬íŠ¸)</td>
<td><code>script-src 'self'</code></td>
</tr>
<tr>
<td><code>'none'</code></td>
<td>ëª¨ë“  ì†ŒìŠ¤ ì°¨ë‹¨</td>
<td><code>object-src 'none'</code></td>
</tr>
<tr>
<td><code>'unsafe-inline'</code></td>
<td>ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸/ìŠ¤íƒ€ì¼ í—ˆìš©</td>
<td><code>style-src 'unsafe-inline'</code></td>
</tr>
<tr>
<td><code>'unsafe-eval'</code></td>
<td>eval(), Function() ë“± í—ˆìš©</td>
<td><code>script-src 'unsafe-eval'</code></td>
</tr>
<tr>
<td><code>'strict-dynamic'</code></td>
<td>ì‹ ë¢°í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¡œë“œëœ ìŠ¤í¬ë¦½íŠ¸ ì‹ ë¢°</td>
<td><code>script-src 'strict-dynamic'</code></td>
</tr>
<tr>
<td><code>'nonce-&lt;base64&gt;'</code></td>
<td>nonceë¡œ íŠ¹ì • ì¸ë¼ì¸ í—ˆìš©</td>
<td><code>script-src 'nonce-abc123'</code></td>
</tr>
<tr>
<td><code>'sha256-&lt;hash&gt;'</code></td>
<td>í•´ì‹œë¡œ íŠ¹ì • ì¸ë¼ì¸ í—ˆìš©</td>
<td><code>script-src 'sha256-...'</code></td>
</tr>
<tr>
<td><code>https:</code></td>
<td>ëª¨ë“  HTTPS ì†ŒìŠ¤</td>
<td><code>img-src https:</code></td>
</tr>
<tr>
<td><code>data:</code></td>
<td>Data URI</td>
<td><code>img-src data:</code></td>
</tr>
<tr>
<td><code>blob:</code></td>
<td>Blob URI</td>
<td><code>worker-src blob:</code></td>
</tr>
<tr>
<td><code>*.example.com</code></td>
<td>ì™€ì¼ë“œì¹´ë“œ ì„œë¸Œë„ë©”ì¸</td>
<td><code>script-src *.cdn.com</code></td>
</tr>
</tbody>
</table>
<h3 id="24-csp">2.4 CSP ì •ì±… ë‹¨ê³„ë³„ êµ¬ì¶•<a class="header-link" href="#24-csp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CSP ì •ì±…ì„ ì ì§„ì ìœ¼ë¡œ êµ¬ì¶• â€” í—ˆìš©ì ì¸ ê²ƒë¶€í„° ì—„ê²©í•œ ê²ƒê¹Œì§€.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ë ˆë²¨ 1: ê¸°ë³¸ CSP (ëª…ë°±í•œ XSS ì°¨ë‹¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># default-src &#39;self&#39;ë¡œ ì‹œì‘í•˜ê³  í•„ìš”ì— ë”°ë¼ ì™„í™”</span>
<span class="n">csp_level1</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span>

<span class="c1"># â”€â”€ ë ˆë²¨ 2: íŠ¹ì • ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ í—ˆìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">csp_level2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;default-src &#39;self&#39;; &quot;</span>
    <span class="s2">&quot;script-src &#39;self&#39; https://cdn.jsdelivr.net; &quot;</span>
    <span class="s2">&quot;style-src &#39;self&#39; https://fonts.googleapis.com; &quot;</span>
    <span class="s2">&quot;font-src &#39;self&#39; https://fonts.gstatic.com; &quot;</span>
    <span class="s2">&quot;img-src &#39;self&#39; data: https:; &quot;</span>
    <span class="s2">&quot;connect-src &#39;self&#39; https://api.example.com; &quot;</span>
    <span class="s2">&quot;object-src &#39;none&#39;; &quot;</span>
    <span class="s2">&quot;base-uri &#39;self&#39;; &quot;</span>
    <span class="s2">&quot;form-action &#39;self&#39;&quot;</span>
<span class="p">)</span>

<span class="c1"># â”€â”€ ë ˆë²¨ 3: Nonce ê¸°ë°˜ CSP (ìµœì‹  ì•± ê¶Œì¥) â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ì„œë²„ê°€ ìš”ì²­ë‹¹ ëœë¤ nonce ìƒì„±</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_csp_with_nonce</span><span class="p">():</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
    <span class="n">csp</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;default-src &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;script-src &#39;self&#39; &#39;nonce-</span><span class="si">{</span><span class="n">nonce</span><span class="si">}</span><span class="s2">&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;style-src &#39;self&#39; &#39;nonce-</span><span class="si">{</span><span class="n">nonce</span><span class="si">}</span><span class="s2">&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;img-src &#39;self&#39; data:; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;font-src &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;connect-src &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;object-src &#39;none&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;base-uri &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;form-action &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;frame-ancestors &#39;none&#39;&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">csp</span><span class="p">,</span> <span class="n">nonce</span>

<span class="n">csp_header</span><span class="p">,</span> <span class="n">nonce</span> <span class="o">=</span> <span class="n">generate_csp_with_nonce</span><span class="p">()</span>
<span class="c1"># HTMLì—ì„œ: &lt;script nonce=&quot;&lt;nonce&gt;&quot;&gt;...&lt;/script&gt;</span>

<span class="c1"># â”€â”€ ë ˆë²¨ 4: í•´ì‹œ ê¸°ë°˜ CSP (ì •ì  ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ìš©) â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_csp_hash</span><span class="p">(</span><span class="n">script_content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CSP ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ í—ˆìš© ëª©ë¡ì„ ìœ„í•œ SHA-256 í•´ì‹œ ê³„ì‚°.&quot;&quot;&quot;</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">script_content</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&#39;sha256-</span><span class="si">{</span><span class="n">b64</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

<span class="n">inline_script</span> <span class="o">=</span> <span class="s2">&quot;console.log(&#39;Hello, World!&#39;);&quot;</span>
<span class="n">script_hash</span> <span class="o">=</span> <span class="n">compute_csp_hash</span><span class="p">(</span><span class="n">inline_script</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CSP í•´ì‹œ: </span><span class="si">{</span><span class="n">script_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># ì¶œë ¥: CSP í•´ì‹œ: &#39;sha256-TWupyvVdPa1DyFqLnQMqRpuUWdS3nKPnz70IcS/1o3Q=&#39;</span>

<span class="n">csp_level4</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;script-src &#39;self&#39; </span><span class="si">{</span><span class="n">script_hash</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># â”€â”€ ë ˆë²¨ 5: strict-dynamic (ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ë¡œë“œí•˜ëŠ” ì•±ìš©)</span>
<span class="n">csp_level5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;script-src &#39;strict-dynamic&#39; &#39;nonce-</span><span class="si">{nonce}</span><span class="s2">&#39;; &quot;</span>
    <span class="s2">&quot;object-src &#39;none&#39;; &quot;</span>
    <span class="s2">&quot;base-uri &#39;self&#39;&quot;</span>
<span class="p">)</span>
<span class="c1"># strict-dynamicì„ ì‚¬ìš©í•˜ë©´ nonceê°€ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¡œë“œëœ ìŠ¤í¬ë¦½íŠ¸ëŠ”</span>
<span class="c1"># ì¶œì²˜ì— ê´€ê³„ì—†ì´ ìë™ìœ¼ë¡œ ì‹ ë¢°ë©ë‹ˆë‹¤.</span>
</code></pre></div>

<h3 id="25-csp">2.5 CSP ë³´ê³ <a class="header-link" href="#25-csp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CSP ìœ„ë°˜ ë³´ê³  â€” ì°¨ë‹¨ ì—†ì´ ì •ì±… ìœ„ë°˜ ê°ì§€.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ Report-Only ëª¨ë“œ (ê°•ì œ ì—†ì´ ëª¨ë‹ˆí„°ë§) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ë¨¼ì € Content-Security-Policy-Report-Only í—¤ë” ì‚¬ìš©</span>
<span class="n">csp_report_only</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;default-src &#39;self&#39;; &quot;</span>
    <span class="s2">&quot;script-src &#39;self&#39;; &quot;</span>
    <span class="s2">&quot;report-uri /csp-report; &quot;</span>
    <span class="s2">&quot;report-to csp-endpoint&quot;</span>
<span class="p">)</span>

<span class="c1"># Report-To í—¤ë” (report-to ì§€ì‹œë¬¸ì˜ ë™ë°˜ì)</span>
<span class="n">report_to</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;csp-endpoint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_age&quot;</span><span class="p">:</span> <span class="mi">86400</span><span class="p">,</span>
    <span class="s2">&quot;endpoints&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/csp-report&quot;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># â”€â”€ CSP ìœ„ë°˜ ë³´ê³ ë¥¼ ë°›ì„ Flask ì—”ë“œí¬ì¸íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;csp_reports&#39;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/csp-report&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">csp_report</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CSP ìœ„ë°˜ ë³´ê³  ìˆ˜ì‹  ë° ë¡œê¹….&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># CSP ë³´ê³ ëŠ” application/csp-reportë¡œ ì „ì†¡ë¨</span>
        <span class="n">report</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">violation</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csp-report&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;CSP ìœ„ë°˜: blocked_uri=</span><span class="si">%s</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;violated_directive=</span><span class="si">%s</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;document_uri=</span><span class="si">%s</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;source_file=</span><span class="si">%s</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;line_number=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">violation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;blocked-uri&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
            <span class="n">violation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;violated-directive&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
            <span class="n">violation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;document-uri&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
            <span class="n">violation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source-file&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
            <span class="n">violation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;line-number&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;received&quot;</span><span class="p">}),</span> <span class="mi">204</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CSP ë³´ê³  ì²˜ë¦¬ ì˜¤ë¥˜: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;invalid report&quot;</span><span class="p">}),</span> <span class="mi">400</span>

<span class="c1"># â”€â”€ CSP ìœ„ë°˜ ë³´ê³  JSON ì˜ˆì œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">example_report</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;csp-report&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;document-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/page&quot;</span><span class="p">,</span>
        <span class="s2">&quot;referrer&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;violated-directive&quot;</span><span class="p">:</span> <span class="s2">&quot;script-src &#39;self&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;effective-directive&quot;</span><span class="p">:</span> <span class="s2">&quot;script-src&quot;</span><span class="p">,</span>
        <span class="s2">&quot;original-policy&quot;</span><span class="p">:</span> <span class="s2">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;blocked-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://evil.com/malicious.js&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status-code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/page&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line-number&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="s2">&quot;column-number&quot;</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="26-csp">2.6 ì¼ë°˜ì ì¸ CSP ì‹¤ìˆ˜<a class="header-link" href="#26-csp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ì¼ë°˜ì ì¸ CSP ì‹¤ìˆ˜ì™€ ìˆ˜ì • ë°©ë²•.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 1: script-srcì— &#39;unsafe-inline&#39; ì‚¬ìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ì´ê²ƒì€ XSS ë°©ì§€ë¥¼ ìœ„í•œ CSPì˜ ëª©ì ì„ ë¬´íš¨í™”í•¨</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span>
<span class="c1"># ìˆ˜ì •: ëŒ€ì‹  nonceë‚˜ í•´ì‹œ ì‚¬ìš©</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39; &#39;nonce-</span><span class="si">{random}</span><span class="s2">&#39;&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 2: script-srcì— ì™€ì¼ë“œì¹´ë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í—ˆìš©</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39; *.googleapis.com&quot;</span>
<span class="c1"># ìˆ˜ì •: íŠ¹ì • í˜¸ìŠ¤íŠ¸ëª… ì‚¬ìš©</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39; https://ajax.googleapis.com&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 3: default-src ëˆ„ë½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># default-src ì—†ìœ¼ë©´ ë‚˜ì—´ë˜ì§€ ì•Šì€ ì§€ì‹œë¬¸ì€ ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë‘ í—ˆìš©</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39;&quot;</span>
<span class="c1"># ìˆ˜ì •: í•­ìƒ ëŒ€ì²´ë¡œ default-src í¬í•¨</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;none&#39;; script-src &#39;self&#39;; style-src &#39;self&#39;; img-src &#39;self&#39;&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 4: script-srcì—ì„œ data: í—ˆìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># data: URIëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ JavaScriptë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŒ</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39; data:&quot;</span>
<span class="c1"># ìˆ˜ì •: í•„ìš”í•œ ê³³ì—ë§Œ ì´ë¯¸ì§€/í°íŠ¸ì— data: ì‚¬ìš©</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;script-src &#39;self&#39;; img-src &#39;self&#39; data:&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 5: object-src ìŠìŒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># Flashì™€ Java ì• í”Œë¦¿ì€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê°€ëŠ¥</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span>  <span class="c1"># object-srcê°€ &#39;self&#39;ë¡œ ëŒ€ì²´ë¨</span>
<span class="c1"># ìˆ˜ì •: object-srcë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì°¨ë‹¨</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;self&#39;; object-src &#39;none&#39;&quot;</span>

<span class="c1"># â”€â”€ ì‹¤ìˆ˜ 6: ì§€ë‚˜ì¹˜ê²Œ í—ˆìš©ì ì¸ connect-src â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ëª¨ë“  HTTPS ì—”ë“œí¬ì¸íŠ¸ë¡œ ë°ì´í„° ìœ ì¶œ í—ˆìš©</span>
<span class="n">bad_csp</span> <span class="o">=</span> <span class="s2">&quot;connect-src https:&quot;</span>
<span class="c1"># ìˆ˜ì •: íŠ¹ì • API ì—”ë“œí¬ì¸íŠ¸ ë‚˜ì—´</span>
<span class="n">good_csp</span> <span class="o">=</span> <span class="s2">&quot;connect-src &#39;self&#39; https://api.example.com&quot;</span>
</code></pre></div>

<hr />
<h2 id="3-strict-transport-security-hsts">3. Strict-Transport-Security (HSTS)<a class="header-link" href="#3-strict-transport-security-hsts" title="Permanent link">&para;</a></h2>
<h3 id="31-hsts">3.1 HSTS ì‘ë™ ë°©ì‹<a class="header-link" href="#31-hsts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HSTS ë³´í˜¸ íë¦„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  HSTS ì—†ì´:                                                          â”‚
â”‚  User â”€â”€http://â”€â”€â–¶ Server â”€â”€301 Redirectâ”€â”€â–¶ https://                â”‚
â”‚        â†‘                                                             â”‚
â”‚        â””â”€â”€ MITMì´ ì´ í‰ë¬¸ HTTP ìš”ì²­ì„ ê°€ë¡œì±Œ ìˆ˜ ìˆìŒ                 â”‚
â”‚                                                                      â”‚
â”‚  HSTSì™€ í•¨ê»˜:                                                        â”‚
â”‚  User â”€â”€http://â”€â”€â–¶ ë¸Œë¼ìš°ì €ê°€ ê°€ë¡œì±” (307 ë‚´ë¶€ ë¦¬ë””ë ‰íŠ¸)             â”‚
â”‚                    Browser â”€â”€https://â”€â”€â–¶ Server                      â”‚
â”‚                    (HTTPë¡œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ìŒ)                        â”‚
â”‚                                                                      â”‚
â”‚  ì²« ë°©ë¬¸:                                                            â”‚
â”‚  1. ë¸Œë¼ìš°ì €ê°€ HTTPë¡œ ì—°ê²°                                           â”‚
â”‚  2. ì„œë²„ê°€ 301 + HSTS í—¤ë”ë¡œ ì‘ë‹µ                                    â”‚
â”‚  3. ë¸Œë¼ìš°ì €ê°€ ë„ë©”ì¸ì— ëŒ€í•œ HSTS ì •ì±… ì €ì¥                          â”‚
â”‚                                                                      â”‚
â”‚  ì´í›„ ë°©ë¬¸:                                                          â”‚
â”‚  1. ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ HTTPSë¡œ ì—…ê·¸ë ˆì´ë“œ                           â”‚
â”‚  2. HTTP ìš”ì²­ì´ ë¸Œë¼ìš°ì €ë¥¼ ë– ë‚˜ì§€ ì•ŠìŒ                               â”‚
â”‚  3. ì˜ëª»ëœ ì¸ì¦ì„œëŠ” í•˜ë“œ ì‹¤íŒ¨ ìœ ë°œ (ìš°íšŒ ì—†ìŒ)                       â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="32-hsts">3.2 HSTS ì§€ì‹œë¬¸<a class="header-link" href="#32-hsts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Strict</span><span class="o">-</span><span class="n">Transport</span><span class="o">-</span><span class="n">Security</span><span class="p">:</span><span class="w"> </span><span class="nb">max</span><span class="o">-</span><span class="n">age</span><span class="o">=</span><span class="mi">31536000</span><span class="p">;</span><span class="w"> </span><span class="n">includeSubDomains</span><span class="p">;</span><span class="w"> </span><span class="nb">preload</span>
</code></pre></div>

<table>
<thead>
<tr>
<th>ì§€ì‹œë¬¸</th>
<th>ëª©ì </th>
<th>ê¶Œì¥ ê°’</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max-age</code></td>
<td>HSTSë¥¼ ê¸°ì–µí•  ê¸°ê°„ (ì´ˆ)</td>
<td><code>31536000</code> (1ë…„)</td>
</tr>
<tr>
<td><code>includeSubDomains</code></td>
<td>ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì— ì ìš©</td>
<td>ì™„ì „í•œ ë³´í˜¸ë¥¼ ìœ„í•´ í¬í•¨</td>
</tr>
<tr>
<td><code>preload</code></td>
<td>ë¸Œë¼ìš°ì € ì‚¬ì „ ë¡œë“œ ëª©ë¡ì— í¬í•¨ ìš”ì²­</td>
<td>í…ŒìŠ¤íŠ¸ í›„ í¬í•¨</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">HSTS êµ¬ì„± ê³ ë ¤ ì‚¬í•­.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ë°°í¬ ì „ëµ: ì ì§„ì  ë¡¤ì•„ì›ƒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ì§§ì€ max-ageë¡œ ì‹œì‘í•˜ê³  ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì¦ê°€</span>

<span class="c1"># 1ë‹¨ê³„: 5ë¶„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸</span>
<span class="n">hsts_test</span> <span class="o">=</span> <span class="s2">&quot;max-age=300&quot;</span>

<span class="c1"># 2ë‹¨ê³„: 1ì£¼ì¼ë¡œ ì¦ê°€</span>
<span class="n">hsts_week</span> <span class="o">=</span> <span class="s2">&quot;max-age=604800&quot;</span>

<span class="c1"># 3ë‹¨ê³„: ì„œë¸Œë„ë©”ì¸ê³¼ í•¨ê»˜ 1ê°œì›”ë¡œ ì¦ê°€</span>
<span class="n">hsts_month</span> <span class="o">=</span> <span class="s2">&quot;max-age=2592000; includeSubDomains&quot;</span>

<span class="c1"># 4ë‹¨ê³„: ì „ì²´ ë°°í¬ (1ë…„ + preload)</span>
<span class="n">hsts_full</span> <span class="o">=</span> <span class="s2">&quot;max-age=31536000; includeSubDomains; preload&quot;</span>

<span class="c1"># ê²½ê³ : ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì´ HTTPSë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ì „ì—</span>
<span class="c1"># ê¸´ max-ageë¥¼ ì„¤ì •í•˜ë©´ ì‚¬ìš©ìë¥¼ ì ê¸€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
<span class="c1"># includeSubDomainsëŠ” ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì´ ìœ íš¨í•œ TLSë¥¼ ê°€ì ¸ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</span>

<span class="c1"># â”€â”€ HSTS Preload ëª©ë¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># HSTS preload ëª©ë¡ì€ ë¸Œë¼ìš°ì €ì— ë‚´ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</span>
<span class="c1"># ì´ ëª©ë¡ì˜ ë„ë©”ì¸ì€ ì²« ë°©ë¬¸ì—ë„ í•­ìƒ HTTPSë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</span>
<span class="c1"># ì œì¶œ: https://hstspreload.org/</span>
<span class="c1">#</span>
<span class="c1"># Preload ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. ìœ íš¨í•œ ì¸ì¦ì„œ</span>
<span class="c1"># 2. ë™ì¼ í˜¸ìŠ¤íŠ¸ì—ì„œ ëª¨ë“  HTTPë¥¼ HTTPSë¡œ ë¦¬ë””ë ‰íŠ¸</span>
<span class="c1"># 3. ë‹¤ìŒì„ í¬í•¨í•˜ëŠ” HSTS í—¤ë”:</span>
<span class="c1">#    - max-age &gt;= 31536000 (1ë…„)</span>
<span class="c1">#    - includeSubDomains</span>
<span class="c1">#    - preload</span>
<span class="c1"># 4. HTTPS ë¦¬ë””ë ‰íŠ¸ë„ HSTS í—¤ë”ë¥¼ í¬í•¨í•´ì•¼ í•¨</span>
</code></pre></div>

<hr />
<h2 id="4-x-content-type-options">4. X-Content-Type-Options<a class="header-link" href="#4-x-content-type-options" title="Permanent link">&para;</a></h2>
<h3 id="41-mime">4.1 MIME ìŠ¤ë‹ˆí•‘ ê³µê²©<a class="header-link" href="#41-mime" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MIME ìŠ¤ë‹ˆí•‘ ê³µê²©                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ê³µê²©ìê°€ ì—…ë¡œë“œ: malicious.jpg                                      â”‚
â”‚  (ì‹¤ì œë¡œëŠ” ì´ë¯¸ì§€ ë°ì´í„°ê°€ ì•„ë‹Œ JavaScript í¬í•¨)                     â”‚
â”‚                                                                      â”‚
â”‚  ì„œë²„ê°€ ì œê³µ: Content-Type: image/jpeg                               â”‚
â”‚                                                                      â”‚
â”‚  nosniff ì—†ì´:                                                       â”‚
â”‚  ë¸Œë¼ìš°ì €ê°€ ì½˜í…ì¸  ìŠ¤ë‹ˆí•‘ â”€â”€â–¶ &quot;ì´ê²ƒì€ JavaScriptì²˜ëŸ¼ ë³´ì„&quot;           â”‚
â”‚  ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ì„ JavaScriptë¡œ ì‹¤í–‰ â”€â”€â–¶ XSS!                        â”‚
â”‚                                                                      â”‚
â”‚  nosniffì™€ í•¨ê»˜:                                                     â”‚
â”‚  ë¸Œë¼ìš°ì €ê°€ Content-Type ì‹ ë¢° â”€â”€â–¶ &quot;ì´ê²ƒì€ image/jpeg&quot;                â”‚
â”‚  ë¸Œë¼ìš°ì €ê°€ ì´ë¯¸ì§€ë¡œ ë Œë”ë§ (ì‹¤íŒ¨) â”€â”€â–¶ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì—†ìŒ             â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="42">4.2 êµ¬ì„±<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>X-Content-Type-Options: nosniff
</code></pre></div>

<p>ì´ê²ƒì€ ê°€ì¥ ê°„ë‹¨í•œ ë³´ì•ˆ í—¤ë”ì…ë‹ˆë‹¤ â€” ì •í™•íˆ í•˜ë‚˜ì˜ ìœ íš¨í•œ ê°’ <code>nosniff</code>ë§Œ ìˆìŠµë‹ˆë‹¤. ëª¨ë“  ì‘ë‹µì— í¬í•¨í•˜ì§€ ì•Šì„ ì´ìœ ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒì„ ë°©ì§€í•©ë‹ˆë‹¤:</p>
<ul>
<li>ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ë‹Œ MIME íƒ€ì…ì˜ íŒŒì¼ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë“œë˜ëŠ” ê²ƒ</li>
<li>ìŠ¤íƒ€ì¼ì‹œíŠ¸ê°€ CSSê°€ ì•„ë‹Œ MIME íƒ€ì…ì˜ íŒŒì¼ì—ì„œ ë¡œë“œë˜ëŠ” ê²ƒ</li>
<li>ì‚¬ìš©ì ì—…ë¡œë“œ ì½˜í…ì¸ ë¥¼ ì œê³µí•  ë•Œ MIME íƒ€ì… í˜¼ë™ ê³µê²©</li>
</ul>
<hr />
<h2 id="5-x-frame-options-frame-ancestors">5. X-Frame-Optionsì™€ frame-ancestors<a class="header-link" href="#5-x-frame-options-frame-ancestors" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 í´ë¦­ì¬í‚¹ ë°©ì§€<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í´ë¦­ì¬í‚¹ ê³µê²©                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ê³µê²©ìì˜ í˜ì´ì§€:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚  &quot;ì—¬ê¸°ë¥¼ í´ë¦­í•˜ë©´ ìƒí’ˆì„ ë°›ìœ¼ì„¸ìš”!&quot;     â”‚                         â”‚
â”‚  â”‚                                          â”‚                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                        â”‚
â”‚  â”‚  â”‚  ë³´ì´ì§€ ì•ŠëŠ” iframe (opacity: 0)â”‚     â”‚                        â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚                        â”‚
â”‚  â”‚  â”‚  â”‚ ê·€í•˜ì˜ ì€í–‰ ì•±         â”‚     â”‚     â”‚                        â”‚
â”‚  â”‚  â”‚  â”‚                        â”‚     â”‚     â”‚                        â”‚
â”‚  â”‚  â”‚  â”‚  [1000ì› ì†¡ê¸ˆ] â—„â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ ì‚¬ìš©ìê°€ ì—¬ê¸°ë¥¼ í´ë¦­   â”‚
â”‚  â”‚  â”‚  â”‚                        â”‚     â”‚     â”‚                        â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚                        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                      â”‚
â”‚  ì‚¬ìš©ìëŠ” ìƒí’ˆ ë²„íŠ¼ì„ í´ë¦­í•œë‹¤ê³  ìƒê°í•˜ì§€ë§Œ,                         â”‚
â”‚  ì‹¤ì œë¡œëŠ” ì€í–‰ ì›¹ì‚¬ì´íŠ¸ê°€ í¬í•¨ëœ ë³´ì´ì§€ ì•ŠëŠ” iframeì˜                â”‚
â”‚  &quot;ì†¡ê¸ˆ&quot; ë²„íŠ¼ì„ í´ë¦­í•˜ê³  ìˆìŠµë‹ˆë‹¤.                                    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52-x-frame-options">5.2 X-Frame-Options ê°’<a class="header-link" href="#52-x-frame-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code># ëª¨ë“  í”„ë ˆì´ë° ê±°ë¶€
X-Frame-Options: DENY

# ë™ì¼ ì¶œì²˜ë§Œ í—ˆìš©
X-Frame-Options: SAMEORIGIN

# íŠ¹ì • ì¶œì²˜ í—ˆìš© (deprecated, ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
X-Frame-Options: ALLOW-FROM https://trusted.example.com
</code></pre></div>

<h3 id="53-csp-frame-ancestors">5.3 CSP frame-ancestors (ìµœì‹  ëŒ€ì²´)<a class="header-link" href="#53-csp-frame-ancestors" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">frame-ancestorsëŠ” X-Frame-Optionsì˜ CSP ëŒ€ì²´ì…ë‹ˆë‹¤.</span>
<span class="sd">ë” ì„¸ë°€í•œ ì œì–´ë¥¼ ì œê³µí•˜ê³  ì—¬ëŸ¬ ì¶œì²˜ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ëª¨ë“  í”„ë ˆì´ë° ì°¨ë‹¨ (X-Frame-Options: DENYì™€ ë™ë“±) â”€â”€â”€â”€â”€</span>
<span class="n">csp_no_frame</span> <span class="o">=</span> <span class="s2">&quot;frame-ancestors &#39;none&#39;&quot;</span>

<span class="c1"># â”€â”€ ë™ì¼ ì¶œì²˜ë§Œ í—ˆìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">csp_same_origin</span> <span class="o">=</span> <span class="s2">&quot;frame-ancestors &#39;self&#39;&quot;</span>

<span class="c1"># â”€â”€ íŠ¹ì • ì¶œì²˜ í—ˆìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">csp_specific</span> <span class="o">=</span> <span class="s2">&quot;frame-ancestors &#39;self&#39; https://trusted.example.com https://partner.example.com&quot;</span>

<span class="c1"># â”€â”€ X-Frame-Optionsì™€ì˜ ì£¼ìš” ì°¨ì´ì  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1">#</span>
<span class="c1"># | ê¸°ëŠ¥                | X-Frame-Options      | frame-ancestors        |</span>
<span class="c1"># |---------------------|----------------------|------------------------|</span>
<span class="c1"># | ë‹¤ì¤‘ ì¶œì²˜           | ì•„ë‹ˆì˜¤               | ì˜ˆ                     |</span>
<span class="c1"># | ì™€ì¼ë“œì¹´ë“œ ì„œë¸Œë„ë©”ì¸| ì•„ë‹ˆì˜¤               | ì˜ˆ (*.example.com)     |</span>
<span class="c1"># | ìŠ¤í‚´ ì œí•œ           | ì•„ë‹ˆì˜¤               | ì˜ˆ (https:)            |</span>
<span class="c1"># | CSP í†µí•©            | ë³„ë„ í—¤ë”            | CSPì˜ ì¼ë¶€             |</span>
<span class="c1"># | ë¸Œë¼ìš°ì € ì§€ì›       | ë²”ìš©                 | ìµœì‹  ë¸Œë¼ìš°ì €          |</span>
<span class="c1">#</span>
<span class="c1"># ê¶Œì¥ì‚¬í•­: ìµœëŒ€ í˜¸í™˜ì„±ì„ ìœ„í•´ ë‘˜ ë‹¤ ì„¤ì •</span>
<span class="c1"># X-Frame-Options: DENY</span>
<span class="c1"># Content-Security-Policy: frame-ancestors &#39;none&#39;</span>
</code></pre></div>

<hr />
<h2 id="6-referrer-policy">6. Referrer-Policy<a class="header-link" href="#6-referrer-policy" title="Permanent link">&para;</a></h2>
<h3 id="61-referrer">6.1 Referrer ì •ë³´ ìœ ì¶œ<a class="header-link" href="#61-referrer" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Referrer ìœ ì¶œ ì‹œë‚˜ë¦¬ì˜¤                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ì‚¬ìš©ìê°€ ë‹¤ìŒì— ìˆìŒ: https://bank.com/accounts/12345/transfer?amount=500 â”‚
â”‚                                                                      â”‚
â”‚  ë§í¬ë¥¼ í´ë¦­: https://analytics.example.com                          â”‚
â”‚                                                                      â”‚
â”‚  Referrer-Policy ì—†ì´:                                               â”‚
â”‚  Referer: https://bank.com/accounts/12345/transfer?amount=500        â”‚
â”‚  â†‘ ê²½ë¡œì™€ ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ë¥¼ í¬í•¨í•œ ì „ì²´ URL ìœ ì¶œ!                      â”‚
â”‚                                                                      â”‚
â”‚  Referrer-Policy: strict-origin-when-cross-originê³¼ í•¨ê»˜              â”‚
â”‚  Referer: https://bank.com                                           â”‚
â”‚  â†‘ ì¶œì²˜ë§Œ ì „ì†¡, ë¯¼ê°í•œ ê²½ë¡œë‚˜ ë§¤ê°œë³€ìˆ˜ ì—†ìŒ                          â”‚
â”‚                                                                      â”‚
â”‚  Referrer-Policy: no-referrerì™€ í•¨ê»˜                                 â”‚
â”‚  Referer: (ë¹„ì–´ ìˆìŒ)                                                â”‚
â”‚  â†‘ referrer ì •ë³´ê°€ ì „í˜€ ì „ì†¡ë˜ì§€ ì•ŠìŒ                                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="62">6.2 ì •ì±… ê°’<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì •ì±…</th>
<th>ë™ì¼ ì¶œì²˜</th>
<th>Cross-Origin (HTTPSâ†’HTTPS)</th>
<th>ë‹¤ìš´ê·¸ë ˆì´ë“œ (HTTPSâ†’HTTP)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>no-referrer</code></td>
<td>ì—†ìŒ</td>
<td>ì—†ìŒ</td>
<td>ì—†ìŒ</td>
</tr>
<tr>
<td><code>no-referrer-when-downgrade</code></td>
<td>ì „ì²´ URL</td>
<td>ì „ì²´ URL</td>
<td>ì—†ìŒ</td>
</tr>
<tr>
<td><code>origin</code></td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì¶œì²˜ë§Œ</td>
</tr>
<tr>
<td><code>origin-when-cross-origin</code></td>
<td>ì „ì²´ URL</td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì¶œì²˜ë§Œ</td>
</tr>
<tr>
<td><code>same-origin</code></td>
<td>ì „ì²´ URL</td>
<td>ì—†ìŒ</td>
<td>ì—†ìŒ</td>
</tr>
<tr>
<td><code>strict-origin</code></td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì—†ìŒ</td>
</tr>
<tr>
<td><code>strict-origin-when-cross-origin</code></td>
<td>ì „ì²´ URL</td>
<td>ì¶œì²˜ë§Œ</td>
<td>ì—†ìŒ</td>
</tr>
<tr>
<td><code>unsafe-url</code></td>
<td>ì „ì²´ URL</td>
<td>ì „ì²´ URL</td>
<td>ì „ì²´ URL</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ê¶Œì¥ Referrer-Policy êµ¬ì„±.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ê¸°ë³¸ ê¶Œì¥ì‚¬í•­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># strict-origin-when-cross-originì€ ìµœì‹  ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ê°’ì´ë©°</span>
<span class="c1"># ê¸°ëŠ¥ê³¼ ê°œì¸ì •ë³´ ë³´í˜¸ì˜ ì¢‹ì€ ê· í˜•ì„ ì œê³µí•©ë‹ˆë‹¤</span>
<span class="n">referrer_policy</span> <span class="o">=</span> <span class="s2">&quot;strict-origin-when-cross-origin&quot;</span>

<span class="c1"># â”€â”€ ìµœëŒ€ ê°œì¸ì •ë³´ ë³´í˜¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># no-referrerëŠ” ëª¨ë“  referrer ì •ë³´ë¥¼ ì œê±°í•©ë‹ˆë‹¤</span>
<span class="c1"># ë‹¨ì : ë¶„ì„ ë° ì¼ë¶€ CSRF ë³´í˜¸ë¥¼ ì†ìƒì‹œí‚µë‹ˆë‹¤</span>
<span class="n">referrer_max_privacy</span> <span class="o">=</span> <span class="s2">&quot;no-referrer&quot;</span>

<span class="c1"># â”€â”€ ë¯¼ê°í•œ URLì´ ìˆëŠ” ì‚¬ì´íŠ¸ìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># same-originì€ ë™ì¼ ì‚¬ì´íŠ¸ ë‚´ì—ì„œë§Œ ì „ì²´ referrer ì „ì†¡</span>
<span class="n">referrer_sensitive</span> <span class="o">=</span> <span class="s2">&quot;same-origin&quot;</span>

<span class="c1"># â”€â”€ ìš”ì†Œë³„ ì¬ì •ì˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ê°œë³„ ìš”ì†Œì—ë„ referrer ì •ì±…ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</span>
<span class="c1"># &lt;a href=&quot;...&quot; referrerpolicy=&quot;no-referrer&quot;&gt;ì™¸ë¶€ ë§í¬&lt;/a&gt;</span>
<span class="c1"># &lt;img src=&quot;...&quot; referrerpolicy=&quot;no-referrer&quot;&gt;</span>
<span class="c1"># &lt;script src=&quot;...&quot; referrerpolicy=&quot;no-referrer&quot;&gt;</span>
</code></pre></div>

<hr />
<h2 id="7-permissions-policy">7. Permissions-Policy<a class="header-link" href="#7-permissions-policy" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ë¸Œë¼ìš°ì € ê¸°ëŠ¥ ì œí•œ<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p>Permissions-Policy (ì´ì „ Feature-Policy)ëŠ” í˜ì´ì§€ì™€ í¬í•¨ëœ ì½˜í…ì¸ ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¸Œë¼ìš°ì € ê¸°ëŠ¥ ë° APIë¥¼ ì œì–´í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Permissions</span><span class="o">-</span><span class="n">Policy</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ë¸Œë¼ìš°ì €</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="err">ì ‘ê·¼</span><span class="w"> </span><span class="err">ì œì–´:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Camera</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Microphone</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Geolocation</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Payment</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nb">camera</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">microphone</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">geolocation</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">payment</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Fullscreen</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Autoplay</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">USB</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Bluetooth</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">fullscreen</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">autoplay</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">usb</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">bluetooth</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ë¬¸ë²•:</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Permissions</span><span class="o">-</span><span class="n">Policy</span><span class="err">:</span><span class="w"> </span><span class="n">feature</span><span class="o">=</span><span class="p">(</span><span class="n">allowlist</span><span class="p">)</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">í—ˆìš©</span><span class="w"> </span><span class="err">ëª©ë¡</span><span class="w"> </span><span class="err">ê°’:</span><span class="w">                                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">*</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="err">ëª¨ë“ </span><span class="w"> </span><span class="err">ì¶œì²˜</span><span class="w"> </span><span class="err">í—ˆìš©</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">self</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="err">ë™ì¼</span><span class="w"> </span><span class="err">ì¶œì²˜ë§Œ</span><span class="w"> </span><span class="err">í—ˆìš©</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="err">ë¹„ì–´</span><span class="w"> </span><span class="err">ìˆìŒ</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="err">ëŠ”</span><span class="w"> </span><span class="err">ì™„ì „íˆ</span><span class="w"> </span><span class="err">ì°¨ë‹¨ì„</span><span class="w"> </span><span class="err">ì˜ë¯¸</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;origin&quot;</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="err">íŠ¹ì •</span><span class="w"> </span><span class="err">ì¶œì²˜</span><span class="w"> </span><span class="err">í—ˆìš©</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="72">7.2 êµ¬ì„± ì˜ˆì œ<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Permissions-Policy í—¤ë” êµ¬ì„±.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ì œí•œì  ì •ì±… (ëŒ€ë¶€ë¶„ì˜ ì‚¬ì´íŠ¸ì— ê¶Œì¥) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">permissions_policy</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;camera=(), &quot;</span>                              <span class="c1"># ì¹´ë©”ë¼ ì°¨ë‹¨</span>
    <span class="s2">&quot;microphone=(), &quot;</span>                          <span class="c1"># ë§ˆì´í¬ ì°¨ë‹¨</span>
    <span class="s2">&quot;geolocation=(), &quot;</span>                         <span class="c1"># ìœ„ì¹˜ì •ë³´ ì°¨ë‹¨</span>
    <span class="s2">&quot;payment=(), &quot;</span>                             <span class="c1"># Payment API ì°¨ë‹¨</span>
    <span class="s2">&quot;usb=(), &quot;</span>                                 <span class="c1"># WebUSB ì°¨ë‹¨</span>
    <span class="s2">&quot;bluetooth=(), &quot;</span>                           <span class="c1"># Web Bluetooth ì°¨ë‹¨</span>
    <span class="s2">&quot;magnetometer=(), &quot;</span>                        <span class="c1"># ìë ¥ê³„ ì°¨ë‹¨</span>
    <span class="s2">&quot;gyroscope=(), &quot;</span>                           <span class="c1"># ìì´ë¡œìŠ¤ì½”í”„ ì°¨ë‹¨</span>
    <span class="s2">&quot;accelerometer=(), &quot;</span>                       <span class="c1"># ê°€ì†ë„ê³„ ì°¨ë‹¨</span>
    <span class="s1">&#39;autoplay=(self), &#39;</span>                        <span class="c1"># ë™ì¼ ì¶œì²˜ì—ì„œë§Œ ìë™ì¬ìƒ í—ˆìš©</span>
    <span class="s1">&#39;fullscreen=(self), &#39;</span>                      <span class="c1"># ë™ì¼ ì¶œì²˜ì—ì„œë§Œ ì „ì²´í™”ë©´ í—ˆìš©</span>
    <span class="s1">&#39;picture-in-picture=(self)&#39;</span>                <span class="c1"># ë™ì¼ ì¶œì²˜ì—ì„œë§Œ PiP í—ˆìš©</span>
<span class="p">)</span>

<span class="c1"># â”€â”€ í™”ìƒ íšŒì˜ ì•±ìš© ì •ì±… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">permissions_video_app</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;camera=(self &quot;https://meet.example.com&quot;), &#39;</span>
    <span class="s1">&#39;microphone=(self &quot;https://meet.example.com&quot;), &#39;</span>
    <span class="s2">&quot;geolocation=(), &quot;</span>
    <span class="s1">&#39;fullscreen=(self), &#39;</span>
    <span class="s1">&#39;display-capture=(self)&#39;</span>
<span class="p">)</span>

<span class="c1"># â”€â”€ ì „ììƒê±°ë˜ ì‚¬ì´íŠ¸ìš© ì •ì±… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">permissions_ecommerce</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;camera=(), &quot;</span>
    <span class="s2">&quot;microphone=(), &quot;</span>
    <span class="s1">&#39;geolocation=(self), &#39;</span>                     <span class="c1"># ë§¤ì¥ ìœ„ì¹˜ ì°¾ê¸°ìš©</span>
    <span class="s1">&#39;payment=(self), &#39;</span>                         <span class="c1"># Payment Request APIìš©</span>
    <span class="s2">&quot;usb=(), &quot;</span>
    <span class="s2">&quot;bluetooth=()&quot;</span>
<span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8-cross-origin-corp-coep-coop">8. Cross-Origin ì •ì±… (CORP, COEP, COOP)<a class="header-link" href="#8-cross-origin-corp-coep-coop" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ê°œìš”<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cross-Origin ê²©ë¦¬                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ì„¸ ê°œì˜ í—¤ë”ê°€ í•¨ê»˜ cross-origin ê²©ë¦¬ë¥¼ ìœ„í•´ ì‘ë™:                  â”‚
â”‚                                                                      â”‚
â”‚  CORP (Cross-Origin-Resource-Policy)                                 â”‚
â”‚  â”œâ”€â”€ ë¦¬ì†ŒìŠ¤(ì´ë¯¸ì§€, ìŠ¤í¬ë¦½íŠ¸ ë“±)ì— ì„¤ì •                              â”‚
â”‚  â”œâ”€â”€ ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆëŠ” ëŒ€ìƒ ì œì–´                            â”‚
â”‚  â””â”€â”€ ê°’: same-site, same-origin, cross-origin                        â”‚
â”‚                                                                      â”‚
â”‚  COEP (Cross-Origin-Embedder-Policy)                                 â”‚
â”‚  â”œâ”€â”€ ë¦¬ì†ŒìŠ¤ë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œì— ì„¤ì •                                   â”‚
â”‚  â”œâ”€â”€ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ì˜µíŠ¸ì¸(CORP ë˜ëŠ” CORSë¥¼ í†µí•´)í•´ì•¼ í•¨              â”‚
â”‚  â””â”€â”€ ê°’: unsafe-none, require-corp, credentialless                   â”‚
â”‚                                                                      â”‚
â”‚  COOP (Cross-Origin-Opener-Policy)                                   â”‚
â”‚  â”œâ”€â”€ ë¬¸ì„œì— ì„¤ì •                                                     â”‚
â”‚  â”œâ”€â”€ window.opener ê´€ê³„ ì œì–´                                         â”‚
â”‚  â””â”€â”€ ê°’: unsafe-none, same-origin, same-origin-allow-popups          â”‚
â”‚                                                                      â”‚
â”‚  COEP: require-corp + COOP: same-originì´ ëª¨ë‘ ì„¤ì •ë˜ë©´:             â”‚
â”‚  â”€â”€â–¶ í˜ì´ì§€ê°€ &quot;cross-origin isolated&quot;                                â”‚
â”‚  â”€â”€â–¶ SharedArrayBuffer, ê³ í•´ìƒë„ íƒ€ì´ë¨¸ í™œì„±í™”                       â”‚
â”‚  â”€â”€â–¶ Spectre ìŠ¤íƒ€ì¼ ì‚¬ì´ë“œ ì±„ë„ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸                    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="82-cross-origin-resource-policy-corp">8.2 Cross-Origin-Resource-Policy (CORP)<a class="header-link" href="#82-cross-origin-resource-policy-corp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CORPëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆëŠ” ì¶œì²˜ë¥¼ ì œì–´í•©ë‹ˆë‹¤.</span>
<span class="sd">API ì‘ë‹µ, ì´ë¯¸ì§€, ìŠ¤í¬ë¦½íŠ¸ ë“±ì— ì„¤ì •í•©ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ê°’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># same-origin:  ë™ì¼ ì¶œì²˜ì˜ ìš”ì²­ë§Œ</span>
<span class="c1"># same-site:    ë™ì¼ ì‚¬ì´íŠ¸ì˜ ìš”ì²­ (ì„œë¸Œë„ë©”ì¸ í¬í•¨)</span>
<span class="c1"># cross-origin: ëª¨ë“  ì¶œì²˜ê°€ ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œ ê°€ëŠ¥</span>

<span class="c1"># ë¹„ê³µê°œ API ì—”ë“œí¬ì¸íŠ¸ìš©</span>
<span class="n">corp_api</span> <span class="o">=</span> <span class="s2">&quot;same-origin&quot;</span>

<span class="c1"># ê³µê°œ CDN ë¦¬ì†ŒìŠ¤ìš©</span>
<span class="n">corp_cdn</span> <span class="o">=</span> <span class="s2">&quot;cross-origin&quot;</span>

<span class="c1"># ì„œë¸Œë„ë©”ì¸ ê°„ ê³µìœ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ìš©</span>
<span class="n">corp_shared</span> <span class="o">=</span> <span class="s2">&quot;same-site&quot;</span>
</code></pre></div>

<h3 id="83-cross-origin-embedder-policy-coep">8.3 Cross-Origin-Embedder-Policy (COEP)<a class="header-link" href="#83-cross-origin-embedder-policy-coep" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">COEPëŠ” í˜ì´ì§€ì— ë¡œë“œëœ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€</span>
<span class="sd">cross-originìœ¼ë¡œ ë¡œë“œë˜ëŠ” ê²ƒì— ëª…ì‹œì ìœ¼ë¡œ ì˜µíŠ¸ì¸í–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ require-corp: ê°€ì¥ ì—„ê²©í•œ ëª¨ë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ëª¨ë“  cross-origin ë¦¬ì†ŒìŠ¤ëŠ” ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ìˆ˜í–‰í•´ì•¼ í•¨:</span>
<span class="c1"># 1. CORP: cross-origin í—¤ë”ì™€ í•¨ê»˜ ì œê³µ</span>
<span class="c1"># 2. crossorigin ì†ì„±ìœ¼ë¡œ ë¡œë“œ (CORS)</span>
<span class="n">coep_strict</span> <span class="o">=</span> <span class="s2">&quot;require-corp&quot;</span>

<span class="c1"># HTMLì—ì„œ ë¦¬ì†ŒìŠ¤ì— crossorigin ì†ì„± í•„ìš”:</span>
<span class="c1"># &lt;img src=&quot;https://cdn.example.com/image.jpg&quot; crossorigin&gt;</span>
<span class="c1"># &lt;script src=&quot;https://cdn.example.com/lib.js&quot; crossorigin&gt;</span>

<span class="c1"># â”€â”€ credentialless: ë” ì‹¤ìš©ì  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># Cross-origin ìš”ì²­ì´ ìê²© ì¦ëª…(ì¿ í‚¤) ì—†ì´ ì´ë£¨ì–´ì§</span>
<span class="c1"># ë¦¬ì†ŒìŠ¤ì— CORP í—¤ë” ë¶ˆí•„ìš”</span>
<span class="n">coep_credentialless</span> <span class="o">=</span> <span class="s2">&quot;credentialless&quot;</span>

<span class="c1"># â”€â”€ unsafe-none: ì œí•œ ì—†ìŒ (ê¸°ë³¸ê°’) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">coep_none</span> <span class="o">=</span> <span class="s2">&quot;unsafe-none&quot;</span>
</code></pre></div>

<h3 id="84-cross-origin-opener-policy-coop">8.4 Cross-Origin-Opener-Policy (COOP)<a class="header-link" href="#84-cross-origin-opener-policy-coop" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">COOPëŠ” í˜ì´ì§€ì™€ opener ê°„ì˜ ê´€ê³„ë¥¼ ì œì–´í•©ë‹ˆë‹¤</span>
<span class="sd">(window.open ë˜ëŠ” ë§í¬ë¥¼ í†µí•´ ì—° í˜ì´ì§€).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ same-origin: ì™„ì „ ê²©ë¦¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># cross-origin í˜ì´ì§€ì— ëŒ€í•œ window.opener ì°¸ì¡° ëŠìŒ</span>
<span class="c1"># cross-origin í˜ì´ì§€ê°€ ì´ ì°½ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€</span>
<span class="n">coop_strict</span> <span class="o">=</span> <span class="s2">&quot;same-origin&quot;</span>

<span class="c1"># â”€â”€ same-origin-allow-popups â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># same-originê³¼ ë™ì¼í•˜ì§€ë§Œ, ì´ í˜ì´ì§€ì—ì„œ ì—° íŒì—…ì€</span>
<span class="c1"># opener ì°¸ì¡°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŒ</span>
<span class="n">coop_popups</span> <span class="o">=</span> <span class="s2">&quot;same-origin-allow-popups&quot;</span>

<span class="c1"># â”€â”€ unsafe-none: ì œí•œ ì—†ìŒ (ê¸°ë³¸ê°’) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">coop_none</span> <span class="o">=</span> <span class="s2">&quot;unsafe-none&quot;</span>

<span class="c1"># â”€â”€ cross-origin ê²©ë¦¬ ë‹¬ì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ë‘ í—¤ë” ëª¨ë‘ í•„ìš”:</span>
<span class="c1"># Cross-Origin-Embedder-Policy: require-corp</span>
<span class="c1"># Cross-Origin-Opener-Policy: same-origin</span>
<span class="c1">#</span>
<span class="c1"># JavaScriptì—ì„œ í™•ì¸:</span>
<span class="c1"># if (crossOriginIsolated) {</span>
<span class="c1">#   // SharedArrayBuffer ì‚¬ìš© ê°€ëŠ¥</span>
<span class="c1">#   // Performance.now()ê°€ ì™„ì „í•œ ì •ë°€ë„ ì œê³µ</span>
<span class="c1"># }</span>
</code></pre></div>

<hr />
<h2 id="9-subresource-integrity-sri">9. Subresource Integrity (SRI)<a class="header-link" href="#9-subresource-integrity-sri" title="Permanent link">&para;</a></h2>
<h3 id="91-sri">9.1 SRI ì‘ë™ ë°©ì‹<a class="header-link" href="#91-sri" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Subresource Integrity (SRI)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ë¬¸ì œ: CDN ì¹¨í•´                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Your App â”‚â”€â”€â”€â–¶â”‚   CDN    â”‚â”€â”€â”€â–¶â”‚ Browser  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                       â†‘                                              â”‚
â”‚                   ê³µê²©ìê°€ CDNì˜                                     â”‚
â”‚                   jquery.min.jsë¥¼                                    â”‚
â”‚                   ìˆ˜ì •                                               â”‚
â”‚                                                                      â”‚
â”‚  í•´ê²°ì±…: SRI í•´ì‹œ í™•ì¸                                               â”‚
â”‚  &lt;script src=&quot;https://cdn/jquery.js&quot;                                â”‚
â”‚          integrity=&quot;sha384-abc123...&quot;                                â”‚
â”‚          crossorigin=&quot;anonymous&quot;&gt;                                    â”‚
â”‚  &lt;/script&gt;                                                           â”‚
â”‚                                                                      â”‚
â”‚  ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ â”€â”€â–¶ í•´ì‹œ ê³„ì‚° â”€â”€â–¶ integrityì™€ ë¹„êµ         â”‚
â”‚  ì¼ì¹˜?    âœ“ ì‹¤í–‰     âœ— ì°¨ë‹¨ ë° ì˜¤ë¥˜ ë³´ê³                              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="92-sri">9.2 SRI í•´ì‹œ ìƒì„±<a class="header-link" href="#92-sri" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë¡œì»¬ íŒŒì¼ì—ì„œ SRI í•´ì‹œ ìƒì„±</span>
cat<span class="w"> </span>jquery-3.7.1.min.js<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>dgst<span class="w"> </span>-sha384<span class="w"> </span>-binary<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>base64<span class="w"> </span>-A
<span class="c1"># ì¶œë ¥: oQVuAfEn...</span>

<span class="c1"># shasumì„ ì‚¬ìš©í•˜ì—¬ SRI í•´ì‹œ ìƒì„±</span>
shasum<span class="w"> </span>-b<span class="w"> </span>-a<span class="w"> </span><span class="m">384</span><span class="w"> </span>jquery-3.7.1.min.js<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{ print $1 }&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xxd<span class="w"> </span>-r<span class="w"> </span>-p<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64

<span class="c1"># curlì„ ì‚¬ìš©í•˜ì—¬ ì›ê²© íŒŒì¼ì—ì„œ í•´ì‹œ ìƒì„±</span>
curl<span class="w"> </span>-s<span class="w"> </span>https://code.jquery.com/jquery-3.7.1.min.js<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>openssl<span class="w"> </span>dgst<span class="w"> </span>-sha384<span class="w"> </span>-binary<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>base64<span class="w"> </span>-A
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pythonì—ì„œ SRI í•´ì‹œ ìƒì„± ë° í™•ì¸.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_sri_hash</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sha384&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì£¼ì–´ì§„ ì½˜í…ì¸ ì— ëŒ€í•œ SRI í•´ì‹œ ìƒì„±.&quot;&quot;&quot;</span>
    <span class="n">hash_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">hashlib</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">hash_func</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">b64</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_sri_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  SRI í•´ì‹œ ìƒì„±.&quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">generate_sri_hash</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì œ</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot;</span>
<span class="n">sri_hash</span> <span class="o">=</span> <span class="n">generate_sri_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;integrity=&quot;</span><span class="si">{</span><span class="n">sri_hash</span><span class="si">}</span><span class="s1">&quot; crossorigin=&quot;anonymous&quot;&gt;&#39;</span><span class="p">)</span>

<span class="c1"># â”€â”€ HTMLì—ì„œ SRI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># ìŠ¤í¬ë¦½íŠ¸ìš©:</span>
<span class="c1"># &lt;script src=&quot;https://cdn.example.com/lib.js&quot;</span>
<span class="c1">#         integrity=&quot;sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC&quot;</span>
<span class="c1">#         crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span>
<span class="c1">#</span>
<span class="c1"># ìŠ¤íƒ€ì¼ì‹œíŠ¸ìš©:</span>
<span class="c1"># &lt;link rel=&quot;stylesheet&quot;</span>
<span class="c1">#       href=&quot;https://cdn.example.com/style.css&quot;</span>
<span class="c1">#       integrity=&quot;sha384-abc123...&quot;</span>
<span class="c1">#       crossorigin=&quot;anonymous&quot;&gt;</span>
<span class="c1">#</span>
<span class="c1"># ë‹¤ì¤‘ í•´ì‹œ (ë§ˆì´ê·¸ë ˆì´ì…˜ìš©):</span>
<span class="c1"># &lt;script src=&quot;https://cdn.example.com/lib.js&quot;</span>
<span class="c1">#         integrity=&quot;sha384-oldHash... sha384-newHash...&quot;</span>
<span class="c1">#         crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span>
<span class="c1"># ë¸Œë¼ìš°ì €ëŠ” ì–´ë–¤ í•´ì‹œë“  ì¼ì¹˜í•˜ë©´ í—ˆìš©</span>

<span class="c1"># â”€â”€ ì¤‘ìš” ì°¸ê³ ì‚¬í•­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># 1. cross-origin SRIì—ëŠ” crossorigin=&quot;anonymous&quot; í•„ìˆ˜</span>
<span class="c1"># 2. SRIëŠ” &lt;script&gt;ì™€ &lt;link rel=&quot;stylesheet&quot;&gt;ì—ë§Œ ì‘ë™</span>
<span class="c1"># 3. í•´ì‹œëŠ” ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ì¼ì¹˜í•´ì•¼ í•¨ (ê³µë°±ë„ ì¤‘ìš”)</span>
<span class="c1"># 4. CDNì´ íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ë©´ í•´ì‹œê°€ ê¹¨ì§ (ì˜ë„ëœ ë™ì‘)</span>
</code></pre></div>

<hr />
<h2 id="10-flask">10. Flask ë³´ì•ˆ í—¤ë” êµ¬ì„±<a class="header-link" href="#10-flask" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 ìˆ˜ë™ í—¤ë” ì„¤ì •<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Flask ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë³´ì•ˆ í—¤ë” ì„¤ì •.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">g</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># â”€â”€ ë°©ë²• 1: after_request ë°ì½”ë ˆì´í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">after_request</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_security_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ëª¨ë“  ì‘ë‹µì— ë³´ì•ˆ í—¤ë” ì¶”ê°€.&quot;&quot;&quot;</span>

    <span class="c1"># CSPìš© nonce ìƒì„±</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;csp_nonce&#39;</span><span class="p">,</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>

    <span class="c1"># Content-Security-Policy</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;default-src &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;script-src &#39;self&#39; &#39;nonce-</span><span class="si">{</span><span class="n">nonce</span><span class="si">}</span><span class="s2">&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;style-src &#39;self&#39; &#39;nonce-</span><span class="si">{</span><span class="n">nonce</span><span class="si">}</span><span class="s2">&#39; https://fonts.googleapis.com; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;font-src &#39;self&#39; https://fonts.gstatic.com; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;img-src &#39;self&#39; data:; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;connect-src &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;object-src &#39;none&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;base-uri &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;form-action &#39;self&#39;; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;frame-ancestors &#39;none&#39;&quot;</span>
    <span class="p">)</span>

    <span class="c1"># HSTS (í”„ë¡œë•ì…˜ì—ì„œ HTTPSë¥¼ í†µí•´ì„œë§Œ ì„¤ì •)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;max-age=31536000; includeSubDomains; preload&#39;</span>
    <span class="p">)</span>

    <span class="c1"># MIME ìŠ¤ë‹ˆí•‘ ë°©ì§€</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nosniff&#39;</span>

    <span class="c1"># í´ë¦­ì¬í‚¹ ë³´í˜¸</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DENY&#39;</span>

    <span class="c1"># Referrer ì œì–´</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Referrer-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;strict-origin-when-cross-origin&#39;</span>

    <span class="c1"># Permissions ì •ì±…</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Permissions-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;camera=(), microphone=(), geolocation=(), payment=()&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Cross-origin ì •ì±…</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;same-origin&#39;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Cross-Origin-Resource-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;same-origin&#39;</span>

    <span class="c1"># ì„œë²„ ì‹ë³„ ì œê±°</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;Server&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">before_request</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_nonce</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê° ìš”ì²­ì— ëŒ€í•œ CSP nonce ìƒì„±.&quot;&quot;&quot;</span>
    <span class="n">g</span><span class="o">.</span><span class="n">csp_nonce</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>


<span class="c1"># â”€â”€ ë°©ë²• 2: Flask-Talisman ì‚¬ìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># pip install flask-talisman</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask_talisman</span><span class="w"> </span><span class="kn">import</span> <span class="n">Talisman</span>

<span class="n">app2</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">csp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;script-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;style-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;self&#39; https://fonts.googleapis.com&quot;</span><span class="p">,</span>
    <span class="s1">&#39;font-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;self&#39; https://fonts.gstatic.com&quot;</span><span class="p">,</span>
    <span class="s1">&#39;img-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;self&#39; data:&quot;</span><span class="p">,</span>
    <span class="s1">&#39;object-src&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">talisman</span> <span class="o">=</span> <span class="n">Talisman</span><span class="p">(</span>
    <span class="n">app2</span><span class="p">,</span>
    <span class="n">content_security_policy</span><span class="o">=</span><span class="n">csp</span><span class="p">,</span>
    <span class="n">content_security_policy_nonce_in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;script-src&#39;</span><span class="p">,</span> <span class="s1">&#39;style-src&#39;</span><span class="p">],</span>
    <span class="n">force_https</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">strict_transport_security</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">strict_transport_security_max_age</span><span class="o">=</span><span class="mi">31536000</span><span class="p">,</span>
    <span class="n">strict_transport_security_include_subdomains</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">strict_transport_security_preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">frame_options</span><span class="o">=</span><span class="s1">&#39;DENY&#39;</span><span class="p">,</span>
    <span class="n">referrer_policy</span><span class="o">=</span><span class="s1">&#39;strict-origin-when-cross-origin&#39;</span><span class="p">,</span>
    <span class="n">permissions_policy</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;camera&#39;</span><span class="p">:</span> <span class="s1">&#39;()&#39;</span><span class="p">,</span>
        <span class="s1">&#39;microphone&#39;</span><span class="p">:</span> <span class="s1">&#39;()&#39;</span><span class="p">,</span>
        <span class="s1">&#39;geolocation&#39;</span><span class="p">:</span> <span class="s1">&#39;()&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">session_cookie_secure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">session_cookie_http_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Jinja2 í…œí”Œë¦¿ì—ì„œ nonce ì‚¬ìš©:</span>
<span class="c1"># &lt;script nonce=&quot;{{ csp_nonce() }}&quot;&gt;</span>
<span class="c1">#     // ì—¬ê¸°ì— ì¸ë¼ì¸ JavaScript</span>
<span class="c1"># &lt;/script&gt;</span>
</code></pre></div>

<h3 id="102">10.2 ë¼ìš°íŠ¸ë³„ í—¤ë” ì¬ì •ì˜<a class="header-link" href="#102" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ì„œë¡œ ë‹¤ë¥¸ ë¼ìš°íŠ¸ì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ ë³´ì•ˆ í—¤ë”.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">make_response</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">custom_csp</span><span class="p">(</span><span class="n">csp_string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;íŠ¹ì • ë¼ìš°íŠ¸ì— ëŒ€í•œ CSPë¥¼ ì¬ì •ì˜í•˜ëŠ” ë°ì½”ë ˆì´í„°.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csp_string</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">return</span> <span class="n">decorated_function</span>
    <span class="k">return</span> <span class="n">decorator</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/admin&#39;</span><span class="p">)</span>
<span class="nd">@custom_csp</span><span class="p">(</span><span class="s2">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;; frame-ancestors &#39;none&#39;&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">admin_panel</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì—„ê²©í•œ CSPê°€ ìˆëŠ” ê´€ë¦¬ì íŒ¨ë„.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;Admin Panel&quot;</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/embed-widget&#39;</span><span class="p">)</span>
<span class="nd">@custom_csp</span><span class="p">(</span>
    <span class="s2">&quot;default-src &#39;self&#39;; &quot;</span>
    <span class="s2">&quot;frame-ancestors &#39;self&#39; https://partner.example.com&quot;</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">embeddable_widget</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;íŠ¹ì • íŒŒíŠ¸ë„ˆê°€ ì„ë² ë“œí•  ìˆ˜ ìˆëŠ” ìœ„ì ¯.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;Widget&quot;</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/public-api&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">public_api</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;cross-origin ì ‘ê·¼ì„ ìœ„í•´ ì™„í™”ëœ CORPê°€ ìˆëŠ” API ì—”ë“œí¬ì¸íŠ¸.&quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">({</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">})</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Cross-Origin-Resource-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cross-origin&#39;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>

<hr />
<h2 id="11-django">11. Django ë³´ì•ˆ í—¤ë” êµ¬ì„±<a class="header-link" href="#11-django" title="Permanent link">&para;</a></h2>
<h3 id="111-django">11.1 Django ì„¤ì •<a class="header-link" href="#111-django" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">settings.pyì—ì„œ Django ë³´ì•ˆ í—¤ë” êµ¬ì„±.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€ ë‚´ì¥ Django ë³´ì•ˆ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>

<span class="c1"># HSTS</span>
<span class="n">SECURE_HSTS_SECONDS</span> <span class="o">=</span> <span class="mi">31536000</span>           <span class="c1"># 1ë…„</span>
<span class="n">SECURE_HSTS_INCLUDE_SUBDOMAINS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">SECURE_HSTS_PRELOAD</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># HTTPS ë¦¬ë””ë ‰íŠ¸</span>
<span class="n">SECURE_SSL_REDIRECT</span> <span class="o">=</span> <span class="kc">True</span>               <span class="c1"># HTTPë¥¼ HTTPSë¡œ ë¦¬ë””ë ‰íŠ¸</span>
<span class="n">SECURE_REDIRECT_EXEMPT</span> <span class="o">=</span> <span class="p">[]</span>              <span class="c1"># ë¦¬ë””ë ‰íŠ¸ì—ì„œ ì œì™¸í•  ê²½ë¡œ</span>

<span class="c1"># Content-Type ìŠ¤ë‹ˆí•‘</span>
<span class="n">SECURE_CONTENT_TYPE_NOSNIFF</span> <span class="o">=</span> <span class="kc">True</span>       <span class="c1"># X-Content-Type-Options: nosniff</span>

<span class="c1"># í´ë¦­ì¬í‚¹ ë³´í˜¸</span>
<span class="n">X_FRAME_OPTIONS</span> <span class="o">=</span> <span class="s1">&#39;DENY&#39;</span>                 <span class="c1"># ë‚´ì¥ ë¯¸ë“¤ì›¨ì–´</span>

<span class="c1"># Referrer ì •ì±…</span>
<span class="n">SECURE_REFERRER_POLICY</span> <span class="o">=</span> <span class="s1">&#39;strict-origin-when-cross-origin&#39;</span>

<span class="c1"># Cross-origin opener ì •ì±…</span>
<span class="n">SECURE_CROSS_ORIGIN_OPENER_POLICY</span> <span class="o">=</span> <span class="s1">&#39;same-origin&#39;</span>

<span class="c1"># ì¿ í‚¤ ë³´ì•ˆ</span>
<span class="n">SESSION_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">SESSION_COOKIE_HTTPONLY</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">SESSION_COOKIE_SAMESITE</span> <span class="o">=</span> <span class="s1">&#39;Lax&#39;</span>
<span class="n">CSRF_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">CSRF_COOKIE_HTTPONLY</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># â”€â”€ í•„ìš”í•œ ë¯¸ë“¤ì›¨ì–´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>       <span class="c1"># ë°˜ë“œì‹œ ì²« ë²ˆì§¸</span>
    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
    <span class="c1"># ... ë‹¤ë¥¸ ë¯¸ë“¤ì›¨ì–´</span>
<span class="p">]</span>
</code></pre></div>

<h3 id="112-django-csp-django-csp">11.2 django-cspë¥¼ ì‚¬ìš©í•œ Django CSP<a class="header-link" href="#112-django-csp-django-csp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">django-csp íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•œ CSP êµ¬ì„±.</span>
<span class="sd">pip install django-csp</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># settings.py</span>
<span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;csp.middleware.CSPMiddleware&#39;</span><span class="p">,</span>
    <span class="c1"># ... ë‹¤ë¥¸ ë¯¸ë“¤ì›¨ì–´</span>
<span class="p">]</span>

<span class="c1"># CSP ì§€ì‹œë¬¸</span>
<span class="n">CSP_DEFAULT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_SCRIPT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_STYLE_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;https://fonts.googleapis.com&quot;</span><span class="p">)</span>
<span class="n">CSP_FONT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;https://fonts.gstatic.com&quot;</span><span class="p">)</span>
<span class="n">CSP_IMG_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;data:&quot;</span><span class="p">)</span>
<span class="n">CSP_CONNECT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_OBJECT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_BASE_URI</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_FORM_ACTION</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<span class="n">CSP_FRAME_ANCESTORS</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">,)</span>

<span class="c1"># script-srcì™€ style-srcì— nonce í™œì„±í™”</span>
<span class="n">CSP_INCLUDE_NONCE_IN</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;script-src&#39;</span><span class="p">,</span> <span class="s1">&#39;style-src&#39;</span><span class="p">]</span>

<span class="c1"># ìœ„ë°˜ ë³´ê³ </span>
<span class="n">CSP_REPORT_URI</span> <span class="o">=</span> <span class="s1">&#39;/csp-report/&#39;</span>

<span class="c1"># Report-only ëª¨ë“œ (í…ŒìŠ¤íŠ¸ìš©)</span>
<span class="c1"># CSP_REPORT_ONLY = True</span>


<span class="c1"># â”€â”€ Django í…œí”Œë¦¿ì—ì„œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># {% load csp %}</span>
<span class="c1">#</span>
<span class="c1"># &lt;script nonce=&quot;{% csp_nonce %}&quot;&gt;</span>
<span class="c1">#     // ì´ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” nonceì— ì˜í•´ í—ˆìš©ë¨</span>
<span class="c1">#     console.log(&#39;Hello from a nonced script&#39;);</span>
<span class="c1"># &lt;/script&gt;</span>
<span class="c1">#</span>
<span class="c1"># â”€â”€ ë·°ë³„ CSP ì¬ì •ì˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="c1"># from csp.decorators import csp_update, csp_replace, csp_exempt</span>
<span class="c1">#</span>
<span class="c1"># @csp_update(SCRIPT_SRC=(&quot;&#39;self&#39;&quot;, &quot;https://cdn.example.com&quot;))</span>
<span class="c1"># def my_view(request):</span>
<span class="c1">#     ...</span>
<span class="c1">#</span>
<span class="c1"># @csp_exempt  # ì´ ë·°ì— ëŒ€í•´ CSP ì™„ì „íˆ ë¹„í™œì„±í™”</span>
<span class="c1"># def legacy_view(request):</span>
<span class="c1">#     ...</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. ë³´ì•ˆ í—¤ë” í…ŒìŠ¤íŠ¸<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="121-curl">12.1 curlë¡œ í…ŒìŠ¤íŠ¸<a class="header-link" href="#121-curl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># â”€â”€ ëª¨ë“  ì‘ë‹µ í—¤ë” ë³´ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
curl<span class="w"> </span>-I<span class="w"> </span>https://example.com

<span class="c1"># â”€â”€ íŠ¹ì • ë³´ì•ˆ í—¤ë” í™•ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
curl<span class="w"> </span>-sI<span class="w"> </span>https://example.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-iE<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;(content-security|strict-transport|x-content-type|x-frame|referrer-policy|permissions-policy|cross-origin)&#39;</span>

<span class="c1"># â”€â”€ TLS ì„¸ë¶€ì •ë³´ë„ ë³´ê¸° ìœ„í•œ ìƒì„¸ ì¶œë ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
curl<span class="w"> </span>-vI<span class="w"> </span>https://example.com<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-40

<span class="c1"># â”€â”€ HSTS í…ŒìŠ¤íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
curl<span class="w"> </span>-sI<span class="w"> </span>https://example.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>strict-transport

<span class="c1"># â”€â”€ report-only ëª¨ë“œì—ì„œ CSP í…ŒìŠ¤íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
curl<span class="w"> </span>-sI<span class="w"> </span>https://example.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>content-security-policy

<span class="c1"># â”€â”€ ëˆ„ë½ëœ í—¤ë” í™•ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="nv">HEADERS_TO_CHECK</span><span class="o">=(</span>
<span class="w">    </span><span class="s2">&quot;Content-Security-Policy&quot;</span>
<span class="w">    </span><span class="s2">&quot;Strict-Transport-Security&quot;</span>
<span class="w">    </span><span class="s2">&quot;X-Content-Type-Options&quot;</span>
<span class="w">    </span><span class="s2">&quot;X-Frame-Options&quot;</span>
<span class="w">    </span><span class="s2">&quot;Referrer-Policy&quot;</span>
<span class="w">    </span><span class="s2">&quot;Permissions-Policy&quot;</span>
<span class="o">)</span>

<span class="nv">URL</span><span class="o">=</span><span class="s2">&quot;https://example.com&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Checking security headers for </span><span class="nv">$URL</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;==================================&quot;</span>

<span class="k">for</span><span class="w"> </span>header<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HEADERS_TO_CHECK</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-sI<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;^</span><span class="nv">$header</span><span class="s2">:&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[PASS] </span><span class="nv">$result</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[FAIL] Missing: </span><span class="nv">$header</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="122-python">12.2 Python ë³´ì•ˆ í—¤ë” ìŠ¤ìºë„ˆ<a class="header-link" href="#122-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ê°„ë‹¨í•œ ë³´ì•ˆ í—¤ë” ìŠ¤ìºë„ˆ.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HeaderCheck</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">present</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &#39;critical&#39;, &#39;high&#39;, &#39;medium&#39;, &#39;low&#39;</span>
    <span class="n">recommendation</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">def</span><span class="w"> </span><span class="nf">scan_security_headers</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeaderCheck</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;URLì˜ ë³´ì•ˆ í—¤ë”ë¥¼ ìŠ¤ìº”í•˜ê³  ê²°ê³¼ ë°˜í™˜.&quot;&quot;&quot;</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># â”€â”€ Content-Security-Policy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">csp</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">csp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">csp</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;CSP í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”. ë‹¤ìŒìœ¼ë¡œ ì‹œì‘: &quot;</span>
            <span class="s2">&quot;Content-Security-Policy: default-src &#39;self&#39;; &quot;</span>
            <span class="s2">&quot;object-src &#39;none&#39;; base-uri &#39;self&#39;&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">csp</span> <span class="k">else</span> <span class="n">_analyze_csp</span><span class="p">(</span><span class="n">csp</span><span class="p">)</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ Strict-Transport-Security â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">hsts</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">hsts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">hsts</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;HSTS í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”: &quot;</span>
            <span class="s2">&quot;Strict-Transport-Security: max-age=31536000; &quot;</span>
            <span class="s2">&quot;includeSubDomains; preload&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">hsts</span> <span class="k">else</span> <span class="n">_analyze_hsts</span><span class="p">(</span><span class="n">hsts</span><span class="p">)</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ X-Content-Type-Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">xcto</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">xcto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">xcto</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”: X-Content-Type-Options: nosniff&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">xcto</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ X-Frame-Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">xfo</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">xfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">xfo</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”: X-Frame-Options: DENY &quot;</span>
            <span class="s2">&quot;(ë˜ëŠ” í”„ë ˆì´ë°ì´ í•„ìš”í•œ ê²½ìš° SAMEORIGIN)&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">xfo</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ Referrer-Policy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">rp</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Referrer-Policy&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Referrer-Policy&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">rp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">rp</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”: Referrer-Policy: &quot;</span>
            <span class="s2">&quot;strict-origin-when-cross-origin&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">rp</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ Permissions-Policy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Permissions-Policy&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Permissions-Policy&#39;</span><span class="p">,</span>
        <span class="n">present</span><span class="o">=</span><span class="n">pp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span>
        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
        <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;í—¤ë”ë¥¼ ì¶”ê°€í•˜ì„¸ìš”: Permissions-Policy: &quot;</span>
            <span class="s2">&quot;camera=(), microphone=(), geolocation=()&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pp</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>
    <span class="p">))</span>

    <span class="c1"># â”€â”€ ìœ„í—˜í•œ í—¤ë” í™•ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Server&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Server&#39;</span><span class="p">,</span>
            <span class="n">present</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">server</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span>
            <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Server í—¤ë”ê°€ ë‹¤ìŒì„ ë…¸ì¶œ: &#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                <span class="s2">&quot;ì œê±° ë˜ëŠ” ë‚œë…í™”ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.&quot;</span>
            <span class="p">)</span>
        <span class="p">))</span>

    <span class="n">x_powered</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X-Powered-By&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x_powered</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HeaderCheck</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;X-Powered-By&#39;</span><span class="p">,</span>
            <span class="n">present</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">x_powered</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
            <span class="n">recommendation</span><span class="o">=</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;X-Powered-Byê°€ ë‹¤ìŒì„ ë…¸ì¶œ: &#39;</span><span class="si">{</span><span class="n">x_powered</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                <span class="s2">&quot;ì •ë³´ ê³µê°œë¥¼ í”¼í•˜ê¸° ìœ„í•´ ì´ í—¤ë”ë¥¼ ì œê±°í•˜ì„¸ìš”.&quot;</span>
            <span class="p">)</span>
        <span class="p">))</span>

    <span class="k">return</span> <span class="n">results</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_analyze_csp</span><span class="p">(</span><span class="n">csp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì¼ë°˜ì ì¸ ì•½ì ì— ëŒ€í•œ CSP ì •ì±… ë¶„ì„.&quot;&quot;&quot;</span>
    <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="s2">&quot;&#39;unsafe-inline&#39;&quot;</span> <span class="ow">in</span> <span class="n">csp</span> <span class="ow">and</span> <span class="s1">&#39;script-src&#39;</span> <span class="ow">in</span> <span class="n">csp</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;script-srcê°€ &#39;unsafe-inline&#39; í—ˆìš© (XSS ë³´í˜¸ ì•½í™”)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;&#39;unsafe-eval&#39;&quot;</span> <span class="ow">in</span> <span class="n">csp</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ì •ì±…ì´ &#39;unsafe-eval&#39; í—ˆìš© (eval() ê¸°ë°˜ ê³µê²© í™œì„±í™”)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;default-src&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">csp</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;default-src ëŒ€ì²´ ì§€ì‹œë¬¸ ëˆ„ë½&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;object-src&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">csp</span> <span class="ow">and</span> <span class="s2">&quot;default-src &#39;none&#39;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">csp</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;object-src ì§€ì‹œë¬¸ ëˆ„ë½ (Flash/í”ŒëŸ¬ê·¸ì¸ ìœ„í—˜)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;base-uri&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">csp</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;base-uri ëˆ„ë½ (dangling markup injection í™œì„±í™” ê°€ëŠ¥)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span> <span class="k">if</span> <span class="n">issues</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_analyze_hsts</span><span class="p">(</span><span class="n">hsts</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì•½ì ì— ëŒ€í•œ HSTS í—¤ë” ë¶„ì„.&quot;&quot;&quot;</span>
    <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hsts_lower</span> <span class="o">=</span> <span class="n">hsts</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;max-age=&#39;</span> <span class="ow">in</span> <span class="n">hsts_lower</span><span class="p">:</span>
        <span class="c1"># max-age ê°’ ì¶”ì¶œ</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;max-age=(\d+)&#39;</span><span class="p">,</span> <span class="n">hsts_lower</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">max_age</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">max_age</span> <span class="o">&lt;</span> <span class="mi">31536000</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;max-age=</span><span class="si">{</span><span class="n">max_age</span><span class="si">}</span><span class="s2">ê°€ 1ë…„(31536000)ë³´ë‹¤ ì‘ìŒ&quot;</span>
                <span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;includesubdomains&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hsts_lower</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;includeSubDomains ëˆ„ë½&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;preload&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hsts_lower</span><span class="p">:</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;preload ëˆ„ë½ (ë¸Œë¼ìš°ì € preload ëª©ë¡ì— ì í•©í•˜ì§€ ì•ŠìŒ)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span> <span class="k">if</span> <span class="n">issues</span> <span class="k">else</span> <span class="s2">&quot;OK&quot;</span>


<span class="c1"># â”€â”€ ì‚¬ìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;https://example.com&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ìŠ¤ìº” ì¤‘: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">scan_security_headers</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;PASS&quot;</span> <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">present</span> <span class="ow">and</span> <span class="n">check</span><span class="o">.</span><span class="n">recommendation</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span> <span class="k">else</span> <span class="s2">&quot;FAIL&quot;</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="s2">&quot;[+]&quot;</span> <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;PASS&quot;</span> <span class="k">else</span> <span class="s2">&quot;[-]&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">check</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">check</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ê°’: </span><span class="si">{</span><span class="n">check</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;(ì„¤ì •ë˜ì§€ ì•ŠìŒ)&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">recommendation</span> <span class="o">!=</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ê¶Œì¥ì‚¬í•­: </span><span class="si">{</span><span class="n">check</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="123">12.3 ì˜¨ë¼ì¸ ìŠ¤ìºë„ˆ<a class="header-link" href="#123" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë³´ì•ˆ í—¤ë” ìŠ¤ìºë„ˆ                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. SecurityHeaders.com                                              â”‚
â”‚     URL: https://securityheaders.com                                 â”‚
â”‚     ë“±ê¸‰: A+ì—ì„œ Fê¹Œì§€                                               â”‚
â”‚     ëª¨ë“  ì£¼ìš” ë³´ì•ˆ í—¤ë” í™•ì¸                                         â”‚
â”‚                                                                      â”‚
â”‚  2. Mozilla Observatory                                              â”‚
â”‚     URL: https://observatory.mozilla.org                             â”‚
â”‚     CSP ë¶„ì„ì„ í¬í•¨í•œ í¬ê´„ì ì¸ ìŠ¤ìº”                                  â”‚
â”‚     ê°œì„  ì¡°ì–¸ ì œê³µ                                                   â”‚
â”‚                                                                      â”‚
â”‚  3. CSP Evaluator (Google)                                           â”‚
â”‚     URL: https://csp-evaluator.withgoogle.com                        â”‚
â”‚     íŠ¹í™”ëœ CSP ë¶„ì„                                                  â”‚
â”‚     ìš°íšŒ ë° ì•½ì  ì‹ë³„                                                â”‚
â”‚                                                                      â”‚
â”‚  4. Hardenize                                                        â”‚
â”‚     URL: https://www.hardenize.com                                   â”‚
â”‚     í—¤ë” + TLS + DNS + ì´ë©”ì¼ ë³´ì•ˆ í…ŒìŠ¤íŠ¸                            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="13_1">13. ì™„ì „í•œ ë³´ì•ˆ í—¤ë” í…œí”Œë¦¿<a class="header-link" href="#13_1" title="Permanent link">&para;</a></h2>
<h3 id="131-nginx">13.1 Nginx êµ¬ì„±<a class="header-link" href="#131-nginx" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/nginx/conf.d/security-headers.conf</span>
<span class="c1"># ì„œë²„ ë¸”ë¡ì— ì´ê²ƒì„ í¬í•¨</span>

<span class="c1"># Content-Security-Policy</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Content-Security-Policy</span>
<span class="w">    </span><span class="s">&quot;default-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">script-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">style-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="w"> </span><span class="s">&#39;unsafe-inline&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">img-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="w"> </span><span class="s">data:</span><span class="p">;</span><span class="w"> </span><span class="k">font-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">connect-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">object-src</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">base-uri</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">form-action</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">frame-ancestors</span><span class="w"> </span><span class="s">&#39;none&#39;&quot;</span>
<span class="w">    </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># HSTS (ëª¨ë“  ê³³ì—ì„œ HTTPSê°€ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•œ í›„ì—ë§Œ í™œì„±í™”)</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span>
<span class="w">    </span><span class="s">&quot;max-age=31536000</span><span class="p">;</span><span class="w"> </span><span class="k">includeSubDomains</span><span class="p">;</span><span class="w"> </span><span class="k">preload&quot;</span>
<span class="w">    </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># MIME ìŠ¤ë‹ˆí•‘ ë°©ì§€</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">X-Content-Type-Options</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># í´ë¦­ì¬í‚¹ ë³´í˜¸</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">X-Frame-Options</span><span class="w"> </span><span class="s">&quot;DENY&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># Referrer ì •ì±…</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Referrer-Policy</span><span class="w"> </span><span class="s">&quot;strict-origin-when-cross-origin&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># Permissions ì •ì±…</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Permissions-Policy</span>
<span class="w">    </span><span class="s">&quot;camera=(),</span><span class="w"> </span><span class="s">microphone=(),</span><span class="w"> </span><span class="s">geolocation=(),</span><span class="w"> </span><span class="s">payment=()&quot;</span>
<span class="w">    </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># Cross-origin ì •ì±…</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Cross-Origin-Opener-Policy</span><span class="w"> </span><span class="s">&quot;same-origin&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Cross-Origin-Resource-Policy</span><span class="w"> </span><span class="s">&quot;same-origin&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="k">add_header</span><span class="w"> </span><span class="s">Cross-Origin-Embedder-Policy</span><span class="w"> </span><span class="s">&quot;require-corp&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="c1"># ì„œë²„ ë²„ì „ ì •ë³´ ì œê±°</span>
<span class="k">server_tokens</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>

<span class="c1"># X-Powered-By ì œê±° (ì—…ìŠ¤íŠ¸ë¦¼ ì•±ì—ì„œ ì„¤ì •í•œ ê²½ìš°)</span>
<span class="k">proxy_hide_header</span><span class="w"> </span><span class="s">X-Powered-By</span><span class="p">;</span>
</code></pre></div>

<h3 id="132-apache">13.2 Apache êµ¬ì„±<a class="header-link" href="#132-apache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># .htaccess ë˜ëŠ” httpd.conf</span>

<span class="c"># Content-Security-Policy</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Content-Security-Policy<span class="w"> </span><span class="s2">&quot;\</span>
<span class="s2">default-src &#39;self&#39;; \</span>
<span class="s2">script-src &#39;self&#39;; \</span>
<span class="s2">style-src &#39;self&#39; &#39;unsafe-inline&#39;; \</span>
<span class="s2">img-src &#39;self&#39; data:; \</span>
<span class="s2">font-src &#39;self&#39;; \</span>
<span class="s2">connect-src &#39;self&#39;; \</span>
<span class="s2">object-src &#39;none&#39;; \</span>
<span class="s2">base-uri &#39;self&#39;; \</span>
<span class="s2">form-action &#39;self&#39;; \</span>
<span class="s2">frame-ancestors &#39;none&#39;&quot;</span>

<span class="c"># HSTS</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Strict-Transport-Security<span class="w"> </span>\
<span class="w">    </span><span class="s2">&quot;max-age=31536000; includeSubDomains; preload&quot;</span>

<span class="c"># ê¸°íƒ€ ë³´ì•ˆ í—¤ë”</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>X-Content-Type-Options<span class="w"> </span><span class="s2">&quot;nosniff&quot;</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>X-Frame-Options<span class="w"> </span><span class="s2">&quot;DENY&quot;</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Referrer-Policy<span class="w"> </span><span class="s2">&quot;strict-origin-when-cross-origin&quot;</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Permissions-Policy<span class="w"> </span>\
<span class="w">    </span><span class="s2">&quot;camera=(), microphone=(), geolocation=(), payment=()&quot;</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Cross-Origin-Opener-Policy<span class="w"> </span><span class="s2">&quot;same-origin&quot;</span>
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Cross-Origin-Resource-Policy<span class="w"> </span><span class="s2">&quot;same-origin&quot;</span>

<span class="c"># ì„œë²„ ì •ë³´ ì œê±°</span>
<span class="nb">ServerTokens</span><span class="w"> </span>Prod
<span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>unset<span class="w"> </span>X-Powered-By
</code></pre></div>

<hr />
<h2 id="14">14. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<h3 id="1-csp">ì—°ìŠµ ë¬¸ì œ 1: CSP ì •ì±… ë¶„ì„<a class="header-link" href="#1-csp" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ CSP ì •ì±…ì„ ë¶„ì„í•˜ê³  ëª¨ë“  ë³´ì•ˆ ì•½ì ì„ ì‹ë³„í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="nt">Content-Security-Policy</span><span class="o">:</span>
<span class="w">    </span><span class="nt">default-src</span><span class="w"> </span><span class="o">*;</span>
<span class="w">    </span><span class="nt">script-src</span><span class="w"> </span><span class="s1">&#39;self&#39;</span><span class="w"> </span><span class="s1">&#39;unsafe-inline&#39;</span><span class="w"> </span><span class="s1">&#39;unsafe-eval&#39;</span><span class="w"> </span><span class="nt">https</span><span class="o">:;</span>
<span class="w">    </span><span class="nt">style-src</span><span class="w"> </span><span class="s1">&#39;self&#39;</span><span class="w"> </span><span class="s1">&#39;unsafe-inline&#39;</span><span class="o">;</span>
<span class="w">    </span><span class="nt">img-src</span><span class="w"> </span><span class="o">*;</span>
<span class="w">    </span><span class="nt">connect-src</span><span class="w"> </span><span class="o">*;</span>
<span class="w">    </span><span class="nt">font-src</span><span class="w"> </span><span class="o">*</span>
</code></pre></div>

<p>ì§ˆë¬¸:
1. ëª‡ ê°œì˜ ë³„ê°œì˜ ë³´ì•ˆ ë¬¸ì œë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆê¹Œ?
2. ê° ë¬¸ì œì— ëŒ€í•´ í™œì„±í™”ë˜ëŠ” ê³µê²© ë²¡í„°ë¥¼ ì„¤ëª…í•˜ì„¸ìš”.
3. Google Fontsì™€ ë‹¨ì¼ CDN (<code>cdn.example.com</code>)ì„ í—ˆìš©í•˜ë©´ì„œ ì•ˆì „í•˜ë„ë¡ ì •ì±…ì„ ë‹¤ì‹œ ì‘ì„±í•˜ì„¸ìš”.</p>
<h3 id="2-flask">ì—°ìŠµ ë¬¸ì œ 2: Flask ë³´ì•ˆ í—¤ë” ë¯¸ë“¤ì›¨ì–´<a class="header-link" href="#2-flask" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” Flask ë¯¸ë“¤ì›¨ì–´ í´ë˜ìŠ¤ë¥¼ êµ¬ì¶•í•˜ì„¸ìš”:</p>
<ol>
<li>ëª¨ë“  ê¶Œì¥ ë³´ì•ˆ í—¤ë” ì„¤ì •</li>
<li>ìš”ì²­ë‹¹ ê³ ìœ í•œ CSP nonce ìƒì„±</li>
<li>Jinja2 í…œí”Œë¦¿ì—ì„œ nonce ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸°</li>
<li>ë°ì½”ë ˆì´í„°ë¥¼ í†µí•œ ë¼ìš°íŠ¸ë³„ CSP ì¬ì •ì˜ í—ˆìš©</li>
<li>CSP í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ "report-only" ëª¨ë“œ ì§€ì›</li>
<li>í—¤ë” êµ¬ì„± ì˜¤ë¥˜ ë¡œê¹…</li>
</ol>
<h3 id="3">ì—°ìŠµ ë¬¸ì œ 3: í—¤ë” ìŠ¤ìºë„ˆ í–¥ìƒ<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ì„¹ì…˜ 12.2ì˜ Python ë³´ì•ˆ í—¤ë” ìŠ¤ìºë„ˆë¥¼ í™•ì¥í•˜ì—¬ ë‹¤ìŒì„ ìˆ˜í–‰í•˜ì„¸ìš”:</p>
<ol>
<li><code>Cross-Origin-Embedder-Policy</code>ì™€ <code>Cross-Origin-Opener-Policy</code> í™•ì¸</li>
<li>HSTS max-ageê°€ ìµœì†Œ 1ë…„ì¸ì§€ í™•ì¸</li>
<li><code>X-Powered-By</code> ë˜ëŠ” <code>Server</code> í—¤ë”ê°€ ë²„ì „ ì •ë³´ë¥¼ ë…¸ì¶œí•˜ëŠ”ì§€ ê°ì§€</li>
<li><code>unsafe-inline</code> ë° <code>unsafe-eval</code> ì‚¬ìš©ì„ ìœ„í•´ CSP íŒŒì‹± ë° ë¶„ì„</li>
<li>ìŠ¤ìº” ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë“±ê¸‰ ìƒì„± (A+ì—ì„œ Fê¹Œì§€)</li>
<li>í…ìŠ¤íŠ¸ ë° JSON í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ ì¶œë ¥</li>
</ol>
<h3 id="4-sri">ì—°ìŠµ ë¬¸ì œ 4: SRI í•´ì‹œ ìƒì„±ê¸°<a class="header-link" href="#4-sri" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš”:</p>
<ol>
<li>CDN URL ëª©ë¡ì„ ì…ë ¥ìœ¼ë¡œ ë°›ê¸°</li>
<li>ê° ë¦¬ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ</li>
<li>SHA-384 ë¬´ê²°ì„± í•´ì‹œ ê³„ì‚°</li>
<li>ë¬´ê²°ì„± ì†ì„±ì´ ìˆëŠ” ì™„ì „í•œ HTML <code>&lt;script&gt;</code> ë˜ëŠ” <code>&lt;link&gt;</code> íƒœê·¸ ìƒì„±</li>
<li>ì„ íƒì ìœ¼ë¡œ ëª¨ë“  íƒœê·¸ê°€ ìˆëŠ” HTML íŒŒì¼ ì‘ì„±</li>
<li>ì˜¤ë¥˜ë¥¼ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬ (ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨, 404 ë“±)</li>
</ol>
<h3 id="5-hsts-preload">ì—°ìŠµ ë¬¸ì œ 5: HSTS Preload ì¤€ë¹„ í™•ì¸<a class="header-link" href="#5-hsts-preload" title="Permanent link">&para;</a></h3>
<p>ë„ë©”ì¸ì´ HSTS preload ì œì¶œ ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë„êµ¬ë¥¼ ì‘ì„±í•˜ì„¸ìš”:</p>
<ol>
<li>ë„ë©”ì¸ì— ìœ íš¨í•œ TLS ì¸ì¦ì„œê°€ ìˆëŠ”ì§€ í™•ì¸</li>
<li>HTTPê°€ HTTPSë¡œ ë¦¬ë””ë ‰íŠ¸ë˜ëŠ”ì§€ í™•ì¸</li>
<li>HSTS í—¤ë”ì— <code>max-age &gt;= 31536000</code>ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</li>
<li><code>includeSubDomains</code> ë° <code>preload</code> ì§€ì‹œë¬¸ í™•ì¸</li>
<li>HTTPS ì§€ì›ì„ ìœ„í•´ ì¼ë°˜ì ì¸ ì„œë¸Œë„ë©”ì¸(www, mail, api) í…ŒìŠ¤íŠ¸</li>
<li>ì¤€ë¹„ ë³´ê³ ì„œ ìƒì„±</li>
</ol>
<h3 id="6-cross-origin">ì—°ìŠµ ë¬¸ì œ 6: Cross-Origin ê²©ë¦¬ ê°ì‚¬<a class="header-link" href="#6-cross-origin" title="Permanent link">&para;</a></h3>
<p>ì£¼ì–´ì§„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ URLì— ëŒ€í•´:</p>
<ol>
<li><code>Cross-Origin-Embedder-Policy</code>ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</li>
<li><code>Cross-Origin-Opener-Policy</code>ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</li>
<li>í˜ì´ì§€ì—ì„œ ë¡œë“œëœ ëª¨ë“  cross-origin ë¦¬ì†ŒìŠ¤ ì‹ë³„</li>
<li>ê° cross-origin ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ <code>Cross-Origin-Resource-Policy</code>ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</li>
<li>COEP: require-corpê°€ í™œì„±í™”ëœ ê²½ìš° ê¹¨ì§ˆ ë¦¬ì†ŒìŠ¤ ë³´ê³ </li>
</ol>
<hr />
<h2 id="_2">ìš”ì•½<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>í—¤ë”</th>
<th>ë°©ì§€í•˜ëŠ” ê³µê²©</th>
<th>í•„ìˆ˜?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-Security-Policy</td>
<td>XSS, ì£¼ì…</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td>Strict-Transport-Security</td>
<td>í”„ë¡œí† ì½œ ë‹¤ìš´ê·¸ë ˆì´ë“œ</td>
<td>ì˜ˆ (HTTPS ì‚¬ì´íŠ¸)</td>
</tr>
<tr>
<td>X-Content-Type-Options</td>
<td>MIME í˜¼ë™</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td>X-Frame-Options</td>
<td>í´ë¦­ì¬í‚¹</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td>Referrer-Policy</td>
<td>ì •ë³´ ìœ ì¶œ</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td>Permissions-Policy</td>
<td>ê¸°ëŠ¥ ë‚¨ìš©</td>
<td>ê¶Œì¥</td>
</tr>
<tr>
<td>CORP/COEP/COOP</td>
<td>Spectre, cross-origin</td>
<td>ê¶Œì¥</td>
</tr>
</tbody>
</table>
<h3 id="_3">í•µì‹¬ ìš”ì <a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>report-only ëª¨ë“œë¡œ ì‹œì‘</strong> â€” CSPë¥¼ ë¨¼ì € report-onlyë¡œ ë°°í¬í•˜ê³ , ìœ„ë°˜ì„ ìˆ˜ì •í•œ í›„ ê°•ì œ ì ìš©</li>
<li><strong>unsafe-inlineë³´ë‹¤ nonce ì‚¬ìš©</strong> â€” nonceëŠ” ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì— ëŒ€í•œ ìš”ì²­ë³„ ì¸ì¦ ì œê³µ</li>
<li><strong>HSTSëŠ” ì ì§„ì  ë¡¤ì•„ì›ƒ í•„ìš”</strong> â€” ì§§ì€ max-ageë¡œ ì‹œì‘í•˜ê³  ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì´ HTTPSë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸í•œ í›„ ì¦ê°€</li>
<li><strong>ì‹¬ì¸µ ë°©ì–´</strong> â€” ë³´ì•ˆ í—¤ë”ëŠ” ì•ˆì „í•œ ì½”ë”© ê´€í–‰ì„ ë³´ì™„í•˜ë©° ëŒ€ì²´í•˜ì§€ ì•ŠìŒ</li>
<li><strong>ì •ê¸°ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸</strong> â€” CI/CDì—ì„œ ìë™í™”ëœ ìŠ¤ìºë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ í—¤ë” íšŒê·€ í¬ì°©</li>
</ol>
<hr />
<p><strong>ì´ì „</strong>: <a href="./08_Injection_Attacks.md">08. Injection ê³µê²©ê³¼ ë°©ì–´</a> | <strong>ë‹¤ìŒ</strong>: <a href="./10_API_Security.md">10_API_Security.md</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/08_Injection_Attacks.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">08. ì¸ì ì…˜ ê³µê²©ê³¼ ë°©ì–´</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/10_API_Security.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">API ë³´ì•ˆ</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}