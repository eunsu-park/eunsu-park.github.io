{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ì•ˆ í…ŒìŠ¤íŒ… - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">ë³´ì•ˆ í…ŒìŠ¤íŒ…</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë³´ì•ˆ í…ŒìŠ¤íŒ…</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/12_Container_Security.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ì»¨í…Œì´ë„ˆ ë° í´ë¼ìš°ë“œ ë³´ì•ˆ</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/14_Incident_Response.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ì‚¬ê³  ëŒ€ì‘ ë° í¬ë Œì‹</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ë³´ì•ˆ í…ŒìŠ¤íŒ… ê°œìš”</a><ul>
<li><a href="#11">1.1 ë³´ì•ˆ í…ŒìŠ¤íŒ… í”¼ë¼ë¯¸ë“œ</a></li>
<li><a href="#12">1.2 ê° í…ŒìŠ¤íŒ… ìœ í˜•ì„ ì ìš©í•  ì‹œì </a></li>
<li><a href="#13">1.3 í…ŒìŠ¤íŒ… ì ‘ê·¼ ë°©ì‹ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#2-sast">2. ì •ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ… (SAST)</a><ul>
<li><a href="#21-sast">2.1 SAST ë™ì‘ ì›ë¦¬</a></li>
<li><a href="#22-bandit-python">2.2 Bandit: Python ë³´ì•ˆ ë¦°í„°</a><ul>
<li><a href="#_3">ì„¤ì¹˜ ë° ê¸°ë³¸ ì‚¬ìš©ë²•</a></li>
<li><a href="#bandit">Bandit í…ŒìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬</a></li>
<li><a href="#bandit_1">Bandit êµ¬ì„± íŒŒì¼</a></li>
<li><a href="#bandit_2">Bandit ì¶œë ¥ í•´ì„í•˜ê¸°</a></li>
<li><a href="#_4">ìœ„ì–‘ì„± ì–µì œí•˜ê¸°</a></li>
</ul>
</li>
<li><a href="#23-semgrep">2.3 Semgrep: ë‹¤ì¤‘ ì–¸ì–´ ì •ì  ë¶„ì„</a><ul>
<li><a href="#_5">ì„¤ì¹˜ ë° ê¸°ë³¸ ì‚¬ìš©ë²•</a></li>
<li><a href="#semgrep">ë§ì¶¤í˜• Semgrep ê·œì¹™ ì‘ì„±</a></li>
<li><a href="#_6">ë§ì¶¤í˜• ê·œì¹™ ì‹¤í–‰</a></li>
<li><a href="#semgrep_1">ê³ ê¸‰ Semgrep íŒ¨í„´</a></li>
</ul>
</li>
<li><a href="#24-sonarqube">2.4 SonarQube ê°œìš”</a></li>
</ul>
</li>
<li><a href="#3-dast">3. ë™ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ… (DAST)</a><ul>
<li><a href="#31-dast">3.1 DAST ë™ì‘ ì›ë¦¬</a></li>
<li><a href="#32-owasp-zap">3.2 OWASP ZAP</a><ul>
<li><a href="#zap-python-api">ZAP Python API</a></li>
</ul>
</li>
<li><a href="#33-burp-suite">3.3 Burp Suite ê°œë…</a></li>
</ul>
</li>
<li><a href="#4-sca">4. ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„± ë¶„ì„ (SCA)</a><ul>
<li><a href="#41-sca">4.1 SCAê°€ ì¤‘ìš”í•œ ì´ìœ </a></li>
<li><a href="#42-pip-audit">4.2 pip-audit</a><ul>
<li><a href="#pip-audit">pip-audit ì¶œë ¥ ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#43-safety">4.3 Safety</a></li>
<li><a href="#44-python">4.4 Python ìŠ¤í¬ë¦½íŠ¸: ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìºë„ˆ</a></li>
<li><a href="#45-dependabot-github">4.5 Dependabot êµ¬ì„± (GitHub)</a></li>
</ul>
</li>
<li><a href="#5">5. í¼ì§•</a><ul>
<li><a href="#51">5.1 í¼ì§•ì´ë€?</a></li>
<li><a href="#52-afl-american-fuzzy-lop">5.2 AFL (American Fuzzy Lop)</a><ul>
<li><a href="#afl">AFL ì¶œë ¥ ë””ë ‰í† ë¦¬ êµ¬ì¡°</a></li>
</ul>
</li>
<li><a href="#53-hypothesis-python">5.3 Hypothesis: Pythonì„ ìœ„í•œ ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ…</a></li>
<li><a href="#54">5.4 ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ í¼ì§•</a></li>
</ul>
</li>
<li><a href="#6">6. ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ë°©ë²•ë¡ </a><ul>
<li><a href="#61">6.1 ì¹¨íˆ¬ í…ŒìŠ¤íŒ… í”„ë¡œì„¸ìŠ¤</a></li>
<li><a href="#62">6.2 ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸</a></li>
<li><a href="#63-python">6.3 Python ì¹¨íˆ¬ í…ŒìŠ¤íŒ… í—¬í¼</a></li>
</ul>
</li>
<li><a href="#7">7. ë³´ì•ˆ ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸</a><ul>
<li><a href="#71">7.1 ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤</a></li>
<li><a href="#72-python">7.2 Python íŠ¹í™” ë³´ì•ˆ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸</a></li>
</ul>
</li>
<li><a href="#8-cicd">8. CI/CD ë³´ì•ˆ íŒŒì´í”„ë¼ì¸ í†µí•©</a><ul>
<li><a href="#81-github-actions">8.1 GitHub Actions ë³´ì•ˆ íŒŒì´í”„ë¼ì¸</a></li>
<li><a href="#82-pre-commit">8.2 ë³´ì•ˆì„ ìœ„í•œ Pre-commit í›…</a></li>
<li><a href="#83-gitlab-ci">8.3 GitLab CI ë³´ì•ˆ íŒŒì´í”„ë¼ì¸</a></li>
</ul>
</li>
<li><a href="#9">9. ì¢…í•© ë³´ì•ˆ ìŠ¤ìºë‹ ìŠ¤í¬ë¦½íŠ¸</a></li>
<li><a href="#10">10. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-bandit">ì—°ìŠµ ë¬¸ì œ 1: Bandit ìŠ¤ìº” ë¶„ì„</a></li>
<li><a href="#2-semgrep">ì—°ìŠµ ë¬¸ì œ 2: ì»¤ìŠ¤í…€ Semgrep ê·œì¹™ ì‘ì„±</a></li>
<li><a href="#3">ì—°ìŠµ ë¬¸ì œ 3: ì˜ì¡´ì„± ê°ì‚¬</a></li>
<li><a href="#4">ì—°ìŠµ ë¬¸ì œ 4: ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ…</a></li>
<li><a href="#5-cicd">ì—°ìŠµ ë¬¸ì œ 5: CI/CD ë³´ì•ˆ íŒŒì´í”„ë¼ì¸</a></li>
<li><a href="#6_1">ì—°ìŠµ ë¬¸ì œ 6: ë³´ì•ˆ ì½”ë“œ ë¦¬ë·°</a></li>
</ul>
</li>
<li><a href="#_7">ìš”ì•½</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">ë³´ì•ˆ í…ŒìŠ¤íŒ…<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<hr />
<p>ë³´ì•ˆ í…ŒìŠ¤íŒ…ì€ ê³µê²©ìë³´ë‹¤ ë¨¼ì € ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì·¨ì•½ì ì„ ì°¾ì•„ë‚´ëŠ” ì²´ê³„ì ì¸ í”„ë¡œì„¸ìŠ¤ì…ë‹ˆë‹¤. ì´ ë ˆìŠ¨ì—ì„œëŠ” ì£¼ìš” ë³´ì•ˆ í…ŒìŠ¤íŒ… ì¹´í…Œê³ ë¦¬ì¸ ì •ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ…(SAST), ë™ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ…(DAST), ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„± ë¶„ì„(SCA), í¼ì§•(fuzzing)ê³¼ í•¨ê»˜ ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ë°©ë²•ë¡  ë° CI/CD í†µí•©ì„ ë‹¤ë£¹ë‹ˆë‹¤. ì´ ë ˆìŠ¨ì„ ë§ˆì¹˜ë©´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ í¬ê´„ì ì¸ ë³´ì•ˆ í…ŒìŠ¤íŒ… íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>
<h2 id="_2">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li>SAST, DAST, SCA, í¼ì§•ì˜ ì°¨ì´ì  ì´í•´</li>
<li>Banditê³¼ Semgrepì„ ì‚¬ìš©í•˜ì—¬ Python ì½”ë“œì˜ ì·¨ì•½ì  ë°œê²¬</li>
<li>í”„ë¡œì íŠ¸ë³„ íŒ¨í„´ì„ ìœ„í•œ ë§ì¶¤í˜• Semgrep ê·œì¹™ ì‘ì„±</li>
<li>CI/CD íŒŒì´í”„ë¼ì¸ì— ë³´ì•ˆ ìŠ¤ìºë‹ í†µí•©</li>
<li>ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ë°©ë²•ë¡  ì ìš©</li>
<li>íš¨ê³¼ì ì¸ ë³´ì•ˆ ì½”ë“œ ë¦¬ë·° ìˆ˜í–‰</li>
</ul>
<hr />
<h2 id="1">1. ë³´ì•ˆ í…ŒìŠ¤íŒ… ê°œìš”<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ë³´ì•ˆ í…ŒìŠ¤íŒ… í”¼ë¼ë¯¸ë“œ<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ë³´ì•ˆ í…ŒìŠ¤íŒ… í”¼ë¼ë¯¸ë“œ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                         /\                                       â”‚
â”‚                        /  \        ìˆ˜ë™ ì¹¨íˆ¬ í…ŒìŠ¤íŒ…              â”‚
â”‚                       / PT \       (ê°€ì¥ ë¹„ìš© ë†’ìŒ, ë¡œì§ ê²°í•¨ì—  â”‚
â”‚                      /      \       ê°€ì¥ ì² ì €í•¨)                 â”‚
â”‚                     /--------\                                   â”‚
â”‚                    /   DAST   \     ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œâ”‚
â”‚                   /            \    ë™ì  í…ŒìŠ¤íŒ…                   â”‚
â”‚                  /--------------\                                 â”‚
â”‚                 /    í¼ì§•        \   í¬ë˜ì‹œ ë°œê²¬ì„ ìœ„í•œ           â”‚
â”‚                /      (Fuzzing)   \  ìë™í™”ëœ ì…ë ¥ ë³€ì´          â”‚
â”‚               /--------------------\                             â”‚
â”‚              /        SCA           \  ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìºë‹      â”‚
â”‚             /                        \                           â”‚
â”‚            /--------------------------\                          â”‚
â”‚           /           SAST             \ ì •ì  ì½”ë“œ ë¶„ì„          â”‚
â”‚          /                              \ (ê°€ì¥ ì €ë ´, ê°€ì¥ ë¹ ë¦„,â”‚
â”‚         /________________________________\ ê°€ì¥ ìë™í™” ê°€ëŠ¥)     â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€ ìœ„ë¡œ ê°ˆìˆ˜ë¡ ë¹„ìš©/ë…¸ë ¥ ì¦ê°€                                 â”‚
â”‚  â—„â”€â”€ ìœ„ë¡œ ê°ˆìˆ˜ë¡ ìë™í™” ê°ì†Œ                                    â”‚
â”‚  â—„â”€â”€ ê° ê³„ì¸µì€ ì„œë¡œ ë‹¤ë¥¸ ì·¨ì•½ì  í´ë˜ìŠ¤ íƒì§€                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12">1.2 ê° í…ŒìŠ¤íŒ… ìœ í˜•ì„ ì ìš©í•  ì‹œì <a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SDLC ë³´ì•ˆ í…ŒìŠ¤íŒ… ë§µ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ì½”ë“œ ì‘ì„± â”€â”€â–º ì»¤ë°‹ â”€â”€â–º ë¹Œë“œ â”€â”€â–º ë°°í¬ â”€â”€â–º í”„ë¡œë•ì…˜               â”‚
â”‚      â”‚           â”‚         â”‚        â”‚           â”‚                â”‚
â”‚      â–¼           â–¼         â–¼        â–¼           â–¼                â”‚
â”‚    IDE        Pre-commit  CI/CD   ìŠ¤í…Œì´ì§•    ì§€ì†ì  ëª¨ë‹ˆí„°ë§    â”‚
â”‚  ë¦°íŒ…          í›…         íŒŒì´í”„ë¼ì¸  í…ŒìŠ¤íŒ…                      â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ SAST â”‚   â”‚SAST + SCAâ”‚  â”‚ ì „ì²´ â”‚  â”‚ DAST â”‚  â”‚ ëŸ°íƒ€ì„   â”‚     â”‚
â”‚  â”‚(IDE) â”‚   â”‚(pre-push)â”‚  â”‚ ìœ í˜• â”‚  â”‚  PT  â”‚  â”‚ ìŠ¤ìºë‹   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="13">1.3 í…ŒìŠ¤íŒ… ì ‘ê·¼ ë°©ì‹ ë¹„êµ<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê¸°ëŠ¥</th>
<th>SAST</th>
<th>DAST</th>
<th>SCA</th>
<th>í¼ì§•</th>
<th>PT</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ì‹¤í–‰ ì¤‘ì¸ ì•± í•„ìš”</strong></td>
<td>ì•„ë‹ˆì˜¤</td>
<td>ì˜ˆ</td>
<td>ì•„ë‹ˆì˜¤</td>
<td>ê²½ìš°ì— ë”°ë¼</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td><strong>ì–¸ì–´ ì˜ì¡´ì </strong></td>
<td>ì˜ˆ</td>
<td>ì•„ë‹ˆì˜¤</td>
<td>ì˜ˆ</td>
<td>ë‹¤ì–‘</td>
<td>ì•„ë‹ˆì˜¤</td>
</tr>
<tr>
<td><strong>ìœ„ì–‘ì„±ë¥ </strong></td>
<td>ë†’ìŒ</td>
<td>ì¤‘ê°„</td>
<td>ë‚®ìŒ</td>
<td>ë‚®ìŒ</td>
<td>ë§¤ìš° ë‚®ìŒ</td>
</tr>
<tr>
<td><strong>ë¡œì§ ê²°í•¨ ë°œê²¬</strong></td>
<td>ë“œë¬¾</td>
<td>ë•Œë•Œë¡œ</td>
<td>ì•„ë‹ˆì˜¤</td>
<td>ë“œë¬¾</td>
<td>ì˜ˆ</td>
</tr>
<tr>
<td><strong>ìë™í™” ìˆ˜ì¤€</strong></td>
<td>ì™„ì „</td>
<td>ì™„ì „</td>
<td>ì™„ì „</td>
<td>ì™„ì „</td>
<td>ë¶€ë¶„ì </td>
</tr>
<tr>
<td><strong>ì†ë„</strong></td>
<td>ë¹ ë¦„</td>
<td>ëŠë¦¼</td>
<td>ë¹ ë¦„</td>
<td>ì¤‘ê°„</td>
<td>ë§¤ìš° ëŠë¦¼</td>
</tr>
<tr>
<td><strong>ì»¤ë²„ë¦¬ì§€</strong></td>
<td>ì½”ë“œ ê²½ë¡œ</td>
<td>ê³µê²© í‘œë©´</td>
<td>ì˜ì¡´ì„±</td>
<td>ì…ë ¥ ê³µê°„</td>
<td>íƒ€ê²Ÿ ì§€í–¥</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-sast">2. ì •ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ… (SAST)<a class="header-link" href="#2-sast" title="Permanent link">&para;</a></h2>
<h3 id="21-sast">2.1 SAST ë™ì‘ ì›ë¦¬<a class="header-link" href="#21-sast" title="Permanent link">&para;</a></h3>
<p>SAST ë„êµ¬ëŠ” ì†ŒìŠ¤ ì½”ë“œ(ë˜ëŠ” ë°”ì´íŠ¸ì½”ë“œ)ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê³  ë¶„ì„í•©ë‹ˆë‹¤. ì´ë“¤ì€ ì¶”ìƒ êµ¬ë¬¸ íŠ¸ë¦¬(AST) ë˜ëŠ” ì œì–´/ë°ì´í„° íë¦„ ê·¸ë˜í”„ë¥¼ êµ¬ì¶•í•˜ê³  ì ì¬ì  ì·¨ì•½ì ì„ ë‚˜íƒ€ë‚´ëŠ” íŒ¨í„´ì„ ë§¤ì¹­í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SAST ë¶„ì„ íŒŒì´í”„ë¼ì¸                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ì†ŒìŠ¤ ì½”ë“œ                                                       â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚  íŒŒì„œ     â”‚ â”€â”€â–º ì¶”ìƒ êµ¬ë¬¸ íŠ¸ë¦¬ (AST)                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  ì œì–´ íë¦„        â”‚ â”€â”€â–º CFG: ì‹¤í–‰ ê²½ë¡œ                        â”‚
â”‚  â”‚  ë¶„ì„             â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  ë°ì´í„° íë¦„      â”‚ â”€â”€â–º ì˜¤ì—¼ ì¶”ì : ì†ŒìŠ¤ â†’ ì‹±í¬                â”‚
â”‚  â”‚  ë¶„ì„             â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  íŒ¨í„´ ë§¤ì¹­        â”‚ â”€â”€â–º ì•Œë ¤ì§„ ì·¨ì•½ì  íŒ¨í„´                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚      â”‚                                                           â”‚
â”‚      â–¼                                                           â”‚
â”‚  ì·¨ì•½ì  ë³´ê³ ì„œ                                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22-bandit-python">2.2 Bandit: Python ë³´ì•ˆ ë¦°í„°<a class="header-link" href="#22-bandit-python" title="Permanent link">&para;</a></h3>
<p>Banditì€ Pythonì„ ìœ„í•œ ê°€ì¥ ì¸ê¸° ìˆëŠ” SAST ë„êµ¬ì…ë‹ˆë‹¤. í•˜ë“œì½”ë”©ëœ ë¹„ë°€ë²ˆí˜¸, <code>eval()</code> ì‚¬ìš©, ì•ˆì „í•˜ì§€ ì•Šì€ í•´ì‹œ í•¨ìˆ˜, SQL ì¸ì ì…˜ íŒ¨í„´ê³¼ ê°™ì€ ì¼ë°˜ì ì¸ ë³´ì•ˆ ë¬¸ì œë¥¼ ê²€ì‚¬í•©ë‹ˆë‹¤.</p>
<h4 id="_3">ì„¤ì¹˜ ë° ê¸°ë³¸ ì‚¬ìš©ë²•<a class="header-link" href="#_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Bandit ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>bandit

<span class="c1"># ë‹¨ì¼ íŒŒì¼ ìŠ¤ìº”</span>
bandit<span class="w"> </span>target_file.py

<span class="c1"># ì „ì²´ ë””ë ‰í† ë¦¬ ìŠ¤ìº”</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/

<span class="c1"># íŠ¹ì • ì‹¬ê°ë„ ìˆ˜ì¤€ìœ¼ë¡œ ìŠ¤ìº”</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>-ll<span class="w">  </span><span class="c1"># Medium ì´ìƒ</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>-lll<span class="w">  </span><span class="c1"># Highë§Œ</span>

<span class="c1"># ì¶œë ¥ í˜•ì‹</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>-f<span class="w"> </span>json<span class="w"> </span>-o<span class="w"> </span>bandit_report.json
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>-f<span class="w"> </span>html<span class="w"> </span>-o<span class="w"> </span>bandit_report.html
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>-f<span class="w"> </span>csv<span class="w"> </span>-o<span class="w"> </span>bandit_report.csv

<span class="c1"># íŠ¹ì • í…ŒìŠ¤íŠ¸ ì œì™¸</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>--skip<span class="w"> </span>B101,B601

<span class="c1"># íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ í¬í•¨</span>
bandit<span class="w"> </span>-r<span class="w"> </span>./myproject/<span class="w"> </span>--tests<span class="w"> </span>B301,B302,B303
</code></pre></div>

<h4 id="bandit">Bandit í…ŒìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬<a class="header-link" href="#bandit" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Bandit í…ŒìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬ ë° íƒì§€ ë‚´ìš©.</span>
<span class="sd">ê° í…ŒìŠ¤íŠ¸ëŠ” B101, B102 ë“±ì˜ IDë¥¼ ê°€ì§‘ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€â”€ B1xx: ì¼ë°˜ ë³´ì•ˆ ë¬¸ì œ â”€â”€â”€</span>

<span class="c1"># B101: assert_used - assertëŠ” -O í”Œë˜ê·¸ë¡œ ì œê±°ë¨</span>
<span class="k">assert</span> <span class="n">user</span><span class="o">.</span><span class="n">is_admin</span>  <span class="c1"># WARNING: B101</span>

<span class="c1"># B102: exec_used</span>
<span class="n">exec</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>  <span class="c1"># WARNING: B102</span>

<span class="c1"># B103: set_bad_file_permissions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">,</span> <span class="mo">0o777</span><span class="p">)</span>  <span class="c1"># WARNING: B103</span>

<span class="c1"># B104: hardcoded_bind_all_interfaces</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span>  <span class="c1"># WARNING: B104</span>

<span class="c1"># B105-B107: hardcoded passwords</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;SuperSecret123&quot;</span>  <span class="c1"># WARNING: B105</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;admin123&quot;</span><span class="p">}</span>  <span class="c1"># WARNING: B106</span>


<span class="c1"># â”€â”€â”€ B2xx: ì•”í˜¸í™” ë¬¸ì œ â”€â”€â”€</span>

<span class="c1"># B301: pickle ì‚¬ìš© (ì—­ì§ë ¬í™” ê³µê²©)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>  <span class="c1"># WARNING: B301</span>

<span class="c1"># B303: ì•ˆì „í•˜ì§€ ì•Šì€ í•´ì‹œ í•¨ìˆ˜</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>  <span class="c1"># WARNING: B303</span>

<span class="c1"># B304-B305: ì•ˆì „í•˜ì§€ ì•Šì€ ì•”í˜¸</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DES</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">DES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">DES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>  <span class="c1"># WARNING: B304</span>


<span class="c1"># â”€â”€â”€ B3xx: ì¸ì ì…˜ ë¬¸ì œ â”€â”€â”€</span>

<span class="c1"># B601: paramiko ì…¸ ì¸ì ì…˜</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">paramiko</span>
<span class="n">client</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>  <span class="c1"># WARNING: B601</span>

<span class="c1"># B602: subprocess with shell=True</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># WARNING: B602</span>

<span class="c1"># B608: ë¬¸ìì—´ í¬ë§¤íŒ…ì„ í†µí•œ SQL ì¸ì ì…˜</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM users WHERE id = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">user_id</span>  <span class="c1"># WARNING: B608</span>


<span class="c1"># â”€â”€â”€ B5xx: ì•”í˜¸í™” ë° SSL ë¬¸ì œ â”€â”€â”€</span>

<span class="c1"># B501: verify=Falseë¡œ ìš”ì²­</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># WARNING: B501</span>

<span class="c1"># B502: ë²„ì „ ì²´í¬ ì—†ëŠ” ssl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>  <span class="c1"># WARNING: B502</span>


<span class="c1"># â”€â”€â”€ B6xx: ì¸ì ì…˜ ë¬¸ì œ (ê³„ì†) â”€â”€â”€</span>

<span class="c1"># B610-B611: Django SQL ì¸ì ì…˜</span>
<span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="p">[</span><span class="n">user_input</span><span class="p">])</span>  <span class="c1"># WARNING: B610</span>

<span class="c1"># B701: Jinja2 autoescape ë¹„í™œì„±í™”</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jinja2</span><span class="w"> </span><span class="kn">import</span> <span class="n">Environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">autoescape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># WARNING: B701</span>
</code></pre></div>

<h4 id="bandit_1">Bandit êµ¬ì„± íŒŒì¼<a class="header-link" href="#bandit_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># .bandit.yaml (ë˜ëŠ” setup.cfg [bandit] ì„¹ì…˜)</span>

<span class="c1"># ê±´ë„ˆë›¸ í…ŒìŠ¤íŠ¸</span>
<span class="nt">skips</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B101</span><span class="w">  </span><span class="c1"># assert_used (í…ŒìŠ¤íŠ¸ íŒŒì¼ì—ì„œëŠ” í—ˆìš©)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B601</span><span class="w">  </span><span class="c1"># paramiko (ì…ë ¥ì„ ì •ì œí•¨)</span>

<span class="c1"># ì œì™¸í•  ê²½ë¡œ</span>
<span class="nt">exclude_dirs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">venv</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.tox</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">migrations</span>

<span class="c1"># ì‹¬ê°ë„ ì„ê³„ê°’ ì„¤ì •</span>
<span class="c1"># ì´ ì‹¬ê°ë„ ì´ìƒë§Œ ë³´ê³ </span>
<span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOW</span>

<span class="c1"># ì‹ ë¢°ë„ ì„ê³„ê°’ ì„¤ì •</span>
<span class="nt">confidence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOW</span>
</code></pre></div>

<h4 id="bandit_2">Bandit ì¶œë ¥ í•´ì„í•˜ê¸°<a class="header-link" href="#bandit_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># ì·¨ì•½í•œ ìƒ˜í”Œ íŒŒì¼ì— bandit ì‹¤í–‰</span>
$<span class="w"> </span>bandit<span class="w"> </span>-r<span class="w"> </span>vulnerable_app.py

Run<span class="w"> </span>started:2025-01-15<span class="w"> </span><span class="m">10</span>:30:00

Test<span class="w"> </span>results:
&gt;&gt;<span class="w"> </span>Issue:<span class="w"> </span><span class="o">[</span>B608:hardcoded_sql_expressions<span class="o">]</span><span class="w"> </span>Possible<span class="w"> </span>SQL<span class="w"> </span>injection<span class="w"> </span>vector
<span class="w">   </span>through<span class="w"> </span>string-based<span class="w"> </span>query<span class="w"> </span>construction.
<span class="w">   </span>Severity:<span class="w"> </span>Medium<span class="w">   </span>Confidence:<span class="w"> </span>Low
<span class="w">   </span>CWE:<span class="w"> </span>CWE-89<span class="w"> </span><span class="o">(</span>https://cwe.mitre.org/data/definitions/89.html<span class="o">)</span>
<span class="w">   </span>Location:<span class="w"> </span>vulnerable_app.py:42:0
<span class="w">   </span>More<span class="w"> </span>Info:<span class="w"> </span>https://bandit.readthedocs.io/en/latest/plugins/b608...
<span class="m">41</span><span class="w">      </span><span class="nv">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>request.args.get<span class="o">(</span><span class="s1">&#39;id&#39;</span><span class="o">)</span>
<span class="m">42</span><span class="w">      </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>f<span class="s2">&quot;SELECT * FROM users WHERE id = &#39;{user_id}&#39;&quot;</span>
<span class="m">43</span><span class="w">      </span>cursor.execute<span class="o">(</span>query<span class="o">)</span>

&gt;&gt;<span class="w"> </span>Issue:<span class="w"> </span><span class="o">[</span>B105:hardcoded_password_string<span class="o">]</span><span class="w"> </span>Possible<span class="w"> </span>hardcoded<span class="w"> </span>password
<span class="w">   </span>Severity:<span class="w"> </span>Low<span class="w">   </span>Confidence:<span class="w"> </span>Medium
<span class="w">   </span>CWE:<span class="w"> </span>CWE-259<span class="w"> </span><span class="o">(</span>https://cwe.mitre.org/data/definitions/259.html<span class="o">)</span>
<span class="w">   </span>Location:<span class="w"> </span>vulnerable_app.py:15:0
<span class="m">14</span>
<span class="m">15</span><span class="w">      </span><span class="nv">DATABASE_PASSWORD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;admin123&quot;</span>
<span class="m">16</span>


--------------------------------------------------
Code<span class="w"> </span>scanned:
<span class="w">    </span>Total<span class="w"> </span>lines<span class="w"> </span>of<span class="w"> </span>code:<span class="w"> </span><span class="m">156</span>
<span class="w">    </span>Total<span class="w"> </span>lines<span class="w"> </span>skipped<span class="w"> </span><span class="o">(</span><span class="c1">#nosec): 0</span>

Run<span class="w"> </span>metrics:
<span class="w">    </span>Total<span class="w"> </span>issues<span class="w"> </span><span class="o">(</span>by<span class="w"> </span>severity<span class="o">)</span>:
<span class="w">        </span>Undefined:<span class="w"> </span><span class="m">0</span>
<span class="w">        </span>Low:<span class="w"> </span><span class="m">1</span>
<span class="w">        </span>Medium:<span class="w"> </span><span class="m">1</span>
<span class="w">        </span>High:<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>Total<span class="w"> </span>issues<span class="w"> </span><span class="o">(</span>by<span class="w"> </span>confidence<span class="o">)</span>:
<span class="w">        </span>Undefined:<span class="w"> </span><span class="m">0</span>
<span class="w">        </span>Low:<span class="w"> </span><span class="m">1</span>
<span class="w">        </span>Medium:<span class="w"> </span><span class="m">1</span>
<span class="w">        </span>High:<span class="w"> </span><span class="m">0</span>
Files<span class="w"> </span>skipped<span class="w"> </span><span class="o">(</span><span class="m">0</span><span class="o">)</span>:
</code></pre></div>

<h4 id="_4">ìœ„ì–‘ì„± ì–µì œí•˜ê¸°<a class="header-link" href="#_4" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># ë°©ë²• 1: #nosecë¡œ ì¸ë¼ì¸ ì–µì œ</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="c1"># ì´ MD5ëŠ” ë¹„ë³´ì•ˆ ì²´í¬ì„¬ìš©ì´ë©°, ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ì´ ì•„ë‹˜</span>
<span class="n">checksum</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">file_content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>  <span class="c1"># nosec B303</span>

<span class="c1"># ë°©ë²• 2: íŠ¹ì • í…ŒìŠ¤íŠ¸ IDë¡œ ì¸ë¼ì¸</span>
<span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span>  <span class="c1"># nosec B303</span>

<span class="c1"># ë°©ë²• 3: ë² ì´ìŠ¤ë¼ì¸ íŒŒì¼ ì‚¬ìš©</span>
<span class="c1"># ë² ì´ìŠ¤ë¼ì¸ ìƒì„± (í˜„ì¬ ë¬¸ì œ ìº¡ì²˜)</span>
<span class="c1"># bandit -r ./myproject/ -f json -o baseline.json</span>
<span class="c1"># ë² ì´ìŠ¤ë¼ì¸ì— ëŒ€í•´ ì‹¤í–‰ (ìƒˆë¡œìš´ ë¬¸ì œë§Œ í‘œì‹œ)</span>
<span class="c1"># bandit -r ./myproject/ -b baseline.json</span>
</code></pre></div>

<h3 id="23-semgrep">2.3 Semgrep: ë‹¤ì¤‘ ì–¸ì–´ ì •ì  ë¶„ì„<a class="header-link" href="#23-semgrep" title="Permanent link">&para;</a></h3>
<p>Semgrepì€ 30ê°œ ì´ìƒì˜ ì–¸ì–´ë¥¼ ì§€ì›í•˜ëŠ” ë¹ ë¥¸ ì˜¤í”ˆì†ŒìŠ¤ SAST ë„êµ¬ë¡œ, ì´í•´í•˜ê³  í™•ì¥í•˜ê¸° ì‰¬ìš´ íŒ¨í„´ ë§¤ì¹­ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<h4 id="_5">ì„¤ì¹˜ ë° ê¸°ë³¸ ì‚¬ìš©ë²•<a class="header-link" href="#_5" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Semgrep ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>semgrep

<span class="c1"># ê¸°ë³¸ ê·œì¹™ìœ¼ë¡œ ì‹¤í–‰</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>auto<span class="w"> </span>.

<span class="c1"># íŠ¹ì • ê·œì¹™ì…‹ìœ¼ë¡œ ì‹¤í–‰</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>p/python<span class="w"> </span>.
semgrep<span class="w"> </span>--config<span class="w"> </span>p/flask<span class="w"> </span>.
semgrep<span class="w"> </span>--config<span class="w"> </span>p/django<span class="w"> </span>.
semgrep<span class="w"> </span>--config<span class="w"> </span>p/owasp-top-ten<span class="w"> </span>.
semgrep<span class="w"> </span>--config<span class="w"> </span>p/security-audit<span class="w"> </span>.

<span class="c1"># ë¡œì»¬ ê·œì¹™ íŒŒì¼ë¡œ ì‹¤í–‰</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>my_rules.yaml<span class="w"> </span>.

<span class="c1"># ì¶œë ¥ í˜•ì‹</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>auto<span class="w"> </span>.<span class="w"> </span>--json<span class="w"> </span>&gt;<span class="w"> </span>report.json
semgrep<span class="w"> </span>--config<span class="w"> </span>auto<span class="w"> </span>.<span class="w"> </span>--sarif<span class="w"> </span>&gt;<span class="w"> </span>report.sarif
</code></pre></div>

<h4 id="semgrep">ë§ì¶¤í˜• Semgrep ê·œì¹™ ì‘ì„±<a class="header-link" href="#semgrep" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># custom_rules.yaml</span>

<span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ê·œì¹™ 1: f-stringì„ í†µí•œ SQL ì¸ì ì…˜ íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sql-injection-fstring</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">$CURSOR.execute(f&quot;...{$VAR}...&quot;)</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">f-string ë³´ê°„ì„ í†µí•œ ì ì¬ì  SQL ì¸ì ì…˜.</span>
<span class="w">      </span><span class="no">ëŒ€ì‹  íŒŒë¼ë¯¸í„°í™”ëœ ì¿¼ë¦¬ ì‚¬ìš©:</span>
<span class="w">      </span><span class="no">cursor.execute(&quot;SELECT * FROM users WHERE id = %s&quot;, (user_id,))</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CWE-89</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A03:2021 Injection</span>
<span class="w">      </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">      </span><span class="nt">technology</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>

<span class="w">  </span><span class="c1"># ê·œì¹™ 2: í•˜ë“œì½”ë”©ëœ JWT ì‹œí¬ë¦¿ íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hardcoded-jwt-secret</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">jwt.encode($PAYLOAD, &quot;...&quot;, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">jwt.encode($PAYLOAD, $CONFIG, ...)</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">JWT í† í°ì´ í•˜ë“œì½”ë”©ëœ ì‹œí¬ë¦¿ìœ¼ë¡œ ì„œëª…ë¨.</span>
<span class="w">      </span><span class="no">í™˜ê²½ ë³€ìˆ˜ ë˜ëŠ” ì‹œí¬ë¦¿ ê´€ë¦¬ ì„œë¹„ìŠ¤ ì‚¬ìš©.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CWE-798</span>

<span class="w">  </span><span class="c1"># ê·œì¹™ 3: ë¡œê·¸ì¸ì— rate limiting ëˆ„ë½ íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login-no-rate-limit</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">@$APP.route(&quot;/login&quot;, ...)</span>
<span class="w">          </span><span class="no">def $FUNC(...):</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not-inside</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">@limiter.limit(...)</span>
<span class="w">          </span><span class="no">@$APP.route(&quot;/login&quot;, ...)</span>
<span class="w">          </span><span class="no">def $FUNC(...):</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">rate limiting ì—†ëŠ” ë¡œê·¸ì¸ ì—”ë“œí¬ì¸íŠ¸. ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©ì„ ë°©ì§€í•˜ê¸° ìœ„í•´</span>
<span class="w">      </span><span class="no">@limiter.limit() ì¶”ê°€.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>

<span class="w">  </span><span class="c1"># ê·œì¹™ 4: ì‚¬ìš©ì ì…ë ¥ê³¼ í•¨ê»˜ eval/exec íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dangerous-eval-user-input</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eval(request.$METHOD.get(...))</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exec(request.$METHOD.get(...))</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">$X = request.$METHOD.get(...)</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">              </span><span class="no">eval($X)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">$X = request.$METHOD.get(...)</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">              </span><span class="no">exec($X)</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">ì‚¬ìš©ì ì…ë ¥ì´ eval()/exec()ì— ì „ë‹¬ë¨. ì´ëŠ” ì„ì˜ ì½”ë“œ ì‹¤í–‰ì„ í—ˆìš©í•¨.</span>
<span class="w">      </span><span class="no">ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì…ë ¥ê³¼ í•¨ê»˜ eval/exec ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CWE-95</span>

<span class="w">  </span><span class="c1"># ê·œì¹™ 5: Flask í¼ì—ì„œ CSRF ë³´í˜¸ ëˆ„ë½ íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flask-form-no-csrf</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">@$APP.route(&quot;...&quot;, methods=[..., &quot;POST&quot;, ...])</span>
<span class="w">          </span><span class="no">def $FUNC(...):</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">              </span><span class="no">$X = request.form[...]</span>
<span class="w">              </span><span class="no">...</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not-inside</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">@csrf.exempt</span>
<span class="w">          </span><span class="no">...</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">POST ì—”ë“œí¬ì¸íŠ¸ê°€ í¼ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•¨. Flask-WTF ë˜ëŠ” ìˆ˜ë™ í† í° ê²€ì¦ì„ í†µí•´</span>
<span class="w">      </span><span class="no">CSRF ë³´í˜¸ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>
</code></pre></div>

<h4 id="_6">ë§ì¶¤í˜• ê·œì¹™ ì‹¤í–‰<a class="header-link" href="#_6" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># ë§ì¶¤í˜• ê·œì¹™ í…ŒìŠ¤íŠ¸</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>custom_rules.yaml<span class="w"> </span>./myproject/

<span class="c1"># ë§ì¶¤í˜• ê·œì¹™ê³¼ í‘œì¤€ ê·œì¹™ì…‹ ê²°í•©</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>custom_rules.yaml<span class="w"> </span>--config<span class="w"> </span>p/python<span class="w"> </span>./myproject/

<span class="c1"># íŠ¹ì • íŒŒì¼ì— ëŒ€í•´ ê·œì¹™ í…ŒìŠ¤íŠ¸</span>
semgrep<span class="w"> </span>--config<span class="w"> </span>custom_rules.yaml<span class="w"> </span>target_file.py

<span class="c1"># ê·œì¹™ êµ¬ë¬¸ ê²€ì¦</span>
semgrep<span class="w"> </span>--validate<span class="w"> </span>--config<span class="w"> </span>custom_rules.yaml
</code></pre></div>

<h4 id="semgrep_1">ê³ ê¸‰ Semgrep íŒ¨í„´<a class="header-link" href="#semgrep_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ì˜¤ì—¼ ì¶”ì : ì†ŒìŠ¤ì—ì„œ ì‹±í¬ê¹Œì§€ ë°ì´í„° ì¶”ì </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flask-ssrf</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">taint</span>
<span class="w">    </span><span class="nt">pattern-sources</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">request.$METHOD.get(...)</span>
<span class="w">    </span><span class="nt">pattern-sinks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">requests.get($URL, ...)</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">ì‚¬ìš©ì ì…ë ¥ì´ HTTP ìš”ì²­ìœ¼ë¡œ íë¦„, SSRF ê°€ëŠ¥ì„±.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>

<span class="w">  </span><span class="c1"># ë©”íƒ€ë³€ìˆ˜ ë¹„êµ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">weak-rsa-key</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rsa.generate_private_key(public_exponent=65537, key_size=$SIZE)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">metavariable-comparison</span><span class="p">:</span>
<span class="w">          </span><span class="nt">metavariable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$SIZE</span>
<span class="w">          </span><span class="nt">comparison</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$SIZE &lt; 2048</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RSA í‚¤ í¬ê¸° $SIZEê°€ ë„ˆë¬´ ì‘ìŒ. ìµœì†Œ 2048 ë¹„íŠ¸ ì‚¬ìš©.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>

<span class="w">  </span><span class="c1"># íŠ¹ì • ë©”íƒ€ë³€ìˆ˜ì— ì´ˆì ì„ ë§ì¶˜ íŒ¨í„´</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unvalidated-redirect</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redirect($URL)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redirect(url_for(...))</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">focus-metavariable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$URL</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ì ì¬ì  ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸. ì•ˆì „í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ìœ„í•´ url_for() ì‚¬ìš©.</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>
</code></pre></div>

<h3 id="24-sonarqube">2.4 SonarQube ê°œìš”<a class="header-link" href="#24-sonarqube" title="Permanent link">&para;</a></h3>
<p>SonarQubeëŠ” ì§€ì†ì ì¸ ì½”ë“œ í’ˆì§ˆ ë° ë³´ì•ˆ ê²€ì‚¬ë¥¼ ìœ„í•œ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ í”Œë«í¼ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SonarQube ì•„í‚¤í…ì²˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ê°œë°œì ë¨¸ì‹                     SonarQube ì„œë²„                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  ì†ŒìŠ¤ ì½”ë“œ    â”‚    ìŠ¤ìº”     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚
â”‚  â”‚      +        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚  â”‚   ë¶„ì„ê¸°     â”‚  â”‚             â”‚
â”‚  â”‚ sonar-scanner â”‚             â”‚  â”‚   ì—”ì§„       â”‚  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚
â”‚                                â”‚         â”‚         â”‚             â”‚
â”‚  CI/CD íŒŒì´í”„ë¼ì¸              â”‚         â–¼         â”‚             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚
â”‚  â”‚  ë¹Œë“œ ìŠ¤í…    â”‚   ë¦¬í¬íŠ¸   â”‚  â”‚   ë°ì´í„°ë² ì´ìŠ¤â”‚  â”‚             â”‚
â”‚  â”‚  + ìŠ¤ìºë„ˆ     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚  â”‚ (PostgreSQL) â”‚  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚
â”‚                                â”‚         â”‚         â”‚             â”‚
â”‚                                â”‚         â–¼         â”‚             â”‚
â”‚  ì›¹ ë¸Œë¼ìš°ì €                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚  Web UI /    â”‚  â”‚             â”‚
â”‚  â”‚  ëŒ€ì‹œë³´ë“œ     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  Dashboard   â”‚  â”‚             â”‚
â”‚  â”‚  &amp; ë¦¬í¬íŠ¸     â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Dockerë¡œ SonarQube ì‹¤í–‰</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>sonarqube<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">9000</span>:9000<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>sonarqube:community

<span class="c1"># í”„ë¡œì íŠ¸ êµ¬ì„±: sonar-project.properties</span>
<span class="c1"># sonar.projectKey=my-python-project</span>
<span class="c1"># sonar.sources=src</span>
<span class="c1"># sonar.python.version=3.11</span>
<span class="c1"># sonar.exclusions=**/tests/**,**/migrations/**</span>

<span class="c1"># ìŠ¤ìºë„ˆ ì‹¤í–‰</span>
sonar-scanner<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.projectKey<span class="o">=</span>my-python-project<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.sources<span class="o">=</span>.<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.host.url<span class="o">=</span>http://localhost:9000<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.token<span class="o">=</span>your_token_here
</code></pre></div>

<hr />
<h2 id="3-dast">3. ë™ì  ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŒ… (DAST)<a class="header-link" href="#3-dast" title="Permanent link">&para;</a></h2>
<h3 id="31-dast">3.1 DAST ë™ì‘ ì›ë¦¬<a class="header-link" href="#31-dast" title="Permanent link">&para;</a></h3>
<p>DAST ë„êµ¬ëŠ” ì¡°ì‘ëœ ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë¶„ì„í•˜ì—¬ ì·¨ì•½ì ì„ ì°¾ëŠ” ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. ìë™í™”ëœ ê³µê²©ìì²˜ëŸ¼ ì‘ë™í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DAST í…ŒìŠ¤íŒ… í”Œë¡œìš°                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     í¬ë¡¤ë§     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   DAST    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   ì‹¤í–‰ ì¤‘ì¸    â”‚                â”‚
â”‚  â”‚   ë„êµ¬    â”‚                â”‚   ì• í”Œë¦¬ì¼€ì´ì…˜ â”‚                â”‚
â”‚  â”‚           â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   (ëŒ€ìƒ)       â”‚                â”‚
â”‚  â”‚           â”‚    ì‘ë‹µ        â”‚               â”‚                â”‚
â”‚  â”‚           â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â”‚           â”‚                                                  â”‚
â”‚  â”‚  ë‹¨ê³„ 1:  â”‚  ì—”ë“œí¬ì¸íŠ¸ ë°œê²¬ì„ ìœ„í•œ ìŠ¤íŒŒì´ë”/í¬ë¡¤ë§         â”‚
â”‚  â”‚  ë°œê²¬     â”‚  í¼, íŒŒë¼ë¯¸í„°, API ì—”ë“œí¬ì¸íŠ¸ ì°¾ê¸°              â”‚
â”‚  â”‚           â”‚                                                  â”‚
â”‚  â”‚  ë‹¨ê³„ 2:  â”‚  ì•…ì˜ì ì¸ í˜ì´ë¡œë“œ ì „ì†¡:                        â”‚
â”‚  â”‚  ê³µê²©     â”‚  - SQL ì¸ì ì…˜ ë¬¸ìì—´                            â”‚
â”‚  â”‚           â”‚  - XSS í˜ì´ë¡œë“œ                                  â”‚
â”‚  â”‚           â”‚  - ê²½ë¡œ ìˆœíšŒ ì‹œë„                                â”‚
â”‚  â”‚           â”‚  - ëª…ë ¹ ì¸ì ì…˜                                   â”‚
â”‚  â”‚           â”‚                                                  â”‚
â”‚  â”‚  ë‹¨ê³„ 3:  â”‚  ì‘ë‹µ ë¶„ì„:                                      â”‚
â”‚  â”‚  ë¶„ì„     â”‚  - ì •ë³´ ë…¸ì¶œ ì—ëŸ¬ ë©”ì‹œì§€                        â”‚
â”‚  â”‚           â”‚  - ë°˜ì‚¬ëœ ì…ë ¥ (XSS)                            â”‚
â”‚  â”‚           â”‚  - ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="32-owasp-zap">3.2 OWASP ZAP<a class="header-link" href="#32-owasp-zap" title="Permanent link">&para;</a></h3>
<p>OWASP ZAP (Zed Attack Proxy)ëŠ” ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë¬´ë£Œ DAST ë„êµ¬ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dockerë¡œ ZAP ì‹¤í–‰</span>
docker<span class="w"> </span>run<span class="w"> </span>-t<span class="w"> </span>owasp/zap2docker-stable<span class="w"> </span>zap-baseline.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>http://target-app:8080

<span class="c1"># ì „ì²´ ìŠ¤ìº” (ë” ì² ì €í•˜ì§€ë§Œ ëŠë¦¼)</span>
docker<span class="w"> </span>run<span class="w"> </span>-t<span class="w"> </span>owasp/zap2docker-stable<span class="w"> </span>zap-full-scan.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>http://target-app:8080

<span class="c1"># API ìŠ¤ìº” (REST APIìš©)</span>
docker<span class="w"> </span>run<span class="w"> </span>-t<span class="w"> </span>owasp/zap2docker-stable<span class="w"> </span>zap-api-scan.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>http://target-app:8080/openapi.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-f<span class="w"> </span>openapi

<span class="c1"># HTML ë¦¬í¬íŠ¸ ìƒì„±</span>
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/zap/wrk/:rw<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>owasp/zap2docker-stable<span class="w"> </span>zap-baseline.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>http://target-app:8080<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-r<span class="w"> </span>report.html
</code></pre></div>

<h4 id="zap-python-api">ZAP Python API<a class="header-link" href="#zap-python-api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ìë™í™”ëœ ìŠ¤ìºë‹ì„ ìœ„í•œ OWASP ZAPì˜ Python API ì‚¬ìš©.</span>
<span class="sd">í•„ìš”: pip install python-owasp-zap-v2.4</span>
<span class="sd">ZAPì´ ë°ëª¬ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•¨.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">zapv2</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZAPv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># ZAPì— ì—°ê²°</span>
<span class="n">zap</span> <span class="o">=</span> <span class="n">ZAPv2</span><span class="p">(</span>
    <span class="n">apikey</span><span class="o">=</span><span class="s1">&#39;your-api-key&#39;</span><span class="p">,</span>
    <span class="n">proxies</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span><span class="p">,</span>
        <span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;http://target-app:5000&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_zap_scan</span><span class="p">(</span><span class="n">target_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ëŒ€ìƒì— ëŒ€í•´ ZAP ìŠ¤ìº” ì‹¤í–‰ ë° ê²°ê³¼ ë°˜í™˜.&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] ëŒ€ìƒ ìŠ¤íŒŒì´ë”ë§: </span><span class="si">{</span><span class="n">target_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">scan_id</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">spider</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">target_url</span><span class="p">)</span>

    <span class="c1"># ìŠ¤íŒŒì´ë” ì™„ë£Œ ëŒ€ê¸°</span>
    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">zap</span><span class="o">.</span><span class="n">spider</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ìŠ¤íŒŒì´ë” ì§„í–‰ë¥ : </span><span class="si">{</span><span class="n">zap</span><span class="o">.</span><span class="n">spider</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] ìŠ¤íŒŒì´ë”ê°€ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zap</span><span class="o">.</span><span class="n">spider</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">scan_id</span><span class="p">))</span><span class="si">}</span><span class="s2">ê°œ URL ë°œê²¬&quot;</span><span class="p">)</span>

    <span class="c1"># ëŠ¥ë™ ìŠ¤ìº” ì‹¤í–‰</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] ëŠ¥ë™ ìŠ¤ìº” ì‹œì‘...&quot;</span><span class="p">)</span>
    <span class="n">scan_id</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">ascan</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">target_url</span><span class="p">)</span>

    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">zap</span><span class="o">.</span><span class="n">ascan</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ëŠ¥ë™ ìŠ¤ìº” ì§„í–‰ë¥ : </span><span class="si">{</span><span class="n">zap</span><span class="o">.</span><span class="n">ascan</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># ê²½ê³  ê°€ì ¸ì˜¤ê¸°</span>
    <span class="n">alerts</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">alerts</span><span class="p">(</span><span class="n">baseurl</span><span class="o">=</span><span class="n">target_url</span><span class="p">)</span>

    <span class="c1"># ìœ„í—˜ ìˆ˜ì¤€ë³„ë¡œ ë¶„ë¥˜</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;High&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Medium&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Low&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Informational&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">alerts</span><span class="p">:</span>
        <span class="n">risk</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;risk&#39;</span><span class="p">,</span> <span class="s1">&#39;Informational&#39;</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="n">risk</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">),</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">),</span>
            <span class="s1">&#39;solution&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;solution&#39;</span><span class="p">),</span>
            <span class="s1">&#39;cweid&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cweid&#39;</span><span class="p">),</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>


<span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìŠ¤ìº” ê²°ê³¼ë¥¼ ì½ê¸° ì‰¬ìš´ í˜•ì‹ìœ¼ë¡œ ì¶œë ¥.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">risk_level</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Informational&#39;</span><span class="p">]:</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">risk_level</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">alerts</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">risk_level</span><span class="si">}</span><span class="s2"> ìœ„í—˜ ê²½ê³ : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">alerts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">alerts</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  [</span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;cweid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  URL: </span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  í•´ê²°ì±…: </span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">][:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_zap_scan</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>

<h3 id="33-burp-suite">3.3 Burp Suite ê°œë…<a class="header-link" href="#33-burp-suite" title="Permanent link">&para;</a></h3>
<p>Burp SuiteëŠ” ë¬´ë£Œ ì»¤ë®¤ë‹ˆí‹° ì—ë””ì…˜ì´ ìˆëŠ” ìƒìš© ì›¹ ë³´ì•ˆ í…ŒìŠ¤íŒ… í”Œë«í¼ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Burp Suite ì•„í‚¤í…ì²˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ë¸Œë¼ìš°ì € â—„â”€â”€â”€â”€â”€â”€â–º Burp í”„ë¡ì‹œ â—„â”€â”€â”€â”€â”€â”€â–º ëŒ€ìƒ ì„œë²„               â”‚
â”‚                      â”‚                                           â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚           â”‚          â”‚                  â”‚                        â”‚
â”‚           â–¼          â–¼                  â–¼                        â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚      â”‚ Spider  â”‚ â”‚Repeater â”‚    â”‚  Scanner   â”‚                  â”‚
â”‚      â”‚(í¬ë¡¤ë§) â”‚ â”‚(ìˆ˜ë™     â”‚    â”‚(ìë™í™”)    â”‚                  â”‚
â”‚      â”‚         â”‚ â”‚ í…ŒìŠ¤íŠ¸)  â”‚    â”‚            â”‚                  â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚           â”‚          â”‚                  â”‚                        â”‚
â”‚           â–¼          â–¼                  â–¼                        â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚      â”‚Sequencerâ”‚ â”‚Intruder â”‚    â”‚  Decoder   â”‚                  â”‚
â”‚      â”‚(í† í°    â”‚ â”‚(í˜ì´ë¡œë“œâ”‚    â”‚(ì¸ì½”ë“œ/    â”‚                  â”‚
â”‚      â”‚ í…ŒìŠ¤íŠ¸) â”‚ â”‚ í¼ì €)   â”‚    â”‚ ë””ì½”ë“œ)    â”‚                  â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                  â”‚
â”‚  ì£¼ìš” ê¸°ëŠ¥:                                                      â”‚
â”‚  - HTTP/HTTPS íŠ¸ë˜í”½ ê°€ë¡œì±„ê¸° ë° ìˆ˜ì •                           â”‚
â”‚  - ìë™í™”ëœ ì·¨ì•½ì  ìŠ¤ìºë‹                                        â”‚
â”‚  - Repeater ë° Intruderë¡œ ìˆ˜ë™ í…ŒìŠ¤íŒ…                          â”‚
â”‚  - Sequencerë¡œ ì„¸ì…˜ í† í° ë¶„ì„                                   â”‚
â”‚  - BApp Storeë¥¼ í†µí•œ í™•ì¥ ê°€ëŠ¥                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="4-sca">4. ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„± ë¶„ì„ (SCA)<a class="header-link" href="#4-sca" title="Permanent link">&para;</a></h2>
<h3 id="41-sca">4.1 SCAê°€ ì¤‘ìš”í•œ ì´ìœ <a class="header-link" href="#41-sca" title="Permanent link">&para;</a></h3>
<p>ëŒ€ë¶€ë¶„ì˜ í˜„ëŒ€ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ 70-90%ì˜ ì„œë“œíŒŒí‹° ì½”ë“œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. SCA ë„êµ¬ëŠ” ì˜ì¡´ì„±ì—ì„œ ì•Œë ¤ì§„ ì·¨ì•½ì ì„ ìŠ¤ìº”í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì½”ë“œ êµ¬ì„±                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   (ì½”ë“œì˜ 70-90%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â”‚  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚
â”‚  â”‚  â–‘â–‘â–‘â–‘â–‘ ì‘ì„±í•œ ì½”ë“œ (10-30%) â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚
â”‚  â”‚  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  ê° ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ìì²´ ì˜ì¡´ì„±ì„ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°           â”‚
â”‚  (ì „ì´ ì˜ì¡´ì„±), ê¹Šì€ ì˜ì¡´ì„± íŠ¸ë¦¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.                  â”‚
â”‚  ì´ íŠ¸ë¦¬ì˜ ì–´ëŠ ê³³ì—ì„œë“  ì·¨ì•½ì ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤. â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="42-pip-audit">4.2 pip-audit<a class="header-link" href="#42-pip-audit" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># pip-audit ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>pip-audit

<span class="c1"># í˜„ì¬ í™˜ê²½ ìŠ¤ìº”</span>
pip-audit

<span class="c1"># requirements íŒŒì¼ ìŠ¤ìº”</span>
pip-audit<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c1"># JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥</span>
pip-audit<span class="w"> </span>-f<span class="w"> </span>json<span class="w"> </span>-o<span class="w"> </span>audit_report.json

<span class="c1"># ì·¨ì•½ì  ìë™ ìˆ˜ì • (íŒ¨í‚¤ì§€ ì—…ê·¸ë ˆì´ë“œ)</span>
pip-audit<span class="w"> </span>--fix

<span class="c1"># íŠ¹ì • ì·¨ì•½ì  ë°ì´í„°ë² ì´ìŠ¤ë¡œ ìŠ¤ìº”</span>
pip-audit<span class="w"> </span>--vulnerability-service<span class="w"> </span>osv<span class="w">  </span><span class="c1"># Google OSV (ê¸°ë³¸ê°’)</span>
pip-audit<span class="w"> </span>--vulnerability-service<span class="w"> </span>pypi<span class="w">  </span><span class="c1"># PyPI Advisory DB</span>

<span class="c1"># ì—„ê²© ëª¨ë“œ: ì·¨ì•½ì  ë°œê²¬ ì‹œ ì˜¤ë¥˜ë¡œ ì¢…ë£Œ</span>
pip-audit<span class="w"> </span>--strict
</code></pre></div>

<h4 id="pip-audit">pip-audit ì¶œë ¥ ì˜ˆì œ<a class="header-link" href="#pip-audit" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pip-audit<span class="w"> </span>-r<span class="w"> </span>requirements.txt

Found<span class="w"> </span><span class="m">3</span><span class="w"> </span>known<span class="w"> </span>vulnerabilities<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>packages

Name<span class="w">       </span>Version<span class="w">  </span>ID<span class="w">                  </span>Fix<span class="w"> </span>Versions
----------<span class="w"> </span>--------<span class="w"> </span>-------------------<span class="w"> </span>---------------
flask<span class="w">      </span><span class="m">2</span>.0.1<span class="w">    </span>PYSEC-2023-62<span class="w">       </span><span class="m">2</span>.3.2
requests<span class="w">   </span><span class="m">2</span>.25.1<span class="w">   </span>PYSEC-2023-74<span class="w">       </span><span class="m">2</span>.31.0
requests<span class="w">   </span><span class="m">2</span>.25.1<span class="w">   </span>GHSA-j8r2-6x86-q33q<span class="w"> </span><span class="m">2</span>.32.0
</code></pre></div>

<h3 id="43-safety">4.3 Safety<a class="header-link" href="#43-safety" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># safety ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>safety

<span class="c1"># í˜„ì¬ í™˜ê²½ ê²€ì‚¬</span>
safety<span class="w"> </span>check

<span class="c1"># requirements íŒŒì¼ ê²€ì‚¬</span>
safety<span class="w"> </span>check<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c1"># JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥</span>
safety<span class="w"> </span>check<span class="w"> </span>--output<span class="w"> </span>json

<span class="c1"># CIì—ì„œ ì‚¬ìš© (ì·¨ì•½ì  ë°œê²¬ ì‹œ ì¢…ë£Œ ì½”ë“œ 1)</span>
safety<span class="w"> </span>check<span class="w"> </span>--full-report
</code></pre></div>

<h3 id="44-python">4.4 Python ìŠ¤í¬ë¦½íŠ¸: ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìºë„ˆ<a class="header-link" href="#44-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">dependency_scanner.py - í¬ê´„ì ì¸ ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìºë„ˆ.</span>
<span class="sd">pip-audit ê²°ê³¼ì™€ ì¶”ê°€ ê²€ì‚¬ë¥¼ ê²°í•©í•©ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Vulnerability</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì˜ì¡´ì„±ì˜ ë‹¨ì¼ ì·¨ì•½ì ì„ ë‚˜íƒ€ëƒ„.&quot;&quot;&quot;</span>
    <span class="n">package</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">vuln_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">fix_version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="n">aliases</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScanResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì˜ì¡´ì„± ìŠ¤ìº” ê²°ê³¼.&quot;&quot;&quot;</span>
    <span class="n">vulnerabilities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vulnerability</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">scanned_packages</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">scan_tool</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_pip_audit</span><span class="p">(</span><span class="n">requirements_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScanResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;pip-audit ì‹¤í–‰ ë° ê²°ê³¼ íŒŒì‹±.&quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;--desc&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">requirements_file</span><span class="p">:</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">requirements_file</span><span class="p">])</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">ScanResult</span><span class="p">(</span><span class="n">scan_tool</span><span class="o">=</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">cmd</span><span class="p">,</span>
            <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

        <span class="c1"># ì˜ì¡´ì„± íŒŒì‹±</span>
        <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dependencies&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">scanned_packages</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">dep</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vulns&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">Vulnerability</span><span class="p">(</span>
                    <span class="n">package</span><span class="o">=</span><span class="n">dep</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                    <span class="n">version</span><span class="o">=</span><span class="n">dep</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">],</span>
                    <span class="n">vuln_id</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                    <span class="n">fix_version</span><span class="o">=</span><span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fix_versions&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fix_versions&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">aliases</span><span class="o">=</span><span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pip-auditê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ. ì‹¤í–‰: pip install pip-audit&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pip-auditì´ 120ì´ˆ í›„ íƒ€ì„ì•„ì›ƒ&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pip-audit ì¶œë ¥ íŒŒì‹± ì‹¤íŒ¨: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_requirements_pinning</span><span class="p">(</span><span class="n">requirements_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì˜ì¡´ì„±ì´ ì •í™•í•œ ë²„ì „ìœ¼ë¡œ ì˜¬ë°”ë¥´ê²Œ ê³ ì •ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬.</span>
<span class="sd">    ê³ ì •ë˜ì§€ ì•Šì€ ì˜ì¡´ì„±ì€ ì·¨ì•½í•œ ë²„ì „ì„ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´</span>
<span class="sd">    ë³´ì•ˆ ìœ„í—˜ì…ë‹ˆë‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">req_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">requirements_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">req_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Requirements íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: </span><span class="si">{</span><span class="n">requirements_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">req_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="c1"># ê³ ì •ë˜ì§€ ì•Šì€ ì˜ì¡´ì„± ê²€ì‚¬</span>
        <span class="k">if</span> <span class="s2">&quot;==&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;&gt;=&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ë¼ì¸ </span><span class="si">{</span><span class="n">line_num</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&#39;ì´ &gt;=ë¥¼ ì‚¬ìš© (ìƒí•œ ë¯¸ê³ ì •). &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;ì •í™•í•œ ê³ ì •ì„ ìœ„í•´ == ì‚¬ìš©.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ë¼ì¸ </span><span class="si">{</span><span class="n">line_num</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&#39;ì— ë²„ì „ ê³ ì • ì—†ìŒ. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;ì •í™•í•œ ë²„ì „ì„ ê³ ì •í•˜ê¸° ìœ„í•´ == ì‚¬ìš©.&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">warnings</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_known_malicious_packages</span><span class="p">(</span><span class="n">requirements_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì•Œë ¤ì§„ íƒ€ì´í¬ìŠ¤ì¿¼íŒ… / ì•…ì„± íŒ¨í‚¤ì§€ ì´ë¦„ ê²€ì‚¬.</span>
<span class="sd">    ì´ëŠ” ë‹¨ìˆœí™”ëœ ê²€ì‚¬ - ì‹¤ì œ ìŠ¤ìºë„ˆëŠ” ë” í° ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ì•Œë ¤ì§„ íƒ€ì´í¬ìŠ¤ì¿¼íŒ… ì˜ˆì œ (ë‹¨ìˆœí™”ëœ ëª©ë¡)</span>
    <span class="n">SUSPICIOUS_PATTERNS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;python-dateutil&quot;</span><span class="p">:</span> <span class="s2">&quot;dateutil&quot;</span><span class="p">,</span>       <span class="c1"># ì¼ë°˜ì ì¸ í˜¼ë™</span>
        <span class="s2">&quot;beautifulsoup4&quot;</span><span class="p">:</span> <span class="s2">&quot;beautifulsoup&quot;</span><span class="p">,</span>   <span class="c1"># êµ¬ë²„ì „</span>
        <span class="c1"># ì•Œë ¤ì§„ ì•…ì„± íŒ¨í‚¤ì§€ ì˜ˆì œ (í˜„ì¬ PyPIì—ì„œ ì œê±°ë¨)</span>
        <span class="s2">&quot;colourama&quot;</span><span class="p">:</span> <span class="s2">&quot;colorama&quot;</span><span class="p">,</span>
        <span class="s2">&quot;python3-dateutil&quot;</span><span class="p">:</span> <span class="s2">&quot;python-dateutil&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jeIlyfish&quot;</span><span class="p">:</span> <span class="s2">&quot;jellyfish&quot;</span><span class="p">,</span>            <span class="c1"># ëŒ€ë¬¸ì I vs ì†Œë¬¸ì l</span>
    <span class="p">}</span>

    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">req_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">requirements_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">req_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">req_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">pkg_name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;==&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pkg_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">SUSPICIOUS_PATTERNS</span><span class="p">]:</span>
            <span class="n">correct</span> <span class="o">=</span> <span class="n">SUSPICIOUS_PATTERNS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ê²½ê³ : &#39;</span><span class="si">{</span><span class="n">pkg_name</span><span class="si">}</span><span class="s2">&#39;ì€ &#39;</span><span class="si">{</span><span class="n">correct</span><span class="si">}</span><span class="s2">&#39;ì˜ íƒ€ì´í¬ìŠ¤ì¿¼íŒ…ì¼ ìˆ˜ ìˆìŒ. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;íŒ¨í‚¤ì§€ ì´ë¦„ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸.&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">warnings</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">(</span><span class="n">scan_result</span><span class="p">:</span> <span class="n">ScanResult</span><span class="p">,</span> <span class="n">pinning_warnings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                    <span class="n">typosquat_warnings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;í˜•ì‹í™”ëœ ë³´ì•ˆ ë¦¬í¬íŠ¸ ìƒì„±.&quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ì˜ì¡´ì„± ë³´ì•ˆ ìŠ¤ìº” ë¦¬í¬íŠ¸&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë„êµ¬: </span><span class="si">{</span><span class="n">scan_result</span><span class="o">.</span><span class="n">scan_tool</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìŠ¤ìº”ëœ íŒ¨í‚¤ì§€: </span><span class="si">{</span><span class="n">scan_result</span><span class="o">.</span><span class="n">scanned_packages</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°œê²¬ëœ ì·¨ì•½ì : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">scan_result</span><span class="o">.</span><span class="n">vulnerabilities</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì˜¤ë¥˜:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!] </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">vulnerabilities</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ì·¨ì•½ì &quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">vulnerabilities</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  íŒ¨í‚¤ì§€: </span><span class="si">{</span><span class="n">vuln</span><span class="o">.</span><span class="n">package</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">vuln</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ID:      </span><span class="si">{</span><span class="n">vuln</span><span class="o">.</span><span class="n">vuln_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vuln</span><span class="o">.</span><span class="n">aliases</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ë³„ì¹­: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vuln</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vuln</span><span class="o">.</span><span class="n">fix_version</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìˆ˜ì •:     </span><span class="si">{</span><span class="n">vuln</span><span class="o">.</span><span class="n">fix_version</span><span class="si">}</span><span class="s2">ë¡œ ì—…ê·¸ë ˆì´ë“œ&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vuln</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
                <span class="n">desc</span> <span class="o">=</span> <span class="n">vuln</span><span class="o">.</span><span class="n">description</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìƒì„¸:  </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pinning_warnings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ë²„ì „ ê³ ì • ê²½ê³ &quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">pinning_warnings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!] </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">typosquat_warnings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  íƒ€ì´í¬ìŠ¤ì¿¼íŒ… ê²½ê³ &quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">typosquat_warnings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!] </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì¢…ë£Œ ê¶Œì¥ì‚¬í•­ ê²°ì •</span>
    <span class="k">if</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">vulnerabilities</span> <span class="ow">or</span> <span class="n">typosquat_warnings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ê²°ê³¼: ì‹¤íŒ¨ - ì£¼ì˜ê°€ í•„ìš”í•œ ë¬¸ì œ ë°œê²¬&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pinning_warnings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ê²°ê³¼: ê²½ê³  - ê³ ì • ë¬¸ì œ ìˆ˜ì • ê³ ë ¤&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  ê²°ê³¼: í†µê³¼ - ë¬¸ì œ ì—†ìŒ&quot;</span><span class="p">)</span>

    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">req_file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;requirements.txt&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] ì˜ì¡´ì„± ìŠ¤ìº” ì¤‘: </span><span class="si">{</span><span class="n">req_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ëª¨ë“  ê²€ì‚¬ ì‹¤í–‰</span>
    <span class="n">scan_result</span> <span class="o">=</span> <span class="n">run_pip_audit</span><span class="p">(</span><span class="n">req_file</span><span class="p">)</span>
    <span class="n">pinning_warnings</span> <span class="o">=</span> <span class="n">check_requirements_pinning</span><span class="p">(</span><span class="n">req_file</span><span class="p">)</span>
    <span class="n">typosquat_warnings</span> <span class="o">=</span> <span class="n">check_known_malicious_packages</span><span class="p">(</span><span class="n">req_file</span><span class="p">)</span>

    <span class="c1"># ë¦¬í¬íŠ¸ ìƒì„± ë° ì¶œë ¥</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span><span class="n">scan_result</span><span class="p">,</span> <span class="n">pinning_warnings</span><span class="p">,</span> <span class="n">typosquat_warnings</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

    <span class="c1"># CIë¥¼ ìœ„í•œ ì ì ˆí•œ ì½”ë“œë¡œ ì¢…ë£Œ</span>
    <span class="k">if</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">vulnerabilities</span> <span class="ow">or</span> <span class="n">typosquat_warnings</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">scan_result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<h3 id="45-dependabot-github">4.5 Dependabot êµ¬ì„± (GitHub)<a class="header-link" href="#45-dependabot-github" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/dependabot.yml</span>

<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">updates</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Python pip ì˜ì¡´ì„±</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">package-ecosystem</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pip&quot;</span>
<span class="w">    </span><span class="nt">directory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">    </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weekly&quot;</span>
<span class="w">      </span><span class="nt">day</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;monday&quot;</span>
<span class="w">      </span><span class="nt">time</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;09:00&quot;</span>
<span class="w">      </span><span class="nt">timezone</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;America/New_York&quot;</span>
<span class="w">    </span><span class="nt">open-pull-requests-limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">reviewers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;security-team&quot;</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;dependencies&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;security&quot;</span>
<span class="w">    </span><span class="c1"># ë§ˆì´ë„ˆ/íŒ¨ì¹˜ ì—…ë°ì´íŠ¸ë¥¼ í•¨ê»˜ ê·¸ë£¹í™”</span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span>
<span class="w">      </span><span class="nt">minor-and-patch</span><span class="p">:</span>
<span class="w">        </span><span class="nt">update-types</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;minor&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;patch&quot;</span>
<span class="w">    </span><span class="c1"># íŠ¹ì • íŒ¨í‚¤ì§€ ë¬´ì‹œ</span>
<span class="w">    </span><span class="nt">ignore</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dependency-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;boto3&quot;</span>
<span class="w">        </span><span class="nt">update-types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;version-update:semver-patch&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="c1"># ë³´ì•ˆ ì—…ë°ì´íŠ¸ë§Œ (ë²„ì „ ì—…ë°ì´íŠ¸ ì—†ìŒ)</span>
<span class="w">    </span><span class="c1"># ë³´ì•ˆë§Œì„ ìœ„í•´ì„œëŠ” ì•„ë˜ ì£¼ì„ í•´ì œ ë° ìŠ¤ì¼€ì¤„ ì œê±°</span>
<span class="w">    </span><span class="c1"># open-pull-requests-limit: 0</span>

<span class="w">  </span><span class="c1"># Docker ë² ì´ìŠ¤ ì´ë¯¸ì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">package-ecosystem</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;docker&quot;</span>
<span class="w">    </span><span class="nt">directory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">    </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weekly&quot;</span>

<span class="w">  </span><span class="c1"># GitHub Actions</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">package-ecosystem</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;github-actions&quot;</span>
<span class="w">    </span><span class="nt">directory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">    </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weekly&quot;</span>
</code></pre></div>

<hr />
<h2 id="5">5. í¼ì§•<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 í¼ì§•ì´ë€?<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>í¼ì§•ì€ í”„ë¡œê·¸ë¨ì— ëœë¤í•˜ê±°ë‚˜, ì˜ëª»ëœ í˜•ì‹ì´ê±°ë‚˜, ì˜ˆìƒì¹˜ ëª»í•œ ì…ë ¥ì„ ê³µê¸‰í•˜ì—¬ í¬ë˜ì‹œ, í–‰(hang), ë³´ì•ˆ ì·¨ì•½ì ì„ ì°¾ëŠ” ìë™í™”ëœ í…ŒìŠ¤íŒ… ê¸°ë²•ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      í¼ì§• í”¼ë“œë°± ë£¨í”„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   ì‹œë“œ      â”‚     â”‚  ë³€ì´       â”‚     â”‚    ëŒ€ìƒ         â”‚       â”‚
â”‚  â”‚   ì½”í¼ìŠ¤    â”‚â”€â”€â”€â”€â–ºâ”‚  ì—”ì§„       â”‚â”€â”€â”€â”€â–ºâ”‚   í”„ë¡œê·¸ë¨      â”‚       â”‚
â”‚  â”‚  (ì´ˆê¸°      â”‚     â”‚            â”‚     â”‚                â”‚       â”‚
â”‚  â”‚   ì…ë ¥)     â”‚     â”‚ - ë¹„íŠ¸ í”Œë¦½â”‚     â”‚ ì…ë ¥ íŒŒì‹±      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ - ì‚½ì…     â”‚     â”‚ ë°ì´í„° ì²˜ë¦¬    â”‚       â”‚
â”‚       â–²             â”‚ - ì‚­ì œ     â”‚     â”‚ ê²°ê³¼ ë°˜í™˜      â”‚       â”‚
â”‚       â”‚             â”‚ - êµì²´     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚                â”‚
â”‚       â”‚                                        â”‚                â”‚
â”‚       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                â”‚
â”‚       â”‚         â”‚  ì»¤ë²„ë¦¬ì§€    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  ëª¨ë‹ˆí„°      â”‚  (ì½”ë“œ ì»¤ë²„ë¦¬ì§€ í”¼ë“œë°±)        â”‚
â”‚  (ìƒˆë¡œìš´ ê²½ë¡œë¥¼ â”‚              â”‚                                 â”‚
â”‚   ì°¾ì€ ì…ë ¥     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚   ì €ì¥)              â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                â”‚  í¬ë˜ì‹œ/ë²„ê·¸ â”‚                                  â”‚
â”‚                â”‚  íƒì§€        â”‚                                  â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52-afl-american-fuzzy-lop">5.2 AFL (American Fuzzy Lop)<a class="header-link" href="#52-afl-american-fuzzy-lop" title="Permanent link">&para;</a></h3>
<p>AFLì€ C/C++ í”„ë¡œê·¸ë¨ì„ ìœ„í•œ ê°€ì¥ ì˜í–¥ë ¥ ìˆëŠ” ì»¤ë²„ë¦¬ì§€ ê°€ì´ë“œ í¼ì €ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># AFL++ ì„¤ì¹˜</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>afl++<span class="w">  </span><span class="c1"># Debian/Ubuntu</span>

<span class="c1"># AFL ê³„ì¸¡ìœ¼ë¡œ ëŒ€ìƒ ì»´íŒŒì¼</span>
afl-cc<span class="w"> </span>-o<span class="w"> </span>target_program<span class="w"> </span>target_program.c

<span class="c1"># ì‹œë“œ ì½”í¼ìŠ¤ ë””ë ‰í† ë¦¬ ìƒì„±</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>seeds
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;valid input&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>seeds/seed1.txt

<span class="c1"># AFL ì‹¤í–‰</span>
afl-fuzz<span class="w"> </span>-i<span class="w"> </span>seeds<span class="w"> </span>-o<span class="w"> </span>findings<span class="w"> </span>./target_program<span class="w"> </span>@@

<span class="c1"># @@ëŠ” ì…ë ¥ íŒŒì¼ ê²½ë¡œë¡œ ëŒ€ì²´ë¨</span>
<span class="c1"># -i: ì‹œë“œ ë””ë ‰í† ë¦¬</span>
<span class="c1"># -o: ì¶œë ¥ ë””ë ‰í† ë¦¬ (í¬ë˜ì‹œ, í–‰, í)</span>

<span class="c1"># AFL ìƒíƒœ ëª¨ë‹ˆí„°ë§</span>
afl-whatsup<span class="w"> </span>findings/
</code></pre></div>

<h4 id="afl">AFL ì¶œë ¥ ë””ë ‰í† ë¦¬ êµ¬ì¡°<a class="header-link" href="#afl" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>findings/
â”œâ”€â”€ crashes/         # í¬ë˜ì‹œë¥¼ ë°œìƒì‹œí‚¨ ì…ë ¥
â”‚   â”œâ”€â”€ id:000000,...  # í¬ë˜ì‹œ ìœ ë°œ ì…ë ¥
â”‚   â””â”€â”€ README.txt
â”œâ”€â”€ hangs/           # í–‰/íƒ€ì„ì•„ì›ƒì„ ë°œìƒì‹œí‚¨ ì…ë ¥
â”œâ”€â”€ queue/           # í¥ë¯¸ë¡œìš´ ì…ë ¥ (ìƒˆë¡œìš´ ì»¤ë²„ë¦¬ì§€)
â””â”€â”€ fuzzer_stats     # í˜„ì¬ í¼ì§• í†µê³„
</code></pre></div>

<h3 id="53-hypothesis-python">5.3 Hypothesis: Pythonì„ ìœ„í•œ ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ…<a class="header-link" href="#53-hypothesis-python" title="Permanent link">&para;</a></h3>
<p>HypothesisëŠ” ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ…ì„ ìœ„í•œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ì „í†µì ì¸ í¼ì €ëŠ” ì•„ë‹ˆì§€ë§Œ, ì—£ì§€ ì¼€ì´ìŠ¤ë¥¼ ì°¾ê¸° ìœ„í•´ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì…ë ¥ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Hypothesisë¥¼ ì´ìš©í•œ ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ….</span>
<span class="sd">ì„¤ì¹˜: pip install hypothesis</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">given</span><span class="p">,</span> <span class="n">assume</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">HealthCheck</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">strategies</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>


<span class="c1"># â”€â”€â”€ ê¸°ë³¸ ì˜ˆì œ: ìƒì„±ëœ ì…ë ¥ìœ¼ë¡œ í•¨ìˆ˜ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encode_decode_round_trip</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì¸ì½”ë”© í›„ ë””ì½”ë”©í•˜ë©´ ì›ë³¸ ë°ì´í„°ë¥¼ ë°˜í™˜í•´ì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="n">encoded</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decoded</span> <span class="o">==</span> <span class="n">data</span>


<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_encode_decode_roundtrip</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;UTF-8 ì¸ì½”ë“œ/ë””ì½”ë“œê°€ ì™„ë²½í•œ ì™•ë³µì„ì„ í…ŒìŠ¤íŠ¸.&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">encode_decode_round_trip</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="c1"># â”€â”€â”€ JSON íŒŒì‹± ê²¬ê³ ì„± í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_json_loads_doesnt_crash</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    json.loadsëŠ” ì„±ê³µì ìœ¼ë¡œ íŒŒì‹±í•˜ê±°ë‚˜</span>
<span class="sd">    ValueError/JSONDecodeErrorë¥¼ ë°œìƒì‹œì¼œì•¼ í•¨ - ì ˆëŒ€ í¬ë˜ì‹œë‚˜ í–‰ ì—†ìŒ.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">pass</span>  <span class="c1"># ìœ íš¨í•˜ì§€ ì•Šì€ JSONì— ëŒ€í•´ ì˜ˆìƒë¨</span>


<span class="c1"># â”€â”€â”€ ì…ë ¥ ê²€ì¦ í•¨ìˆ˜ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_email</span><span class="p">(</span><span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê°„ë‹¨í•œ ì´ë©”ì¼ ê²€ì¦ (ë°ëª¨ë¥¼ ìœ„í•´ ì˜ë„ì ìœ¼ë¡œ ë²„ê·¸ê°€ ìˆìŒ).&quot;&quot;&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">))</span>


<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">emails</span><span class="p">())</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_valid_emails_pass_validation</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ëª¨ë“  ìœ íš¨í•œ ì´ë©”ì¼ì€ ê²€ì¦ê¸°ë¥¼ í†µê³¼í•´ì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="c1"># ì´ê²ƒì€ ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ë†’ìŒ, ì •ê·œì‹ì˜ ê°­ì„ ë…¸ì¶œí•¨</span>
    <span class="k">assert</span> <span class="n">validate_email</span><span class="p">(</span><span class="n">email</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;ìœ íš¨í•œ ì´ë©”ì¼ ê±°ë¶€ë¨: </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="c1"># â”€â”€â”€ êµ¬ì¡°í™”ëœ ë°ì´í„°ë¡œ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="c1"># ì‚¬ìš©ì ë“±ë¡ ë°ì´í„° ìƒì„±ì„ ìœ„í•œ ì „ëµ</span>
<span class="n">user_strategy</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">fixed_dictionaries</span><span class="p">({</span>
    <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">characters</span><span class="p">(</span><span class="n">whitelist_categories</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)),</span>
        <span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_size</span><span class="o">=</span><span class="mi">50</span>
    <span class="p">),</span>
    <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="n">st</span><span class="o">.</span><span class="n">emails</span><span class="p">(),</span>
    <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">128</span><span class="p">),</span>
    <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">st</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
<span class="p">})</span>


<span class="k">def</span><span class="w"> </span><span class="nf">process_registration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì‚¬ìš©ì ë“±ë¡ ì²˜ë¦¬. ëª¨ë“  ìœ íš¨í•œ ì…ë ¥ì„ ì²˜ë¦¬í•´ì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ì‚¬ìš©ìëª…ì´ ë„ˆë¬´ ì§§ìŒ&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì§§ìŒ&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ìµœì†Œ 13ì„¸ ì´ìƒì´ì–´ì•¼ í•¨&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;registered&#39;</span>
    <span class="p">}</span>


<span class="nd">@given</span><span class="p">(</span><span class="n">user_strategy</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_registration_never_crashes</span><span class="p">(</span><span class="n">user_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë“±ë¡ì€ ì„±ê³µí•˜ê±°ë‚˜ ValueErrorë¥¼ ë°œìƒì‹œì¼œì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">process_registration</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">result</span>
        <span class="k">assert</span> <span class="s1">&#39;email&#39;</span> <span class="ow">in</span> <span class="n">result</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„°ì— ëŒ€í•´ ì˜ˆìƒë¨</span>


<span class="c1"># â”€â”€â”€ URL íŒŒì„œ í¼ì§• â”€â”€â”€</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">urlunparse</span>

<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">from_regex</span><span class="p">(</span>
    <span class="sa">r</span><span class="s1">&#39;https?://[a-z0-9.-]{1,50}(:[0-9]{1,5})?(/[a-z0-9._-]{0,20}){0,5}(\?[a-z0-9=&amp;]{0,50})?&#39;</span><span class="p">,</span>
    <span class="n">fullmatch</span><span class="o">=</span><span class="kc">True</span>
<span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_url_parse_roundtrip</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;URL íŒŒì‹± í›„ ì–¸íŒŒì‹±ì€ URLì„ ë³´ì¡´í•´ì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">reconstructed</span> <span class="o">=</span> <span class="n">urlunparse</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
    <span class="c1"># ì»´í¬ë„ŒíŠ¸ ë¹„êµë¥¼ ìœ„í•´ ë‘˜ ë‹¤ ì¬íŒŒì‹± (ì •ê·œí™”ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)</span>
    <span class="k">assert</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">reconstructed</span><span class="p">)</span><span class="o">.</span><span class="n">netloc</span> <span class="o">==</span> <span class="n">parsed</span><span class="o">.</span><span class="n">netloc</span>


<span class="c1"># â”€â”€â”€ ë³´ì•ˆì— ë¯¼ê°í•œ í•¨ìˆ˜ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sanitize_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;íŒŒì¼ëª…ì—ì„œ ìœ„í—˜í•œ ë¬¸ì ì œê±°.&quot;&quot;&quot;</span>
    <span class="c1"># ê²½ë¡œ êµ¬ë¶„ì ë° ë„ ë°”ì´íŠ¸ ì œê±°</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">sanitized</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">sanitized</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># ì„ í–‰ ì  ì œê±° (ìˆ¨ê¹€ íŒŒì¼)</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">sanitized</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sanitized</span> <span class="ow">or</span> <span class="s1">&#39;unnamed&#39;</span>


<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">255</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_sanitized_filename_is_safe</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì •ì œëœ íŒŒì¼ëª…ì€ ì ˆëŒ€ ê²½ë¡œ ìˆœíšŒë¥¼ í¬í•¨í•˜ì§€ ì•Šì•„ì•¼ í•¨.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sanitize_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s1">&#39;/&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ê²½ë¡œ êµ¬ë¶„ì í¬í•¨: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ë°±ìŠ¬ë˜ì‹œ í¬í•¨: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ë„ ë°”ì´íŠ¸ í¬í•¨: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;ìˆ¨ê¹€ íŒŒì¼: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="s1">&#39;..&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ê²½ë¡œ ìˆœíšŒ í¬í•¨: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ì •ì œ í›„ ë¹ˆ íŒŒì¼ëª…&quot;</span>


<span class="c1"># â”€â”€â”€ ê³ ê¸‰: ìƒíƒœ ê¸°ë°˜ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">hypothesis.stateful</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleBasedStateMachine</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">initialize</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ShoppingCartStateMachine</span><span class="p">(</span><span class="n">RuleBasedStateMachine</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì‡¼í•‘ ì¹´íŠ¸ë¥¼ ìœ„í•œ ìƒíƒœ ê¸°ë°˜ í…ŒìŠ¤íŒ….</span>
<span class="sd">    Hypothesisê°€ ì‘ì—… ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•˜ê³ </span>
<span class="sd">    ê° ë‹¨ê³„ í›„ ë¶ˆë³€ì„±ì„ ê²€ì‚¬í•¨.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cart</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="nd">@initialize</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_cart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cart</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="nd">@rule</span><span class="p">(</span>
        <span class="n">item</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
        <span class="n">price</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">floats</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">quantity</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">quantity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì¹´íŠ¸ì— ì•„ì´í…œ ì¶”ê°€.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;quantity&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">quantity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="n">quantity</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recalculate_total</span><span class="p">()</span>

    <span class="nd">@rule</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì¹´íŠ¸ì—ì„œ ì•„ì´í…œ ì œê±°.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_recalculate_total</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_recalculate_total</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;quantity&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë¶ˆë³€ì„±: í•©ê³„ëŠ” ì ˆëŒ€ ìŒìˆ˜ê°€ ì•„ë‹ˆì–´ì•¼ í•¨.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ìŒìˆ˜ í•©ê³„: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cart</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>


<span class="c1"># ìƒíƒœ ë¨¸ì‹ ì—ì„œ í…ŒìŠ¤íŠ¸ ìƒì„±</span>
<span class="n">TestShoppingCart</span> <span class="o">=</span> <span class="n">ShoppingCartStateMachine</span><span class="o">.</span><span class="n">TestCase</span>


<span class="c1"># â”€â”€â”€ ì„¤ì •ê³¼ í•¨ê»˜ Hypothesis ì‹¤í–‰ â”€â”€â”€</span>

<span class="nd">@settings</span><span class="p">(</span>
    <span class="n">max_examples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>        <span class="c1"># ìƒì„±í•  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìˆ˜</span>
    <span class="n">deadline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>            <span class="c1"># í…ŒìŠ¤íŠ¸ë‹¹ ì‹œê°„ ì œí•œ ì—†ìŒ</span>
    <span class="n">suppress_health_check</span><span class="o">=</span><span class="p">[</span>   <span class="c1"># íŠ¹ì • ê±´ê°• ê²€ì‚¬ ì–µì œ</span>
        <span class="n">HealthCheck</span><span class="o">.</span><span class="n">too_slow</span><span class="p">,</span>
        <span class="n">HealthCheck</span><span class="o">.</span><span class="n">filter_too_much</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_binary_processing</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë°”ì´ë„ˆë¦¬ í”„ë¡œì„¸ì„œê°€ ëª¨ë“  ì…ë ¥ì„ ì²˜ë¦¬í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸.&quot;&quot;&quot;</span>
    <span class="c1"># ì—¬ê¸°ì— ë°”ì´ë„ˆë¦¬ ì²˜ë¦¬ í•¨ìˆ˜</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># errors=&#39;replace&#39;ë¡œëŠ” ì—¬ê¸°ì— ì ˆëŒ€ ë„ë‹¬í•˜ì§€ ì•Šì•„ì•¼ í•¨</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="54">5.4 ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ í¼ì§•<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">êµìœ¡ ëª©ì ì„ ìœ„í•œ ê°„ë‹¨í•œ í”„ë¡œí† ì½œ í¼ì €.</span>
<span class="sd">í”„ë¡œí† ì½œ í…ŒìŠ¤íŒ…ì„ ìœ„í•œ ì˜ëª»ëœ í˜•ì‹ì˜ ì…ë ¥ ìƒì„±.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Generator</span>


<span class="k">def</span><span class="w"> </span><span class="nf">mutate_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">num_mutations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë°”ì´íŠ¸ ë¬¸ìì—´ì— ëœë¤ ë³€ì´ ì ìš©.&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_mutations</span><span class="p">):</span>
        <span class="n">mutation_type</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span>
            <span class="s1">&#39;bit_flip&#39;</span><span class="p">,</span> <span class="s1">&#39;byte_replace&#39;</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span>
            <span class="s1">&#39;duplicate&#39;</span><span class="p">,</span> <span class="s1">&#39;overflow&#39;</span>
        <span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
            <span class="k">continue</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;bit_flip&#39;</span><span class="p">:</span>
            <span class="n">bit</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;byte_replace&#39;</span><span class="p">:</span>
            <span class="c1"># í¥ë¯¸ë¡œìš´ ê°’ìœ¼ë¡œ êµì²´</span>
            <span class="n">interesting</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">]</span>
            <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">interesting</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;insert&#39;</span><span class="p">:</span>
            <span class="n">insert_data</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">insert_data</span>

        <span class="k">elif</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;delete&#39;</span><span class="p">:</span>
            <span class="n">del_len</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">pos</span><span class="p">))</span>
            <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span> <span class="o">+</span> <span class="n">del_len</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;duplicate&#39;</span><span class="p">:</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
            <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span>

        <span class="k">elif</span> <span class="n">mutation_type</span> <span class="o">==</span> <span class="s1">&#39;overflow&#39;</span><span class="p">:</span>
            <span class="c1"># ë§¤ìš° ê¸´ ë¬¸ìì—´ ì‚½ì…</span>
            <span class="n">overflow</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">65536</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">overflow</span>

    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_http_fuzz_requests</span><span class="p">(</span><span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;í¼ì§•ëœ HTTP ìš”ì²­ ìƒì„±.&quot;&quot;&quot;</span>

    <span class="n">base_requests</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s2">Host: </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
        <span class="sa">f</span><span class="s2">&quot;POST /login HTTP/1.1</span><span class="se">\r\n</span><span class="s2">Host: </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="se">\r\n</span><span class="s2">Content-Length: 10</span><span class="se">\r\n\r\n</span><span class="s2">user=admin&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
        <span class="sa">f</span><span class="s2">&quot;GET /</span><span class="si">{</span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5000</span><span class="si">}</span><span class="s2"> HTTP/1.1</span><span class="se">\r\n</span><span class="s2">Host: </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
    <span class="p">]</span>

    <span class="c1"># ì›ë³¸ ìš”ì²­ ì–‘ë³´</span>
    <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">base_requests</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">req</span>

    <span class="c1"># ë³€ì´ëœ ë²„ì „ ì–‘ë³´</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">base_requests</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">mutate_bytes</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>

    <span class="c1"># íŠ¹ìˆ˜ ì¼€ì´ìŠ¤</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">1024</span>                        <span class="c1"># ë„ ë°”ì´íŠ¸</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;GET / HTTP/9.9</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span>             <span class="c1"># ìœ íš¨í•˜ì§€ ì•Šì€ ë²„ì „</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;XYZZY / HTTP/1.1</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span>           <span class="c1"># ìœ íš¨í•˜ì§€ ì•Šì€ ë©”ì„œë“œ</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;X: Y</span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">10000</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span>  <span class="c1"># í—¤ë” í­íƒ„</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s2">Content-Length: -1</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span>         <span class="c1"># ìŒìˆ˜ ê¸¸ì´</span>
    <span class="k">yield</span> <span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s2">Content-Length: 999999999</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span>  <span class="c1"># ê±°ëŒ€í•œ ê¸¸ì´</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fuzz_target</span><span class="p">(</span><span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ëŒ€ìƒ ì„œë²„ì— í¼ì§•ëœ ìš”ì²­ ì „ì†¡.</span>

<span class="sd">    ê²½ê³ : ì†Œìœ í•˜ê±°ë‚˜ ëª…ì‹œì  í…ŒìŠ¤íŠ¸ ê¶Œí•œì´ ìˆëŠ” ì„œë²„ì—ë§Œ ì‚¬ìš©.</span>
<span class="sd">    ë¬´ë‹¨ í…ŒìŠ¤íŒ…ì€ ë¶ˆë²•ì…ë‹ˆë‹¤.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] í¼ì§• ì¤‘ </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">crash_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_sent</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">generate_http_fuzz_requests</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
                <span class="n">total_sent</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!] í˜ì´ë¡œë“œ #</span><span class="si">{</span><span class="n">total_sent</span><span class="si">}</span><span class="s2">ì—ì„œ íƒ€ì„ì•„ì›ƒ &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;(ê¸¸ì´=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="n">total_sent</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">except</span> <span class="ne">ConnectionRefusedError</span><span class="p">:</span>
            <span class="n">crash_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!!!] í˜ì´ë¡œë“œ #</span><span class="si">{</span><span class="n">total_sent</span><span class="si">}</span><span class="s2"> í›„ ì—°ê²° ê±°ë¶€ë¨. &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;ì„œë²„ê°€ í¬ë˜ì‹œí–ˆì„ ìˆ˜ ìˆìŒ!&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       í˜ì´ë¡œë“œ (ì²˜ìŒ 100 ë°”ì´íŠ¸): </span><span class="si">{</span><span class="n">payload</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># í¬ë˜ì‹œ ìœ ë°œ í˜ì´ë¡œë“œ ì €ì¥</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;crash_</span><span class="si">{</span><span class="n">crash_count</span><span class="si">}</span><span class="s2">.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [!] ì˜¤ë¥˜: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] í¼ì§• ì™„ë£Œ. </span><span class="si">{</span><span class="n">total_sent</span><span class="si">}</span><span class="s2">ê°œ í˜ì´ë¡œë“œ ì „ì†¡. &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;íƒì§€ëœ í¬ë˜ì‹œ: </span><span class="si">{</span><span class="n">crash_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ë°©ë²•ë¡ <a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ì¹¨íˆ¬ í…ŒìŠ¤íŒ… í”„ë¡œì„¸ìŠ¤<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ë°©ë²•ë¡                                   â”‚
â”‚              (PTES / OWASP ê¸°ë°˜)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 1. ê³„íš ë° ë²”ìœ„      â”‚  ëŒ€ìƒ, êµì „ ê·œì¹™ ì •ì˜                 â”‚
â”‚  â”‚    (ì‚¬ì „ êµì „)       â”‚  ë²•ì  ìŠ¹ì¸, ê²½ê³„                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 2. ì •ì°°              â”‚  ìˆ˜ë™: OSINT, DNS, WHOIS              â”‚
â”‚  â”‚    (ì •ë³´             â”‚  ëŠ¥ë™: í¬íŠ¸ ìŠ¤ìº”, ì„œë¹„ìŠ¤ ì—´ê±°         â”‚
â”‚  â”‚     ìˆ˜ì§‘)            â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 3. ì·¨ì•½ì             â”‚  ìë™í™” ìŠ¤ìºë‹ (Nessus, ZAP)          â”‚
â”‚  â”‚    í‰ê°€              â”‚  ìˆ˜ë™ í…ŒìŠ¤íŒ…, ì„¤ì • ì˜¤ë¥˜               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 4. ìµìŠ¤í”Œë¡œì‡        â”‚  ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡ ì‹œë„               â”‚
â”‚  â”‚                      â”‚  ì ‘ê·¼ íšë“, ê¶Œí•œ ìƒìŠ¹                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 5. ìµìŠ¤í”Œë¡œì‡ í›„     â”‚  ì¸¡ë©´ ì´ë™, ë°ì´í„° ìœ ì¶œ í…ŒìŠ¤íŠ¸        â”‚
â”‚  â”‚                      â”‚  ì§€ì†ì„± ë©”ì»¤ë‹ˆì¦˜                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 6. ë³´ê³               â”‚  ê²½ì˜ì§„ ìš”ì•½, ê¸°ìˆ  ìƒì„¸               â”‚
â”‚  â”‚                      â”‚  ê°œì„  ê¶Œì¥ì‚¬í•­                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="62">6.2 ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¹¨íˆ¬ í…ŒìŠ¤íŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ì¸ì¦:                                                            â”‚
â”‚  [ ] ë¸Œë£¨íŠ¸í¬ìŠ¤ ë³´í˜¸ (ê³„ì • ì ê¸ˆ, ì†ë„ ì œí•œ)                       â”‚
â”‚  [ ] ë¹„ë°€ë²ˆí˜¸ ë³µì¡ë„ ê°•ì œ                                         â”‚
â”‚  [ ] ë‹¤ì¤‘ ì¸ì¦                                                    â”‚
â”‚  [ ] ì„¸ì…˜ ê´€ë¦¬ (íƒ€ì„ì•„ì›ƒ, ë¡œí…Œì´ì…˜, ë³´ì•ˆ í”Œë˜ê·¸)                  â”‚
â”‚  [ ] ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì»¤ë‹ˆì¦˜                                     â”‚
â”‚  [ ] ê¸°ë³¸ ì¸ì¦ ì •ë³´                                               â”‚
â”‚                                                                   â”‚
â”‚  ê¶Œí•œ ë¶€ì—¬:                                                       â”‚
â”‚  [ ] ìˆ˜í‰ ê¶Œí•œ ìƒìŠ¹ (ë‹¤ë¥¸ ì‚¬ìš©ì ë°ì´í„° ì ‘ê·¼)                     â”‚
â”‚  [ ] ìˆ˜ì§ ê¶Œí•œ ìƒìŠ¹ (ê´€ë¦¬ì ê¸°ëŠ¥)                                 â”‚
â”‚  [ ] IDOR (ì•ˆì „í•˜ì§€ ì•Šì€ ì§ì ‘ ê°ì²´ ì°¸ì¡°)                          â”‚
â”‚  [ ] ê¸°ëŠ¥ ìˆ˜ì¤€ ì ‘ê·¼ ì œì–´ ëˆ„ë½                                     â”‚
â”‚                                                                   â”‚
â”‚  ì…ë ¥ ê²€ì¦:                                                       â”‚
â”‚  [ ] SQL ì¸ì ì…˜ (ëª¨ë“  ì…ë ¥ ì§€ì )                                  â”‚
â”‚  [ ] XSS (ë°˜ì‚¬í˜•, ì €ì¥í˜•, DOM ê¸°ë°˜)                               â”‚
â”‚  [ ] ëª…ë ¹ ì¸ì ì…˜                                                  â”‚
â”‚  [ ] ê²½ë¡œ ìˆœíšŒ / LFI / RFI                                        â”‚
â”‚  [ ] XML ì™¸ë¶€ ì—”í‹°í‹° (XXE)                                        â”‚
â”‚  [ ] ì„œë²„ ì¸¡ ìš”ì²­ ìœ„ì¡° (SSRF)                                     â”‚
â”‚  [ ] í…œí”Œë¦¿ ì¸ì ì…˜ (SSTI)                                         â”‚
â”‚                                                                   â”‚
â”‚  êµ¬ì„±:                                                            â”‚
â”‚  [ ] HTTPS ê°•ì œ                                                   â”‚
â”‚  [ ] ë³´ì•ˆ í—¤ë” (CSP, HSTS, X-Frame-Options ë“±)                   â”‚
â”‚  [ ] CORS ì •ì±…                                                    â”‚
â”‚  [ ] ì—ëŸ¬ ì²˜ë¦¬ (í”„ë¡œë•ì…˜ì—ì„œ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ì—†ìŒ)                  â”‚
â”‚  [ ] ë””ë ‰í† ë¦¬ ëª©ë¡ ë¹„í™œì„±í™”                                       â”‚
â”‚  [ ] ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥/í˜ì´ì§€ ì œê±°                                    â”‚
â”‚                                                                   â”‚
â”‚  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§:                                                   â”‚
â”‚  [ ] ê²½ìŸ ì¡°ê±´                                                    â”‚
â”‚  [ ] ê°€ê²© ì¡°ì‘                                                    â”‚
â”‚  [ ] ì›Œí¬í”Œë¡œìš° ìš°íšŒ                                              â”‚
â”‚  [ ] ëŒ€ëŸ‰ í• ë‹¹                                                    â”‚
â”‚                                                                   â”‚
â”‚  API íŠ¹í™”:                                                        â”‚
â”‚  [ ] API í‚¤ ë…¸ì¶œ                                                  â”‚
â”‚  [ ] ì†ë„ ì œí•œ                                                    â”‚
â”‚  [ ] ê³¼ë„í•œ ë°ì´í„° ë…¸ì¶œ                                           â”‚
â”‚  [ ] ë¦¬ì†ŒìŠ¤ ì œí•œ ë¶€ì¡±                                             â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="63-python">6.3 Python ì¹¨íˆ¬ í…ŒìŠ¤íŒ… í—¬í¼<a class="header-link" href="#63-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ì¹¨íˆ¬ í…ŒìŠ¤íŒ… í—¬í¼ í•¨ìˆ˜.</span>
<span class="sd">ìŠ¹ì¸ëœ í…ŒìŠ¤íŒ…ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.parse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="c1"># â”€â”€â”€ SQL ì¸ì ì…˜ í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="n">SQL_INJECTION_PAYLOADS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;&#39; OR &#39;1&#39;=&#39;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; OR &#39;1&#39;=&#39;1&#39; --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; OR &#39;1&#39;=&#39;1&#39; /*&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1; DROP TABLE users --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; UNION SELECT NULL,NULL,NULL --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; AND 1=1 --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; AND 1=2 --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;admin&#39;--&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1&#39; ORDER BY 1 --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1&#39; ORDER BY 100 --&quot;</span><span class="p">,</span>
    <span class="s2">&quot;-1 OR 1=1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39; OR &#39;&#39;=&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&#39;; WAITFOR DELAY &#39;0:0:5&#39; --&quot;</span><span class="p">,</span>  <span class="c1"># Time-based blind SQLi (MSSQL)</span>
    <span class="s2">&quot;&#39; OR SLEEP(5) --&quot;</span><span class="p">,</span>              <span class="c1"># Time-based blind SQLi (MySQL)</span>
<span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_sql_injection</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    URL íŒŒë¼ë¯¸í„°ì˜ SQL ì¸ì ì…˜ ì·¨ì•½ì  í…ŒìŠ¤íŠ¸.</span>
<span class="sd">    ì ì¬ì ìœ¼ë¡œ ì·¨ì•½í•œ í˜ì´ë¡œë“œ ëª©ë¡ ë°˜í™˜.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># ë¨¼ì € ë² ì´ìŠ¤ë¼ì¸ ì‘ë‹µ ê°€ì ¸ì˜¤ê¸°</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">baseline_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseline</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">baseline_time</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">SQL_INJECTION_PAYLOADS</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span> <span class="n">payload</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                    <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span> <span class="n">payload</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span>
                <span class="p">)</span>

            <span class="c1"># SQL ì¸ì ì…˜ ì§•í›„ ê²€ì‚¬</span>
            <span class="n">indicators</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># ì—ëŸ¬ ê¸°ë°˜: ì‘ë‹µì˜ SQL ì—ëŸ¬ ë©”ì‹œì§€</span>
            <span class="n">sql_errors</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;sql syntax&quot;</span><span class="p">,</span> <span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="s2">&quot;sqlite&quot;</span><span class="p">,</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ora-&quot;</span><span class="p">,</span> <span class="s2">&quot;unclosed quotation&quot;</span><span class="p">,</span> <span class="s2">&quot;unterminated string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syntax error&quot;</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">sql_errors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SQL ì—ëŸ¬ ë©”ì‹œì§€: &#39;</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

            <span class="c1"># ë¶ˆë¦° ê¸°ë°˜: ìƒë‹¹í•œ ê¸¸ì´ ì°¨ì´</span>
            <span class="n">length_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="n">baseline_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">length_diff</span> <span class="o">&gt;</span> <span class="n">baseline_length</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">:</span>
                <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ì‘ë‹µ ê¸¸ì´ ë³€ê²½: </span><span class="si">{</span><span class="n">baseline_length</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># ì‹œê°„ ê¸°ë°˜: ì‘ë‹µì´ ìƒë‹¹íˆ ë” ì˜¤ë˜ ê±¸ë¦¼</span>
            <span class="n">time_diff</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">-</span> <span class="n">baseline_time</span>
            <span class="k">if</span> <span class="n">time_diff</span> <span class="o">&gt;</span> <span class="mf">4.0</span><span class="p">:</span>
                <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ì‘ë‹µ ì§€ì—°: </span><span class="si">{</span><span class="n">resp</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(ë² ì´ìŠ¤ë¼ì¸: </span><span class="si">{</span><span class="n">baseline_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s)&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">indicators</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                    <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
                    <span class="s1">&#39;indicators&#39;</span><span class="p">:</span> <span class="n">indicators</span><span class="p">,</span>
                    <span class="s1">&#39;response_length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">),</span>
                    <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="n">resp</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
                <span class="p">})</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;indicators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ìš”ì²­ íƒ€ì„ì•„ì›ƒ (ì‹œê°„ ê¸°ë°˜ SQLi ê°€ëŠ¥ì„±)&#39;</span><span class="p">],</span>
                <span class="s1">&#39;response_length&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="mf">15.0</span>
            <span class="p">})</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># ì—°ê²° ì—ëŸ¬, ê±´ë„ˆë›°ê¸°</span>

    <span class="k">return</span> <span class="n">results</span>


<span class="c1"># â”€â”€â”€ XSS í…ŒìŠ¤íŒ… â”€â”€â”€</span>

<span class="n">XSS_PAYLOADS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;&lt;script&gt;alert(1)&lt;/script&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&lt;img src=x onerror=alert(1)&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&lt;svg onload=alert(1)&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&#39;</span><span class="p">,</span>
    <span class="s2">&quot;&#39;-alert(1)-&#39;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;&lt;body onload=alert(1)&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;{{7*7}}&#39;</span><span class="p">,</span>  <span class="c1"># í…œí”Œë¦¿ ì¸ì ì…˜ í…ŒìŠ¤íŠ¸</span>
    <span class="s1">&#39;${7*7}&#39;</span><span class="p">,</span>   <span class="c1"># í…œí”Œë¦¿ ì¸ì ì…˜ í…ŒìŠ¤íŠ¸</span>
    <span class="s1">&#39;javascript:alert(1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&lt;iframe src=&quot;javascript:alert(1)&quot;&gt;&#39;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_reflected_xss</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    í˜ì´ë¡œë“œê°€ ì´ìŠ¤ì¼€ì´í”„ë˜ì§€ ì•Šê³  ì‘ë‹µì— ë‚˜íƒ€ë‚˜ëŠ”ì§€ ê²€ì‚¬í•˜ì—¬</span>
<span class="sd">    ë°˜ì‚¬í˜• XSS í…ŒìŠ¤íŠ¸.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">XSS_PAYLOADS</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span> <span class="n">payload</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
            <span class="p">)</span>

            <span class="c1"># í˜ì´ë¡œë“œê°€ ì¸ì½”ë”© ì—†ì´ ë°˜ì‚¬ë˜ëŠ”ì§€ ê²€ì‚¬</span>
            <span class="k">if</span> <span class="n">payload</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                    <span class="s1">&#39;reflected&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
                <span class="p">})</span>
            <span class="c1"># HTML ì¸ì½”ë”©ëœ ë²„ì „ ê²€ì‚¬ (ë¶€ë¶„ ë³´í˜¸)</span>
            <span class="n">encoded</span> <span class="o">=</span> <span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>
                              <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">)</span>
                              <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;quot;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">encoded</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span> <span class="ow">and</span> <span class="n">payload</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                    <span class="s1">&#39;reflected&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
                <span class="p">})</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">return</span> <span class="n">results</span>


<span class="c1"># â”€â”€â”€ ë³´ì•ˆ í—¤ë” ê²€ì‚¬ê¸° â”€â”€â”€</span>

<span class="n">SECURITY_HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;HSTS - HTTPS ê°•ì œ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;max-age=31536000; includeSubDomains&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;CSP - XSS ë° ì¸ì ì…˜ ë°©ì§€&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;MIME ìŠ¤ë‹ˆí•‘ ë°©ì§€&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;nosniff&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;í´ë¦­ì¬í‚¹ ë°©ì§€&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;DENY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;X-XSS-Protection&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;ë ˆê±°ì‹œ XSS í•„í„°&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>  <span class="c1"># í˜„ëŒ€ì  ê°€ì´ë“œ: ë¹„í™œì„±í™”, CSP ì‚¬ìš©</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;Referrer-Policy&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Referrer ì •ë³´ ì œì–´&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;strict-origin-when-cross-origin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;Permissions-Policy&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;ë¸Œë¼ìš°ì € ê¸°ëŠ¥ ì œì–´&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="s1">&#39;camera=(), microphone=(), geolocation=()&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_security_headers</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;URLì˜ ë³´ì•ˆ í—¤ë” ê²€ì‚¬.&quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
        <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
        <span class="s1">&#39;headers_present&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;headers_missing&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">SECURITY_HEADERS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;headers_present&#39;</span><span class="p">][</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;headers_missing&#39;</span><span class="p">][</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;recommended&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;recommended&#39;</span><span class="p">],</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">],</span>
            <span class="p">}</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<hr />
<h2 id="7">7. ë³´ì•ˆ ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë³´ì•ˆ ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 1: ë³€ê²½ì‚¬í•­ ì´í•´                                            â”‚
â”‚  â”œâ”€â”€ ì´ ì½”ë“œëŠ” ë¬´ì—‡ì„ í•˜ëŠ”ê°€?                                     â”‚
â”‚  â”œâ”€â”€ ì–´ë–¤ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ”ê°€?                                    â”‚
â”‚  â””â”€â”€ ì‹ ë¢° ê²½ê³„ëŠ” ë¬´ì—‡ì¸ê°€?                                        â”‚
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 2: ì…ë ¥/ì¶œë ¥ ê²€ì‚¬                                           â”‚
â”‚  â”œâ”€â”€ ëª¨ë“  ì™¸ë¶€ ì…ë ¥ì´ ê²€ì¦ë˜ì—ˆëŠ”ê°€?                               â”‚
â”‚  â”œâ”€â”€ ì¶œë ¥ì´ ì ì ˆíˆ ì¸ì½”ë”©ë˜ì—ˆëŠ”ê°€?                                â”‚
â”‚  â””â”€â”€ íŒŒì¼ ì‘ì—…ì´ ì•ˆì „í•œ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?                        â”‚
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 3: ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬                                        â”‚
â”‚  â”œâ”€â”€ ëª¨ë“  ë³´í˜¸ëœ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ì¸ì¦ ê²€ì‚¬?                        â”‚
â”‚  â”œâ”€â”€ ì ì ˆí•œ ì„¸ì…˜ ê´€ë¦¬?                                            â”‚
â”‚  â””â”€â”€ ìµœì†Œ ê¶Œí•œ ì ìš©?                                              â”‚
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 4: ë°ì´í„° ë³´í˜¸                                              â”‚
â”‚  â”œâ”€â”€ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ì €ì¥ ì‹œ ì•”í˜¸í™”?                              â”‚
â”‚  â”œâ”€â”€ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ì „ì†¡ ì‹œ ì•”í˜¸í™”?                              â”‚
â”‚  â”œâ”€â”€ ì†ŒìŠ¤ ì½”ë“œì— ë¹„ë°€ ì—†ìŒ?                                       â”‚
â”‚  â””â”€â”€ PIIë¥¼ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬?                                         â”‚
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 5: ì—ëŸ¬ ì²˜ë¦¬                                                â”‚
â”‚  â”œâ”€â”€ ì—ëŸ¬ê°€ ì •ë³´ë¥¼ ëˆ„ì¶œí•˜ì§€ ì•ŠëŠ”ê°€?                               â”‚
â”‚  â”œâ”€â”€ ì ì ˆí•œ ì˜ˆì™¸ ì²˜ë¦¬?                                            â”‚
â”‚  â””â”€â”€ ì•ˆì „í•˜ê²Œ ì‹¤íŒ¨ (ê¸°ë³¸ì ìœ¼ë¡œ ê±°ë¶€)?                             â”‚
â”‚                                                                   â”‚
â”‚  ë‹¨ê³„ 6: ì˜ì¡´ì„±                                                   â”‚
â”‚  â”œâ”€â”€ ìƒˆë¡œìš´ ì˜ì¡´ì„±ì„ ê²€í† í–ˆëŠ”ê°€?                                  â”‚
â”‚  â”œâ”€â”€ ë²„ì „ì´ ê³ ì •ë˜ì—ˆëŠ”ê°€?                                         â”‚
â”‚  â””â”€â”€ ì•Œë ¤ì§„ ì·¨ì•½ì ì„ í™•ì¸í–ˆëŠ”ê°€?                                  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="72-python">7.2 Python íŠ¹í™” ë³´ì•ˆ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸<a class="header-link" href="#72-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ì˜ˆì œë¥¼ í¬í•¨í•œ Python ë³´ì•ˆ ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸.</span>
<span class="sd">ê° ì„¹ì…˜ì€ ì·¨ì•½í•œ ë²„ì „ê³¼ ì•ˆì „í•œ ë²„ì „ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€â”€ 1. ì…ë ¥ ê²€ì¦ â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ê²€ì¦ ì—†ìŒ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user_bad</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE id = </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># ì•ˆì „: íŒŒë¼ë¯¸í„°í™”ëœ ì¿¼ë¦¬ + íƒ€ì… ê²€ì¦</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user_good</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">user_id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ì ID&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id = ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">user_id</span><span class="p">,))</span>


<span class="c1"># â”€â”€â”€ 2. ì¸ì¦ â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ë¹„ë°€ë²ˆí˜¸ ë¹„êµ ì‹œ íƒ€ì´ë° ê³µê²©</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_password_bad</span><span class="p">(</span><span class="n">stored</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">provided</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">stored</span> <span class="o">==</span> <span class="n">provided</span>  <span class="c1"># ë¬¸ìì—´ ë¹„êµëŠ” ë‹¨ë½ í‰ê°€ë¨</span>

<span class="c1"># ì•ˆì „: ìƒìˆ˜ ì‹œê°„ ë¹„êµ</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_password_good</span><span class="p">(</span><span class="n">stored</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">provided</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">stored</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">provided</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>


<span class="c1"># â”€â”€â”€ 3. ì§ë ¬í™” â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ë°ì´í„°ë¡œ pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_data_bad</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># ì„ì˜ ì½”ë“œ ì‹¤í–‰!</span>

<span class="c1"># ì•ˆì „: JSON ë˜ëŠ” ê²€ì¦ëœ ìŠ¤í‚¤ë§ˆ ì‚¬ìš©</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_data_good</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># ìŠ¤í‚¤ë§ˆ ê²€ì¦</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;JSON ê°ì²´ ì˜ˆìƒ&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed</span>


<span class="c1"># â”€â”€â”€ 4. íŒŒì¼ ì‘ì—… â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ê²½ë¡œ ìˆœíšŒ</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_file_bad</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/uploads/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># ì•ˆì „: ê²½ë¡œ í•´ì„ ë° ê²€ì¦</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="n">UPLOAD_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/uploads&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_file_good</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">UPLOAD_DIR</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_relative_to</span><span class="p">(</span><span class="n">UPLOAD_DIR</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ê²½ë¡œ ìˆœíšŒ íƒì§€&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">file_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>


<span class="c1"># â”€â”€â”€ 5. ì•”í˜¸í™” â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ì•½í•œ í•´ì‹±</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hash_password_bad</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="c1"># ì•ˆì „: ì ì ˆí•œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">argon2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PasswordHasher</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">PasswordHasher</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hash_password_good</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">ph</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">verify_password_good</span><span class="p">(</span><span class="nb">hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ph</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># â”€â”€â”€ 6. Subprocess â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ì…¸ ì¸ì ì…˜</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_command_bad</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cat </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ì•ˆì „: ì…¸ ì—†ìŒ, ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_command_good</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="c1"># ë¨¼ì € íŒŒì¼ëª… ê²€ì¦</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">filename</span><span class="p">:</span>  <span class="c1"># ê²½ë¡œ êµ¬ë¶„ì ì—†ìŒ</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ìœ íš¨í•˜ì§€ ì•Šì€ íŒŒì¼ëª…&quot;</span><span class="p">)</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># â”€â”€â”€ 7. ë¡œê¹… â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ë¯¼ê°í•œ ë°ì´í„° ë¡œê¹…</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">login_bad</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¡œê·¸ì¸ ì‹œë„: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># ë¹„ë°€ë²ˆí˜¸ ë¡œê¹…!</span>

<span class="c1"># ì•ˆì „: ë¹„ë°€ ì ˆëŒ€ ë¡œê¹… ê¸ˆì§€</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login_good</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¡œê·¸ì¸ ì‹œë„: user=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># ë¯¼ê°í•œ í•„ë“œëŠ” í”Œë ˆì´ìŠ¤í™€ë” ì‚¬ìš©</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ë¡œê·¸ì¸ ì‹œë„: user=</span><span class="si">%s</span><span class="s2"> password=&lt;REDACTED&gt;&quot;</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>


<span class="c1"># â”€â”€â”€ 8. ì •ê·œ í‘œí˜„ì‹ â”€â”€â”€</span>

<span class="c1"># ì·¨ì•½: ReDoS (ì •ê·œ í‘œí˜„ì‹ ì„œë¹„ìŠ¤ ê±°ë¶€)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_email_bad</span><span class="p">(</span><span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="c1"># ì´ íŒ¨í„´ì€ ì¹˜ëª…ì ì¸ ë°±íŠ¸ë˜í‚¹ì— ì·¨ì•½</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^([a-zA-Z0-9]+)*@[a-zA-Z0-9]+\.[a-zA-Z]+$&#39;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">))</span>

<span class="c1"># ì•ˆì „: ì˜ í…ŒìŠ¤íŠ¸ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë˜ëŠ” ê°„ë‹¨í•œ íŒ¨í„´ ì‚¬ìš©</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_email_good</span><span class="p">(</span><span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="c1"># ê°„ë‹¨í•œ, ë°±íŠ¸ë˜í‚¹ ì—†ëŠ” íŒ¨í„´</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">email</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">254</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[^@\s]+@[^@\s]+\.[^@\s]+$&#39;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">))</span>
</code></pre></div>

<hr />
<h2 id="8-cicd">8. CI/CD ë³´ì•ˆ íŒŒì´í”„ë¼ì¸ í†µí•©<a class="header-link" href="#8-cicd" title="Permanent link">&para;</a></h2>
<h3 id="81-github-actions">8.1 GitHub Actions ë³´ì•ˆ íŒŒì´í”„ë¼ì¸<a class="header-link" href="#81-github-actions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/workflows/security.yml</span>

<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scanning Pipeline</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">develop</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ UTCì— ì£¼ê°„ ì‹¤í–‰</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">9</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">1&#39;</span>

<span class="nt">permissions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">read</span>
<span class="w">  </span><span class="nt">security-events</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># SARIF ì—…ë¡œë“œìš©</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># â”€â”€â”€ ë‹¨ê³„ 1: SAST â”€â”€â”€</span>
<span class="w">  </span><span class="nt">sast-bandit</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SAST:</span><span class="nv"> </span><span class="s">Bandit&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.12&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Bandit</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install bandit[toml]</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Bandit</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">bandit -r src/ \</span>
<span class="w">            </span><span class="no">-f sarif \</span>
<span class="w">            </span><span class="no">-o bandit-results.sarif \</span>
<span class="w">            </span><span class="no">--severity-level medium \</span>
<span class="w">            </span><span class="no">--confidence-level medium \</span>
<span class="w">            </span><span class="no">--exclude tests/</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload SARIF</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v3</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit-results.sarif</span>

<span class="w">  </span><span class="nt">sast-semgrep</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SAST:</span><span class="nv"> </span><span class="s">Semgrep&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Semgrep</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep/semgrep-action@v1</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">            </span><span class="no">p/python</span>
<span class="w">            </span><span class="no">p/flask</span>
<span class="w">            </span><span class="no">p/owasp-top-ten</span>
<span class="w">            </span><span class="no">.semgrep/custom_rules.yaml</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">SEMGREP_APP_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SEMGREP_APP_TOKEN }}</span>

<span class="w">  </span><span class="c1"># â”€â”€â”€ ë‹¨ê³„ 2: SCA â”€â”€â”€</span>
<span class="w">  </span><span class="nt">sca-dependencies</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SCA:</span><span class="nv"> </span><span class="s">Dependency</span><span class="nv"> </span><span class="s">Check&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.12&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">pip install -r requirements.txt</span>
<span class="w">          </span><span class="no">pip install pip-audit safety</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run pip-audit</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">pip-audit \</span>
<span class="w">            </span><span class="no">-r requirements.txt \</span>
<span class="w">            </span><span class="no">-f json \</span>
<span class="w">            </span><span class="no">-o pip-audit-results.json \</span>
<span class="w">            </span><span class="no">--desc</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Safety</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">safety check \</span>
<span class="w">            </span><span class="no">-r requirements.txt \</span>
<span class="w">            </span><span class="no">--full-report \</span>
<span class="w">            </span><span class="no">--output json &gt; safety-results.json</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for critical vulnerabilities</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">python -c &quot;</span>
<span class="w">          </span><span class="no">import json, sys</span>
<span class="w">          </span><span class="no">with open(&#39;pip-audit-results.json&#39;) as f:</span>
<span class="w">              </span><span class="no">data = json.load(f)</span>
<span class="w">          </span><span class="no">vulns = []</span>
<span class="w">          </span><span class="no">for dep in data.get(&#39;dependencies&#39;, []):</span>
<span class="w">              </span><span class="no">vulns.extend(dep.get(&#39;vulns&#39;, []))</span>
<span class="w">          </span><span class="no">if vulns:</span>
<span class="w">              </span><span class="no">print(f&#39;Found {len(vulns)} vulnerabilities!&#39;)</span>
<span class="w">              </span><span class="no">for v in vulns:</span>
<span class="w">                  </span><span class="no">print(f&#39;  - {v[\&quot;id\&quot;]}: {v.get(\&quot;description\&quot;, \&quot;\&quot;)[:80]}&#39;)</span>
<span class="w">              </span><span class="no">sys.exit(1)</span>
<span class="w">          </span><span class="no">print(&#39;No vulnerabilities found.&#39;)</span>
<span class="w">          </span><span class="no">&quot;</span>

<span class="w">  </span><span class="c1"># â”€â”€â”€ ë‹¨ê³„ 3: ë¹„ë°€ ìŠ¤ìºë‹ â”€â”€â”€</span>
<span class="w">  </span><span class="nt">secret-scanning</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Secret</span><span class="nv"> </span><span class="s">Scanning&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># ë¹„ë°€ ìŠ¤ìºë‹ì„ ìœ„í•œ ì „ì²´ íˆìŠ¤í† ë¦¬</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Gitleaks</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks/gitleaks-action@v2</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run TruffleHog</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflesecurity/trufflehog@main</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">extra_args</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--only-verified</span>

<span class="w">  </span><span class="c1"># â”€â”€â”€ ë‹¨ê³„ 4: ì»¨í…Œì´ë„ˆ ìŠ¤ìºë‹ â”€â”€â”€</span>
<span class="w">  </span><span class="nt">container-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Container</span><span class="nv"> </span><span class="s">Scan&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github.event_name == &#39;push&#39;</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build Docker image</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker build -t myapp:${{ github.sha }} .</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Trivy</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-action@master</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">image-ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:${{ github.sha }}</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;sarif&#39;</span>
<span class="w">          </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
<span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;CRITICAL,HIGH&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Trivy SARIF</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v3</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy-results.sarif</span>

<span class="w">  </span><span class="c1"># â”€â”€â”€ ë‹¨ê³„ 5: DAST (ìŠ¤í…Œì´ì§•ì—ì„œ) â”€â”€â”€</span>
<span class="w">  </span><span class="nt">dast-zap</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DAST:</span><span class="nv"> </span><span class="s">ZAP</span><span class="nv"> </span><span class="s">Baseline&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sast-bandit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sast-semgrep</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sca-dependencies</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github.ref == &#39;refs/heads/main&#39;</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Start application</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">docker-compose up -d</span>
<span class="w">          </span><span class="no">sleep 10  # ì•± ì‹œì‘ ëŒ€ê¸°</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run ZAP Baseline Scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zaproxy/action-baseline@v0.12.0</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;http://localhost:8080&#39;</span>
<span class="w">          </span><span class="nt">rules_file_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.zap/rules.tsv&#39;</span>
<span class="w">          </span><span class="nt">cmd_options</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;-a&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Stop application</span>
<span class="w">        </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always()</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker-compose down</span>

<span class="w">  </span><span class="c1"># â”€â”€â”€ ë³´ì•ˆ ê²Œì´íŠ¸ â”€â”€â”€</span>
<span class="w">  </span><span class="nt">security-gate</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Security</span><span class="nv"> </span><span class="s">Gate&quot;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sast-bandit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sast-semgrep</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sca-dependencies</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">secret-scanning</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check results</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">echo &quot;ëª¨ë“  ë³´ì•ˆ ê²€ì‚¬ í†µê³¼!&quot;</span>
<span class="w">          </span><span class="no">echo &quot;ìƒì„¸í•œ ë°œê²¬ì‚¬í•­ì€ Security íƒ­ì„ í™•ì¸í•˜ì„¸ìš”.&quot;</span>
</code></pre></div>

<h3 id="82-pre-commit">8.2 ë³´ì•ˆì„ ìœ„í•œ Pre-commit í›…<a class="header-link" href="#82-pre-commit" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .pre-commit-config.yaml</span>

<span class="nt">repos</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Bandit - Python ë³´ì•ˆ ë¦°í„°</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/PyCQA/bandit</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1.7.7&#39;</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-c&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;pyproject.toml&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;-ll&#39;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">additional_dependencies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;bandit[toml]&#39;</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="c1"># ë¹„ë°€ íƒì§€</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/Yelp/detect-secrets</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.4.0</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detect-secrets</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--baseline&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;.secrets.baseline&#39;</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="c1"># ê°œì¸ í‚¤ ê²€ì‚¬</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/pre-commit/pre-commit-hooks</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v4.5.0</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detect-private-key</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-added-large-files</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--maxkb=500&#39;</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="c1"># Gitleaks</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/gitleaks/gitleaks</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v8.18.1</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks</span>
</code></pre></div>

<h3 id="83-gitlab-ci">8.3 GitLab CI ë³´ì•ˆ íŒŒì´í”„ë¼ì¸<a class="header-link" href="#83-gitlab-ci" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .gitlab-ci.yml</span>

<span class="nt">stages</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deploy</span>

<span class="nt">variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">PIP_CACHE_DIR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$CI_PROJECT_DIR/.cache/pip&quot;</span>

<span class="c1"># â”€â”€â”€ SAST ë‹¨ê³„ â”€â”€â”€</span>
<span class="nt">bandit-sast</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python:3.12-slim</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install bandit</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit -r src/ -f json -o gl-sast-report.json --severity-level medium || true</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gl-sast-report.json</span>

<span class="nt">semgrep-sast</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep/semgrep:latest</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep --config auto --sarif -o semgrep-results.sarif .</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep-results.sarif</span>

<span class="c1"># â”€â”€â”€ ì˜ì¡´ì„± ìŠ¤ìºë‹ â”€â”€â”€</span>
<span class="nt">dependency-check</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python:3.12-slim</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install pip-audit</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip-audit -r requirements.txt --strict</span>
<span class="w">  </span><span class="nt">allow_failure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="c1"># â”€â”€â”€ ë¹„ë°€ íƒì§€ â”€â”€â”€</span>
<span class="nt">secret-detection</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zricethezav/gitleaks:latest</span>
<span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks detect --source . --report-path gitleaks-report.json</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">secret_detection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks-report.json</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì¢…í•© ë³´ì•ˆ ìŠ¤ìºë‹ ìŠ¤í¬ë¦½íŠ¸<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">security_scanner.py - Unified security scanning orchestrator.</span>
<span class="sd">Runs multiple security tools and generates a combined report.</span>

<span class="sd">Usage:</span>
<span class="sd">    python security_scanner.py --project-dir ./myproject</span>
<span class="sd">    python security_scanner.py --project-dir ./myproject --output report.json</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">asdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Finding</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single security finding from any tool.&quot;&quot;&quot;</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># CRITICAL, HIGH, MEDIUM, LOW, INFO</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># SAST, SCA, SECRET, CONFIG</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cwe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScanReport</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combined report from all scanners.&quot;&quot;&quot;</span>
    <span class="n">project</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">scan_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">scan_duration_seconds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">findings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Finding</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">tools_run</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">tools_failed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">summary</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_date</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SecurityScanner</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orchestrates multiple security scanning tools.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">project_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">ScanReport</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScanReport</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all available security scanners.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] Starting security scan of: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] Scan started at: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">scan_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_run_bandit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_pip_audit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_secret_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_security_configs</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">scan_duration_seconds</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_summary</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_run_bandit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run Bandit SAST scanner.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Running Bandit (SAST)...&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;bandit&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">),</span>
                    <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;--severity-level&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;-x&quot;</span><span class="p">,</span> <span class="s2">&quot;tests,venv,.tox&quot;</span>
                <span class="p">],</span>
                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span>
            <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Finding</span><span class="p">(</span>
                    <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;bandit&quot;</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">issue</span><span class="p">[</span><span class="s2">&quot;issue_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="n">category</span><span class="o">=</span><span class="s2">&quot;SAST&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">issue</span><span class="p">[</span><span class="s1">&#39;test_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">issue</span><span class="p">[</span><span class="s1">&#39;test_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">issue</span><span class="p">[</span><span class="s2">&quot;issue_text&quot;</span><span class="p">],</span>
                    <span class="n">file</span><span class="o">=</span><span class="n">issue</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">issue</span><span class="p">[</span><span class="s2">&quot;line_number&quot;</span><span class="p">],</span>
                    <span class="n">cwe</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issue_cwe&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span>
                <span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;bandit&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[]))</span><span class="si">}</span><span class="s2"> issues&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    [!] Bandit not installed&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;bandit&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    [!] Bandit failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;bandit&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_run_pip_audit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run pip-audit SCA scanner.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Running pip-audit (SCA)...&quot;</span><span class="p">)</span>

        <span class="n">req_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;requirements.txt&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">req_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    [!] No requirements.txt found, skipping&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">req_file</span><span class="p">),</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;--desc&quot;</span><span class="p">],</span>
                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span>
            <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
            <span class="n">vuln_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dependencies&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">dep</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vulns&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="n">vuln_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">fix_versions</span> <span class="o">=</span> <span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fix_versions&quot;</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Finding</span><span class="p">(</span>
                        <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;HIGH&quot;</span><span class="p">,</span>
                        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;SCA&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dep</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">dep</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vuln</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="n">vuln</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                        <span class="n">fix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Upgrade to </span><span class="si">{</span><span class="n">fix_versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="k">if</span> <span class="n">fix_versions</span> <span class="k">else</span> <span class="s2">&quot;No fix available&quot;</span><span class="p">,</span>
                    <span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Found </span><span class="si">{</span><span class="n">vuln_count</span><span class="si">}</span><span class="s2"> vulnerable dependencies&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    [!] pip-audit not installed&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    [!] pip-audit failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pip-audit&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_run_secret_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for hardcoded secrets in source files.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Checking for hardcoded secrets...&quot;</span><span class="p">)</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

        <span class="n">secret_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?i)(api[_-]?key|apikey)\s*[:=]\s*[&quot;</span><span class="se">\&#39;</span><span class="s1">][a-zA-Z0-9]{20,}[&quot;</span><span class="se">\&#39;</span><span class="s1">]&#39;</span><span class="p">,</span>
             <span class="s2">&quot;Possible API key&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?i)(password|passwd|pwd)\s*[:=]\s*[&quot;</span><span class="se">\&#39;</span><span class="s1">][^&quot;</span><span class="se">\&#39;</span><span class="s1">]{6,}[&quot;</span><span class="se">\&#39;</span><span class="s1">]&#39;</span><span class="p">,</span>
             <span class="s2">&quot;Possible hardcoded password&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?i)(secret|token)\s*[:=]\s*[&quot;</span><span class="se">\&#39;</span><span class="s1">][a-zA-Z0-9+/=]{20,}[&quot;</span><span class="se">\&#39;</span><span class="s1">]&#39;</span><span class="p">,</span>
             <span class="s2">&quot;Possible hardcoded secret/token&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-----BEGIN (?:RSA |DSA |EC )?PRIVATE KEY-----&#39;</span><span class="p">,</span>
             <span class="s2">&quot;Private key detected&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?i)aws[_-]?(?:access[_-]?key[_-]?id|secret[_-]?access[_-]?key)\s*[:=]\s*[&quot;</span><span class="se">\&#39;</span><span class="s1">]?[A-Z0-9]{16,}&#39;</span><span class="p">,</span>
             <span class="s2">&quot;Possible AWS credential&quot;</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">findings_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">py_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.py&quot;</span><span class="p">):</span>
            <span class="c1"># Skip virtual environments and test fixtures</span>
            <span class="n">rel_path</span> <span class="o">=</span> <span class="n">py_file</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">part</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">)</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span>
                   <span class="p">[</span><span class="s1">&#39;venv&#39;</span><span class="p">,</span> <span class="s1">&#39;.tox&#39;</span><span class="p">,</span> <span class="s1">&#39;node_modules&#39;</span><span class="p">,</span> <span class="s1">&#39;__pycache__&#39;</span><span class="p">]):</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">py_file</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="c1"># Skip comments with nosec</span>
                    <span class="k">if</span> <span class="s1">&#39;# nosec&#39;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">or</span> <span class="s1">&#39;# noqa&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">secret_patterns</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
                            <span class="n">findings_count</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Finding</span><span class="p">(</span>
                                <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;secret-scanner&quot;</span><span class="p">,</span>
                                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;HIGH&quot;</span><span class="p">,</span>
                                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;SECRET&quot;</span><span class="p">,</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Potential secret found in source code&quot;</span><span class="p">,</span>
                                <span class="n">file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">),</span>
                                <span class="n">line</span><span class="o">=</span><span class="n">line_num</span><span class="p">,</span>
                                <span class="n">cwe</span><span class="o">=</span><span class="s2">&quot;CWE-798&quot;</span><span class="p">,</span>
                                <span class="n">fix</span><span class="o">=</span><span class="s2">&quot;Move secrets to environment variables or &quot;</span>
                                    <span class="s2">&quot;a secret management service&quot;</span><span class="p">,</span>
                            <span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;secret-scanner&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Found </span><span class="si">{</span><span class="n">findings_count</span><span class="si">}</span><span class="s2"> potential secrets&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_security_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for security-related configuration issues.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Checking security configurations...&quot;</span><span class="p">)</span>

        <span class="n">findings_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Check for DEBUG mode in Flask/Django settings</span>
        <span class="k">for</span> <span class="n">py_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.py&quot;</span><span class="p">):</span>
            <span class="n">rel_path</span> <span class="o">=</span> <span class="n">py_file</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">part</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">)</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;venv&#39;</span><span class="p">,</span> <span class="s1">&#39;.tox&#39;</span><span class="p">]):</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">py_file</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

                <span class="c1"># Flask DEBUG</span>
                <span class="k">if</span> <span class="s1">&#39;app.run(debug=True)&#39;</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                    <span class="n">findings_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Finding</span><span class="p">(</span>
                        <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;config-checker&quot;</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
                        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Flask debug mode enabled&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Debug mode should not be enabled in production&quot;</span><span class="p">,</span>
                        <span class="n">file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">),</span>
                        <span class="n">fix</span><span class="o">=</span><span class="s2">&quot;Use environment variable: &quot;</span>
                            <span class="s2">&quot;app.run(debug=os.getenv(&#39;FLASK_DEBUG&#39;, False))&quot;</span><span class="p">,</span>
                    <span class="p">))</span>

                <span class="c1"># Django DEBUG</span>
                <span class="k">if</span> <span class="s1">&#39;DEBUG = True&#39;</span> <span class="ow">in</span> <span class="n">content</span> <span class="ow">and</span> <span class="s1">&#39;settings&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">):</span>
                    <span class="n">findings_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Finding</span><span class="p">(</span>
                        <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;config-checker&quot;</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
                        <span class="n">category</span><span class="o">=</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Django DEBUG mode enabled in settings&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;DEBUG should be False in production&quot;</span><span class="p">,</span>
                        <span class="n">file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rel_path</span><span class="p">),</span>
                        <span class="n">fix</span><span class="o">=</span><span class="s2">&quot;Use: DEBUG = os.getenv(&#39;DJANGO_DEBUG&#39;, &#39;False&#39;) == &#39;True&#39;&quot;</span><span class="p">,</span>
                    <span class="p">))</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;config-checker&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Found </span><span class="si">{</span><span class="n">findings_count</span><span class="si">}</span><span class="s2"> configuration issues&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate summary statistics.&quot;&quot;&quot;</span>
        <span class="n">severity_counts</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;CRITICAL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;LOW&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;INFO&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
        <span class="n">category_counts</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;SAST&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SCA&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SECRET&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;CONFIG&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="p">:</span>
            <span class="n">severity_counts</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="n">severity_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">category_counts</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;total_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="p">),</span>
            <span class="s1">&#39;by_severity&#39;</span><span class="p">:</span> <span class="n">severity_counts</span><span class="p">,</span>
            <span class="s1">&#39;by_category&#39;</span><span class="p">:</span> <span class="n">category_counts</span><span class="p">,</span>
            <span class="s1">&#39;tools_run&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="p">),</span>
            <span class="s1">&#39;tools_failed&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="p">),</span>
        <span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="n">report</span><span class="p">:</span> <span class="n">ScanReport</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print a formatted text report.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  SECURITY SCAN REPORT&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Project:  </span><span class="si">{</span><span class="n">report</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Date:     </span><span class="si">{</span><span class="n">report</span><span class="o">.</span><span class="n">scan_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Duration: </span><span class="si">{</span><span class="n">report</span><span class="o">.</span><span class="n">scan_duration_seconds</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Tools:    </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">tools_run</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Failed:   </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">tools_failed</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Total findings: </span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;total_findings&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  By severity: &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;CRITICAL=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;HIGH=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;HIGH&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;MEDIUM=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;LOW=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;LOW&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  By category: &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;SAST=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_category&#39;</span><span class="p">][</span><span class="s1">&#39;SAST&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;SCA=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_category&#39;</span><span class="p">][</span><span class="s1">&#39;SCA&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;SECRET=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_category&#39;</span><span class="p">][</span><span class="s1">&#39;SECRET&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;CONFIG=</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_category&#39;</span><span class="p">][</span><span class="s1">&#39;CONFIG&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Print findings grouped by severity</span>
    <span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;LOW&#39;</span><span class="p">,</span> <span class="s1">&#39;INFO&#39;</span><span class="p">]:</span>
        <span class="n">findings</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="n">severity</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">findings</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">65</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">severity</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span><span class="si">}</span><span class="s2"> findings)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">65</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  [</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;    File: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">line</span><span class="p">:</span>
                    <span class="n">loc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">description</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">fix</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Fix: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">fix</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">65</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;by_severity&#39;</span><span class="p">][</span><span class="s1">&#39;HIGH&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  RESULT: FAIL - Critical/High issues found&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;total_findings&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  RESULT: WARN - Issues found, review recommended&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  RESULT: PASS - No issues found&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Unified Security Scanner&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--project-dir&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to project directory&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--output&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output JSON report file&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--fail-on&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
                        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">],</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Severity level that causes non-zero exit&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">scanner</span> <span class="o">=</span> <span class="n">SecurityScanner</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">run_all</span><span class="p">()</span>

    <span class="c1"># Print text report</span>
    <span class="n">print_report</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

    <span class="c1"># Save JSON report</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">asdict</span><span class="p">(</span><span class="n">report</span><span class="p">),</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">JSON report saved to: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Exit code based on findings</span>
    <span class="n">severity_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;critical&#39;</span><span class="p">]</span>
    <span class="n">threshold_idx</span> <span class="o">=</span> <span class="n">severity_order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">fail_on</span><span class="p">)</span>
    <span class="n">fail_severities</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">severity_order</span><span class="p">[</span><span class="n">threshold_idx</span><span class="p">:]]</span>

    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span> <span class="ow">in</span> <span class="n">fail_severities</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10">10. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="1-bandit">ì—°ìŠµ ë¬¸ì œ 1: Bandit ìŠ¤ìº” ë¶„ì„<a class="header-link" href="#1-bandit" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì˜ ì˜ë„ì ìœ¼ë¡œ ì·¨ì•½í•œ ì½”ë“œì— ëŒ€í•´ Banditì„ ì‹¤í–‰í•˜ê³  ëª¨ë“  ë°œê²¬ ì‚¬í•­ì„ ìˆ˜ì •í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;vulnerable_app.py - Fix all security issues found by Bandit.&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&quot;my-super-secret-key-12345&quot;</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">():</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;app.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM products WHERE name LIKE &#39;%</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">%&#39;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/run&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_command</span><span class="p">():</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmd&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/load&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/hash&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hash_password</span><span class="p">():</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pw&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p><strong>ê³¼ì œ:</strong>
1. <code>bandit vulnerable_app.py</code>ë¥¼ ì‹¤í–‰í•˜ê³  ëª¨ë“  ë°œê²¬ ì‚¬í•­ì„ ë¬¸ì„œí™”í•˜ì„¸ìš”
2. ê° ì·¨ì•½ì ì„ ìˆ˜ì •í•˜ì„¸ìš”
3. Banditì„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ ëª¨ë“  ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”</p>
<h3 id="2-semgrep">ì—°ìŠµ ë¬¸ì œ 2: ì»¤ìŠ¤í…€ Semgrep ê·œì¹™ ì‘ì„±<a class="header-link" href="#2-semgrep" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ íƒì§€í•˜ëŠ” Semgrep ê·œì¹™ì„ ì‘ì„±í•˜ì„¸ìš”:
1. ë¬¸ìì—´ ì—°ê²°ì´ í¬í•¨ëœ <code>os.system()</code> ì‚¬ìš©
2. POSTë¥¼ ìˆ˜ë½í•˜ì§€ë§Œ <code>Content-Type</code>ì„ ê²€ì¦í•˜ì§€ ì•ŠëŠ” Flask ë¼ìš°íŠ¸
3. HTTP ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ ë‚´ì—ì„œ <code>eval()</code> ë˜ëŠ” <code>exec()</code> ì‚¬ìš©
4. í•˜ë“œì½”ë”©ëœ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´</p>
<h3 id="3">ì—°ìŠµ ë¬¸ì œ 3: ì˜ì¡´ì„± ê°ì‚¬<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ì˜ë„ì ìœ¼ë¡œ ì˜¤ë˜ë˜ê³  ì·¨ì•½í•œ íŒ¨í‚¤ì§€ê°€ í¬í•¨ëœ <code>requirements.txt</code>ë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code>flask==2.0.1
requests==2.25.1
django==3.2.0
pyyaml==5.3.1
pillow==8.0.0
</code></pre></div>

<ol>
<li><code>pip-audit -r requirements.txt</code>ë¥¼ ì‹¤í–‰í•˜ê³  ë°œê²¬ëœ ëª¨ë“  CVEë¥¼ ë¬¸ì„œí™”í•˜ì„¸ìš”</li>
<li>ê° íŒ¨í‚¤ì§€ì˜ ìµœì†Œ ì•ˆì „ ë²„ì „ì„ í™•ì¸í•˜ì„¸ìš”</li>
<li>ìˆ˜ì •ëœ ë²„ì „ì´ í¬í•¨ëœ <code>requirements-secure.txt</code>ë¥¼ ìƒì„±í•˜ì„¸ìš”</li>
</ol>
<h3 id="4">ì—°ìŠµ ë¬¸ì œ 4: ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŒ…<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì— ëŒ€í•œ Hypothesis í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš”:
1. ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê²€ì¦ê¸° (ëŒ€ë¬¸ì, ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í•„ìˆ˜, ìµœì†Œ 8ì)
2. <code>javascript:</code> ë° <code>data:</code> ìŠ¤í‚´ì„ ë°©ì§€í•´ì•¼ í•˜ëŠ” URL ì‚´ê· ê¸°
3. ëª¨ë“  HTMLì„ ì œê±°í•˜ë˜ í…ìŠ¤íŠ¸ ë‚´ìš©ì€ ë³´ì¡´í•´ì•¼ í•˜ëŠ” HTML íƒœê·¸ ì œê±°ê¸°</p>
<h3 id="5-cicd">ì—°ìŠµ ë¬¸ì œ 5: CI/CD ë³´ì•ˆ íŒŒì´í”„ë¼ì¸<a class="header-link" href="#5-cicd" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” GitHub Actions ì›Œí¬í”Œë¡œìš°ë¥¼ ì„¤ê³„í•˜ê³  êµ¬í˜„í•˜ì„¸ìš”:
1. SARIF ì¶œë ¥ìœ¼ë¡œ Bandit ì‹¤í–‰
2. requirements.txtì— ëŒ€í•´ pip-audit ì‹¤í–‰
3. gitleaksë¥¼ ì‚¬ìš©í•œ ì‹œí¬ë¦¿ ê²€ì‚¬
4. HIGH ë˜ëŠ” CRITICAL ë°œê²¬ ì‚¬í•­ì´ ìˆìœ¼ë©´ íŒŒì´í”„ë¼ì¸ ì‹¤íŒ¨
5. ë°œê²¬ ì‚¬í•­ ìš”ì•½ì„ PRì— ì½”ë©˜íŠ¸ë¡œ ê²Œì‹œ</p>
<h3 id="6_1">ì—°ìŠµ ë¬¸ì œ 6: ë³´ì•ˆ ì½”ë“œ ë¦¬ë·°<a class="header-link" href="#6_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì½”ë“œë¥¼ ë¦¬ë·°í•˜ê³  ëª¨ë“  ë³´ì•ˆ ë¬¸ì œë¥¼ ì‹ë³„í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jwt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/users/&lt;user_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;SELECT id, name, email, ssn FROM users WHERE id = </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;ssn&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;User </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s1"> not found&#39;</span><span class="p">}),</span> <span class="mi">404</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE email = &#39;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;AND password = &#39;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">4</span><span class="p">]},</span>
            <span class="s1">&#39;secret123&#39;</span><span class="p">,</span>
            <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;HS256&#39;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid credentials&#39;</span><span class="p">}),</span> <span class="mi">401</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/redirect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_redirect</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">upload</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;/uploads&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;uploaded&#39;</span><span class="p">})</span>
</code></pre></div>

<p>ìµœì†Œ 10ê°€ì§€ì˜ ì„œë¡œ ë‹¤ë¥¸ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¬¸ì„œí™”í•˜ê³  ê°ê°ì— ëŒ€í•œ ìˆ˜ì • ë°©ë²•ì„ ì œì‹œí•˜ì„¸ìš”.</p>
<hr />
<h2 id="_7">ìš”ì•½<a class="header-link" href="#_7" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë³´ì•ˆ í…ŒìŠ¤íŒ… í•µì‹¬ ìš”ì•½                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. ë°©ì–´ ê³„ì¸µí™”: SAST + SCA + DAST + í¼ì§• ì¡°í•© ì‚¬ìš©             â”‚
â”‚  2. ì‹œí”„íŠ¸ ë ˆí”„íŠ¸: SDLCì—ì„œ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ë²„ê·¸ ë°œê²¬               â”‚
â”‚  3. ìë™í™”: ëª¨ë“  ë„êµ¬ë¥¼ CI/CD íŒŒì´í”„ë¼ì¸ì— í†µí•©                  â”‚
â”‚  4. ì»¤ìŠ¤í…€ ê·œì¹™: í”„ë¡œì íŠ¸ë³„ Semgrep ê·œì¹™ ì‘ì„±                   â”‚
â”‚  5. ì˜¤íƒ ê´€ë¦¬: ë² ì´ìŠ¤ë¼ì¸ê³¼ #nosecë¡œ ê´€ë¦¬                        â”‚
â”‚  6. ì˜ì¡´ì„±: ì •ê¸°ì ìœ¼ë¡œ ìŠ¤ìº” ë° ì—…ë°ì´íŠ¸ (Dependabot/SCA)        â”‚
â”‚  7. ì½”ë“œ ë¦¬ë·°: ë³´ì•ˆì€ ì‚¬ëŒê³¼ ë„êµ¬ì˜ í˜‘ì—…                         â”‚
â”‚  8. í¼ì§•: ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œëŠ” ë°œê²¬í•˜ì§€ ëª»í•˜ëŠ” ë²„ê·¸ íƒì§€              â”‚
â”‚  9. ì¹¨íˆ¬ í…ŒìŠ¤íŒ…: ë‹¤ë¥¸ ëª¨ë“  ë°œê²¬ ì‚¬í•­ì„ ê²€ì¦                      â”‚
â”‚ 10. ì§€ì†ì : ë³´ì•ˆ í…ŒìŠ¤íŒ…ì€ ì¼íšŒì„±ì´ ì•„ë‹Œ ì§€ì†ì  í™œë™              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<p><strong>ì´ì „</strong>: <a href="./12_Container_Security.md">12. ì»¨í…Œì´ë„ˆ ë° í´ë¼ìš°ë“œ ë³´ì•ˆ</a> | <strong>ë‹¤ìŒ</strong>: <a href="14_Incident_Response.md">14. ì‚¬ê³  ëŒ€ì‘ê³¼ í¬ë Œì‹</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/12_Container_Security.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ì»¨í…Œì´ë„ˆ ë° í´ë¼ìš°ë“œ ë³´ì•ˆ</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/14_Incident_Response.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ì‚¬ê³  ëŒ€ì‘ ë° í¬ë Œì‹</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}