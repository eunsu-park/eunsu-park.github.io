{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>레슨 09: 프로세스 관리 및 작업 제어(Process Management and Job Control) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Shell_Script/">Shell Script</a>
    <span class="separator">/</span>
    <span class="current">레슨 09: 프로세스 관리 및 작업 제어(Process Management and Job Control)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>레슨 09: 프로세스 관리 및 작업 제어(Process Management and Job Control)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Shell_Script/08_Regex_in_Bash.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">레슨 08: Bash에서의 정규 표현식(Regular Expressions)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Shell_Script/10_Error_Handling.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Lesson 10: 에러 처리 및 디버깅</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#1-background-processes">1. 백그라운드 프로세스(Background Processes)</a><ul>
<li><a href="#_1">기본 백그라운드 실행</a></li>
<li><a href="#wait">wait 명령</a></li>
<li><a href="#_2">작업 제어 명령</a></li>
<li><a href="#_3">작업 제어 예제</a></li>
</ul>
</li>
<li><a href="#2-parallel-execution">2. 병렬 실행(Parallel Execution)</a><ul>
<li><a href="#_4">기본 병렬 패턴</a></li>
<li><a href="#pid">백그라운드 PID 추적</a></li>
<li><a href="#_5">동시성 제한</a></li>
<li><a href="#xargs">xargs를 사용한 병렬 실행</a></li>
<li><a href="#_6">병렬 처리 템플릿</a></li>
</ul>
</li>
<li><a href="#3-subshells">3. 서브셸(Subshells)</a><ul>
<li><a href="#_7">서브셸 구문</a></li>
<li><a href="#vs">서브셸 vs 명령 그룹화</a></li>
<li><a href="#_8">실용적인 서브셸 사용</a></li>
<li><a href="#_9">변수 스코프 함의</a></li>
</ul>
</li>
<li><a href="#4-signals">4. 시그널(Signals)</a><ul>
<li><a href="#_10">일반적인 시그널</a></li>
<li><a href="#_11">시그널 전송</a></li>
<li><a href="#_12">시그널 나열</a></li>
</ul>
</li>
<li><a href="#5-trap">5. trap 명령</a><ul>
<li><a href="#trap">기본 trap 구문</a></li>
<li><a href="#_13">여러 시그널 트랩</a></li>
<li><a href="#_14">시그널 무시</a></li>
<li><a href="#exit">EXIT에 대한 트랩</a></li>
<li><a href="#trap_1">trap을 사용한 디버깅</a></li>
</ul>
</li>
<li><a href="#6-cleanup-patterns">6. 정리 패턴(Cleanup Patterns)</a><ul>
<li><a href="#_15">임시 파일 정리</a></li>
<li><a href="#_16">포괄적인 정리</a></li>
<li><a href="#_17">락 파일 패턴</a></li>
<li><a href="#idempotent-cleanup">멱등적 정리(Idempotent Cleanup)</a></li>
</ul>
</li>
<li><a href="#7-coprocesses-coproc">7. 코프로세스(Coprocesses) (coproc)</a><ul>
<li><a href="#_18">기본 코프로세스</a></li>
<li><a href="#_19">명명된 코프로세스</a></li>
<li><a href="#_20">대화형 코프로세스 예제</a></li>
<li><a href="#_21">에러 처리가 있는 코프로세스</a></li>
</ul>
</li>
<li><a href="#8-process-priority">8. 프로세스 우선순위(Process Priority)</a><ul>
<li><a href="#nice">nice 명령</a></li>
<li><a href="#renice">renice 명령</a></li>
<li><a href="#ionice">ionice 명령</a></li>
<li><a href="#_22">결합된 우선순위 예제</a></li>
<li><a href="#_23">우선순위 관리 스크립트</a></li>
</ul>
</li>
<li><a href="#_24">연습 문제</a><ul>
<li><a href="#1">문제 1: 병렬 파일 프로세서</a></li>
<li><a href="#2">문제 2: 시그널 안전 다운로드 매니저</a></li>
<li><a href="#3">문제 3: 백그라운드 작업 모니터</a></li>
<li><a href="#4">문제 4: 코프로세스 계산기 서비스</a></li>
<li><a href="#5">문제 5: 우선순위 기반 작업 스케줄러</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="09-process-management-and-job-control">레슨 09: 프로세스 관리 및 작업 제어(Process Management and Job Control)<a class="header-link" href="#09-process-management-and-job-control" title="Permanent link">&para;</a></h1>
<p><strong>난이도</strong>: ⭐⭐⭐</p>
<p><strong>이전</strong>: <a href="./08_Regex_in_Bash.md">08_Regex_in_Bash.md</a> | <strong>다음</strong>: <a href="./10_Error_Handling.md">10_Error_Handling.md</a></p>
<h2 id="1-background-processes">1. 백그라운드 프로세스(Background Processes)<a class="header-link" href="#1-background-processes" title="Permanent link">&para;</a></h2>
<p>셸 스크립트는 백그라운드에서 프로세스를 실행할 수 있어 병렬 실행과 성능 향상을 가능하게 합니다.</p>
<h3 id="_1">기본 백그라운드 실행<a class="header-link" href="#_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># &amp;로 명령을 백그라운드에서 실행</span>
sleep<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Sleep started in background&quot;</span>

<span class="c1"># 마지막 백그라운드 프로세스의 PID</span>
<span class="nv">SLEEP_PID</span><span class="o">=</span><span class="nv">$!</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Sleep PID: </span><span class="nv">$SLEEP_PID</span><span class="s2">&quot;</span>

<span class="c1"># 다른 작업 계속 수행</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Doing other work...&quot;</span>

<span class="c1"># 백그라운드 프로세스가 완료될 때까지 대기</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$SLEEP_PID</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Sleep completed&quot;</span>
</code></pre></div>

<h3 id="wait">wait 명령<a class="header-link" href="#wait" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 여러 백그라운드 프로세스 시작</span>
sleep<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">PID1</span><span class="o">=</span><span class="nv">$!</span>

sleep<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">PID2</span><span class="o">=</span><span class="nv">$!</span>

sleep<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">PID3</span><span class="o">=</span><span class="nv">$!</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Started 3 background processes: </span><span class="nv">$PID1</span><span class="s2">, </span><span class="nv">$PID2</span><span class="s2">, </span><span class="nv">$PID3</span><span class="s2">&quot;</span>

<span class="c1"># 모든 백그라운드 작업 대기</span>
<span class="nb">wait</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All processes completed&quot;</span>

<span class="c1"># 특정 PID 대기</span>
sleep<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">SPECIFIC_PID</span><span class="o">=</span><span class="nv">$!</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$SPECIFIC_PID</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Specific process </span><span class="nv">$SPECIFIC_PID</span><span class="s2"> completed with exit code: </span><span class="nv">$?</span><span class="s2">&quot;</span>

<span class="c1"># Bash 4.3+: 임의의 작업이 완료될 때까지 대기</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_VERSINFO</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_VERSINFO</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">&amp;</span>

<span class="w">    </span><span class="nb">wait</span><span class="w"> </span>-n<span class="w">  </span><span class="c1"># 다음 작업이 완료될 때까지 대기</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;First job completed&quot;</span>

<span class="w">    </span><span class="nb">wait</span><span class="w"> </span>-n
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Second job completed&quot;</span>

<span class="w">    </span><span class="nb">wait</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All remaining jobs completed&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<h3 id="_2">작업 제어 명령<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 장시간 실행되는 프로세스 시작</span>
sleep<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># 모든 작업 나열</span>
<span class="nb">jobs</span>
<span class="c1"># 출력: [1]+ Running    sleep 100 &amp;</span>

<span class="c1"># PID와 함께 나열</span>
<span class="nb">jobs</span><span class="w"> </span>-l
<span class="c1"># 출력: [1]+ 12345 Running    sleep 100 &amp;</span>

<span class="c1"># 실행 중인 작업만 나열</span>
<span class="nb">jobs</span><span class="w"> </span>-r

<span class="c1"># 중지된 작업만 나열</span>
<span class="nb">jobs</span><span class="w"> </span>-s

<span class="c1"># 작업을 포그라운드로 가져오기</span>
<span class="c1"># fg %1    # (대화형 셸에서 주석 해제)</span>

<span class="c1"># 작업을 백그라운드로 보내기 (중지된 경우)</span>
<span class="c1"># bg %1    # (대화형 셸에서 주석 해제)</span>

<span class="c1"># 작업 참조:</span>
<span class="c1"># %1       - 작업 번호 1</span>
<span class="c1"># %?sleep  - 명령에 &quot;sleep&quot;이 포함된 작업</span>
<span class="c1"># %%       - 현재 작업</span>
<span class="c1"># %+       - 현재 작업 (%%와 동일)</span>
<span class="c1"># %-       - 이전 작업</span>

<span class="c1"># 백그라운드 작업 종료</span>
<span class="nb">kill</span><span class="w"> </span>%1
</code></pre></div>

<h3 id="_3">작업 제어 예제<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 작업 제어를 보여주는 함수</span>
job_control_demo<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting 3 jobs...&quot;</span>

<span class="w">    </span><span class="o">(</span>sleep<span class="w"> </span><span class="m">5</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job 1 done&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="o">(</span>sleep<span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job 2 done&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="o">(</span>sleep<span class="w"> </span><span class="m">7</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job 3 done&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span>

<span class="w">    </span><span class="c1"># 모든 작업 표시</span>
<span class="w">    </span><span class="nb">jobs</span>

<span class="w">    </span><span class="c1"># 작업 2를 특정하여 대기</span>
<span class="w">    </span><span class="nb">wait</span><span class="w"> </span>%2
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job 2 has completed&quot;</span>

<span class="w">    </span><span class="c1"># 나머지 모두 대기</span>
<span class="w">    </span><span class="nb">wait</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All jobs completed&quot;</span>
<span class="o">}</span>

job_control_demo
</code></pre></div>

<h2 id="2-parallel-execution">2. 병렬 실행(Parallel Execution)<a class="header-link" href="#2-parallel-execution" title="Permanent link">&para;</a></h2>
<p>독립적인 작업을 병렬로 실행하면 스크립트를 크게 가속화할 수 있습니다.</p>
<h3 id="_4">기본 병렬 패턴<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 순차 실행 (느림)</span>
sequential<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..5<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Task </span><span class="nv">$i</span><span class="s2"> completed&quot;</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

<span class="c1"># 병렬 실행 (빠름)</span>
parallel_basic<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..5<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="o">(</span>
<span class="w">            </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Task </span><span class="nv">$i</span><span class="s2"> completed&quot;</span>
<span class="w">        </span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="k">done</span>
<span class="w">    </span><span class="nb">wait</span>
<span class="o">}</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Sequential (5 seconds):&quot;</span>
<span class="nb">time</span><span class="w"> </span>sequential

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nParallel (1 second):&quot;</span>
<span class="nb">time</span><span class="w"> </span>parallel_basic
</code></pre></div>

<h3 id="pid">백그라운드 PID 추적<a class="header-link" href="#pid" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 배열에 PID 저장</span>
<span class="nv">pids</span><span class="o">=()</span>

<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..5<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="k">$((</span><span class="nv">RANDOM</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="nv">pids</span><span class="o">+=(</span><span class="nv">$!</span><span class="o">)</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Started job </span><span class="nv">$i</span><span class="s2"> with PID </span><span class="si">${</span><span class="nv">pids</span><span class="p">[-1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># 각 PID를 대기하고 종료 상태 확인</span>
<span class="k">for</span><span class="w"> </span>pid<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">wait</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$pid</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nv">status</span><span class="o">=</span><span class="nv">$?</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;PID </span><span class="nv">$pid</span><span class="s2"> exited with status </span><span class="nv">$status</span><span class="s2">&quot;</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="_5">동시성 제한<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 최대 N개의 작업을 병렬로 실행</span>
<span class="nv">MAX_JOBS</span><span class="o">=</span><span class="m">3</span>

run_with_limit<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">max_jobs</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">shift</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">jobs</span><span class="o">=(</span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="o">)</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">pids</span><span class="o">=()</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">0</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span>job<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">jobs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="c1"># 한계에 도달하면 하나가 완료될 때까지 대기</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ge<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$max_jobs</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">wait</span><span class="w"> </span>-n<span class="w">  </span><span class="c1"># Bash 4.3+</span>
<span class="w">            </span><span class="c1"># 완료된 PID 제거</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!pids[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-0<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="nb">unset</span><span class="w"> </span><span class="s1">&#39;pids[$i]&#39;</span>
<span class="w">                </span><span class="k">fi</span>
<span class="w">            </span><span class="k">done</span>
<span class="w">            </span><span class="nv">pids</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span><span class="w">  </span><span class="c1"># 배열 재색인</span>
<span class="w">        </span><span class="k">fi</span>

<span class="w">        </span><span class="c1"># 새 작업 시작</span>
<span class="w">        </span><span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$job</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="nv">pids</span><span class="o">+=(</span><span class="nv">$!</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Started job: </span><span class="nv">$job</span><span class="s2"> (PID: </span><span class="nv">$!</span><span class="s2">)&quot;</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># 남은 작업 대기</span>
<span class="w">    </span><span class="nb">wait</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All jobs completed&quot;</span>
<span class="o">}</span>

<span class="c1"># 사용 예제</span>
<span class="nv">jobs</span><span class="o">=(</span>
<span class="w">    </span><span class="s2">&quot;sleep 2; echo &#39;Job 1 done&#39;&quot;</span>
<span class="w">    </span><span class="s2">&quot;sleep 1; echo &#39;Job 2 done&#39;&quot;</span>
<span class="w">    </span><span class="s2">&quot;sleep 3; echo &#39;Job 3 done&#39;&quot;</span>
<span class="w">    </span><span class="s2">&quot;sleep 1; echo &#39;Job 4 done&#39;&quot;</span>
<span class="w">    </span><span class="s2">&quot;sleep 2; echo &#39;Job 5 done&#39;&quot;</span>
<span class="o">)</span>

run_with_limit<span class="w"> </span><span class="nv">$MAX_JOBS</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">jobs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<h3 id="xargs">xargs를 사용한 병렬 실행<a class="header-link" href="#xargs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># xargs로 파일을 병렬 처리</span>
process_file<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Processing </span><span class="nv">$file</span><span class="s2">...&quot;</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2"> processed&quot;</span>
<span class="o">}</span>

<span class="nb">export</span><span class="w"> </span>-f<span class="w"> </span>process_file

<span class="c1"># 4개의 작업을 병렬로 실행</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;file1.txt\nfile2.txt\nfile3.txt\nfile4.txt\nfile5.txt&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>xargs<span class="w"> </span>-P<span class="w"> </span><span class="m">4</span><span class="w"> </span>-I<span class="w"> </span><span class="o">{}</span><span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;process_file &quot;{}&quot;&#39;</span>

<span class="c1"># 대안: parallel (GNU parallel 도구, 설치된 경우)</span>
<span class="c1"># seq 1 10 | parallel -j 4 &#39;echo Processing {}; sleep 1&#39;</span>
</code></pre></div>

<h3 id="_6">병렬 처리 템플릿<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 범용 병렬 프로세서</span>
parallel_process<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">max_parallel</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">processor_func</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">items</span><span class="o">=(</span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="o">)</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">pids</span><span class="o">=()</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span>item<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">items</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="c1"># 동시성 제한</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ge<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$max_parallel</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!pids[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-0<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="nb">wait</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">                    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job for &#39;</span><span class="nv">$item</span><span class="s2">&#39; completed (PID: </span><span class="si">${</span><span class="nv">pids</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">, status: </span><span class="nv">$?</span><span class="s2">)&quot;</span>
<span class="w">                    </span><span class="nb">unset</span><span class="w"> </span><span class="s1">&#39;pids[$i]&#39;</span>
<span class="w">                </span><span class="k">fi</span>
<span class="w">            </span><span class="k">done</span>
<span class="w">            </span><span class="nv">pids</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">            </span>sleep<span class="w"> </span><span class="m">0</span>.1
<span class="w">        </span><span class="k">done</span>

<span class="w">        </span><span class="c1"># 새 작업 시작</span>
<span class="w">        </span><span class="nv">$processor_func</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$item</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="nv">pids</span><span class="o">+=(</span><span class="nv">$!</span><span class="o">)</span>
<span class="w">        </span><span class="o">((</span>count++<span class="o">))</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># 남은 모든 작업 대기</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>pid<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pids</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">wait</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$pid</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Processed </span><span class="nv">$count</span><span class="s2"> items&quot;</span>
<span class="o">}</span>

<span class="c1"># 예제 프로세서 함수</span>
my_processor<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">item</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="k">$((</span><span class="nv">RANDOM</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Processed: </span><span class="nv">$item</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="nb">export</span><span class="w"> </span>-f<span class="w"> </span>my_processor

<span class="c1"># 최대 5개 병렬로 20개 항목 처리</span>
<span class="nv">items</span><span class="o">=(</span><span class="k">$(</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">20</span><span class="k">)</span><span class="o">)</span>
parallel_process<span class="w"> </span><span class="m">5</span><span class="w"> </span>my_processor<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">items</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<h2 id="3-subshells">3. 서브셸(Subshells)<a class="header-link" href="#3-subshells" title="Permanent link">&para;</a></h2>
<p>서브셸은 자체 변수 스코프를 가진 격리된 실행 환경을 생성합니다.</p>
<h3 id="_7">서브셸 구문<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 괄호는 서브셸을 생성합니다</span>
<span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span>

<span class="o">(</span>
<span class="w">    </span><span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Inside subshell: </span><span class="nv">$VAR</span><span class="s2">&quot;</span>
<span class="o">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Outside subshell: </span><span class="nv">$VAR</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 여전히 &quot;outer&quot;</span>

<span class="c1"># 명령 치환도 서브셸을 생성합니다</span>
<span class="nv">result</span><span class="o">=</span><span class="k">$(</span>
<span class="w">    </span><span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;command substitution&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VAR</span><span class="s2">&quot;</span>
<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Result: </span><span class="nv">$result</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;VAR is still: </span><span class="nv">$VAR</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 여전히 &quot;outer&quot;</span>
</code></pre></div>

<h3 id="vs">서브셸 vs 명령 그룹화<a class="header-link" href="#vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 서브셸 ( ) - 별도 프로세스, 격리된 스코프</span>
<span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;original&quot;</span>
<span class="o">(</span><span class="w"> </span><span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;subshell&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/tmp<span class="p">;</span><span class="w"> </span><span class="nb">pwd</span><span class="w"> </span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;VAR: </span><span class="nv">$VAR</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># &quot;original&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;PWD: </span><span class="nv">$PWD</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># 변경되지 않음</span>

<span class="c1"># 명령 그룹화 { } - 동일한 프로세스, 공유 스코프</span>
<span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;original&quot;</span>
<span class="o">{</span><span class="w"> </span><span class="nv">VAR</span><span class="o">=</span><span class="s2">&quot;grouped&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;In group: </span><span class="nv">$VAR</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;VAR: </span><span class="nv">$VAR</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># &quot;grouped&quot;</span>

<span class="c1"># 참고: { }는 공백과 세미콜론/줄바꿈이 } 앞에 필요합니다</span>
</code></pre></div>

<h3 id="_8">실용적인 서브셸 사용<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 1. 임시 디렉토리 변경</span>
<span class="o">(</span><span class="nb">cd</span><span class="w"> </span>/tmp<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ls<span class="w"> </span>-la<span class="o">)</span><span class="w">  </span><span class="c1"># 이후 원래 디렉토리로 돌아옴</span>

<span class="c1"># 2. 임시 환경 변경</span>
<span class="o">(</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/custom/path:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CUSTOM_VAR</span><span class="o">=</span><span class="s2">&quot;value&quot;</span>
<span class="w">    </span>./my_program<span class="w">  </span><span class="c1"># 수정된 환경 사용</span>
<span class="o">)</span>
<span class="c1"># 여기서 환경 복원됨</span>

<span class="c1"># 3. 리다이렉션을 위한 그룹화</span>
<span class="o">(</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Log entry 1&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Log entry 2&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Log entry 3&quot;</span>
<span class="o">)</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>logfile.txt

<span class="c1"># 4. 백그라운드 작업 격리</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..3<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="o">(</span>
<span class="w">        </span><span class="c1"># 각 반복은 격리된 환경을 가짐</span>
<span class="w">        </span><span class="nv">ITERATION</span><span class="o">=</span><span class="nv">$i</span>
<span class="w">        </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Iteration </span><span class="nv">$ITERATION</span><span class="s2"> complete&quot;</span>
<span class="w">    </span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="k">done</span>
<span class="nb">wait</span>

<span class="c1"># 5. 그룹화된 명령이 있는 파이프라인</span>
<span class="o">(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;line 1&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;line 2&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;line 3&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;line 2&quot;</span>
</code></pre></div>

<h3 id="_9">변수 스코프 함의<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 서브셸에서 수정된 변수는 유지되지 않음</span>
<span class="nv">counter</span><span class="o">=</span><span class="m">0</span>

<span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="o">((</span>counter++<span class="o">))</span><span class="w">  </span><span class="c1"># while이 서브셸에 있으면 작동하지 않습니다!</span>
<span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span>&lt;<span class="o">(</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">10</span><span class="o">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Counter: </span><span class="nv">$counter</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 10 (프로세스 치환은 while에 대한 서브셸 회피)</span>

<span class="c1"># 이것은 서브셸을 생성합니다 (while에 파이프)</span>
<span class="nv">counter</span><span class="o">=</span><span class="m">0</span>
seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="o">((</span>counter++<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Counter: </span><span class="nv">$counter</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 0 (서브셸이 변경 사항을 격리)</span>

<span class="c1"># 해결책 1: 프로세스 치환 사용 (위에 표시됨)</span>
<span class="c1"># 해결책 2: here 문자열 또는 리다이렉션 사용</span>
<span class="c1"># 해결책 3: 파일 디스크립터 사용</span>
</code></pre></div>

<h2 id="4-signals">4. 시그널(Signals)<a class="header-link" href="#4-signals" title="Permanent link">&para;</a></h2>
<p>시그널은 프로세스에 이벤트를 알리는 소프트웨어 인터럽트입니다.</p>
<h3 id="_10">일반적인 시그널<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>시그널</th>
<th>번호</th>
<th>설명</th>
<th>기본 동작</th>
</tr>
</thead>
<tbody>
<tr>
<td>SIGHUP</td>
<td>1</td>
<td>행업 (터미널 닫힘)</td>
<td>종료</td>
</tr>
<tr>
<td>SIGINT</td>
<td>2</td>
<td>인터럽트 (Ctrl+C)</td>
<td>종료</td>
</tr>
<tr>
<td>SIGQUIT</td>
<td>3</td>
<td>종료 (Ctrl+)</td>
<td>종료 + 코어 덤프</td>
</tr>
<tr>
<td>SIGKILL</td>
<td>9</td>
<td>킬 (캐치 불가)</td>
<td>종료</td>
</tr>
<tr>
<td>SIGTERM</td>
<td>15</td>
<td>종료 요청</td>
<td>종료</td>
</tr>
<tr>
<td>SIGSTOP</td>
<td>19</td>
<td>중지 (캐치 불가)</td>
<td>중지</td>
</tr>
<tr>
<td>SIGCONT</td>
<td>18</td>
<td>중지된 경우 계속</td>
<td>계속</td>
</tr>
<tr>
<td>SIGUSR1</td>
<td>10</td>
<td>사용자 정의 시그널 1</td>
<td>종료</td>
</tr>
<tr>
<td>SIGUSR2</td>
<td>12</td>
<td>사용자 정의 시그널 2</td>
<td>종료</td>
</tr>
<tr>
<td>SIGPIPE</td>
<td>13</td>
<td>깨진 파이프</td>
<td>종료</td>
</tr>
<tr>
<td>SIGCHLD</td>
<td>17</td>
<td>자식 프로세스 변경됨</td>
<td>무시</td>
</tr>
<tr>
<td>SIGALRM</td>
<td>14</td>
<td>타이머 만료</td>
<td>종료</td>
</tr>
</tbody>
</table>
<h3 id="_11">시그널 전송<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 백그라운드 프로세스 시작</span>
sleep<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">PID</span><span class="o">=</span><span class="nv">$!</span>

<span class="c1"># 프로세스에 시그널 전송</span>
<span class="nb">kill</span><span class="w"> </span>-SIGTERM<span class="w"> </span><span class="nv">$PID</span><span class="w">  </span><span class="c1"># 정중한 종료 요청</span>
<span class="c1"># kill -15 $PID     # 동일, 번호 사용</span>

<span class="c1"># kill -SIGKILL $PID  # 강제 종료 (캐치 불가)</span>
<span class="c1"># kill -9 $PID        # 동일, 번호 사용</span>

<span class="c1"># 프로세스가 실행 중인지 확인 (시그널 0)</span>
<span class="k">if</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-0<span class="w"> </span><span class="nv">$PID</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Process </span><span class="nv">$PID</span><span class="s2"> is running&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Process </span><span class="nv">$PID</span><span class="s2"> is not running&quot;</span>
<span class="k">fi</span>

<span class="c1"># 프로세스 그룹에 시그널 전송</span>
<span class="c1"># kill -TERM -$$  # 전체 프로세스 그룹 종료</span>
</code></pre></div>

<h3 id="_12">시그널 나열<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 모든 시그널 나열</span>
<span class="nb">kill</span><span class="w"> </span>-l

<span class="c1"># 번호로부터 시그널 이름 가져오기</span>
<span class="nb">kill</span><span class="w"> </span>-l<span class="w"> </span><span class="m">9</span><span class="w">   </span><span class="c1"># KILL</span>

<span class="c1"># 이름으로부터 시그널 번호 가져오기</span>
<span class="nb">kill</span><span class="w"> </span>-l<span class="w"> </span>TERM<span class="w">  </span><span class="c1"># 15</span>
</code></pre></div>

<h2 id="5-trap">5. trap 명령<a class="header-link" href="#5-trap" title="Permanent link">&para;</a></h2>
<p><code>trap</code> 명령은 스크립트가 시그널을 캐치하고 처리할 수 있게 합니다.</p>
<h3 id="trap">기본 trap 구문<a class="header-link" href="#trap" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># trap 구문: trap &#39;commands&#39; SIGNAL [SIGNAL...]</span>

<span class="c1"># Ctrl+C (SIGINT) 캐치</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;echo &quot;Caught SIGINT (Ctrl+C)! Exiting...&quot;; exit 1&#39;</span><span class="w"> </span>INT

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Press Ctrl+C to trigger the trap...&quot;</span>
sleep<span class="w"> </span><span class="m">30</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Completed normally&quot;</span>
</code></pre></div>

<h3 id="_13">여러 시그널 트랩<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

cleanup<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Cleanup function called by signal: </span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="c1"># 여기서 정리 수행</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="o">}</span>

<span class="c1"># 여러 시그널 트랩</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;cleanup SIGINT&#39;</span><span class="w"> </span>INT
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;cleanup SIGTERM&#39;</span><span class="w"> </span>TERM
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;cleanup SIGHUP&#39;</span><span class="w"> </span>HUP

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Script running (PID: </span><span class="nv">$$</span><span class="s2">)...&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Try: kill -TERM </span><span class="nv">$$</span><span class="s2">&quot;</span>
<span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="_14">시그널 무시<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># SIGINT 무시 (빈 문자열)</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>INT

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Try Ctrl+C - it won&#39;t work!&quot;</span>
sleep<span class="w"> </span><span class="m">5</span>

<span class="c1"># 기본 동작으로 재설정</span>
<span class="nb">trap</span><span class="w"> </span>-<span class="w"> </span>INT

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Now Ctrl+C will work again&quot;</span>
sleep<span class="w"> </span><span class="m">5</span>
</code></pre></div>

<h3 id="exit">EXIT에 대한 트랩<a class="header-link" href="#exit" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># EXIT 의사 시그널: 스크립트 종료 시 트리거됨 (모든 이유)</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;echo &quot;Script exiting...&quot;&#39;</span><span class="w"> </span>EXIT

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting script&quot;</span>
sleep<span class="w"> </span><span class="m">2</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Ending script&quot;</span>

<span class="c1"># EXIT 트랩은 스크립트가 어떻게 종료되든 여기서 실행됩니다</span>
</code></pre></div>

<h3 id="trap_1">trap을 사용한 디버깅<a class="header-link" href="#trap_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># DEBUG 의사 시그널: 각 명령 전에 실행됨</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;echo &quot;Executing: $BASH_COMMAND&quot;&#39;</span><span class="w"> </span>DEBUG

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;First command&quot;</span>
<span class="nv">x</span><span class="o">=</span><span class="m">10</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;x is </span><span class="nv">$x</span><span class="s2">&quot;</span>
<span class="o">((</span>x++<span class="o">))</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;x is now </span><span class="nv">$x</span><span class="s2">&quot;</span>

<span class="nb">trap</span><span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w">  </span><span class="c1"># DEBUG 트랩 비활성화</span>
</code></pre></div>

<h2 id="6-cleanup-patterns">6. 정리 패턴(Cleanup Patterns)<a class="header-link" href="#6-cleanup-patterns" title="Permanent link">&para;</a></h2>
<p>적절한 정리는 스크립트가 임시 파일, 락 파일 또는 고아 프로세스를 남기지 않도록 보장합니다.</p>
<h3 id="_15">임시 파일 정리<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 임시 파일 생성</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="k">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="c1"># 종료 시 정리 보장</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;rm -f &quot;$TMPFILE&quot;&#39;</span><span class="w"> </span>EXIT

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Using temp file: </span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>

<span class="c1"># 임시 파일 사용</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>
cat<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>

<span class="c1"># 종료 시 자동으로 정리됩니다</span>
</code></pre></div>

<h3 id="_16">포괄적인 정리<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 정리 함수</span>
cleanup<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">exit_code</span><span class="o">=</span><span class="nv">$?</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Performing cleanup...&quot;</span>

<span class="w">    </span><span class="c1"># 임시 파일 제거</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPDIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPDIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPDIR</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># 락 파일 해제</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># 자식 프로세스 종료</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$WORKER_PID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$WORKER_PID</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null

<span class="w">    </span><span class="c1"># 상태 복원</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ORIGINAL_DIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ORIGINAL_DIR</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Cleanup complete&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$exit_code</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># 트랩 설정</span>
<span class="nb">trap</span><span class="w"> </span>cleanup<span class="w"> </span>EXIT<span class="w"> </span>INT<span class="w"> </span>TERM

<span class="c1"># 원래 디렉토리 기억</span>
<span class="nv">ORIGINAL_DIR</span><span class="o">=</span><span class="nv">$PWD</span>

<span class="c1"># 임시 리소스 생성</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="k">)</span>
<span class="nv">TMPDIR</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="w"> </span>-d<span class="k">)</span>
<span class="nv">LOCKFILE</span><span class="o">=</span><span class="s2">&quot;/tmp/myscript.lock&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Resources created:&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  TMPFILE: </span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  TMPDIR: </span><span class="nv">$TMPDIR</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  LOCKFILE: </span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span>

<span class="c1"># 작업 시뮬레이션</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Working...&quot;</span>
sleep<span class="w"> </span><span class="m">2</span>

<span class="c1"># 자동으로 정리됩니다</span>
</code></pre></div>

<h3 id="_17">락 파일 패턴<a class="header-link" href="#_17" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">LOCKFILE</span><span class="o">=</span><span class="s2">&quot;/var/lock/myscript.lock&quot;</span>

<span class="c1"># 락 획득</span>
acquire_lock<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Another instance is running (lock file exists)&quot;</span>
<span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="c1"># 우리 PID로 락 파일 생성</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOCKFILE</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># 정리 보장</span>
<span class="w">    </span><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;rm -f &quot;$LOCKFILE&quot;; exit&#39;</span><span class="w"> </span>EXIT<span class="w"> </span>INT<span class="w"> </span>TERM
<span class="o">}</span>

<span class="c1"># 대안: mkdir로 원자적 락</span>
acquire_lock_atomic<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">lockdir</span><span class="o">=</span><span class="s2">&quot;/var/lock/myscript.lock.d&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span>mkdir<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$lockdir</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;rmdir &quot;$lockdir&quot;; exit&#39;</span><span class="w"> </span>EXIT<span class="w"> </span>INT<span class="w"> </span>TERM
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Another instance is running&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

acquire_lock

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Lock acquired, doing work...&quot;</span>
sleep<span class="w"> </span><span class="m">5</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Done&quot;</span>
</code></pre></div>

<h3 id="idempotent-cleanup">멱등적 정리(Idempotent Cleanup)<a class="header-link" href="#idempotent-cleanup" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 안전하게 여러 번 호출할 수 있는 정리</span>
cleanup<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># 플래그를 사용하여 정리된 것을 추적</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CLEANUP_DONE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">return</span>
<span class="w">    </span><span class="nv">CLEANUP_DONE</span><span class="o">=</span><span class="m">1</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running cleanup...&quot;</span>

<span class="w">    </span><span class="c1"># 제거하기 전에 확인</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Removed </span><span class="nv">$TMPFILE</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="c1"># 실행 중인 경우에만 프로세스 종료</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CHILD_PID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-0<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CHILD_PID</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">kill</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CHILD_PID</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nb">wait</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CHILD_PID</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Killed process </span><span class="nv">$CHILD_PID</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="nb">trap</span><span class="w"> </span>cleanup<span class="w"> </span>EXIT<span class="w"> </span>INT<span class="w"> </span>TERM

<span class="nv">TMPFILE</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="k">)</span>
sleep<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="p">&amp;</span>
<span class="nv">CHILD_PID</span><span class="o">=</span><span class="nv">$!</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Press Ctrl+C to test cleanup...&quot;</span>
sleep<span class="w"> </span><span class="m">30</span>
</code></pre></div>

<h2 id="7-coprocesses-coproc">7. 코프로세스(Coprocesses) (coproc)<a class="header-link" href="#7-coprocesses-coproc" title="Permanent link">&para;</a></h2>
<p>Bash 4.0+는 양방향 통신을 위한 코프로세스를 지원합니다.</p>
<h3 id="_18">기본 코프로세스<a class="header-link" href="#_18" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 코프로세스 시작</span>
coproc<span class="w"> </span>BC<span class="w"> </span><span class="o">{</span><span class="w"> </span>bc<span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="c1"># 코프로세스에 쓰기 (stdin)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;5 + 3&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BC</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># 코프로세스에서 읽기 (stdout)</span>
<span class="nb">read</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BC</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>result
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Result: </span><span class="nv">$result</span><span class="s2">&quot;</span>

<span class="c1"># 코프로세스 닫기</span>
<span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;exec </span><span class="si">${</span><span class="nv">BC</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&gt;&amp;-&quot;</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$BC_PID</span>
</code></pre></div>

<h3 id="_19">명명된 코프로세스<a class="header-link" href="#_19" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 명명된 코프로세스</span>
coproc<span class="w"> </span>CALC<span class="w"> </span><span class="o">{</span><span class="w"> </span>bc<span class="w"> </span>-l<span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="c1"># 계산 함수</span>
calculate<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CALC</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">read</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CALC</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>result
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># 계산기 사용</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;sqrt(16) = </span><span class="k">$(</span>calculate<span class="w"> </span><span class="s1">&#39;sqrt(16)&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 / 3 = </span><span class="k">$(</span>calculate<span class="w"> </span><span class="s1">&#39;10 / 3&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;e(1) = </span><span class="k">$(</span>calculate<span class="w"> </span><span class="s1">&#39;e(1)&#39;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># 정리</span>
<span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;exec </span><span class="si">${</span><span class="nv">CALC</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&gt;&amp;-&quot;</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$CALC_PID</span>
</code></pre></div>

<h3 id="_20">대화형 코프로세스 예제<a class="header-link" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 셸 코프로세스 시작</span>
coproc<span class="w"> </span>SHELL<span class="w"> </span><span class="o">{</span><span class="w"> </span>bash<span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="c1"># 코프로세스에서 명령 실행 함수</span>
exec_in_coproc<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">cmd</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$cmd</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SHELL</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;echo &#39;&lt;&lt;&lt;END&gt;&gt;&gt;&#39;&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SHELL</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SHELL</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;&lt;&lt;END&gt;&gt;&gt;&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">break</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

<span class="c1"># 명령 실행</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Current directory:&quot;</span>
exec_in_coproc<span class="w"> </span><span class="s2">&quot;pwd&quot;</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nFiles:&quot;</span>
exec_in_coproc<span class="w"> </span><span class="s2">&quot;ls -1&quot;</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nEnvironment variable:&quot;</span>
exec_in_coproc<span class="w"> </span><span class="s2">&quot;echo \$HOME&quot;</span>

<span class="c1"># 정리</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SHELL</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$SHELL_PID</span>
</code></pre></div>

<h3 id="_21">에러 처리가 있는 코프로세스<a class="header-link" href="#_21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 에러 처리가 있는 코프로세스 시작</span>
start_coproc<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>coproc<span class="w"> </span>WORKER<span class="w"> </span><span class="o">{</span><span class="w"> </span>python3<span class="w"> </span>-u<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">import sys</span>
<span class="s1">while True:</span>
<span class="s1">    try:</span>
<span class="s1">        line = input()</span>
<span class="s1">        if line == &quot;QUIT&quot;:</span>
<span class="s1">            break</span>
<span class="s1">        # 라인 처리</span>
<span class="s1">        print(f&quot;Processed: {line}&quot;)</span>
<span class="s1">        sys.stdout.flush()</span>
<span class="s1">    except EOFError:</span>
<span class="s1">        break</span>
<span class="s1">&#39;</span><span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed to start coprocess&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="c1"># 정리 설정</span>
<span class="w">    </span><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;echo &quot;QUIT&quot; &gt;&amp;&quot;${WORKER[1]}&quot; 2&gt;/dev/null; wait $WORKER_PID 2&gt;/dev/null&#39;</span><span class="w"> </span>EXIT
<span class="o">}</span>

<span class="c1"># 코프로세스 사용</span>
send_to_worker<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">WORKER</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">read</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">WORKER</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-t<span class="w"> </span><span class="m">5</span><span class="w"> </span>response<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Timeout or error reading from worker&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$response</span><span class="s2">&quot;</span>
<span class="o">}</span>

start_coproc

send_to_worker<span class="w"> </span><span class="s2">&quot;task1&quot;</span>
send_to_worker<span class="w"> </span><span class="s2">&quot;task2&quot;</span>
send_to_worker<span class="w"> </span><span class="s2">&quot;task3&quot;</span>
</code></pre></div>

<h2 id="8-process-priority">8. 프로세스 우선순위(Process Priority)<a class="header-link" href="#8-process-priority" title="Permanent link">&para;</a></h2>
<p>프로세스의 CPU 및 I/O 우선순위를 제어합니다.</p>
<h3 id="nice">nice 명령<a class="header-link" href="#nice" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Nice 값은 -20 (최고 우선순위)에서 19 (최저)까지</span>
<span class="c1"># 기본값은 0</span>

<span class="c1"># 낮은 우선순위로 실행 (nice 값 10)</span>
nice<span class="w"> </span>-n<span class="w"> </span><span class="m">10</span><span class="w"> </span>./cpu-intensive-script.sh

<span class="c1"># 높은 우선순위로 실행 (음수 값은 root 필요)</span>
<span class="c1"># sudo nice -n -10 ./important-script.sh</span>

<span class="c1"># 현재 nice 값 확인</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Current nice value: </span><span class="k">$(</span>nice<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>

<h3 id="renice">renice 명령<a class="header-link" href="#renice" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 프로세스 시작</span>
./my-script.sh<span class="w"> </span><span class="p">&amp;</span>
<span class="nv">PID</span><span class="o">=</span><span class="nv">$!</span>

<span class="c1"># 실행 중인 프로세스의 우선순위 변경</span>
renice<span class="w"> </span>-n<span class="w"> </span><span class="m">15</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$PID</span>

<span class="c1"># 사용자의 모든 프로세스 renice</span>
<span class="c1"># sudo renice -n 10 -u username</span>

<span class="c1"># 그룹의 모든 프로세스 renice</span>
<span class="c1"># sudo renice -n 5 -g groupname</span>
</code></pre></div>

<h3 id="ionice">ionice 명령<a class="header-link" href="#ionice" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># I/O 스케줄링 클래스:</span>
<span class="c1"># 0 - None (기본)</span>
<span class="c1"># 1 - Real-time (최고 우선순위, root 필요)</span>
<span class="c1"># 2 - Best-effort (기본)</span>
<span class="c1"># 3 - Idle (다른 I/O가 없을 때만)</span>

<span class="c1"># idle I/O 우선순위로 실행</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span>./disk-intensive-script.sh

<span class="c1"># best-effort, 우선순위 4 (0-7, 낮을수록 높은 우선순위)로 실행</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span>./my-script.sh

<span class="c1"># 실행 중인 프로세스의 I/O 우선순위 변경</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$PID</span>
</code></pre></div>

<h3 id="_22">결합된 우선순위 예제<a class="header-link" href="#_22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># CPU와 I/O 집약적 작업을 낮은 우선순위로 실행</span>
run_low_priority<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">cmd</span><span class="o">=</span><span class="nv">$1</span>

<span class="w">    </span><span class="c1"># nice로 시작</span>
<span class="w">    </span>nice<span class="w"> </span>-n<span class="w"> </span><span class="m">19</span><span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$cmd</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">pid</span><span class="o">=</span><span class="nv">$!</span>

<span class="w">    </span><span class="c1"># I/O 우선순위를 idle로 설정</span>
<span class="w">    </span>ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$pid</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Started low priority process: </span><span class="nv">$pid</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Nice: </span><span class="k">$(</span>ps<span class="w"> </span>-o<span class="w"> </span><span class="nv">nice</span><span class="o">=</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$pid</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;I/O class: </span><span class="k">$(</span>ionice<span class="w"> </span>-p<span class="w"> </span><span class="nv">$pid</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nb">wait</span><span class="w"> </span><span class="nv">$pid</span>
<span class="o">}</span>

<span class="c1"># 사용 예제</span>
run_low_priority<span class="w"> </span><span class="s2">&quot;find / -name &#39;*.log&#39; 2&gt;/dev/null | xargs gzip&quot;</span>
</code></pre></div>

<h3 id="_23">우선순위 관리 스크립트<a class="header-link" href="#_23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 프로세스 우선순위 관리</span>
manage_priority<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">pid</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">cpu_priority</span><span class="o">=</span><span class="nv">$2</span><span class="w">  </span><span class="c1"># -20 ~ 19</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">io_class</span><span class="o">=</span><span class="nv">$3</span><span class="w">      </span><span class="c1"># 0-3</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">io_priority</span><span class="o">=</span><span class="nv">$4</span><span class="w">   </span><span class="c1"># 0-7</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Managing priority for PID </span><span class="nv">$pid</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># CPU 우선순위 설정</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$cpu_priority</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>renice<span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$cpu_priority</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$pid</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  CPU priority set to </span><span class="nv">$cpu_priority</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Failed to set CPU priority (may need sudo)&quot;</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="c1"># I/O 우선순위 설정</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$io_class</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">local</span><span class="w"> </span><span class="nv">ionice_cmd</span><span class="o">=</span><span class="s2">&quot;ionice -c </span><span class="nv">$io_class</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$io_priority</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">ionice_cmd</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$ionice_cmd</span><span class="s2"> -n </span><span class="nv">$io_priority</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nv">$ionice_cmd</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$pid</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  I/O priority set to class </span><span class="nv">$io_class</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Failed to set I/O priority (may need sudo)&quot;</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="c1"># 현재 우선순위 표시</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Current nice value: </span><span class="k">$(</span>ps<span class="w"> </span>-o<span class="w"> </span><span class="nv">nice</span><span class="o">=</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$pid</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Current I/O: </span><span class="k">$(</span>ionice<span class="w"> </span>-p<span class="w"> </span><span class="nv">$pid</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-1<span class="k">)</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># 예제: 낮은 우선순위로 백업 실행</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting backup...&quot;</span>
./backup.sh<span class="w"> </span><span class="p">&amp;</span>
<span class="nv">BACKUP_PID</span><span class="o">=</span><span class="nv">$!</span>

manage_priority<span class="w"> </span><span class="nv">$BACKUP_PID</span><span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">3</span>
<span class="nb">wait</span><span class="w"> </span><span class="nv">$BACKUP_PID</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Backup complete&quot;</span>
</code></pre></div>

<h2 id="_24">연습 문제<a class="header-link" href="#_24" title="Permanent link">&para;</a></h2>
<h3 id="1">문제 1: 병렬 파일 프로세서<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>설정 가능한 최대 동시 작업 수로 여러 파일을 병렬로 처리하는 스크립트를 작성하세요. 각 파일은 작업을 시뮬레이션하는 함수(sleep)로 처리되어야 하며, 스크립트는 각 파일이 처리를 시작하고 완료할 때 보고해야 합니다.</p>
<p>요구 사항:
- 디렉토리 경로와 최대 동시 작업 수를 인수로 받음
- 디렉토리의 모든 <code>.txt</code> 파일 처리
- 총 처리 시간 추적 및 보고
- 에러를 우아하게 처리</p>
<h3 id="2">문제 2: 시그널 안전 다운로드 매니저<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<p>다음 기능을 가진 다운로드 매니저 스크립트를 만드세요:
- 여러 URL을 병렬로 다운로드
- 진행 상황을 상태 파일에 저장
- SIGINT (Ctrl+C)로 중단하고 나중에 재개 가능
- SIGTERM에서 부분 다운로드 정리
- 모든 정리를 적절히 처리하기 위해 trap 사용</p>
<h3 id="3">문제 3: 백그라운드 작업 모니터<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>다음 기능을 가진 작업 모니터링 시스템을 구현하세요:
- 여러 백그라운드 작업 시작
- 매초마다 상태 모니터링
- 각 작업이 완료될 때 보고
- 진행 표시기 표시
- 동시 작업을 최대값으로 제한 (예: 3)
- 작업 실패를 처리하고 실패한 작업을 한 번 재시도</p>
<h3 id="4">문제 4: 코프로세스 계산기 서비스<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>코프로세스를 사용하여 계산기 서비스를 만드세요:
- <code>bc</code> 코프로세스 시작
- 표현식을 입력할 명령줄 인터페이스 제공
- 히스토리 지원 (최근 10개 계산 표시)
- 에러 처리 (잘못된 표현식)
- 적절한 종료 시퀀스 구현</p>
<h3 id="5">문제 5: 우선순위 기반 작업 스케줄러<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>다음 기능을 가진 작업 스케줄러를 만드세요:
- 우선순위 수준(high, medium, low)을 가진 작업 수락
- 높은 우선순위 작업은 nice 값 0으로 실행
- 중간 우선순위 작업은 nice 값 10으로 실행
- 낮은 우선순위 작업은 nice 값 19와 I/O 클래스 idle로 실행
- 모든 실행 중인 작업의 상태 보고
- 총 동시 작업을 5개로 제한
- 종료 시 적절한 정리 구현</p>
<hr />
<p><strong>이전</strong>: <a href="./08_Regex_in_Bash.md">08_Regex_in_Bash.md</a> | <strong>다음</strong>: <a href="./10_Error_Handling.md">10_Error_Handling.md</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Shell_Script/08_Regex_in_Bash.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">레슨 08: Bash에서의 정규 표현식(Regular Expressions)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Shell_Script/10_Error_Handling.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Lesson 10: 에러 처리 및 디버깅</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}