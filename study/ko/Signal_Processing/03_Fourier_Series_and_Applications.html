{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš© - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/02_LTI_Systems_and_Convolution.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">LTI ì‹œìŠ¤í…œê³¼ í•©ì„±ê³±</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/04_Continuous_Fourier_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ì£¼ê¸° ì‹ í˜¸ ë³µìŠµ</a><ul>
<li><a href="#11">1.1 ì •ì˜</a></li>
<li><a href="#12">1.2 ê³ ì¡°íŒŒ</a></li>
<li><a href="#13">1.3 ì£¼ê¸° ì‹ í˜¸ì˜ í•©</a></li>
</ul>
</li>
<li><a href="#2">2. ì‚¼ê°í•¨ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a><ul>
<li><a href="#21">2.1 í‘œí˜„</a></li>
<li><a href="#22">2.2 ì§êµì„±ìœ¼ë¡œë¶€í„°ì˜ ìœ ë„</a></li>
<li><a href="#23">2.3 ì½¤íŒ©íŠ¸ ì‚¼ê°í•¨ìˆ˜ í˜•íƒœ</a></li>
<li><a href="#24">2.4 ëŒ€ì¹­ì„±ì„ ì´ìš©í•œ ê³„ì‚° ë‹¨ìˆœí™”</a></li>
</ul>
</li>
<li><a href="#3">3. ë³µì†Œ ì§€ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a><ul>
<li><a href="#31">3.1 í‘œí˜„</a></li>
<li><a href="#32">3.2 ì‚¼ê°í•¨ìˆ˜ ê³„ìˆ˜ì™€ì˜ ê´€ê³„</a></li>
<li><a href="#33">3.3 ë³µì†Œ í˜•íƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </a></li>
<li><a href="#34">3.4 ìœ ë„</a></li>
</ul>
</li>
<li><a href="#4">4. í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°</a><ul>
<li><a href="#41-square-wave">4.1 êµ¬í˜•íŒŒ(Square Wave)</a></li>
<li><a href="#42-sawtooth-wave">4.2 í†±ë‹ˆíŒŒ(Sawtooth Wave)</a></li>
<li><a href="#43-triangle-wave">4.3 ì‚¼ê°íŒŒ(Triangle Wave)</a></li>
<li><a href="#44-rectified-sinusoid">4.4 ì •ë¥˜ ì •í˜„íŒŒ(Rectified Sinusoid, ì „íŒŒ ì •ë¥˜)</a></li>
</ul>
</li>
<li><a href="#5">5. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ìˆ˜ë ´</a><ul>
<li><a href="#51-dirichlet-conditions">5.1 ë””ë¦¬í´ë ˆ ì¡°ê±´(Dirichlet Conditions)</a></li>
<li><a href="#52">5.2 ìˆ˜ë ´ì˜ ì¢…ë¥˜</a></li>
<li><a href="#53">5.3 ìˆ˜ë ´ ì†ë„</a></li>
</ul>
</li>
<li><a href="#6">6. ê¹ìŠ¤ í˜„ìƒ</a><ul>
<li><a href="#61">6.1 ì„¤ëª…</a></li>
<li><a href="#62">6.2 ìˆ˜í•™ì  ì„¤ëª…</a></li>
<li><a href="#63">6.3 ì‹¤ìš©ì  ì‹œì‚¬ì </a></li>
</ul>
</li>
<li><a href="#7">7. íŒŒë¥´ì„¸ë°œ ì •ë¦¬</a><ul>
<li><a href="#71">7.1 ì§„ìˆ </a></li>
<li><a href="#72">7.2 í•´ì„</a></li>
<li><a href="#73">7.3 ì˜ˆ: êµ¬í˜•íŒŒ ì „ë ¥</a></li>
<li><a href="#74">7.4 ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼</a></li>
</ul>
</li>
<li><a href="#8">8. ì„  ìŠ¤í™íŠ¸ëŸ¼</a><ul>
<li><a href="#81">8.1 ì •ì˜</a></li>
<li><a href="#82">8.2 ë‹¨ì¸¡ ëŒ€ ì–‘ì¸¡ ìŠ¤í™íŠ¸ëŸ¼</a></li>
</ul>
</li>
<li><a href="#9">9. ì‘ìš©: í‘œì¤€ íŒŒí˜• ë¶„í•´</a><ul>
<li><a href="#91">9.1 í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê·¼ì‚¬ ê°¤ëŸ¬ë¦¬</a></li>
<li><a href="#92">9.2 ë¬¼ë¦¬ì  ì‘ìš©: ì—´ì „ë„</a></li>
<li><a href="#93">9.3 ì‹ í˜¸ í•©ì„±: ê°€ì‚° ì‚¬ìš´ë“œ í•©ì„±</a></li>
</ul>
</li>
<li><a href="#10">10. ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a><ul>
<li><a href="#101">10.1 ì •ì˜</a></li>
<li><a href="#102">10.2 ì—°ì†ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ì˜ ì£¼ìš” ì°¨ì´ì </a></li>
<li><a href="#103-dft">10.3 DFTì™€ì˜ ì—°ê²°</a></li>
</ul>
</li>
<li><a href="#11-python">11. Python ì˜ˆì œ</a><ul>
<li><a href="#111">11.1 ì¢…í•© í‘¸ë¦¬ì— ê¸‰ìˆ˜ ë¶„ì„ê¸°</a></li>
<li><a href="#112">11.2 ê¹ìŠ¤ í˜„ìƒ ì™„í™”</a></li>
<li><a href="#113">11.3 ëŒ€í™”í˜• ê³„ìˆ˜ íƒìƒ‰ê¸°</a></li>
</ul>
</li>
<li><a href="#12_1">12. ìš”ì•½</a><ul>
<li><a href="#_3">ì£¼ìš” ê³µì‹</a></li>
<li><a href="#_4">ê°œë… ê³„ì¸µ êµ¬ì¡°</a></li>
<li><a href="#_5">í•µì‹¬ ì •ë¦¬</a></li>
</ul>
</li>
<li><a href="#13_1">13. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ ë¬¸ì œ 1: í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°</a></li>
<li><a href="#2_1">ì—°ìŠµ ë¬¸ì œ 2: ëŒ€ì¹­ì„± í™œìš©</a></li>
<li><a href="#3_1">ì—°ìŠµ ë¬¸ì œ 3: ê¹ìŠ¤ í˜„ìƒ íƒêµ¬</a></li>
<li><a href="#4_1">ì—°ìŠµ ë¬¸ì œ 4: íŒŒë¥´ì„¸ë°œ ì •ë¦¬ ì‘ìš©</a></li>
<li><a href="#5_1">ì—°ìŠµ ë¬¸ì œ 5: ì‹ í˜¸ ì¬êµ¬ì„± ë„ì „</a></li>
<li><a href="#6_1">ì—°ìŠµ ë¬¸ì œ 6: ì‹¤ì œ ì‹ í˜¸ì˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a></li>
<li><a href="#7-lti">ì—°ìŠµ ë¬¸ì œ 7: í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ LTI ì‹œìŠ¤í…œ</a></li>
<li><a href="#8_1">ì—°ìŠµ ë¬¸ì œ 8: ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a></li>
</ul>
</li>
<li><a href="#14">14. ì°¸ê³  ë¬¸í—Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>ì´ì „</strong>: <a href="./02_LTI_Systems_and_Convolution.md">02. LTI ì‹œìŠ¤í…œê³¼ í•©ì„±ê³±</a> | <strong>ë‹¤ìŒ</strong>: <a href="./04_Continuous_Fourier_Transform.md">04. ì—°ì† í‘¸ë¦¬ì— ë³€í™˜</a></p>
<hr />
<p>ë ˆìŠ¨ 02ì—ì„œ LTI ì‹œìŠ¤í…œì´ ì„í„ìŠ¤ ì‘ë‹µì— ì˜í•´ ì™„ì „íˆ íŠ¹ì„±í™”ë˜ë©°, í•©ì„±ê³±ì„ í†µí•´ ì„ì˜ì˜ ì…ë ¥ì— ëŒ€í•œ ì¶œë ¥ì„ ê³„ì‚°í•  ìˆ˜ ìˆìŒì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹œê°„ ì˜ì—­ì—ì„œì˜ í•©ì„±ê³±ì€ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í›¨ì”¬ ë” ìš°ì•„í•œ ì ‘ê·¼ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì‹ í˜¸ë¥¼ ë³µì†Œ ì§€ìˆ˜í•¨ìˆ˜ë¡œ ë¶„í•´í•˜ëŠ” ê²ƒì¸ë°, ë³µì†Œ ì§€ìˆ˜í•¨ìˆ˜ëŠ” LTI ì‹œìŠ¤í…œì˜ <strong>ê³ ìœ í•¨ìˆ˜(eigenfunction)</strong>ì…ë‹ˆë‹¤. ê° ì§€ìˆ˜í•¨ìˆ˜ì— ëŒ€í•œ ì‘ë‹µì€ ë‹¨ìˆœí•œ ìŠ¤ì¼€ì¼ë§ì´ë©°, ì „ì²´ ì¶œë ¥ì€ ì´ ìŠ¤ì¼€ì¼ëœ ì§€ìˆ˜í•¨ìˆ˜ë“¤ì˜ í•©ì…ë‹ˆë‹¤.</p>
<p><strong>ì£¼ê¸° ì‹ í˜¸(periodic signal)</strong>ì˜ ê²½ìš°, ì´ ë¶„í•´ë¥¼ <strong>í‘¸ë¦¬ì— ê¸‰ìˆ˜(Fourier series)</strong>ë¼ê³  í•©ë‹ˆë‹¤. ì´ ë ˆìŠ¨ì—ì„œëŠ” ìˆ˜í•™ì  ê¸°ì´ˆë¡œë¶€í„° í‘¸ë¦¬ì— ê¸‰ìˆ˜ë¥¼ ìœ ë„í•˜ê³ , ìˆ˜ë ´ íŠ¹ì„±ì„ íƒêµ¬í•˜ë©°, ì£¼ê¸° í˜„ìƒ ë¶„ì„ì—ì„œì˜ í™œìš©ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
<p><strong>ë‚œì´ë„</strong>: â­â­â­</p>
<p><strong>í•™ìŠµ ëª©í‘œ</strong>:
- í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ì‚¼ê°í•¨ìˆ˜ í˜•íƒœì™€ ë³µì†Œ ì§€ìˆ˜ í˜•íƒœ ìœ ë„
- í‘œì¤€ íŒŒí˜•ì— ëŒ€í•œ í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°
- ìˆ˜ë ´ì„ ìœ„í•œ ë””ë¦¬í´ë ˆ ì¡°ê±´(Dirichlet conditions) ì§„ìˆ  ë° ì ìš©
- ê¹ìŠ¤ í˜„ìƒ(Gibbs phenomenon)ê³¼ ì‹¤ìš©ì  ì‹œì‚¬ì  ì„¤ëª…
- íŒŒë¥´ì„¸ë°œ ì •ë¦¬(Parseval's theorem)ë¥¼ í™œìš©í•œ ìŠ¤í™íŠ¸ëŸ¼ ê³„ìˆ˜ë¡œë¶€í„° ì‹ í˜¸ ì „ë ¥ ê³„ì‚°
- ì„  ìŠ¤í™íŠ¸ëŸ¼(line spectra, ì§„í­ ë° ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼) í•´ì„
- Pythonì„ í™œìš©í•œ í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê·¼ì‚¬ ê³„ì‚° ë° ìˆ˜ë ´ ì‹œê°í™”</p>
<hr />
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ì£¼ê¸°-ì‹ í˜¸-ë³µìŠµ">ì£¼ê¸° ì‹ í˜¸ ë³µìŠµ</a></li>
<li><a href="#2-ì‚¼ê°í•¨ìˆ˜-í‘¸ë¦¬ì—-ê¸‰ìˆ˜">ì‚¼ê°í•¨ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a></li>
<li><a href="#3-ë³µì†Œ-ì§€ìˆ˜-í‘¸ë¦¬ì—-ê¸‰ìˆ˜">ë³µì†Œ ì§€ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a></li>
<li><a href="#4-í‘¸ë¦¬ì—-ê³„ìˆ˜-ê³„ì‚°">í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°</a></li>
<li><a href="#5-í‘¸ë¦¬ì—-ê¸‰ìˆ˜ì˜-ìˆ˜ë ´">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ìˆ˜ë ´</a></li>
<li><a href="#6-ê¹ìŠ¤-í˜„ìƒ">ê¹ìŠ¤ í˜„ìƒ</a></li>
<li><a href="#7-íŒŒë¥´ì„¸ë°œ-ì •ë¦¬">íŒŒë¥´ì„¸ë°œ ì •ë¦¬</a></li>
<li><a href="#8-ì„ -ìŠ¤í™íŠ¸ëŸ¼">ì„  ìŠ¤í™íŠ¸ëŸ¼</a></li>
<li><a href="#9-ì‘ìš©-í‘œì¤€-íŒŒí˜•-ë¶„í•´">ì‘ìš©: í‘œì¤€ íŒŒí˜• ë¶„í•´</a></li>
<li><a href="#10-ì´ì‚°ì‹œê°„-í‘¸ë¦¬ì—-ê¸‰ìˆ˜">ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜</a></li>
<li><a href="#11-python-ì˜ˆì œ">Python ì˜ˆì œ</a></li>
<li><a href="#12-ìš”ì•½">ìš”ì•½</a></li>
<li><a href="#13-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
<li><a href="#14-ì°¸ê³ -ë¬¸í—Œ">ì°¸ê³  ë¬¸í—Œ</a></li>
</ol>
<hr />
<h2 id="1">1. ì£¼ê¸° ì‹ í˜¸ ë³µìŠµ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì •ì˜<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ì—°ì†ì‹œê°„ ì‹ í˜¸ $x(t)$ê°€ ì£¼ê¸° $T$ë¥¼ ê°€ì§„ <strong>ì£¼ê¸° ì‹ í˜¸</strong>ì¸ ê²½ìš°:</p>
<p>$$x(t + T) = x(t) \quad \text{ëª¨ë“  } t \text{ì— ëŒ€í•´}$$</p>
<p>ì´ë¥¼ ë§Œì¡±í•˜ëŠ” ê°€ì¥ ì‘ì€ ì–‘ìˆ˜ $T$ë¥¼ <strong>ê¸°ë³¸ ì£¼ê¸°(fundamental period)</strong> $T_0$ë¼ê³  í•©ë‹ˆë‹¤. <strong>ê¸°ë³¸ ì£¼íŒŒìˆ˜(fundamental frequency)</strong>ëŠ”:</p>
<p>$$f_0 = \frac{1}{T_0} \quad \text{(Hz)}, \qquad \omega_0 = \frac{2\pi}{T_0} \quad \text{(rad/s)}$$</p>
<h3 id="12">1.2 ê³ ì¡°íŒŒ<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>ê¸°ë³¸ ì£¼íŒŒìˆ˜ $\omega_0$ë¥¼ ê°€ì§„ ì£¼ê¸° ì‹ í˜¸ì˜ <strong>$n$ë²ˆì§¸ ê³ ì¡°íŒŒ(harmonic)</strong>ëŠ” ì£¼íŒŒìˆ˜ $n\omega_0$ë¥¼ ê°€ì§‘ë‹ˆë‹¤. ê¸°ë³¸íŒŒëŠ” ì²« ë²ˆì§¸ ê³ ì¡°íŒŒ($n = 1$)ì…ë‹ˆë‹¤. $2\omega_0$ì—ì„œì˜ ì‹ í˜¸ëŠ” ë‘ ë²ˆì§¸ ê³ ì¡°íŒŒ, ì´ëŸ° ì‹ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.</p>
<h3 id="13">1.3 ì£¼ê¸° ì‹ í˜¸ì˜ í•©<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p>$x_1(t)$ì˜ ì£¼ê¸°ê°€ $T_1$ì´ê³  $x_2(t)$ì˜ ì£¼ê¸°ê°€ $T_2$ì´ë©´, ê·¸ í•© $x_1(t) + x_2(t)$ëŠ” $T_1/T_2$ê°€ <strong>ìœ ë¦¬ìˆ˜(rational number)</strong>ì¸ ê²½ìš°ì—ë§Œ ì£¼ê¸°ì ì…ë‹ˆë‹¤. í•©ì˜ ì£¼ê¸°ëŠ” $T_1$ê³¼ $T_2$ì˜ <strong>ìµœì†Œê³µë°°ìˆ˜(least common multiple)</strong>ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Periodic signals and harmonics ---</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Fundamental and harmonics</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># 1 Hz fundamental</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">axes</span><span class="p">):</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Harmonic n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">: $</span><span class="se">\\</span><span class="s1">cos(2</span><span class="se">\\</span><span class="s1">pi </span><span class="se">\\</span><span class="s1">cdot </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">cdot </span><span class="si">{</span><span class="n">f0</span><span class="si">}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">cdot t)$, &#39;</span>
                 <span class="sa">f</span><span class="s1">&#39;frequency = </span><span class="si">{</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">f0</span><span class="si">}</span><span class="s1"> Hz, period = </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;harmonics.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2">2. ì‚¼ê°í•¨ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 í‘œí˜„<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° $T_0$ë¥¼ ê°€ì§„ ì£¼ê¸° ì‹ í˜¸ $x(t)$ë¥¼ í‘œí˜„í•˜ëŠ” <strong>ì‚¼ê°í•¨ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜(trigonometric Fourier series)</strong>:</p>
<p>$$x(t) = a_0 + \sum_{n=1}^{\infty} \left[ a_n \cos(n\omega_0 t) + b_n \sin(n\omega_0 t) \right]$$</p>
<p>ì—¬ê¸°ì„œ $\omega_0 = 2\pi/T_0$ì´ê³  <strong>í‘¸ë¦¬ì— ê³„ìˆ˜(Fourier coefficients)</strong>ëŠ”:</p>
<p>$$a_0 = \frac{1}{T_0} \int_{T_0} x(t) \, dt \quad \text{(DC ì„±ë¶„ / í‰ê· ê°’)}$$</p>
<p>$$a_n = \frac{2}{T_0} \int_{T_0} x(t) \cos(n\omega_0 t) \, dt, \quad n = 1, 2, 3, \ldots$$</p>
<p>$$b_n = \frac{2}{T_0} \int_{T_0} x(t) \sin(n\omega_0 t) \, dt, \quad n = 1, 2, 3, \ldots$$</p>
<p>$\int_{T_0}$ì€ ì„ì˜ì˜ ì™„ì „í•œ í•œ ì£¼ê¸°ì— ëŒ€í•œ ì ë¶„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
<h3 id="22">2.2 ì§êµì„±ìœ¼ë¡œë¶€í„°ì˜ ìœ ë„<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>ê³„ìˆ˜ë¥¼ êµ¬í•˜ëŠ” í•µì‹¬ì€ í•œ ì£¼ê¸° $[0, T_0]$ì— ê±¸ì¹œ ì‚¼ê°í•¨ìˆ˜ì˜ <strong>ì§êµì„±(orthogonality)</strong>ì…ë‹ˆë‹¤:</p>
<p>$$\int_0^{T_0} \cos(m\omega_0 t) \cos(n\omega_0 t) \, dt = \begin{cases} T_0 & m = n = 0 \\ T_0/2 & m = n \neq 0 \\ 0 & m \neq n \end{cases}$$</p>
<p>$$\int_0^{T_0} \sin(m\omega_0 t) \sin(n\omega_0 t) \, dt = \begin{cases} T_0/2 & m = n \neq 0 \\ 0 & m \neq n \end{cases}$$</p>
<p>$$\int_0^{T_0} \cos(m\omega_0 t) \sin(n\omega_0 t) \, dt = 0 \quad \text{ëª¨ë“  } m, n \text{ì— ëŒ€í•´}$$</p>
<p>$a_n$ì„ êµ¬í•˜ë ¤ë©´: í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ì–‘ë³€ì— $\cos(n\omega_0 t)$ë¥¼ ê³±í•˜ê³  í•œ ì£¼ê¸°ì— ê±¸ì³ ì ë¶„í•©ë‹ˆë‹¤. ì§êµì„± ë•ë¶„ì— $n$ê³¼ ì¼ì¹˜í•˜ëŠ” í•­ì„ ì œì™¸í•œ ëª¨ë“  í•­ì´ ì‚¬ë¼ì§€ê³ , ê³„ìˆ˜ ê³µì‹ì´ ë„ì¶œë©ë‹ˆë‹¤.</p>
<h3 id="23">2.3 ì½¤íŒ©íŠ¸ ì‚¼ê°í•¨ìˆ˜ í˜•íƒœ<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p>ê° ê³ ì¡°íŒŒë¥¼ í•˜ë‚˜ì˜ ì •í˜„íŒŒë¡œ ê²°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p>$$x(t) = C_0 + \sum_{n=1}^{\infty} C_n \cos(n\omega_0 t + \phi_n)$$</p>
<p>ì—¬ê¸°ì„œ:</p>
<p>$$C_0 = a_0, \quad C_n = \sqrt{a_n^2 + b_n^2}, \quad \phi_n = -\arctan\left(\frac{b_n}{a_n}\right)$$</p>
<h3 id="24">2.4 ëŒ€ì¹­ì„±ì„ ì´ìš©í•œ ê³„ì‚° ë‹¨ìˆœí™”<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p>ì‹ í˜¸ì˜ ëŒ€ì¹­ì„±ì„ ì´ìš©í•˜ë©´ ê³„ìˆ˜ ê³„ì‚°ì„ ë‹¨ìˆœí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ì‹ í˜¸ íŠ¹ì„±</th>
<th>ê²°ê³¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ìš°í•¨ìˆ˜(Even)</strong>: $x(t) = x(-t)$</td>
<td>ëª¨ë“  $n$ì— ëŒ€í•´ $b_n = 0$ (ì½”ì‚¬ì¸ í•­ë§Œ ì¡´ì¬)</td>
</tr>
<tr>
<td><strong>ê¸°í•¨ìˆ˜(Odd)</strong>: $x(t) = -x(-t)$</td>
<td>ëª¨ë“  $n$ì— ëŒ€í•´ $a_n = 0$ (ì‚¬ì¸ í•­ë§Œ ì¡´ì¬, $a_0 = 0$)</td>
</tr>
<tr>
<td><strong>ë°˜íŒŒ ëŒ€ì¹­(Half-wave symmetry)</strong>: $x(t + T_0/2) = -x(t)$</td>
<td>ì§ìˆ˜ $n$ì— ëŒ€í•´ $a_n = b_n = 0$ (í™€ìˆ˜ ê³ ì¡°íŒŒë§Œ ì¡´ì¬)</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Orthogonality verification ---</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># period</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>  <span class="c1"># = 1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Orthogonality of Trigonometric Functions ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># cos(m*t) * cos(n*t) integrals</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cos(m*t) * cos(n*t) over [0, 2*pi]:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  m=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">integral</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (expected </span><span class="si">{</span><span class="n">T0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">m</span><span class="o">==</span><span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">T0</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">cos(m*t) * sin(n*t) over [0, 2*pi]:&quot;</span><span class="p">)</span>
<span class="n">all_zero</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">:</span>
            <span class="n">all_zero</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  m=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">integral</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">all_zero</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  All integrals are zero (as expected)&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ë³µì†Œ ì§€ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 í‘œí˜„<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>ë³µì†Œ ì§€ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜(complex exponential Fourier series)</strong>(í”íˆ <strong>ì§€ìˆ˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜</strong>ë¼ê³ ë„ í•¨):</p>
<p>$$x(t) = \sum_{n=-\infty}^{\infty} c_n \, e^{jn\omega_0 t}$$</p>
<p>ì—¬ê¸°ì„œ <strong>ë³µì†Œ í‘¸ë¦¬ì— ê³„ìˆ˜(complex Fourier coefficients)</strong>ëŠ”:</p>
<p>$$c_n = \frac{1}{T_0} \int_{T_0} x(t) \, e^{-jn\omega_0 t} \, dt, \quad n = 0, \pm 1, \pm 2, \ldots$$</p>
<h3 id="32">3.2 ì‚¼ê°í•¨ìˆ˜ ê³„ìˆ˜ì™€ì˜ ê´€ê³„<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>$$c_0 = a_0$$</p>
<p>$$c_n = \frac{a_n - jb_n}{2}, \quad c_{-n} = \frac{a_n + jb_n}{2} = c_n^* \quad (n > 0)$$</p>
<p>ì—­ê´€ê³„:</p>
<p>$$a_n = 2\text{Re}(c_n) = c_n + c_{-n}$$</p>
<p>$$b_n = -2\text{Im}(c_n) = j(c_n - c_{-n})$$</p>
<p><strong>ì‹¤ìˆ˜ ì‹ í˜¸</strong>ì˜ ê²½ìš°: $c_{-n} = c_n^*$ (ì¼¤ë ˆ ëŒ€ì¹­, conjugate symmetry).</p>
<h3 id="33">3.3 ë³µì†Œ í˜•íƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ <a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p>ë³µì†Œ ì§€ìˆ˜ í˜•íƒœëŠ” ì‹ í˜¸ì²˜ë¦¬ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì„ í˜¸ë©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ê°„ê²°í•œ í‘œê¸°</strong>: $a_n$ê³¼ $b_n$ì„ ë”°ë¡œ ì“°ëŠ” ëŒ€ì‹  ë‹¨ì¼ í•©ì‚°</li>
<li><strong>ê³ ìœ í•¨ìˆ˜ íŠ¹ì„±</strong>: $e^{jn\omega_0 t}$ëŠ” LTI ì‹œìŠ¤í…œì˜ ê³ ìœ í•¨ìˆ˜</li>
<li><strong>í‘¸ë¦¬ì— ë³€í™˜ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í™•ì¥</strong>: ë³€í™˜ì€ ì—°ì† ì£¼íŒŒìˆ˜ í™•ì¥</li>
<li><strong>ì£¼íŒŒìˆ˜ ì„±ë¶„ì˜ ì§ì ‘ ê°€ì‹œí™”</strong>: ì£¼íŒŒìˆ˜ $n\omega_0$ì—ì„œì˜ $c_n$ì´ í¬ê¸°ì™€ ìœ„ìƒ ëª¨ë‘ ì œê³µ</li>
</ol>
<h3 id="34">3.4 ìœ ë„<a class="header-link" href="#34" title="Permanent link">&para;</a></h3>
<p>ì˜¤ì¼ëŸ¬ ê³µì‹(Euler's formula)ìœ¼ë¡œ ì‹œì‘:</p>
<p>$$\cos(n\omega_0 t) = \frac{e^{jn\omega_0 t} + e^{-jn\omega_0 t}}{2}, \quad \sin(n\omega_0 t) = \frac{e^{jn\omega_0 t} - e^{-jn\omega_0 t}}{2j}$$</p>
<p>ì‚¼ê°í•¨ìˆ˜ ê¸‰ìˆ˜ì— ëŒ€ì…í•˜ê³  ì–‘ìˆ˜ ë° ìŒìˆ˜ $n$ì— ëŒ€í•´ $e^{jn\omega_0 t}$ë¥¼ ê°€ì§„ í•­ë“¤ì„ ì •ë¦¬í•˜ë©´ ë³µì†Œ í˜•íƒœê°€ ë„ì¶œë©ë‹ˆë‹¤.</p>
<hr />
<h2 id="4">4. í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-square-wave">4.1 êµ¬í˜•íŒŒ(Square Wave)<a class="header-link" href="#41-square-wave" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° $T_0$ì™€ ì§„í­ $A$ë¥¼ ê°€ì§„ <strong>êµ¬í˜•íŒŒ(square wave)</strong>:</p>
<p>$$x(t) = \begin{cases} A & 0 < t < T_0/2 \\ -A & T_0/2 < t < T_0 \end{cases}$$</p>
<p><strong>ì‚¼ê°í•¨ìˆ˜ ê³„ìˆ˜</strong> (ì§ì ‘ ê³„ì‚°):</p>
<p>$$a_0 = 0 \quad \text{(í‰ê· ê°’ 0)}$$</p>
<p>$$a_n = 0 \quad \text{(ëª¨ë“  } n \text{ì— ëŒ€í•´, ë°˜íŒŒ ëŒ€ì¹­ìœ¼ë¡œ ì¸í•´)}$$</p>
<p>$$b_n = \begin{cases} \frac{4A}{n\pi} & n \text{ì´ í™€ìˆ˜} \\ 0 & n \text{ì´ ì§ìˆ˜} \end{cases}$$</p>
<p>ë”°ë¼ì„œ:</p>
<p>$$x(t) = \frac{4A}{\pi} \left[\sin(\omega_0 t) + \frac{1}{3}\sin(3\omega_0 t) + \frac{1}{5}\sin(5\omega_0 t) + \cdots \right]$$</p>
<p><strong>ë³µì†Œ ê³„ìˆ˜</strong>:</p>
<p>$$c_n = \begin{cases} \frac{-2jA}{n\pi} & n \text{ì´ í™€ìˆ˜} \\ 0 & n \text{ì´ ì§ìˆ˜ (}n = 0\text{ í¬í•¨)} \end{cases}$$</p>
<h3 id="42-sawtooth-wave">4.2 í†±ë‹ˆíŒŒ(Sawtooth Wave)<a class="header-link" href="#42-sawtooth-wave" title="Permanent link">&para;</a></h3>
<p>í•œ ì£¼ê¸° $[0, T_0)$ ë™ì•ˆ $-A$ì—ì„œ $A$ë¡œ ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” í†±ë‹ˆíŒŒ:</p>
<p>$$x(t) = A\left(\frac{2t}{T_0} - 1\right), \quad 0 \leq t < T_0$$</p>
<p><strong>ê³„ìˆ˜</strong>:</p>
<p>$$a_0 = 0, \quad a_n = 0$$</p>
<p>$$b_n = \frac{-2A}{n\pi}(-1)^{n+1} = \frac{2A}{n\pi}(-1)^{n+1} \cdot (-1) = \frac{(-1)^{n+1} \cdot 2A}{n\pi}$$</p>
<p>ë” ì •í™•í•˜ê²Œ:</p>
<p>$$b_n = \frac{-2A}{n\pi} \quad \Rightarrow \quad x(t) = \frac{-2A}{\pi}\sum_{n=1}^{\infty} \frac{(-1)^n}{n} \sin(n\omega_0 t)$$</p>
<h3 id="43-triangle-wave">4.3 ì‚¼ê°íŒŒ(Triangle Wave)<a class="header-link" href="#43-triangle-wave" title="Permanent link">&para;</a></h3>
<p>ì§„í­ $A$ì™€ ì£¼ê¸° $T_0$ë¥¼ ê°€ì§„ ì‚¼ê°íŒŒ:</p>
<p>$$x(t) = \begin{cases} \frac{4A}{T_0}t & 0 \leq t \leq T_0/4 \\ A - \frac{4A}{T_0}(t - T_0/4) & T_0/4 \leq t \leq 3T_0/4 \\ -A + \frac{4A}{T_0}(t - 3T_0/4) & 3T_0/4 \leq t \leq T_0 \end{cases}$$</p>
<p>ë°˜íŒŒ ëŒ€ì¹­ì„ ê°€ì§„ ìš°í•¨ìˆ˜ì´ë¯€ë¡œ:</p>
<p>$$a_n = \begin{cases} \frac{8A}{n^2\pi^2} & n = 1, 5, 9, \ldots \\ \frac{-8A}{n^2\pi^2} & n = 3, 7, 11, \ldots \\ 0 & n \text{ì´ ì§ìˆ˜} \end{cases}$$</p>
<p>$$b_n = 0 \quad \text{ëª¨ë“  } n \text{ì— ëŒ€í•´}$$</p>
<p>ì½¤íŒ©íŠ¸ í˜•íƒœ:</p>
<p>$$x(t) = \frac{8A}{\pi^2} \sum_{k=0}^{\infty} \frac{(-1)^k}{(2k+1)^2} \cos((2k+1)\omega_0 t)$$</p>
<h3 id="44-rectified-sinusoid">4.4 ì •ë¥˜ ì •í˜„íŒŒ(Rectified Sinusoid, ì „íŒŒ ì •ë¥˜)<a class="header-link" href="#44-rectified-sinusoid" title="Permanent link">&para;</a></h3>
<p>$$x(t) = |A\sin(\omega_0 t)|$$</p>
<p>ì´ëŠ” ì£¼ê¸° $T_0/2$ë¥¼ ê°€ì§€ë¯€ë¡œ(ê¸°ë³¸ ì£¼íŒŒìˆ˜ $2\omega_0$), í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ì›ë˜ $\omega_0$ì˜ ì§ìˆ˜ ê³ ì¡°íŒŒë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<p>$$x(t) = \frac{2A}{\pi} - \frac{4A}{\pi}\sum_{n=1}^{\infty} \frac{1}{4n^2 - 1} \cos(2n\omega_0 t)$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Fourier coefficients computation ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_fourier_coefficients</span><span class="p">(</span><span class="n">x_func</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">N_harmonics</span><span class="p">,</span> <span class="n">N_points</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute complex Fourier coefficients numerically.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x_func: function of t returning signal values</span>
<span class="sd">        T0: fundamental period</span>
<span class="sd">        N_harmonics: number of harmonics (positive + negative)</span>
<span class="sd">        N_points: integration resolution</span>

<span class="sd">    Returns:</span>
<span class="sd">        n_values: harmonic indices</span>
<span class="sd">        cn: complex Fourier coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">N_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">/</span> <span class="n">N_points</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">x_func</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">n_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N_harmonics</span><span class="p">,</span> <span class="n">N_harmonics</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_values</span><span class="p">):</span>
        <span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_vals</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">n_values</span><span class="p">,</span> <span class="n">cn</span>


<span class="c1"># Square wave</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">def</span><span class="w"> </span><span class="nf">square_wave</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">))</span>

<span class="n">n_vals</span><span class="p">,</span> <span class="n">cn</span> <span class="o">=</span> <span class="n">compute_fourier_coefficients</span><span class="p">(</span><span class="n">square_wave</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Display non-negligible coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Square Wave Fourier Coefficients (|cn| &gt; 0.01):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;n&#39;</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;|cn|&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;angle(cn) (deg)&#39;</span><span class="si">:</span><span class="s2">&gt;16</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Expected |cn|&#39;</span><span class="si">:</span><span class="s2">&gt;14</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">cn</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">/</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10.6f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="si">:</span><span class="s2">&gt;16.1f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">expected</span><span class="si">:</span><span class="s2">&gt;14.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5">5. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ìˆ˜ë ´<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-dirichlet-conditions">5.1 ë””ë¦¬í´ë ˆ ì¡°ê±´(Dirichlet Conditions)<a class="header-link" href="#51-dirichlet-conditions" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ <strong>ë””ë¦¬í´ë ˆ ì¡°ê±´</strong>ì´ ë§Œì¡±ë˜ë©´, $x(t)$ê°€ ì—°ì†ì¸ ëª¨ë“  ì ì—ì„œ í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” $x(t)$ë¡œ ìˆ˜ë ´í•©ë‹ˆë‹¤:</p>
<ol>
<li>$x(t)$ëŠ” í•œ ì£¼ê¸°ì—ì„œ ì ˆëŒ€ ì ë¶„ ê°€ëŠ¥í•©ë‹ˆë‹¤: $\int_{T_0} |x(t)| \, dt < \infty$</li>
<li>$x(t)$ëŠ” í•œ ì£¼ê¸° ë‚´ì—ì„œ ìœ í•œí•œ ìˆ˜ì˜ ê·¹ëŒ€ê°’ê³¼ ê·¹ì†Œê°’ì„ ê°€ì§‘ë‹ˆë‹¤</li>
<li>$x(t)$ëŠ” í•œ ì£¼ê¸° ë‚´ì—ì„œ ìœ í•œí•œ ìˆ˜ì˜ ë¶ˆì—°ì†ì ì„ ê°€ì§‘ë‹ˆë‹¤</li>
</ol>
<p>ë¶ˆì—°ì†ì ì—ì„œ, í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” <strong>ì¤‘ê°„ê°’(midpoint)</strong>ìœ¼ë¡œ ìˆ˜ë ´í•©ë‹ˆë‹¤:</p>
<p>$$\text{FS}\{x(t_0)\} = \frac{x(t_0^+) + x(t_0^-)}{2}$$</p>
<h3 id="52">5.2 ìˆ˜ë ´ì˜ ì¢…ë¥˜<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>ì ë³„ ìˆ˜ë ´(Pointwise convergence)</strong>: $\lim_{N \to \infty} S_N(t) = x(t)$, ê° íŠ¹ì • $t$ì—ì„œ (ë¶ˆì—°ì†ì ì„ ì œì™¸í•  ìˆ˜ ìˆìŒ).</p>
<p><strong>ê· ë“± ìˆ˜ë ´(Uniform convergence)</strong>: $\lim_{N \to \infty} \max_t |x(t) - S_N(t)| = 0$. ì´ëŠ” ë” ê°•í•œ ì¡°ê±´ì´ë©° $x(t)$ì˜ ì—°ì†ì„±ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.</p>
<p><strong>í‰ê· ì œê³±(L2) ìˆ˜ë ´(Mean-square convergence)</strong>: $\lim_{N \to \infty} \int_{T_0} |x(t) - S_N(t)|^2 \, dt = 0$. ì´ëŠ” ì œê³± ì ë¶„ ê°€ëŠ¥í•œ ì‹ í˜¸ì— ëŒ€í•´ í•­ìƒ ì„±ë¦½í•©ë‹ˆë‹¤.</p>
<h3 id="53">5.3 ìˆ˜ë ´ ì†ë„<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ê³„ìˆ˜ê°€ ê°ì†Œí•˜ëŠ” ì†ë„ëŠ” ì‹ í˜¸ì˜ ë§¤ë„ëŸ¬ì›€(smoothness)ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ì‹ í˜¸ íŠ¹ì„±</th>
<th>ê³„ìˆ˜ ê°ì†Œìœ¨</th>
<th>ì˜ˆì‹œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ë¶ˆì—°ì†</td>
<td>$|c_n| \sim 1/n$</td>
<td>êµ¬í˜•íŒŒ</td>
</tr>
<tr>
<td>ì—°ì†ì´ì§€ë§Œ ë„í•¨ìˆ˜ê°€ ë¶ˆì—°ì†</td>
<td>$|c_n| \sim 1/n^2$</td>
<td>ì‚¼ê°íŒŒ</td>
</tr>
<tr>
<td>ì—°ì†ì´ê³  ì—°ì† ë„í•¨ìˆ˜ ë³´ìœ </td>
<td>$|c_n| \sim 1/n^3$</td>
<td>í¬ë¬¼ì„  íŒŒ</td>
</tr>
<tr>
<td>$k$ë²ˆ ë¯¸ë¶„ ê°€ëŠ¥</td>
<td>$|c_n| \sim 1/n^{k+1}$</td>
<td>ë” ë§¤ë„ëŸ¬ìš´ ì‹ í˜¸</td>
</tr>
<tr>
<td>ë¬´í•œíˆ ë¯¸ë¶„ ê°€ëŠ¥</td>
<td>$1/n$ì˜ ì„ì˜ ê±°ë“­ì œê³±ë³´ë‹¤ ë¹ ë¦„</td>
<td>ê°€ìš°ì‹œì•ˆ</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>í•µì‹¬</strong>: ë” ë§¤ë„ëŸ¬ìš´ ì‹ í˜¸ëŠ” ë” ë¹ ë¥´ê²Œ ê°ì†Œí•˜ëŠ” í‘¸ë¦¬ì— ê³„ìˆ˜ë¥¼ ê°€ì§€ë¯€ë¡œ, ì¢‹ì€ ê·¼ì‚¬ë¥¼ ìœ„í•´ ë” ì ì€ í•­ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¶ˆì—°ì†ì€ ëŠë¦° ($1/n$) ê°ì†Œë¥¼ ì•¼ê¸°í•˜ë©°, ì´ê²ƒì´ ê¹ìŠ¤ í˜„ìƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
</blockquote>
<hr />
<h2 id="6">6. ê¹ìŠ¤ í˜„ìƒ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ì„¤ëª…<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ê¸‰ìˆ˜ê°€ ì í”„ ë¶ˆì—°ì†ì„ ê°€ì§„ ì‹ í˜¸ë¥¼ ê·¼ì‚¬í•  ë•Œ, ë¶€ë¶„ í•© $S_N(t)$ì€ ë¶ˆì—°ì†ì  ê·¼ì²˜ì—ì„œ <strong>ë§ì‰(ringing, ì§„ë™)</strong> í˜„ìƒì„ ë³´ì…ë‹ˆë‹¤. $N$ì´ ì¦ê°€í• ìˆ˜ë¡:</p>
<ul>
<li>ì˜¤ë²„ìŠˆíŠ¸/ì–¸ë”ìŠˆíŠ¸ì˜ í­ì€ ì¢ì•„ì§‘ë‹ˆë‹¤ (ë¶ˆì—°ì†ì ì— ë” ê°€ê¹Œì´ ì´ë™)</li>
<li><strong>ìµœëŒ€ ì˜¤ë²„ìŠˆíŠ¸ëŠ” $N$ì— ê´€ê³„ì—†ì´ ì í”„ í¬ê¸°ì˜ ì•½ 9%</strong>ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤</li>
</ul>
<p>ì´ê²ƒì´ J. Willard Gibbsì˜ ì´ë¦„ì„ ë”´ <strong>ê¹ìŠ¤ í˜„ìƒ(Gibbs phenomenon)</strong>ì…ë‹ˆë‹¤.</p>
<h3 id="62">6.2 ìˆ˜í•™ì  ì„¤ëª…<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>ë‹¨ìœ„ ê³„ë‹¨ ë¶ˆì—°ì†(0ì—ì„œ 1ë¡œ ì í”„)ì— ëŒ€í•´, ê¹ìŠ¤ ì˜¤ë²„ìŠˆíŠ¸ëŠ” ë‹¤ìŒìœ¼ë¡œ ìˆ˜ë ´í•©ë‹ˆë‹¤:</p>
<p>$$\frac{1}{\pi} \int_0^{\pi} \frac{\sin(u)}{u} \, du - \frac{1}{2} \approx 0.0895$$</p>
<p>ì´ëŠ” í‘¸ë¦¬ì— ë¶€ë¶„ í•©ì˜ ìµœëŒ€ê°’ì´ $0.5$ ëŒ€ì‹  ì•½ $\frac{1}{2} + 0.0895 = 0.5895$ì— ë„ë‹¬í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ë©°, ì í”„ì˜ ì•½ <strong>8.95%</strong>ì˜ ì˜¤ë²„ìŠˆíŠ¸ì— í•´ë‹¹í•©ë‹ˆë‹¤.</p>
<h3 id="63">6.3 ì‹¤ìš©ì  ì‹œì‚¬ì <a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<ul>
<li>ê¹ìŠ¤ í˜„ìƒì€ í‘¸ë¦¬ì— ê¸‰ìˆ˜ì— ë‚´ì¬ëœ ê²ƒìœ¼ë¡œ, ë” ë§ì€ í•­ì„ ì¶”ê°€í•´ë„ ì œê±°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</li>
<li><strong>ìœˆë„ì‰(windowing)</strong>(ì˜ˆ: Fejer í•©ì‚°, Lanczos ì‹œê·¸ë§ˆ ì¸ìˆ˜)ìœ¼ë¡œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
<li>í•„í„° ì„¤ê³„ì—ì„œëŠ” <strong>í†µê³¼ëŒ€ì—­ ë¦¬í”Œ(passband ripple)</strong>ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤ (ë ˆìŠ¨ 09 ì°¸ì¡°)</li>
<li>ì˜ìƒ ì²˜ë¦¬ì—ì„œëŠ” ë‚ ì¹´ë¡œìš´ ì—ì§€ì—ì„œ <strong>ë§ì‰ ì•„í‹°íŒ©íŠ¸(ringing artifacts)</strong>ë¥¼ ìœ ë°œí•©ë‹ˆë‹¤</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Gibbs phenomenon demonstration ---</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

<span class="c1"># Square wave Fourier series partial sums</span>
<span class="k">def</span><span class="w"> </span><span class="nf">square_fourier_partial</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Partial sum of square wave Fourier series with N harmonics.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># odd harmonics only</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># True square wave</span>
<span class="n">x_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">N_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">N_values</span><span class="p">):</span>
    <span class="n">S_N</span> <span class="o">=</span> <span class="n">square_fourier_partial</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square wave&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">S_N</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$S_</span><span class="se">{{</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="se">}}</span><span class="s1">(t)$&#39;</span><span class="p">)</span>

    <span class="c1"># Mark the Gibbs overshoot</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="c1"># Find max near discontinuity at t=0</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">S_N</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
        <span class="n">overshoot_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overshoot: </span><span class="si">{</span><span class="n">overshoot_pct</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">max_val</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> harmonics&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t / </span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Gibbs Phenomenon: Fourier Series of Square Wave&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gibbs_phenomenon.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Measure overshoot vs N</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Gibbs Overshoot vs Number of Harmonics ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;N&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Max Value&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Overshoot %&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">1001</span><span class="p">]:</span>
    <span class="n">t_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">square_fourier_partial</span><span class="p">(</span><span class="n">t_fine</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">overshoot</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">max_val</span><span class="si">:</span><span class="s2">&gt;10.6f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">overshoot</span><span class="si">:</span><span class="s2">&gt;11.4f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7">7. íŒŒë¥´ì„¸ë°œ ì •ë¦¬<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ì§„ìˆ <a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p><strong>íŒŒë¥´ì„¸ë°œ ì •ë¦¬(Parseval's theorem)</strong>(í‘¸ë¦¬ì— ê¸‰ìˆ˜ì— ëŒ€í•œ)ëŠ” ì£¼ê¸° ì‹ í˜¸ì˜ í‰ê·  ì „ë ¥ì´ í‘¸ë¦¬ì— ê³„ìˆ˜ì˜ ì œê³± í¬ê¸°ì˜ í•©ê³¼ ê°™ë‹¤ê³  ì§„ìˆ í•©ë‹ˆë‹¤:</p>
<p>$$\frac{1}{T_0} \int_{T_0} |x(t)|^2 \, dt = \sum_{n=-\infty}^{\infty} |c_n|^2$$</p>
<p>ì‚¼ê°í•¨ìˆ˜ ê³„ìˆ˜ë¡œ í‘œí˜„í•˜ë©´:</p>
<p>$$\frac{1}{T_0} \int_{T_0} |x(t)|^2 \, dt = a_0^2 + \frac{1}{2}\sum_{n=1}^{\infty} (a_n^2 + b_n^2) = \sum_{n=0}^{\infty} \frac{C_n^2}{2 - \delta_{n0}}$$</p>
<h3 id="72">7.2 í•´ì„<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<p>íŒŒë¥´ì„¸ë°œ ì •ë¦¬ëŠ” <strong>ì—ë„ˆì§€ ë³´ì¡´(conservation of energy)</strong> ì§„ìˆ ì…ë‹ˆë‹¤:</p>
<ul>
<li><strong>ì¢Œë³€</strong>: ì‹œê°„ ì˜ì—­ì—ì„œ ê³„ì‚°ëœ ì´ í‰ê·  ì „ë ¥</li>
<li><strong>ìš°ë³€</strong>: ê° ê³ ì¡°íŒŒì˜ ì „ë ¥ ê¸°ì—¬ì˜ í•©</li>
</ul>
<p>ê° ê³ ì¡°íŒŒ $n$ì€ ì´ ì „ë ¥ì— $|c_n|^2 + |c_{-n}|^2 = 2|c_n|^2$ ($n \neq 0$)ì˜ ì „ë ¥ì„ ê¸°ì—¬í•©ë‹ˆë‹¤.</p>
<h3 id="73">7.3 ì˜ˆ: êµ¬í˜•íŒŒ ì „ë ¥<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<p>ì§„í­ $A$ë¥¼ ê°€ì§„ êµ¬í˜•íŒŒì— ëŒ€í•´:</p>
<p>$$P_x = \frac{1}{T_0} \int_{T_0} A^2 \, dt = A^2$$</p>
<p>í‘¸ë¦¬ì— ê³„ìˆ˜ë¡œë¶€í„° (í™€ìˆ˜ $n$ì— ëŒ€í•´ $|c_n| = 2A/(n\pi)$):</p>
<p>$$\sum_{n \text{ í™€ìˆ˜}} |c_n|^2 = 2 \sum_{k=0}^{\infty} \left(\frac{2A}{(2k+1)\pi}\right)^2 = \frac{8A^2}{\pi^2} \sum_{k=0}^{\infty} \frac{1}{(2k+1)^2} = \frac{8A^2}{\pi^2} \cdot \frac{\pi^2}{8} = A^2 \quad \checkmark$$</p>
<p>ë˜í•œ ì´ë¡œë¶€í„° ì•„ë¦„ë‹¤ìš´ í•­ë“±ì‹ì´ ì¦ëª…ë©ë‹ˆë‹¤: $\sum_{k=0}^{\infty} \frac{1}{(2k+1)^2} = \frac{\pi^2}{8}$.</p>
<h3 id="74">7.4 ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼<a class="header-link" href="#74" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° ì‹ í˜¸ì˜ <strong>ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼(power spectrum)</strong>ì€ ì£¼íŒŒìˆ˜ $n\omega_0$ì— ëŒ€í•´ ê°’ $\{|c_n|^2\}$ë¥¼ ë‚˜íƒ€ë‚¸ ê²ƒì…ë‹ˆë‹¤. ì „ë ¥ì´ ê³ ì¡°íŒŒì— ì–´ë–»ê²Œ ë¶„í¬ë˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Parseval&#39;s theorem verification ---</span>

<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Square wave</span>
<span class="k">def</span><span class="w"> </span><span class="nf">square_wave</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">square_wave</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Time-domain power</span>
<span class="n">P_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Frequency-domain power (Parseval&#39;s)</span>
<span class="n">N_max</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">n_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N_max</span><span class="p">,</span> <span class="n">N_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_vals</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_vals</span><span class="p">):</span>
    <span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

<span class="n">P_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Cumulative power contribution</span>
<span class="n">cn_positive</span> <span class="o">=</span> <span class="n">cn</span><span class="p">[</span><span class="n">n_vals</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">n_positive</span> <span class="o">=</span> <span class="n">n_vals</span><span class="p">[</span><span class="n">n_vals</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">power_each</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn_positive</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">power_each</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># double for n &gt; 0 (conjugate symmetry)</span>
<span class="n">P_cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">power_each</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Parseval&#39;s Theorem Verification (Square Wave) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time-domain power:      P = </span><span class="si">{</span><span class="n">P_time</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frequency-domain power: P = </span><span class="si">{</span><span class="n">P_freq</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">P_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P_freq</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># How many harmonics capture 99% of power?</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="o">*</span> <span class="n">P_time</span>
<span class="n">n_99</span> <span class="o">=</span> <span class="n">n_positive</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">P_cumulative</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Harmonics for 99% power: n = </span><span class="si">{</span><span class="n">n_99</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Power spectrum</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_positive</span><span class="p">[:</span><span class="mi">30</span><span class="p">],</span> <span class="n">power_each</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span> <span class="o">/</span> <span class="n">P_time</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
             <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum (</span><span class="si">% o</span><span class="s1">f Total Power)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Harmonic number n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power contribution (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Cumulative power</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_positive</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">P_cumulative</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">/</span> <span class="n">P_time</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;r-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;99%&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95%&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cumulative Power (Parseval&#39;s)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of harmonics included&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative power (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;parseval_theorem.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì„  ìŠ¤í™íŠ¸ëŸ¼<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ì •ì˜<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° ì‹ í˜¸ì˜ ìŠ¤í™íŠ¸ëŸ¼ì€ <strong>ì´ì‚°ì (discrete)</strong>(ë¹„ì£¼ê¸° ì‹ í˜¸ì˜ ì—°ì† ìŠ¤í™íŠ¸ëŸ¼ê³¼ ëŒ€ì¡°ì ìœ¼ë¡œ, $\omega_0$ì˜ ë°°ìˆ˜ì—ì„œ ì„ ë“¤ì˜ ì§‘í•©)ì…ë‹ˆë‹¤ (ë ˆìŠ¨ 04 ì°¸ì¡°).</p>
<p><strong>ì„  ìŠ¤í™íŠ¸ëŸ¼(line spectrum)</strong>ì€ ë‘ ê°œì˜ ê·¸ë˜í”„ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ì§„í­ ìŠ¤í™íŠ¸ëŸ¼(Amplitude spectrum)</strong>: $|c_n|$ ëŒ€ $n\omega_0$ (ë˜ëŠ” ë‹¨ìˆœíˆ $n$ì— ëŒ€í•´)</li>
<li><strong>ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼(Phase spectrum)</strong>: $\angle c_n$ ëŒ€ $n\omega_0$</li>
</ol>
<p>ì‹¤ìˆ˜ ì‹ í˜¸ì˜ ê²½ìš°, ì§„í­ ìŠ¤í™íŠ¸ëŸ¼ì€ <strong>ìš°í•¨ìˆ˜</strong>($|c_n| = |c_{-n}|$)ì´ê³  ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼ì€ <strong>ê¸°í•¨ìˆ˜</strong>($\angle c_n = -\angle c_{-n}$)ì…ë‹ˆë‹¤.</p>
<h3 id="82">8.2 ë‹¨ì¸¡ ëŒ€ ì–‘ì¸¡ ìŠ¤í™íŠ¸ëŸ¼<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì¢…ë¥˜</th>
<th>ì£¼íŒŒìˆ˜ ë²”ìœ„</th>
<th>ì‚¬ìš©í•˜ëŠ” ê³„ìˆ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ì–‘ì¸¡(Two-sided)</strong></td>
<td>$-\infty < n < \infty$</td>
<td>ë³µì†Œ $c_n$</td>
</tr>
<tr>
<td><strong>ë‹¨ì¸¡(One-sided)</strong></td>
<td>$n \geq 0$</td>
<td>ì½¤íŒ©íŠ¸ $C_n = 2|c_n|$ ($C_0 = |c_0|$)</td>
</tr>
</tbody>
</table>
<p>ë‹¨ì¸¡ ìŠ¤í™íŠ¸ëŸ¼ì€ ì£¼íŒŒìˆ˜ $n\omega_0$ì—ì„œì˜ ì—ë„ˆì§€ê°€ $c_n$ê³¼ $c_{-n}$ ì‚¬ì´ì— ë¶„ë¦¬ë˜ê¸° ë•Œë¬¸ì— ($n > 0$ì— ëŒ€í•´) ë³µì†Œ ê³„ìˆ˜ í¬ê¸°ì˜ ë‘ ë°°ì¸ ì§„í­ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Line spectra for different waveforms ---</span>

<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">N_harm</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">waveforms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Square Wave&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">)),</span>
    <span class="s1">&#39;Sawtooth Wave&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)),</span>
    <span class="s1">&#39;Triangle Wave&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Half-Rectified Sine&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">)),</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveforms</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">waveforms</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">waveforms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Compute complex Fourier coefficients</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N_harm</span><span class="p">,</span> <span class="n">N_harm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_range</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_range</span><span class="p">):</span>
        <span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

    <span class="c1"># Time-domain signal</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Amplitude spectrum (two-sided)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Amplitude Spectrum $|c_n|$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Harmonic n&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|c_n|$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Phase spectrum (two-sided)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
    <span class="c1"># Zero out phase for negligible coefficients</span>
    <span class="n">phase</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">phase</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                      <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Phase Spectrum $</span><span class="se">\\</span><span class="s1">angle c_n$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Harmonic n&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;line_spectra.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì‘ìš©: í‘œì¤€ íŒŒí˜• ë¶„í•´<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê·¼ì‚¬ ê°¤ëŸ¬ë¦¬<a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ê¸‰ìˆ˜ê°€ í‘œì¤€ íŒŒí˜•ì„ ì ì§„ì ìœ¼ë¡œ ì¬êµ¬ì„±í•˜ëŠ” ë°©ì‹ì„ ì‹œê°í™”í•´ ë´…ì‹œë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Progressive Fourier reconstruction ---</span>

<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fourier_square</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Square wave: sum of (4/n*pi)*sin(n*t) for odd n.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fourier_sawtooth</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sawtooth: sum of (-2/n*pi)*(-1)^n * sin(n*t).&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fourier_triangle</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Triangle: sum of (8/n^2*pi^2)*(-1)^k * cos(n*t) for odd n.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># True waveforms</span>
<span class="n">square_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">sawtooth_true</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">triangle_true</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">waveforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Square Wave&#39;</span><span class="p">,</span> <span class="n">square_true</span><span class="p">,</span> <span class="n">fourier_square</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Sawtooth Wave&#39;</span><span class="p">,</span> <span class="n">sawtooth_true</span><span class="p">,</span> <span class="n">fourier_sawtooth</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Triangle Wave&#39;</span><span class="p">,</span> <span class="n">triangle_true</span><span class="p">,</span> <span class="n">fourier_triangle</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">N_terms_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveforms</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_terms_list</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="n">fourier_func</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">waveforms</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_terms_list</span><span class="p">):</span>
        <span class="n">x_approx</span> <span class="o">=</span> <span class="n">fourier_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x_approx</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> harmonics&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Fourier Series Convergence for Standard Waveforms&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fourier_convergence.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="92">9.2 ë¬¼ë¦¬ì  ì‘ìš©: ì—´ì „ë„<a class="header-link" href="#92" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ì›ë˜ Joseph Fourierê°€ ì—´ ë°©ì •ì‹(heat equation)ì„ í’€ê¸° ìœ„í•´ ê°œë°œí–ˆìŠµë‹ˆë‹¤. ì´ˆê¸° ì˜¨ë„ ë¶„í¬ $f(x)$ë¥¼ ê°€ì§€ê³  ì–‘ ëì´ 0ë„ë¡œ ìœ ì§€ëœ ê¸¸ì´ $L$ì˜ ê¸ˆì† ë§‰ëŒ€ë¥¼ ìƒê°í•´ ë´…ì‹œë‹¤.</p>
<p>ìœ„ì¹˜ $x$ì™€ ì‹œê°„ $t$ì—ì„œì˜ ì˜¨ë„ëŠ”:</p>
<p>$$u(x, t) = \sum_{n=1}^{\infty} b_n \sin\left(\frac{n\pi x}{L}\right) e^{-\alpha (n\pi/L)^2 t}$$</p>
<p>ì—¬ê¸°ì„œ $b_n$ì€ $f(x)$ì˜ í‘¸ë¦¬ì— ì‚¬ì¸ ê¸‰ìˆ˜ ê³„ìˆ˜ì´ê³  $\alpha$ëŠ” ì—´í™•ì‚°ìœ¨(thermal diffusivity)ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Heat equation solution using Fourier series ---</span>

<span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># rod length</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>     <span class="c1"># thermal diffusivity</span>
<span class="n">N_terms</span> <span class="o">=</span> <span class="mi">50</span>     <span class="c1"># Fourier terms</span>

<span class="c1"># Initial temperature: step function (hot in the middle)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initial_temp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.75</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Compute Fourier sine coefficients</span>
<span class="n">x_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">x_int</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f_x</span> <span class="o">=</span> <span class="n">initial_temp</span><span class="p">(</span><span class="n">x_int</span><span class="p">)</span>

<span class="n">bn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_terms</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_terms</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">bn</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">f_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_int</span> <span class="o">/</span> <span class="n">L</span><span class="p">),</span> <span class="n">x_int</span><span class="p">)</span>

<span class="c1"># Solution at various times</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">t_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_terms</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span> <span class="o">+=</span> <span class="n">bn</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t_val</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t_val</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Position x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature u(x, t)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Heat Equation: Fourier Series Solution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;heat_equation_fourier.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="93">9.3 ì‹ í˜¸ í•©ì„±: ê°€ì‚° ì‚¬ìš´ë“œ í•©ì„±<a class="header-link" href="#93" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ì˜¤ë””ì˜¤ ê³µí•™ì—ì„œ <strong>ê°€ì‚° í•©ì„±(additive synthesis)</strong>ì˜ ì´ë¡ ì  ê¸°ë°˜ì…ë‹ˆë‹¤. ì´ëŠ” ìˆœìˆ˜í•œ ìŒ(ì •í˜„íŒŒ)ì„ ë”í•˜ì—¬ ë³µì¡í•œ ì†Œë¦¬ë¥¼ ë§Œë“œëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Additive sound synthesis ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>  <span class="c1"># CD quality sampling rate</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">duration</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Synthesize different timbres at A4 (440 Hz)</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">440</span>

<span class="k">def</span><span class="w"> </span><span class="nf">synthesize</span><span class="p">(</span><span class="n">harmonics</span><span class="p">,</span> <span class="n">amplitudes</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Additive synthesis from harmonic specification.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">phases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">harmonics</span><span class="p">))</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">phi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">harmonics</span><span class="p">,</span> <span class="n">amplitudes</span><span class="p">,</span> <span class="n">phases</span><span class="p">):</span>
        <span class="n">signal</span> <span class="o">+=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phi</span><span class="p">)</span>
    <span class="c1"># Normalize</span>
    <span class="n">signal</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">signal</span>

<span class="c1"># Different timbres</span>
<span class="n">timbres</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pure Tone (1 harmonic)&#39;</span><span class="p">:</span> <span class="n">synthesize</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]),</span>
    <span class="s1">&#39;Clarinet-like (odd harmonics)&#39;</span><span class="p">:</span> <span class="n">synthesize</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="s1">&#39;Bright/Sawtooth (all harmonics)&#39;</span><span class="p">:</span> <span class="n">synthesize</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="p">[</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
    <span class="p">),</span>
    <span class="s1">&#39;Organ-like (specific harmonics)&#39;</span><span class="p">:</span> <span class="n">synthesize</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">timbres</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">timbres</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timbres</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="c1"># Time domain (show 3 cycles)</span>
    <span class="n">n_show</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">f0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">n_show</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">signal</span><span class="p">[:</span><span class="n">n_show</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> â€” Time Domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Frequency domain</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">freqs</span><span class="p">[:</span><span class="mi">30</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">//</span> <span class="n">fs</span><span class="p">],</span>
                      <span class="n">spectrum</span><span class="p">[:</span><span class="mi">30</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">//</span> <span class="n">fs</span><span class="p">],</span>
                      <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> â€” Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8000</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;additive_synthesis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10">10. ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 ì •ì˜<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° $N$ì„ ê°€ì§„ ì´ì‚°ì‹œê°„ ì£¼ê¸° ì‹ í˜¸ $x[n]$ì€ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p>$$x[n] = \sum_{k=0}^{N-1} c_k \, e^{j(2\pi/N)kn}$$</p>
<p>ì—¬ê¸°ì„œ <strong>ì´ì‚°ì‹œê°„(DT) í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê³„ìˆ˜</strong>ëŠ”:</p>
<p>$$c_k = \frac{1}{N} \sum_{n=0}^{N-1} x[n] \, e^{-j(2\pi/N)kn}, \quad k = 0, 1, \ldots, N-1$$</p>
<h3 id="102">10.2 ì—°ì†ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ì˜ ì£¼ìš” ì°¨ì´ì <a class="header-link" href="#102" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŠ¹ì„±</th>
<th>ì—°ì†ì‹œê°„(Continuous-Time)</th>
<th>ì´ì‚°ì‹œê°„(Discrete-Time)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ê³ ì¡°íŒŒ ìˆ˜</td>
<td>ë¬´í•œ</td>
<td>ìœ í•œ ($N$ê°œ)</td>
</tr>
<tr>
<td>ê³„ìˆ˜ ì¸ë±ìŠ¤ ë²”ìœ„</td>
<td>$n \in \mathbb{Z}$ (ë¬´í•œ)</td>
<td>$k = 0, 1, \ldots, N-1$ (ìœ í•œ)</td>
</tr>
<tr>
<td>ê¸‰ìˆ˜</td>
<td>ê·¼ì‚¬ (ì ˆì‚¬ëœ)</td>
<td><strong>ì •í™•í•œ</strong> í‘œí˜„</td>
</tr>
<tr>
<td>ìˆ˜ë ´ ë¬¸ì œ</td>
<td>ê¹ìŠ¤ í˜„ìƒ, ë””ë¦¬í´ë ˆ ì¡°ê±´</td>
<td>ì—†ìŒ (ìœ í•œ í•©)</td>
</tr>
</tbody>
</table>
<p>ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ì£¼ê¸° $N$ì„ ê°€ì§„ ì£¼ê¸° ìˆ˜ì—´ì´ $N$ê°œì˜ ë…ë¦½ ê°’ë§Œ ê°€ì§€ê¸° ë•Œë¬¸ì—, $N$ê°œì˜ ê³„ìˆ˜ë¡œ í•­ìƒ ì •í™•í•©ë‹ˆë‹¤.</p>
<h3 id="103-dft">10.3 DFTì™€ì˜ ì—°ê²°<a class="header-link" href="#103-dft" title="Permanent link">&para;</a></h3>
<p>ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê³„ìˆ˜ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ í•œ ì£¼ê¸°ì˜ <strong>ì´ì‚° í‘¸ë¦¬ì— ë³€í™˜(Discrete Fourier Transform, DFT)</strong>ì„ $1/N$ë¡œ ìŠ¤ì¼€ì¼í•œ ê²ƒì…ë‹ˆë‹¤. ì´ ì—°ê²°ì€ ë ˆìŠ¨ 06ì˜ í•µì‹¬ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Discrete-time Fourier series ---</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># period</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Example: discrete-time square wave</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># DT Fourier coefficients</span>
<span class="n">ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">ck</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span>

<span class="c1"># Reconstruction (should be exact)</span>
<span class="n">x_reconstructed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">x_reconstructed</span> <span class="o">+=</span> <span class="n">ck</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:      &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reconstructed: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_reconstructed</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max error:     &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_reconstructed</span><span class="p">))))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DT Signal $x[n]$ (period N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ck</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amplitude $|c_k|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ck</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
             <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase $</span><span class="se">\\</span><span class="s1">angle c_k$ (degrees)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dt_fourier_series.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-python">11. Python ì˜ˆì œ<a class="header-link" href="#11-python" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 ì¢…í•© í‘¸ë¦¬ì— ê¸‰ìˆ˜ ë¶„ì„ê¸°<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FourierSeriesAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete Fourier series analysis toolkit.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal_func</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Signal&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal_func</span> <span class="o">=</span> <span class="n">signal_func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">=</span> <span class="n">T0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">signal_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N_max</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute complex Fourier coefficients c_n for |n| &lt;= N_max.&quot;&quot;&quot;</span>
        <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N_max</span><span class="p">,</span> <span class="n">N_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_range</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_range</span><span class="p">):</span>
            <span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">cn</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">cn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reconstruct signal from Fourier coefficients.&quot;&quot;&quot;</span>
        <span class="n">x_approx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">cn</span><span class="p">):</span>
            <span class="n">x_approx</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_approx</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N_max</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">N_show</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete analysis with plots.&quot;&quot;&quot;</span>
        <span class="n">n_range</span><span class="p">,</span> <span class="n">cn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_coefficients</span><span class="p">(</span><span class="n">N_max</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

        <span class="c1"># 1. Original signal</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_plot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal_func</span><span class="p">(</span><span class="n">t_plot</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> â€” Time Domain&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t / Tâ‚€&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># 2. Amplitude spectrum</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amplitude Spectrum $|c_n|$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Harmonic n&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|c_n|$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># 3. Progressive reconstruction</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">t_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal_func</span><span class="p">(</span><span class="n">t_recon</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_show</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">N</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">N_show</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">n_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cn_sub</span> <span class="o">=</span> <span class="n">cn</span><span class="p">[(</span><span class="n">n_range</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">N</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">n_range</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">)]</span>
            <span class="n">x_approx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">n_sub</span><span class="p">,</span> <span class="n">cn_sub</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">x_approx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Progressive Reconstruction&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t / Tâ‚€&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># 4. Reconstruction error vs N</span>
        <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">N_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_test</span><span class="p">:</span>
            <span class="n">n_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cn_sub</span> <span class="o">=</span> <span class="n">cn</span><span class="p">[(</span><span class="n">n_range</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">N</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">n_range</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">)]</span>
            <span class="n">x_approx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">n_sub</span><span class="p">,</span> <span class="n">cn_sub</span><span class="p">)</span>
            <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_approx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">N_test</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error vs N&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of harmonics N&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MSE&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># 5. Power spectrum</span>
        <span class="n">ax5</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">P_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">power_contributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">n_pos</span> <span class="o">=</span> <span class="n">n_range</span><span class="p">[</span><span class="n">n_range</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">cn_pos</span> <span class="o">=</span> <span class="n">cn</span><span class="p">[</span><span class="n">n_range</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">P_cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn_pos</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Add symmetric part</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_pos</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">P_cumulative</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="o">-</span><span class="n">n</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_pos</span><span class="p">,</span> <span class="n">P_cumulative</span> <span class="o">/</span> <span class="n">P_total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;r-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;99%&#39;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cumulative Power (Parseval&#39;s)&quot;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Max harmonic&#39;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f total power&#39;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax5</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># 6. Phase spectrum</span>
        <span class="n">ax6</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
        <span class="n">phase</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">phase</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase Spectrum $</span><span class="se">\\</span><span class="s1">angle c_n$ (degrees)&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Harmonic n&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (Â°)&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fourier Series Analysis: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;fourier_analysis_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
                    <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Analyze different waveforms</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Square wave</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">FourierSeriesAnalyzer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">)),</span>
    <span class="n">T0</span><span class="p">,</span> <span class="s2">&quot;Square Wave&quot;</span>
<span class="p">)</span>
<span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>

<span class="c1"># Triangle wave</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">FourierSeriesAnalyzer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">T0</span><span class="p">,</span> <span class="s2">&quot;Triangle Wave&quot;</span>
<span class="p">)</span>
<span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
</code></pre></div>

<h3 id="112">11.2 ê¹ìŠ¤ í˜„ìƒ ì™„í™”<a class="header-link" href="#112" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Gibbs phenomenon mitigation using sigma factors ---</span>

<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># Square wave Fourier coefficients</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cn_square</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="c1"># Standard partial sum</span>
<span class="k">def</span><span class="w"> </span><span class="nf">partial_sum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">window_func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">cn_square</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">window_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">*=</span> <span class="n">window_func</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Sigma factors for Gibbs mitigation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lanczos_sigma</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lanczos sigma factor: sinc(n/N).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fejer_sigma</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fejer (Cesaro) kernel: 1 - |n|/N.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">raised_cosine_sigma</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised cosine (Hanning-like).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span>

<span class="c1"># Compare methods</span>
<span class="n">x_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Standard Fourier (N=30)&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Lanczos sigma factors&quot;</span><span class="p">,</span> <span class="n">lanczos_sigma</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Fejer (Cesaro) summation&quot;</span><span class="p">,</span> <span class="n">fejer_sigma</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Raised cosine window&quot;</span><span class="p">,</span> <span class="n">raised_cosine_sigma</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">methods</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">partial_sum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t / </span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Gibbs Phenomenon Mitigation Methods&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gibbs_mitigation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="113">11.3 ëŒ€í™”í˜• ê³„ìˆ˜ íƒìƒ‰ê¸°<a class="header-link" href="#113" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Effect of modifying individual Fourier coefficients ---</span>

<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">T0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">N_harm</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Start with square wave coefficients</span>
<span class="n">cn_original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_harm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N_harm</span><span class="p">,</span> <span class="n">N_harm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_range</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cn_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">reconstruct</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="n">n_range</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Original</span>
<span class="n">x_orig</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_original</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Square Wave (N=10)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Remove 3rd harmonic</span>
<span class="n">cn_no3</span> <span class="o">=</span> <span class="n">cn_original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cn_no3</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cn_no3</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x_no3</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_no3</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_no3</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No 3rd harmonic&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Remove 3rd Harmonic&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Double the 3rd harmonic</span>
<span class="n">cn_double3</span> <span class="o">=</span> <span class="n">cn_original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cn_double3</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">cn_double3</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">x_double3</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_double3</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_double3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3rd harmonic x2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Double the 3rd Harmonic&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add even harmonics</span>
<span class="n">cn_even</span> <span class="o">=</span> <span class="n">cn_original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
    <span class="n">idx_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n_range</span> <span class="o">==</span> <span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">idx_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n_range</span> <span class="o">==</span> <span class="o">-</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cn_even</span><span class="p">[</span><span class="n">idx_pos</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">cn_even</span><span class="p">[</span><span class="n">idx_neg</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">x_even</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_even</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_even</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+ even harmonics&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Add Even Harmonics (breaks half-wave symmetry)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Phase shift all harmonics by pi/4</span>
<span class="n">cn_phased</span> <span class="o">=</span> <span class="n">cn_original</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">n_range</span><span class="p">))</span>
<span class="n">x_phased</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_phased</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_phased</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Phase shifted&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase Shift Each Harmonic by $n </span><span class="se">\\</span><span class="s1">cdot </span><span class="se">\\</span><span class="s1">pi/4$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Random phases (same magnitude)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">cn_random_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cn_original</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cn_original</span><span class="p">)))</span>
<span class="c1"># Keep conjugate symmetry for real output</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_range</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cn_random_phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">cn_random_phase</span><span class="p">[</span><span class="n">n_range</span> <span class="o">==</span> <span class="o">-</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">x_random</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">cn_random_phase</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n_range</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_orig</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="n">x_random</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random phases&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random Phases (same magnitudes)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t / T_0$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Effect of Modifying Fourier Coefficients&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;coefficient_explorer.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. ìš”ì•½<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="_3">ì£¼ìš” ê³µì‹<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>í˜•íƒœ</th>
<th>ê¸‰ìˆ˜</th>
<th>ê³„ìˆ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì‚¼ê°í•¨ìˆ˜</td>
<td>$x(t) = a_0 + \sum_{n=1}^{\infty}[a_n\cos(n\omega_0 t) + b_n\sin(n\omega_0 t)]$</td>
<td>$a_0 = \frac{1}{T_0}\int x \, dt$, $a_n = \frac{2}{T_0}\int x\cos(n\omega_0 t) \, dt$, $b_n = \frac{2}{T_0}\int x\sin(n\omega_0 t) \, dt$</td>
</tr>
<tr>
<td>ë³µì†Œ ì§€ìˆ˜</td>
<td>$x(t) = \sum_{n=-\infty}^{\infty} c_n e^{jn\omega_0 t}$</td>
<td>$c_n = \frac{1}{T_0}\int x(t) e^{-jn\omega_0 t} \, dt$</td>
</tr>
<tr>
<td>ì½¤íŒ©íŠ¸</td>
<td>$x(t) = C_0 + \sum_{n=1}^{\infty} C_n\cos(n\omega_0 t + \phi_n)$</td>
<td>$C_n = \sqrt{a_n^2 + b_n^2}$, $\phi_n = -\arctan(b_n/a_n)$</td>
</tr>
</tbody>
</table>
<h3 id="_4">ê°œë… ê³„ì¸µ êµ¬ì¡°<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>            ì£¼ê¸° ì‹ í˜¸ x(t)
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                       â–¼
  ë””ë¦¬í´ë ˆ ì¡°ê±´            í‘¸ë¦¬ì— ê³„ìˆ˜
  (ìˆ˜ë ´ ê²€ì¦)             cn ë˜ëŠ” (an, bn)
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼           â–¼           â–¼
              ì„  ìŠ¤í™íŠ¸ëŸ¼  íŒŒë¥´ì„¸ë°œ    ì¬êµ¬ì„±
              |cn| vs n   ì „ë ¥ í•©     ë¶€ë¶„ í•©
                                        ê¹ìŠ¤ í˜„ìƒ
</code></pre></div>

<h3 id="_5">í•µì‹¬ ì •ë¦¬<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>í‘¸ë¦¬ì— ê¸‰ìˆ˜</strong>ëŠ” ì£¼ê¸° ì‹ í˜¸ë¥¼ ê³ ì¡°íŒŒì ìœ¼ë¡œ ê´€ë ¨ëœ ì •í˜„íŒŒë¡œ ë¶„í•´í•©ë‹ˆë‹¤</li>
<li>ì‚¼ê°í•¨ìˆ˜ì˜ <strong>ì§êµì„±(orthogonality)</strong>ì´ ìˆ˜í•™ì  ê¸°ë°˜ì…ë‹ˆë‹¤</li>
<li><strong>ë³µì†Œ ì§€ìˆ˜ í˜•íƒœ</strong>ê°€ ì‹ í˜¸ì²˜ë¦¬ì—ì„œ ì„ í˜¸ë©ë‹ˆë‹¤ (LTI ì‹œìŠ¤í…œì˜ ê³ ìœ í•¨ìˆ˜)</li>
<li>ê³„ìˆ˜ <strong>ê°ì†Œìœ¨</strong>ì€ ì‹ í˜¸ì˜ ë§¤ë„ëŸ¬ì›€ì„ ë°˜ì˜í•©ë‹ˆë‹¤ (ë¶ˆì—°ì†ì—ì„œ $1/n$, ì—°ì†ì—ì„œ $1/n^2$)</li>
<li><strong>ê¹ìŠ¤ í˜„ìƒ</strong>: ë¶ˆì—°ì†ì ì—ì„œ 9% ì˜¤ë²„ìŠˆíŠ¸ëŠ” ë” ë§ì€ í•­ì„ ì¶”ê°€í•´ë„ ì œê±°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</li>
<li><strong>íŒŒë¥´ì„¸ë°œ ì •ë¦¬</strong>: ì „ë ¥ì€ ì‹œê°„ ì˜ì—­ê³¼ ì£¼íŒŒìˆ˜ ì˜ì—­ ì‚¬ì´ì—ì„œ ë³´ì¡´ë©ë‹ˆë‹¤</li>
<li><strong>ì„  ìŠ¤í™íŠ¸ëŸ¼</strong>ì€ ì£¼ê¸° ì‹ í˜¸ì˜ ì™„ì „í•œ ì£¼íŒŒìˆ˜ ì˜ì—­ ê·¸ë¦¼ì„ ì œê³µí•©ë‹ˆë‹¤</li>
</ol>
<hr />
<h2 id="13_1">13. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#13_1" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ ë¬¸ì œ 1: í‘¸ë¦¬ì— ê³„ìˆ˜ ê³„ì‚°<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì‹ í˜¸ë“¤ì— ëŒ€í•œ í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê³„ìˆ˜(ì‚¼ê°í•¨ìˆ˜ ë° ë³µì†Œ ì§€ìˆ˜ ëª¨ë‘)ë¥¼ ê³„ì‚°í•˜ì„¸ìš”:</p>
<ol>
<li>$x(t) = |\sin(\omega_0 t)|$ (ì „íŒŒ ì •ë¥˜ ì‚¬ì¸)</li>
<li>$x(t) = \cos^2(\omega_0 t)$ (íŒíŠ¸: ë¨¼ì € ì‚¼ê°í•¨ìˆ˜ í•­ë“±ì‹ ì‚¬ìš©)</li>
<li>í„ìŠ¤ ì—´(pulse train): $x(t) = 1$ ($|t| < \tau/2$), $x(t) = 0$ ($\tau/2 < |t| < T_0/2$), ì£¼ê¸° $T_0$ë¡œ ì£¼ê¸°ì </li>
</ol>
<h3 id="2_1">ì—°ìŠµ ë¬¸ì œ 2: ëŒ€ì¹­ì„± í™œìš©<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ê° ì‹ í˜¸ì— ëŒ€í•´ ëŒ€ì¹­ ìœ í˜•(ìš°í•¨ìˆ˜, ê¸°í•¨ìˆ˜, ë°˜íŒŒ)ì„ íŒŒì•…í•˜ê³ , ê³„ì‚°í•˜ì§€ ì•Šê³  ì–´ë–¤ í‘¸ë¦¬ì— ê³„ìˆ˜ê°€ 0ì¸ì§€ ê²°ì •í•˜ì„¸ìš”:</p>
<ol>
<li>$[-\pi, \pi]$ì—ì„œ $x(t) = t^2$, ì£¼ê¸°ì </li>
<li>$[-\pi, \pi]$ì—ì„œ $x(t) = t$, ì£¼ê¸°ì </li>
<li>$[-\pi, \pi]$ì—ì„œ $x(t) = |t|$, ì£¼ê¸°ì </li>
<li>ê³„ë‹¨í•¨ìˆ˜: $0 < t < \pi$ì—ì„œ $x(t) = +1$, $-\pi < t < 0$ì—ì„œ $x(t) = -1$</li>
</ol>
<h3 id="3_1">ì—°ìŠµ ë¬¸ì œ 3: ê¹ìŠ¤ í˜„ìƒ íƒêµ¬<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<ol>
<li>$N = 5, 21, 101$ì— ëŒ€í•´ êµ¬í˜•íŒŒì˜ í‘¸ë¦¬ì— ë¶€ë¶„ í•© $S_N(t)$ë¥¼ ê³„ì‚°í•˜ê³  ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ì„¸ìš”</li>
<li>ê° $N$ì— ëŒ€í•´ ìµœëŒ€ ì˜¤ë²„ìŠˆíŠ¸ë¥¼ ìˆ˜ì¹˜ì ìœ¼ë¡œ êµ¬í•˜ì„¸ìš”</li>
<li>ì˜¤ë²„ìŠˆíŠ¸ ë¹„ìœ¨ì´ ì•½ 8.95%ë¡œ ìˆ˜ë ´í•¨ì„ ë³´ì´ì„¸ìš”</li>
<li>Lanczos ì‹œê·¸ë§ˆ ì¸ìˆ˜ë¥¼ êµ¬í˜„í•˜ê³  ì¤„ì–´ë“  ì˜¤ë²„ìŠˆíŠ¸ë¥¼ ì‹œì—°í•˜ì„¸ìš”</li>
<li>í‘œì¤€ í‘¸ë¦¬ì— ëŒ€ Lanczos ìœˆë„ìš° ë¶€ë¶„ í•©ì˜ MSEë¥¼ ë¹„êµí•˜ì„¸ìš”</li>
</ol>
<h3 id="4_1">ì—°ìŠµ ë¬¸ì œ 4: íŒŒë¥´ì„¸ë°œ ì •ë¦¬ ì‘ìš©<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<ol>
<li>íŒŒë¥´ì„¸ë°œ ì •ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ í†±ë‹ˆíŒŒì—ì„œ $\sum_{n=1}^{\infty} \frac{1}{n^2}$ë¥¼ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>íŒŒë¥´ì„¸ë°œ ì •ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ ì‚¼ê°íŒŒì—ì„œ $\sum_{k=0}^{\infty} \frac{1}{(2k+1)^4}$ë¥¼ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>ë“€í‹° ì‚¬ì´í´ $d = \tau/T_0$ë¥¼ ê°€ì§„ í„ìŠ¤ ì—´ì— ëŒ€í•´:</li>
<li>$d$ì˜ í•¨ìˆ˜ë¡œ ì „ë ¥ì„ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>$d = 0.1, 0.25, 0.5$ì— ëŒ€í•´ ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ì„ ê·¸ë¦¬ì„¸ìš”</li>
<li>ê° ê²½ìš°ì— ëŒ€í•´ íŒŒë¥´ì„¸ë°œ ì •ë¦¬ë¥¼ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê²€ì¦í•˜ì„¸ìš”</li>
</ol>
<h3 id="5_1">ì—°ìŠµ ë¬¸ì œ 5: ì‹ í˜¸ ì¬êµ¬ì„± ë„ì „<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>$T_0 = 1$ sì¸ ì£¼ê¸° ì‹ í˜¸ì˜ ì§„í­ ìŠ¤í™íŠ¸ëŸ¼ $|c_n|$ê³¼ ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼ $\angle c_n$ ($|n| \leq 10$)ë§Œ ì£¼ì–´ì§„ ê²½ìš°:</p>
<table>
<thead>
<tr>
<th>$n$</th>
<th>$|c_n|$</th>
<th>$\angle c_n$ (rad)</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0.5</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0.8</td>
<td>$-\pi/4$</td>
</tr>
<tr>
<td>2</td>
<td>0.3</td>
<td>$-\pi/2$</td>
</tr>
<tr>
<td>3</td>
<td>0.6</td>
<td>$\pi/3$</td>
</tr>
<tr>
<td>5</td>
<td>0.2</td>
<td>$-\pi/6$</td>
</tr>
<tr>
<td>7</td>
<td>0.1</td>
<td>$\pi/4$</td>
</tr>
</tbody>
</table>
<ol>
<li>$x(t)$ë¥¼ ì¬êµ¬ì„±í•˜ê³  ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ì„¸ìš”</li>
<li>íŒŒë¥´ì„¸ë°œ ì •ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ $x(t)$ì˜ í‰ê·  ì „ë ¥ì„ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>ëª¨ë“  ìœ„ìƒì„ 0ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì‹ í˜¸ ëª¨ì–‘ì€ ì–´ë–»ê²Œ ë³€í•˜ë‚˜ìš”?</li>
<li>ëª¨ë“  ìœ„ìƒì„ ë¬´ì‘ìœ„ë¡œ ì„¤ì •í•˜ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?</li>
</ol>
<h3 id="6_1">ì—°ìŠµ ë¬¸ì œ 6: ì‹¤ì œ ì‹ í˜¸ì˜ í‘¸ë¦¬ì— ê¸‰ìˆ˜<a class="header-link" href="#6_1" title="Permanent link">&para;</a></h3>
<ol>
<li>100 Hzì˜ í†±ë‹ˆíŒŒë¥¼ 44100 Hzë¡œ 0.1ì´ˆ ë™ì•ˆ ìƒ˜í”Œë§í•˜ì—¬ ìƒì„±í•˜ì„¸ìš”</li>
<li>í•´ì„ì  ê³µì‹ê³¼ ìˆ˜ì¹˜ ì ë¶„ ëª¨ë‘ë¥¼ ì‚¬ìš©í•˜ì—¬ í‘¸ë¦¬ì— ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>ë‘ ê²°ê³¼ë¥¼ ë¹„êµí•˜ì„¸ìš”</li>
<li>ì²« 5, 10, 20ê°œì˜ ê³ ì¡°íŒŒë§Œì„ ì‚¬ìš©í•˜ì—¬ ì‹ í˜¸ë¥¼ ì¬êµ¬ì„±í•˜ì„¸ìš”</li>
<li>ì›ë³¸ê³¼ ë¹„êµí•œ ê° ì¬êµ¬ì„±ì˜ SNR(dB)ì„ ê³„ì‚°í•˜ì„¸ìš”</li>
</ol>
<h3 id="7-lti">ì—°ìŠµ ë¬¸ì œ 7: í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ LTI ì‹œìŠ¤í…œ<a class="header-link" href="#7-lti" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° ì…ë ¥ $x(t) = \sum c_n e^{jn\omega_0 t}$ê°€ ì£¼íŒŒìˆ˜ ì‘ë‹µ $H(j\omega)$ë¥¼ ê°€ì§„ LTI ì‹œìŠ¤í…œì— ì¸ê°€ë©ë‹ˆë‹¤.</p>
<ol>
<li>ì¶œë ¥ë„ ë™ì¼í•œ ì£¼ê¸°ë¥¼ ê°€ì§„ ì£¼ê¸° ì‹ í˜¸ì„ì„ ë³´ì´ì„¸ìš”</li>
<li>ì¶œë ¥ í‘¸ë¦¬ì— ê³„ìˆ˜ê°€ $d_n = c_n \cdot H(jn\omega_0)$ì„ì„ ë³´ì´ì„¸ìš”</li>
<li>$f_0 = 100$ Hzì¸ êµ¬í˜•íŒŒê°€ ì°¨ë‹¨ ì£¼íŒŒìˆ˜ 500 Hzì˜ RC ì €ì—­í†µê³¼ í•„í„°ë¥¼ í†µê³¼í•©ë‹ˆë‹¤. ì¶œë ¥ í‘¸ë¦¬ì— ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ê³  ì¶œë ¥ ì‹ í˜¸ë¥¼ ì¬êµ¬ì„±í•˜ì„¸ìš”.</li>
<li>í•„í„°ê°€ ê¹ìŠ¤ í˜„ìƒì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ë‚˜ìš”?</li>
</ol>
<h3 id="8_1">ì—°ìŠµ ë¬¸ì œ 8: ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜<a class="header-link" href="#8_1" title="Permanent link">&para;</a></h3>
<ol>
<li>ì´ì‚° êµ¬í˜•íŒŒë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì£¼ê¸° $N = 32$ì˜ ì´ì‚°ì‹œê°„ ì£¼ê¸° ìˆ˜ì—´ $x[n]$ì„ ìƒì„±í•˜ì„¸ìš”</li>
<li>ëª¨ë“  $N = 32$ê°œì˜ ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”</li>
<li>ì¬êµ¬ì„±ì´ ì •í™•í•¨ì„ ê²€ì¦í•˜ì„¸ìš”</li>
<li><code>np.fft.fft</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•œ DFTì™€ ë¹„êµí•˜ì„¸ìš”</li>
<li>ì´ì‚°ì‹œê°„ í‘¸ë¦¬ì— ê¸‰ìˆ˜ì— ê¹ìŠ¤ í˜„ìƒì´ ì—†ìŒì„ ë³´ì´ì„¸ìš” (ì´ìœ  ì„¤ëª…)</li>
</ol>
<hr />
<h2 id="14">14. ì°¸ê³  ë¬¸í—Œ<a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<ol>
<li>Oppenheim, A. V. &amp; Willsky, A. S. <em>Signals and Systems</em> (2nd ed.), Ch. 3-4. Prentice Hall, 1997.</li>
<li>Haykin, S. &amp; Van Veen, B. <em>Signals and Systems</em> (2nd ed.), Ch. 3, 6. Wiley, 2003.</li>
<li>Lathi, B. P. &amp; Green, R. A. <em>Linear Systems and Signals</em> (3rd ed.), Ch. 6. Oxford University Press, 2018.</li>
<li>Boas, M. L. <em>Mathematical Methods in the Physical Sciences</em> (3rd ed.), Ch. 7. Wiley, 2006.</li>
<li>Smith, S. W. <em>The Scientist and Engineer's Guide to Digital Signal Processing</em>, Ch. 13. California Technical Publishing, 1997.</li>
</ol>
<hr />
<p><a href="./02_LTI_Systems_and_Convolution.md">ì´ì „: 02. LTI ì‹œìŠ¤í…œê³¼ í•©ì„±ê³±</a> | <a href="./04_Continuous_Fourier_Transform.md">ë‹¤ìŒ: 04. ì—°ì† í‘¸ë¦¬ì— ë³€í™˜</a> | <a href="./00_Overview.md">ê°œìš”</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/02_LTI_Systems_and_Convolution.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">LTI ì‹œìŠ¤í…œê³¼ í•©ì„±ê³±</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/04_Continuous_Fourier_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}