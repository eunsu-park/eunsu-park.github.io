{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/03_Fourier_Series_and_Applications.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/05_Sampling_and_Reconstruction.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">í‘œë³¸í™”ì™€ ì‹ í˜¸ ë³µì›</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ëª©ì°¨</a></li>
<li><a href="#1">1. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì—ì„œ í‘¸ë¦¬ì— ë³€í™˜ìœ¼ë¡œ</a><ul>
<li><a href="#11">1.1 ê·¹í•œ ê³¼ì •</a></li>
<li><a href="#12">1.2 ë¬¼ë¦¬ì  í•´ì„</a></li>
</ul>
</li>
<li><a href="#2">2. í‘¸ë¦¬ì— ë³€í™˜ì˜ ì •ì˜</a><ul>
<li><a href="#21">2.1 ìˆœë°©í–¥ ë³€í™˜ (ë¶„ì„)</a></li>
<li><a href="#22">2.2 ì—­ë³€í™˜ (í•©ì„±)</a></li>
<li><a href="#23">2.3 ëŒ€ì•ˆì  í‘œê¸° ê·œì•½</a></li>
<li><a href="#24">2.4 í¬ê¸°ì™€ ìœ„ìƒ</a></li>
</ul>
</li>
<li><a href="#3">3. ì¡´ì¬ ì¡°ê±´</a><ul>
<li><a href="#31">3.1 ì¶©ë¶„ ì¡°ê±´</a></li>
<li><a href="#32">3.2 ë” ë„“ì€ ì¡´ì¬ ì¡°ê±´</a></li>
</ul>
</li>
<li><a href="#4">4. ì¼ë°˜ì ì¸ ë³€í™˜ ìŒ</a><ul>
<li><a href="#41">4.1 í‘¸ë¦¬ì— ë³€í™˜ ìŒ í‘œ</a></li>
<li><a href="#42">4.2 ìœ ë„ ì˜ˆì‹œ</a></li>
</ul>
</li>
<li><a href="#5">5. í‘¸ë¦¬ì— ë³€í™˜ì˜ ì„±ì§ˆ</a><ul>
<li><a href="#51-linearity">5.1 ì„ í˜•ì„±(Linearity)</a></li>
<li><a href="#52-time-shifting">5.2 ì‹œê°„ ì´ë™(Time Shifting)</a></li>
<li><a href="#53-frequency-shifting">5.3 ì£¼íŒŒìˆ˜ ì´ë™(Frequency Shifting) â€” ë³€ì¡°</a></li>
<li><a href="#54-time-scaling">5.4 ì‹œê°„ ìŠ¤ì¼€ì¼ë§(Time Scaling)</a></li>
<li><a href="#55-time-reversal">5.5 ì‹œê°„ ë°˜ì „(Time Reversal)</a></li>
<li><a href="#56-duality">5.6 ìŒëŒ€ì„±(Duality)</a></li>
<li><a href="#57-differentiation-in-time">5.7 ì‹œê°„ ë¯¸ë¶„(Differentiation in Time)</a></li>
<li><a href="#58-integration">5.8 ì ë¶„(Integration)</a></li>
<li><a href="#59-differentiation-in-frequency">5.9 ì£¼íŒŒìˆ˜ ë¯¸ë¶„(Differentiation in Frequency)</a></li>
<li><a href="#510">5.10 ì„±ì§ˆ ìš”ì•½ í‘œ</a></li>
</ul>
</li>
<li><a href="#6">6. í•©ì„±ê³± ì •ë¦¬</a><ul>
<li><a href="#61">6.1 ê³µì‹</a></li>
<li><a href="#62">6.2 ì¦ëª…</a></li>
<li><a href="#63-lti">6.3 ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ LTI ì‹œìŠ¤í…œ ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#7">7. ê³±ì…ˆ ì •ë¦¬(ìœˆë„ì‰)</a><ul>
<li><a href="#71">7.1 ê³µì‹</a></li>
<li><a href="#72-windowing">7.2 ìœˆë„ì‰(Windowing)</a></li>
<li><a href="#73-window-functions">7.3 ì°½ í•¨ìˆ˜(Window Functions)</a></li>
</ul>
</li>
<li><a href="#8">8. íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬</a><ul>
<li><a href="#81">8.1 ê³µì‹ (ì—ë„ˆì§€ ë²„ì „)</a></li>
<li><a href="#82">8.2 í•´ì„</a></li>
<li><a href="#83">8.3 ì¼ë°˜í™” íŒŒë¥´ìŠ¤ë°œ (ë ˆì¼ë¦¬ ì •ë¦¬)</a></li>
<li><a href="#84">8.4 ì£¼íŒŒìˆ˜ ëŒ€ì—­ì˜ ì—ë„ˆì§€</a></li>
</ul>
</li>
<li><a href="#9">9. ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„</a><ul>
<li><a href="#91">9.1 ìŠ¤í™íŠ¸ëŸ¼ì´ ì•Œë ¤ì£¼ëŠ” ê²ƒ</a></li>
<li><a href="#92">9.2 ë³µí•© ì‹ í˜¸ì˜ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„</a></li>
<li><a href="#93-lti">9.3 LTI ì‹œìŠ¤í…œ ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#10">10. ì´ìƒì ì¸ í•„í„°</a><ul>
<li><a href="#101">10.1 ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°</a></li>
<li><a href="#102">10.2 ì´ìƒì ì¸ ê³ ì—­í†µê³¼ í•„í„°</a></li>
<li><a href="#103">10.3 ì´ìƒì ì¸ ëŒ€ì—­í†µê³¼ í•„í„°</a></li>
<li><a href="#104">10.4 ì´ìƒì ì¸ ëŒ€ì—­ì €ì§€(ë…¸ì¹˜) í•„í„°</a></li>
<li><a href="#105">10.5 ì´ìƒì ì¸ ì „ì—­í†µê³¼ í•„í„°</a></li>
</ul>
</li>
<li><a href="#11-">11. ëŒ€ì—­í­ê³¼ ì‹œê°„-ëŒ€ì—­í­ ê³±</a><ul>
<li><a href="#111">11.1 ëŒ€ì—­í­ ì •ì˜</a></li>
<li><a href="#112-">11.2 ì‹œê°„-ëŒ€ì—­í­ ê³± (ë¶ˆí™•ì •ì„± ì›ë¦¬)</a></li>
<li><a href="#113">11.3 ì‹¤ì œì  ì˜ë¯¸</a></li>
</ul>
</li>
<li><a href="#12-python">12. Python ì˜ˆì œ</a><ul>
<li><a href="#121-ctft">12.1 ì¢…í•© CTFT ë¶„ì„ íˆ´í‚·</a></li>
<li><a href="#122">12.2 ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ í•„í„°ë§</a></li>
<li><a href="#123">12.3 ì„±ì§ˆ ê²€ì¦ ìŠ¤ìœ„íŠ¸</a></li>
<li><a href="#124">12.4 ë³€í™˜ ìŒ ê°¤ëŸ¬ë¦¬</a></li>
</ul>
</li>
<li><a href="#13">13. ìš”ì•½</a><ul>
<li><a href="#_2">í•µì‹¬ ê°œë…</a></li>
<li><a href="#_3">ë³€í™˜ ì„±ì§ˆ ë¹ ë¥¸ ì°¸ì¡°</a></li>
<li><a href="#_4">ê¸‰ìˆ˜ì—ì„œ ë³€í™˜ìœ¼ë¡œ: í° ê·¸ë¦¼</a></li>
</ul>
</li>
<li><a href="#14">14. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ ë¬¸ì œ 1: ë³€í™˜ ê³„ì‚°</a></li>
<li><a href="#2_1">ì—°ìŠµ ë¬¸ì œ 2: ì„±ì§ˆ ì‘ìš©</a></li>
<li><a href="#3_1">ì—°ìŠµ ë¬¸ì œ 3: í•©ì„±ê³± ì •ë¦¬ ì‘ìš©</a></li>
<li><a href="#4_1">ì—°ìŠµ ë¬¸ì œ 4: íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬</a></li>
<li><a href="#5_1">ì—°ìŠµ ë¬¸ì œ 5: í•„í„° ì„¤ê³„</a></li>
<li><a href="#6-">ì—°ìŠµ ë¬¸ì œ 6: ì‹œê°„-ëŒ€ì—­í­ ê³±</a></li>
<li><a href="#7_1">ì—°ìŠµ ë¬¸ì œ 7: ìŒëŒ€ì„±</a></li>
<li><a href="#8_1">ì—°ìŠµ ë¬¸ì œ 8: ì¢…í•© ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#15">15. ì°¸ê³  ë¬¸í—Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="continuous-fourier-transform">ì—°ì† í‘¸ë¦¬ì— ë³€í™˜(Continuous Fourier Transform)<a class="header-link" href="#continuous-fourier-transform" title="Permanent link">&para;</a></h1>
<p><strong>ì´ì „</strong>: <a href="./03_Fourier_Series_and_Applications.md">03. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</a> | <strong>ë‹¤ìŒ</strong>: <a href="./05_Sampling_and_Reconstruction.md">05. í‘œë³¸í™”ì™€ ë³µì›</a></p>
<hr />
<p>í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ì£¼ê¸° ì‹ í˜¸ë¥¼ ì¡°í™” ê´€ë ¨ ì‚¬ì¸íŒŒë“¤ë¡œ ë¶„í•´í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëŒ€ë¶€ë¶„ì˜ ì‹¤ì œ ì‹ í˜¸ë“¤ â€” ìŒì„±, ë ˆì´ë” í„ìŠ¤, ê³¼ë„ ì§„ë™ â€” ì€ <strong>ë¹„ì£¼ê¸°ì </strong>ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ë¶„ì„í•˜ë ¤ë©´ í‘¸ë¦¬ì— ê¸‰ìˆ˜ë¥¼ ë¹„ì£¼ê¸° ì‹ í˜¸ë¡œ í™•ì¥í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ê°€ ë°”ë¡œ <strong>ì—°ì†ì‹œê°„ í‘¸ë¦¬ì— ë³€í™˜(Continuous-Time Fourier Transform, CTFT)</strong>ì´ë©°, ì´ëŠ” ì‹ í˜¸ë¥¼ ì‹œê°„ ì˜ì—­ì—ì„œ ì—°ì† ì£¼íŒŒìˆ˜ ì˜ì—­ í‘œí˜„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
<p>í‘¸ë¦¬ì— ë³€í™˜ì€ ê³¼í•™ê³¼ ê³µí•™ ì „ë°˜ì— ê±¸ì³ ê°€ì¥ ê°•ë ¥í•˜ê³  ë³´í¸ì ì¸ ë„êµ¬ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ ë ˆìŠ¨ì—ì„œëŠ” ë³€í™˜ì„ ê¸°ë³¸ ì›ë¦¬ë¡œë¶€í„° ìœ ë„í•˜ê³ , í•µì‹¬ ì„±ì§ˆë“¤ì„ ëª©ë¡í™”í•˜ë©°, ì¼ë°˜ì ì¸ ë³€í™˜ ìŒ(transform pair) í‘œë¥¼ ì‘ì„±í•˜ê³ , ì´ë¥¼ í†µí•´ ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„ê³¼ í•„í„°ë§ì´ ì–´ë–»ê²Œ ê°€ëŠ¥í•œì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
<p><strong>ë‚œì´ë„</strong>: â­â­â­</p>
<p><strong>í•™ìŠµ ëª©í‘œ</strong>:
- ë¹„ì£¼ê¸° ì‹ í˜¸ì— ëŒ€í•œ í‘¸ë¦¬ì— ê¸‰ìˆ˜ì˜ ê·¹í•œìœ¼ë¡œì„œ í‘¸ë¦¬ì— ë³€í™˜ ìœ ë„
- ì£¼ìš” CTFT ì„±ì§ˆ (ì„ í˜•ì„±, ì´ë™, ìŠ¤ì¼€ì¼ë§, ìŒëŒ€ì„±, í•©ì„±ê³±) ì¦ëª…
- í‘œì¤€ ì‹ í˜¸ì˜ ìˆœë°©í–¥ ë° ì—­ í‘¸ë¦¬ì— ë³€í™˜ ê³„ì‚°
- í•©ì„±ê³± ì •ë¦¬ë¥¼ ì ìš©í•˜ì—¬ LTI ì‹œìŠ¤í…œ ë¶„ì„ ë‹¨ìˆœí™”
- ì£¼íŒŒìˆ˜ ì˜ì—­ í‘œí˜„ì„ ë¬¼ë¦¬ì ìœ¼ë¡œ í•´ì„
- ì´ìƒì ì¸ ì£¼íŒŒìˆ˜ ì„ íƒ í•„í„° (ì €ì—­í†µê³¼, ê³ ì—­í†µê³¼, ëŒ€ì—­í†µê³¼) ì„¤ëª…
- ëŒ€ì—­í­ê³¼ ì‹œê°„-ëŒ€ì—­í­ ê³± (ë¶ˆí™•ì •ì„± ì›ë¦¬) ì´í•´
- Python (FFT)ì„ ì´ìš©í•œ ì—°ì† ì‹ í˜¸ í‘¸ë¦¬ì— ë¶„ì„</p>
<hr />
<h2 id="_1">ëª©ì°¨<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-í‘¸ë¦¬ì—-ê¸‰ìˆ˜ì—ì„œ-í‘¸ë¦¬ì—-ë³€í™˜ìœ¼ë¡œ">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì—ì„œ í‘¸ë¦¬ì— ë³€í™˜ìœ¼ë¡œ</a></li>
<li><a href="#2-í‘¸ë¦¬ì—-ë³€í™˜ì˜-ì •ì˜">í‘¸ë¦¬ì— ë³€í™˜ì˜ ì •ì˜</a></li>
<li><a href="#3-ì¡´ì¬-ì¡°ê±´">ì¡´ì¬ ì¡°ê±´</a></li>
<li><a href="#4-ì¼ë°˜ì ì¸-ë³€í™˜-ìŒ">ì¼ë°˜ì ì¸ ë³€í™˜ ìŒ</a></li>
<li><a href="#5-í‘¸ë¦¬ì—-ë³€í™˜ì˜-ì„±ì§ˆ">í‘¸ë¦¬ì— ë³€í™˜ì˜ ì„±ì§ˆ</a></li>
<li><a href="#6-í•©ì„±ê³±-ì •ë¦¬">í•©ì„±ê³± ì •ë¦¬</a></li>
<li><a href="#7-ê³±ì…ˆ-ì •ë¦¬ìœˆë„ì‰">ê³±ì…ˆ ì •ë¦¬(ìœˆë„ì‰)</a></li>
<li><a href="#8-íŒŒë¥´ìŠ¤ë°œ-ì •ë¦¬">íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬</a></li>
<li><a href="#9-ì£¼íŒŒìˆ˜-ì˜ì—­-ë¶„ì„">ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„</a></li>
<li><a href="#10-ì´ìƒì ì¸-í•„í„°">ì´ìƒì ì¸ í•„í„°</a></li>
<li><a href="#11-ëŒ€ì—­í­ê³¼-ì‹œê°„-ëŒ€ì—­í­-ê³±">ëŒ€ì—­í­ê³¼ ì‹œê°„-ëŒ€ì—­í­ ê³±</a></li>
<li><a href="#12-python-ì˜ˆì œ">Python ì˜ˆì œ</a></li>
<li><a href="#13-ìš”ì•½">ìš”ì•½</a></li>
<li><a href="#14-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
<li><a href="#15-ì°¸ê³ -ë¬¸í—Œ">ì°¸ê³  ë¬¸í—Œ</a></li>
</ol>
<hr />
<h2 id="1">1. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì—ì„œ í‘¸ë¦¬ì— ë³€í™˜ìœ¼ë¡œ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ê·¹í•œ ê³¼ì •<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ì£¼ê¸° $T_0$ì„ ê°€ì§€ë©° í•œ ì£¼ê¸° êµ¬ê°„ì—ì„œ ë¹„ì£¼ê¸° ì‹ í˜¸ $x(t)$ì™€ ê°™ì€ ì£¼ê¸° ì‹ í˜¸ $\tilde{x}(t)$ë¥¼ ê³ ë ¤í•©ë‹ˆë‹¤:</p>
<p>$$\tilde{x}(t) = x(t) \text{ for } -T_0/2 < t < T_0/2$$</p>
<p>ë³µì†Œ í‘¸ë¦¬ì— ê¸‰ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>$$\tilde{x}(t) = \sum_{n=-\infty}^{\infty} c_n e^{jn\omega_0 t}, \quad c_n = \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} x(t) e^{-jn\omega_0 t} \, dt$$</p>
<p><strong>í¬ë½ì„  í•¨ìˆ˜(envelope function)</strong>ë¥¼ ì •ì˜í•©ë‹ˆë‹¤:</p>
<p>$$X(\omega) \equiv T_0 \cdot c_n \bigg|_{\omega = n\omega_0} = \int_{-T_0/2}^{T_0/2} x(t) e^{-j\omega t} \, dt$$</p>
<p>ì´ì œ $T_0 \to \infty$ë¡œ ì·¨í•˜ë©´, ì¡°í™”íŒŒ ê°„ê²© $\omega_0 = 2\pi/T_0 \to 0$ì´ ë˜ê³ , ì´ì‚° ì£¼íŒŒìˆ˜ $n\omega_0$ëŠ” ì—°ì† ë³€ìˆ˜ $\omega$ê°€ ë˜ë©°, í•©ì€ ì ë¶„ì´ ë©ë‹ˆë‹¤:</p>
<p>$$\sum_n c_n e^{jn\omega_0 t} = \sum_n \frac{X(n\omega_0)}{T_0} e^{jn\omega_0 t} = \frac{1}{2\pi} \sum_n X(n\omega_0) e^{jn\omega_0 t} \omega_0$$</p>
<p>$\omega_0 \to d\omega$ë¡œ ê°€ë©´:</p>
<p>$$x(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(\omega) e^{j\omega t} \, d\omega$$</p>
<p>ê·¸ë¦¬ê³  $X(\omega)$ì˜ ì ë¶„ í•œê³„ëŠ” ë¬´í•œëŒ€ë¡œ í™•ì¥ë©ë‹ˆë‹¤:</p>
<p>$$X(\omega) = \int_{-\infty}^{\infty} x(t) e^{-j\omega t} \, dt$$</p>
<p>ì´ ë‘ ë°©ì •ì‹ì˜ ìŒì´ í‘¸ë¦¬ì— ë³€í™˜ì„ ì •ì˜í•©ë‹ˆë‹¤.</p>
<h3 id="12">1.2 ë¬¼ë¦¬ì  í•´ì„<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>í‘¸ë¦¬ì— ê¸‰ìˆ˜</th>
<th>í‘¸ë¦¬ì— ë³€í™˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì£¼ê¸° ì‹ í˜¸</td>
<td>ë¹„ì£¼ê¸° ì‹ í˜¸</td>
</tr>
<tr>
<td>ì´ì‚° ìŠ¤í™íŠ¸ëŸ¼ (ì„  ìŠ¤í™íŠ¸ëŸ¼)</td>
<td>ì—°ì† ìŠ¤í™íŠ¸ëŸ¼ (ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„)</td>
</tr>
<tr>
<td>ê³„ìˆ˜ $c_n$ (ë¬´ì°¨ì›)</td>
<td>$X(\omega)$ëŠ” [ì‹ í˜¸ $\times$ ì‹œê°„]ì˜ ë‹¨ìœ„</td>
</tr>
<tr>
<td>$n\omega_0$ì—ì„œë§Œ ì£¼íŒŒìˆ˜ ì¡´ì¬</td>
<td>ëª¨ë“  ì£¼íŒŒìˆ˜ $\omega \in \mathbb{R}$</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. í‘¸ë¦¬ì— ë³€í™˜ì˜ ì •ì˜<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ìˆœë°©í–¥ ë³€í™˜ (ë¶„ì„)<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>$$X(\omega) = \mathcal{F}\{x(t)\} = \int_{-\infty}^{\infty} x(t) \, e^{-j\omega t} \, dt$$</p>
<p>$X(\omega)$ë¥¼ $x(t)$ì˜ <strong>í‘¸ë¦¬ì— ë³€í™˜</strong>, <strong>ìŠ¤í™íŠ¸ëŸ¼</strong>, ë˜ëŠ” <strong>ì£¼íŒŒìˆ˜ ì˜ì—­ í‘œí˜„</strong>ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
<h3 id="22">2.2 ì—­ë³€í™˜ (í•©ì„±)<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>$$x(t) = \mathcal{F}^{-1}\{X(\omega)\} = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(\omega) \, e^{j\omega t} \, d\omega$$</p>
<h3 id="23">2.3 ëŒ€ì•ˆì  í‘œê¸° ê·œì•½<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p>ë¬¸í—Œì—ì„œ ì„¸ ê°€ì§€ ê·œì•½ì´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ê·œì•½</th>
<th>ìˆœë°©í–¥</th>
<th>ì—­ë°©í–¥</th>
<th>ì‚¬ìš©ì²˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\omega$ (ê°ì£¼íŒŒìˆ˜)</td>
<td>$\int x \, e^{-j\omega t} dt$</td>
<td>$\frac{1}{2\pi}\int X \, e^{j\omega t} d\omega$</td>
<td>Oppenheim, Haykin (ì´ ê°•ì¢Œ)</td>
</tr>
<tr>
<td>$f$ (ì¼ë°˜ ì£¼íŒŒìˆ˜)</td>
<td>$\int x \, e^{-j2\pi ft} dt$</td>
<td>$\int X \, e^{j2\pi ft} df$</td>
<td>Bracewell, ê³µí•™ ì‹¤ë¬´</td>
</tr>
<tr>
<td>ëŒ€ì¹­í˜•</td>
<td>$\frac{1}{\sqrt{2\pi}}\int x \, e^{-j\omega t} dt$</td>
<td>$\frac{1}{\sqrt{2\pi}}\int X \, e^{j\omega t} d\omega$</td>
<td>ë¬¼ë¦¬í•™, ì–‘ìì—­í•™</td>
</tr>
</tbody>
</table>
<p><code>scipy.fft</code>ê°€ ì‚¬ìš©í•˜ëŠ” $f$-ê·œì•½ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>$$X(f) = \int_{-\infty}^{\infty} x(t) \, e^{-j2\pi ft} \, dt, \qquad x(t) = \int_{-\infty}^{\infty} X(f) \, e^{j2\pi ft} \, df$$</p>
<p>ë³€í™˜: $X(\omega) = X(f)|_{f=\omega/(2\pi)}$ ($\omega = 2\pi f$ ê´€ê³„ ì‚¬ìš©).</p>
<h3 id="24">2.4 í¬ê¸°ì™€ ìœ„ìƒ<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p>$X(\omega)$ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë³µì†Œìˆ˜ì´ë¯€ë¡œ:</p>
<p>$$X(\omega) = |X(\omega)| e^{j\angle X(\omega)}$$</p>
<ul>
<li>$|X(\omega)|$ = <strong>í¬ê¸° ìŠ¤í™íŠ¸ëŸ¼</strong> (ì§„í­ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„)</li>
<li>$\angle X(\omega)$ = <strong>ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼</strong></li>
<li>$|X(\omega)|^2$ = <strong>ì—ë„ˆì§€ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„(ESD)</strong></li>
</ul>
<p>ì‹¤ìˆ˜ ì‹ í˜¸ì— ëŒ€í•´: $X(-\omega) = X^*(\omega)$ (<strong>ì¼¤ë ˆ ëŒ€ì¹­</strong>)ì´ë¯€ë¡œ:
- $|X(-\omega)| = |X(\omega)|$ (í¬ê¸°ëŠ” ìš°í•¨ìˆ˜)
- $\angle X(-\omega) = -\angle X(\omega)$ (ìœ„ìƒì€ ê¸°í•¨ìˆ˜)</p>
<hr />
<h2 id="3">3. ì¡´ì¬ ì¡°ê±´<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì¶©ë¶„ ì¡°ê±´<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>$x(t)$ê°€ <strong>ì ˆëŒ€ ì ë¶„ ê°€ëŠ¥(absolutely integrable)</strong>í•˜ë©´ í‘¸ë¦¬ì— ë³€í™˜ì´ ì¡´ì¬í•©ë‹ˆë‹¤:</p>
<p>$$\int_{-\infty}^{\infty} |x(t)| \, dt < \infty$$</p>
<p>ì´ëŠ” $|X(\omega)| \leq \int |x(t)| \, dt < \infty$ (ë³€í™˜ì´ ìœ ê³„)ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.</p>
<h3 id="32">3.2 ë” ë„“ì€ ì¡´ì¬ ì¡°ê±´<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>ë§ì€ ì¤‘ìš”í•œ ì‹ í˜¸ë“¤ ($\sin(\omega_0 t)$, $u(t)$, $\delta(t)$ ë“±)ì€ ì ˆëŒ€ ì ë¶„ ê°€ëŠ¥í•˜ì§€ ì•Šì§€ë§Œ, <strong>ë¶„í¬(distributions)</strong> (ì¼ë°˜í™” í•¨ìˆ˜)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ë°˜í™”ëœ ì˜ë¯¸ì—ì„œ ì—¬ì „íˆ í‘¸ë¦¬ì— ë³€í™˜ì„ ê°€ì§‘ë‹ˆë‹¤. ì´ë“¤ì˜ ë³€í™˜ì€ ë””ë™ ë¸íƒ€ í•¨ìˆ˜ë¥¼ í¬í•¨í•©ë‹ˆë‹¤:</p>
<p>$$\mathcal{F}\{\delta(t)\} = 1, \qquad \mathcal{F}\{1\} = 2\pi\delta(\omega)$$</p>
<p>$$\mathcal{F}\{e^{j\omega_0 t}\} = 2\pi\delta(\omega - \omega_0)$$</p>
<p>ì´ëŸ¬í•œ ì¼ë°˜í™” ë³€í™˜ì€ ì£¼ê¸° ì‹ í˜¸ì™€ ìƒìˆ˜ë¥¼ í‘¸ë¦¬ì— ë³€í™˜ ì²´ê³„ ë‚´ì—ì„œ ë‹¤ë£¨ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.</p>
<hr />
<h2 id="4">4. ì¼ë°˜ì ì¸ ë³€í™˜ ìŒ<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 í‘¸ë¦¬ì— ë³€í™˜ ìŒ í‘œ<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: center;">ì‹ í˜¸ $x(t)$</th>
<th style="text-align: center;">ë³€í™˜ $X(\omega)$</th>
<th style="text-align: left;">ë¹„ê³ </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">$\delta(t)$</td>
<td style="text-align: center;">$1$</td>
<td style="text-align: left;">ì„í„ìŠ¤ëŠ” ëª¨ë“  ì£¼íŒŒìˆ˜ë¥¼ ë™ë“±í•˜ê²Œ í¬í•¨</td>
</tr>
<tr>
<td style="text-align: center;">$1$</td>
<td style="text-align: center;">$2\pi\delta(\omega)$</td>
<td style="text-align: left;">ìƒìˆ˜(DC)ëŠ” $\omega = 0$ì—ì„œ ë‹¨ì¼ ì£¼íŒŒìˆ˜</td>
</tr>
<tr>
<td style="text-align: center;">$e^{j\omega_0 t}$</td>
<td style="text-align: center;">$2\pi\delta(\omega - \omega_0)$</td>
<td style="text-align: left;">ë³µì†Œ ì§€ìˆ˜ëŠ” ë‹¨ì¼ ìŠ¤í™íŠ¸ëŸ¼ ì„ </td>
</tr>
<tr>
<td style="text-align: center;">$\cos(\omega_0 t)$</td>
<td style="text-align: center;">$\pi[\delta(\omega - \omega_0) + \delta(\omega + \omega_0)]$</td>
<td style="text-align: left;">ë‘ ê°œì˜ ìŠ¤í™íŠ¸ëŸ¼ ì„ </td>
</tr>
<tr>
<td style="text-align: center;">$\sin(\omega_0 t)$</td>
<td style="text-align: center;">$\frac{\pi}{j}[\delta(\omega - \omega_0) - \delta(\omega + \omega_0)]$</td>
<td style="text-align: left;">ë‘ ê°œì˜ ìŠ¤í™íŠ¸ëŸ¼ ì„ </td>
</tr>
<tr>
<td style="text-align: center;">$u(t)$</td>
<td style="text-align: center;">$\pi\delta(\omega) + \frac{1}{j\omega}$</td>
<td style="text-align: left;">ë‹¨ìœ„ ê³„ë‹¨</td>
</tr>
<tr>
<td style="text-align: center;">$e^{-at}u(t)$, $a > 0$</td>
<td style="text-align: center;">$\frac{1}{a + j\omega}$</td>
<td style="text-align: left;">ì¸ê³¼ ì§€ìˆ˜</td>
</tr>
<tr>
<td style="text-align: center;">$e^{-a\|t\|}$, $a > 0$</td>
<td style="text-align: center;">$\frac{2a}{a^2 + \omega^2}$</td>
<td style="text-align: left;">ì–‘ì¸¡ ì§€ìˆ˜</td>
</tr>
<tr>
<td style="text-align: center;">$\text{rect}(t/\tau)$</td>
<td style="text-align: center;">$\tau \, \text{sinc}(\omega\tau / 2\pi)$</td>
<td style="text-align: left;">ì§ì‚¬ê°í˜• $\leftrightarrow$ sinc</td>
</tr>
<tr>
<td style="text-align: center;">$\text{sinc}(Wt)$</td>
<td style="text-align: center;">$\frac{1}{W}\text{rect}(\omega / (2\pi W))$</td>
<td style="text-align: left;">sinc $\leftrightarrow$ ì§ì‚¬ê°í˜• (ìŒëŒ€ì„±)</td>
</tr>
<tr>
<td style="text-align: center;">$e^{-t^2/(2\sigma^2)}$</td>
<td style="text-align: center;">$\sigma\sqrt{2\pi} \, e^{-\sigma^2\omega^2/2}$</td>
<td style="text-align: left;">ê°€ìš°ì‹œì•ˆ $\leftrightarrow$ ê°€ìš°ì‹œì•ˆ</td>
</tr>
<tr>
<td style="text-align: center;">$\text{tri}(t/\tau)$</td>
<td style="text-align: center;">$\tau \, \text{sinc}^2(\omega\tau / 2\pi)$</td>
<td style="text-align: left;">ì‚¼ê°í˜• $\leftrightarrow$ sinc$^2$</td>
</tr>
<tr>
<td style="text-align: center;">$\text{sgn}(t)$</td>
<td style="text-align: center;">$\frac{2}{j\omega}$</td>
<td style="text-align: left;">ë¶€í˜¸ í•¨ìˆ˜</td>
</tr>
<tr>
<td style="text-align: center;">$\delta(t - t_0)$</td>
<td style="text-align: center;">$e^{-j\omega t_0}$</td>
<td style="text-align: left;">ì´ë™ëœ ì„í„ìŠ¤</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ìœ ë„ ì˜ˆì‹œ<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>ì¸ê³¼ ì§€ìˆ˜</strong> $x(t) = e^{-at}u(t)$, $a > 0$:</p>
<p>$$X(\omega) = \int_0^{\infty} e^{-at} e^{-j\omega t} \, dt = \int_0^{\infty} e^{-(a+j\omega)t} \, dt = \frac{1}{a + j\omega}$$</p>
<p>í¬ê¸°: $|X(\omega)| = \frac{1}{\sqrt{a^2 + \omega^2}}$</p>
<p>ìœ„ìƒ: $\angle X(\omega) = -\arctan(\omega/a)$</p>
<p><strong>ì§ì‚¬ê° í„ìŠ¤</strong> $x(t) = \text{rect}(t/\tau)$:</p>
<p>$$X(\omega) = \int_{-\tau/2}^{\tau/2} e^{-j\omega t} \, dt = \frac{e^{j\omega\tau/2} - e^{-j\omega\tau/2}}{j\omega} = \tau \cdot \frac{\sin(\omega\tau/2)}{\omega\tau/2} = \tau \, \text{sinc}\left(\frac{\omega\tau}{2\pi}\right)$$</p>
<p><strong>ê°€ìš°ì‹œì•ˆ í„ìŠ¤</strong> $x(t) = e^{-t^2/(2\sigma^2)}$:</p>
<p>$$X(\omega) = \int_{-\infty}^{\infty} e^{-t^2/(2\sigma^2)} e^{-j\omega t} \, dt$$</p>
<p>ì§€ìˆ˜ì˜ ì œê³± ì™„ì„±:</p>
<p>$$-\frac{t^2}{2\sigma^2} - j\omega t = -\frac{1}{2\sigma^2}(t + j\sigma^2\omega)^2 - \frac{\sigma^2\omega^2}{2}$$</p>
<p>$$X(\omega) = e^{-\sigma^2\omega^2/2} \int_{-\infty}^{\infty} e^{-(t+j\sigma^2\omega)^2/(2\sigma^2)} \, dt = \sigma\sqrt{2\pi} \, e^{-\sigma^2\omega^2/2}$$</p>
<p>ê°€ìš°ì‹œì•ˆì€ (ìŠ¤ì¼€ì¼ë§ê¹Œì§€) ìê¸° ìì‹ ì˜ í‘¸ë¦¬ì— ë³€í™˜ì…ë‹ˆë‹¤. ì‹œê°„ ì˜ì—­ì—ì„œ ì¢ì€ ê°€ìš°ì‹œì•ˆì€ ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ë„“ì€ ê°€ìš°ì‹œì•ˆì„ ë§Œë“¤ê³ , ê·¸ ë°˜ëŒ€ë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Fourier transform pairs visualization ---</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

<span class="c1"># 1. Causal exponential</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x(t) = e^</span><span class="se">{{</span><span class="s1">-</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">t</span><span class="se">}}</span><span class="s1">u(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X1</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X1</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">angle X(</span><span class="se">\\</span><span class="s1">omega)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$X(</span><span class="se">\\</span><span class="s1">omega) = 1/(</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1"> + j</span><span class="se">\\</span><span class="s1">omega)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Rectangular pulse</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tau</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x(t) = </span><span class="se">\\</span><span class="s1">mathrm</span><span class="se">{{</span><span class="s1">rect</span><span class="se">}}</span><span class="s1">(t/</span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$X(</span><span class="se">\\</span><span class="s1">omega) = </span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">cdot </span><span class="se">\\</span><span class="s1">mathrm</span><span class="se">{{</span><span class="s1">sinc</span><span class="se">}}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega </span><span class="se">\\</span><span class="s1">cdot </span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s1">/(2</span><span class="se">\\</span><span class="s1">pi))$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Gaussian pulse</span>
<span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]:</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">X3</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gaussian: $x(t) = e^{-t^2/(2</span><span class="se">\\</span><span class="s1">sigma^2)}$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$X(</span><span class="se">\\</span><span class="s1">omega) = </span><span class="se">\\</span><span class="s1">sigma</span><span class="se">\\</span><span class="s1">sqrt{2</span><span class="se">\\</span><span class="s1">pi} </span><span class="se">\\</span><span class="s1">cdot e^{-</span><span class="se">\\</span><span class="s1">sigma^2</span><span class="se">\\</span><span class="s1">omega^2/2}$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. Two-sided exponential</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t2</span><span class="p">))</span>
<span class="n">X4</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x(t) = e^</span><span class="se">{{</span><span class="s1">-</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">|t|</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">X4</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$X(</span><span class="se">\\</span><span class="s1">omega) = </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="si">}</span><span class="s1">/(</span><span class="si">{</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s1"> + </span><span class="se">\\</span><span class="s1">omega^2)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;transform_pairs.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5">5. í‘¸ë¦¬ì— ë³€í™˜ì˜ ì„±ì§ˆ<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<p>í‘¸ë¦¬ì— ë³€í™˜ì˜ ì„±ì§ˆë“¤ì€ ë§¤ìš° ê°•ë ¥í•©ë‹ˆë‹¤ â€” ì´ë¥¼ í†µí•´ ì ë¶„ì„ ë‹¤ì‹œ ê³„ì‚°í•˜ì§€ ì•Šê³ ë„ ê°„ë‹¨í•œ ë³€í™˜ìœ¼ë¡œë¶€í„° ë³µì¡í•œ ì‹ í˜¸ì˜ ë³€í™˜ì„ ê²°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="51-linearity">5.1 ì„ í˜•ì„±(Linearity)<a class="header-link" href="#51-linearity" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{ax_1(t) + bx_2(t)\} = aX_1(\omega) + bX_2(\omega)$$</p>
<p>ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ì¤‘ì²©(superposition)ì´ ì„±ë¦½í•©ë‹ˆë‹¤.</p>
<h3 id="52-time-shifting">5.2 ì‹œê°„ ì´ë™(Time Shifting)<a class="header-link" href="#52-time-shifting" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(t - t_0)\} = e^{-j\omega t_0} X(\omega)$$</p>
<p>ì‹œê°„ ì§€ì—°ì€ ìŠ¤í™íŠ¸ëŸ¼ì— <strong>ì„ í˜• ìœ„ìƒ</strong> $-\omega t_0$ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. <strong>í¬ê¸° ìŠ¤í™íŠ¸ëŸ¼ì€ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</strong> â€” ì‹ í˜¸ë¥¼ ì‹œê°„ ì¶•ì—ì„œ ì´ë™í•´ë„ ì£¼íŒŒìˆ˜ ë‚´ìš©ì€ ë°”ë€Œì§€ ì•Šê³  ìœ„ìƒ ê´€ê³„ë§Œ ë°”ë€ë‹ˆë‹¤.</p>
<p><strong>ì¦ëª…</strong>:</p>
<p>$$\int x(t - t_0) e^{-j\omega t} dt \overset{\tau = t - t_0}{=} \int x(\tau) e^{-j\omega(\tau + t_0)} d\tau = e^{-j\omega t_0} X(\omega)$$</p>
<h3 id="53-frequency-shifting">5.3 ì£¼íŒŒìˆ˜ ì´ë™(Frequency Shifting) â€” ë³€ì¡°<a class="header-link" href="#53-frequency-shifting" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(t) e^{j\omega_0 t}\} = X(\omega - \omega_0)$$</p>
<p>ì‹œê°„ ì˜ì—­ì—ì„œ ë³µì†Œ ì§€ìˆ˜ë¥¼ ê³±í•˜ë©´ ìŠ¤í™íŠ¸ëŸ¼ì´ $\omega_0$ë§Œí¼ <strong>ì´ë™</strong>í•©ë‹ˆë‹¤. ì´ê²ƒì´ í†µì‹ ì—ì„œ <strong>ë³€ì¡°(modulation)</strong>ì˜ ìˆ˜í•™ì  ê¸°ì´ˆì…ë‹ˆë‹¤.</p>
<p><strong>ë”°ë¦„ì •ë¦¬</strong> (ì½”ì‚¬ì¸ ë³€ì¡°):</p>
<p>$$\mathcal{F}\{x(t)\cos(\omega_0 t)\} = \frac{1}{2}[X(\omega - \omega_0) + X(\omega + \omega_0)]$$</p>
<p>ìŠ¤í™íŠ¸ëŸ¼ì´ $\pm\omega_0$ë¡œ ì´ë™í•˜ê³  ì§„í­ì´ ì ˆë°˜ì´ ë©ë‹ˆë‹¤.</p>
<h3 id="54-time-scaling">5.4 ì‹œê°„ ìŠ¤ì¼€ì¼ë§(Time Scaling)<a class="header-link" href="#54-time-scaling" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(at)\} = \frac{1}{|a|} X\left(\frac{\omega}{a}\right)$$</p>
<ul>
<li>ì‹œê°„ ì••ì¶• ($|a| > 1$)ì€ ì£¼íŒŒìˆ˜ <strong>íŒ½ì°½</strong>ì„ ìœ ë°œ</li>
<li>ì‹œê°„ íŒ½ì°½ ($|a| < 1$)ì€ ì£¼íŒŒìˆ˜ <strong>ì••ì¶•</strong>ì„ ìœ ë°œ</li>
<li>$|X(\omega)|$ ì•„ë˜ ë©´ì ì€ ì—ë„ˆì§€ ë³´ì¡´ì„ ìœ„í•´ $1/|a|$ë¡œ ìŠ¤ì¼€ì¼ë¨</li>
</ul>
<p>ì´ê²ƒì´ <strong>ë¶ˆí™•ì •ì„± ì›ë¦¬</strong>ì˜ ìˆ˜í•™ì  í‘œí˜„ì…ë‹ˆë‹¤: ì‹œê°„ê³¼ ì£¼íŒŒìˆ˜ì—ì„œ ë™ì‹œì— ì„ì˜ë¡œ êµ­ì†Œí™”(localized)ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
<h3 id="55-time-reversal">5.5 ì‹œê°„ ë°˜ì „(Time Reversal)<a class="header-link" href="#55-time-reversal" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(-t)\} = X(-\omega)$$</p>
<p>$a = -1$ì¸ ìŠ¤ì¼€ì¼ë§ì˜ íŠ¹ìˆ˜ ê²½ìš°ì…ë‹ˆë‹¤. ì‹¤ìˆ˜ ì‹ í˜¸ì— ëŒ€í•´ $X(-\omega) = X^*(\omega)$ì´ë¯€ë¡œ:</p>
<p>$$\mathcal{F}\{x(-t)\} = X^*(\omega) \quad \text{(ì‹¤ìˆ˜ ì‹ í˜¸)}$$</p>
<h3 id="56-duality">5.6 ìŒëŒ€ì„±(Duality)<a class="header-link" href="#56-duality" title="Permanent link">&para;</a></h3>
<p>$x(t) \leftrightarrow X(\omega)$ì´ë©´:</p>
<p>$$X(t) \leftrightarrow 2\pi \, x(-\omega)$$</p>
<p><strong>ì˜ˆì‹œ</strong>: $\text{rect}(t/\tau) \leftrightarrow \tau\,\text{sinc}(\omega\tau/(2\pi))$ì´ë¯€ë¡œ, ìŒëŒ€ì„±ì— ì˜í•´:</p>
<p>$$\tau\,\text{sinc}(\tau t/(2\pi)) \leftrightarrow 2\pi \, \text{rect}(-\omega/\tau) = 2\pi\,\text{rect}(\omega/\tau)$$</p>
<p>ì´ê²ƒì´ sinc í•¨ìˆ˜ì˜ ë³€í™˜ì„ ì–»ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
<h3 id="57-differentiation-in-time">5.7 ì‹œê°„ ë¯¸ë¶„(Differentiation in Time)<a class="header-link" href="#57-differentiation-in-time" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\left\{\frac{d^n x}{dt^n}\right\} = (j\omega)^n X(\omega)$$</p>
<p>ì‹œê°„ ë¯¸ë¶„ì€ ì£¼íŒŒìˆ˜ì—ì„œ $j\omega$ë¥¼ ê³±í•˜ëŠ” ê²ƒì— í•´ë‹¹í•©ë‹ˆë‹¤. ê³ ì£¼íŒŒìˆ˜ê°€ ì¦í­ë©ë‹ˆë‹¤ â€” ë¯¸ë¶„ì€ <strong>ê³ ì—­í†µê³¼ ì—°ì‚°</strong>ì…ë‹ˆë‹¤.</p>
<h3 id="58-integration">5.8 ì ë¶„(Integration)<a class="header-link" href="#58-integration" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\left\{\int_{-\infty}^{t} x(\tau) \, d\tau\right\} = \frac{X(\omega)}{j\omega} + \pi X(0)\delta(\omega)$$</p>
<p>ì ë¶„ì€ $j\omega$ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì— í•´ë‹¹í•©ë‹ˆë‹¤ (DC í•­ í¬í•¨). ì €ì£¼íŒŒìˆ˜ê°€ ì¦í­ë©ë‹ˆë‹¤ â€” ì ë¶„ì€ <strong>ì €ì—­í†µê³¼ ì—°ì‚°</strong>ì…ë‹ˆë‹¤.</p>
<h3 id="59-differentiation-in-frequency">5.9 ì£¼íŒŒìˆ˜ ë¯¸ë¶„(Differentiation in Frequency)<a class="header-link" href="#59-differentiation-in-frequency" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{(-jt)^n x(t)\} = \frac{d^n X(\omega)}{d\omega^n}$$</p>
<p>ë˜ëŠ” ë™ë“±í•˜ê²Œ:</p>
<p>$$\mathcal{F}\{t^n x(t)\} = j^n \frac{d^n X(\omega)}{d\omega^n}$$</p>
<h3 id="510">5.10 ì„±ì§ˆ ìš”ì•½ í‘œ<a class="header-link" href="#510" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì„±ì§ˆ</th>
<th>ì‹œê°„ ì˜ì—­</th>
<th>ì£¼íŒŒìˆ˜ ì˜ì—­</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì„ í˜•ì„±</td>
<td>$ax_1 + bx_2$</td>
<td>$aX_1 + bX_2$</td>
</tr>
<tr>
<td>ì‹œê°„ ì´ë™</td>
<td>$x(t - t_0)$</td>
<td>$e^{-j\omega t_0}X(\omega)$</td>
</tr>
<tr>
<td>ì£¼íŒŒìˆ˜ ì´ë™</td>
<td>$x(t)e^{j\omega_0 t}$</td>
<td>$X(\omega - \omega_0)$</td>
</tr>
<tr>
<td>ìŠ¤ì¼€ì¼ë§</td>
<td>$x(at)$</td>
<td>$\frac{1}{|a|}X(\omega/a)$</td>
</tr>
<tr>
<td>ë°˜ì „</td>
<td>$x(-t)$</td>
<td>$X(-\omega)$</td>
</tr>
<tr>
<td>ìŒëŒ€ì„±</td>
<td>$X(t)$</td>
<td>$2\pi x(-\omega)$</td>
</tr>
<tr>
<td>ì‹œê°„ ë¯¸ë¶„</td>
<td>$\frac{dx}{dt}$</td>
<td>$j\omega X(\omega)$</td>
</tr>
<tr>
<td>ì£¼íŒŒìˆ˜ ë¯¸ë¶„</td>
<td>$(-jt)x(t)$</td>
<td>$\frac{dX}{d\omega}$</td>
</tr>
<tr>
<td>í•©ì„±ê³±</td>
<td>$x * h$</td>
<td>$X \cdot H$</td>
</tr>
<tr>
<td>ê³±ì…ˆ</td>
<td>$x \cdot w$</td>
<td>$\frac{1}{2\pi}X * W$</td>
</tr>
<tr>
<td>ì¼¤ë ˆ</td>
<td>$x^*(t)$</td>
<td>$X^*(-\omega)$</td>
</tr>
<tr>
<td>íŒŒë¥´ìŠ¤ë°œ</td>
<td>$\int|x|^2 dt$</td>
<td>$\frac{1}{2\pi}\int|X|^2 d\omega$</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Fourier transform properties demonstration ---</span>

<span class="c1"># Use FFT to approximate the CTFT</span>
<span class="k">def</span><span class="w"> </span><span class="nf">approx_ctft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Approximate CTFT using FFT.&quot;&quot;&quot;</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">omega</span><span class="p">,</span> <span class="n">X</span>

<span class="c1"># Setup</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Original signal: Gaussian pulse</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">omega</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">approx_ctft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># 1. Time shifting</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">x_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">_</span><span class="p">,</span> <span class="n">X_shifted</span> <span class="o">=</span> <span class="n">approx_ctft</span><span class="p">(</span><span class="n">x_shifted</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_shifted</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$x(t - </span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Shifting&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_shifted</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X_</span><span class="si">{shifted}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude unchanged by time shift&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Time scaling</span>
<span class="n">x_compressed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">x_expanded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">_</span><span class="p">,</span> <span class="n">X_comp</span> <span class="o">=</span> <span class="n">approx_ctft</span><span class="p">(</span><span class="n">x_compressed</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">X_exp</span> <span class="o">=</span> <span class="n">approx_ctft</span><span class="p">(</span><span class="n">x_expanded</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_compressed</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(2t)$ compressed&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_expanded</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(0.5t)$ expanded&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Scaling&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_comp</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X_</span><span class="si">{comp}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega)|$ expanded&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_exp</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X_</span><span class="si">{exp}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega)|$ compressed&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Compression in time = expansion in frequency&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Frequency shifting (modulation)</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="mf">20.0</span>  <span class="c1"># carrier frequency</span>
<span class="n">x_mod</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega_c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">X_mod</span> <span class="o">=</span> <span class="n">approx_ctft</span><span class="p">(</span><span class="n">x_mod</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(t)$ envelope&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_mod</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(t)</span><span class="se">\\</span><span class="s1">cos(</span><span class="se">\\</span><span class="s1">omega_c t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frequency Shifting (modulation, $</span><span class="se">\\</span><span class="s1">omega_c=</span><span class="si">{</span><span class="n">omega_c</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original $|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_mod</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$|X_</span><span class="si">{mod}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum shifted to $</span><span class="se">\\</span><span class="s1">pm</span><span class="se">\\</span><span class="s1">omega_c$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ft_properties.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6">6. í•©ì„±ê³± ì •ë¦¬<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ê³µì‹<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(t) * h(t)\} = X(\omega) \cdot H(\omega)$$</p>
<p><strong>ì‹œê°„ ì˜ì—­ì—ì„œì˜ í•©ì„±ê³±ì€ ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ ê³±ì…ˆì…ë‹ˆë‹¤.</strong></p>
<p>ì´ê²ƒì€ ì•„ë§ˆë„ í‘¸ë¦¬ì— ë³€í™˜ì˜ ê°€ì¥ ì¤‘ìš”í•œ ì„±ì§ˆì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ LTI ì‹œìŠ¤í…œì˜ ì¶œë ¥ì„ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li>ì…ë ¥ ë³€í™˜: $x(t) \to X(\omega)$</li>
<li>ì£¼íŒŒìˆ˜ ì‘ë‹µ ê³±ì…ˆ: $Y(\omega) = X(\omega) \cdot H(\omega)$</li>
<li>ì—­ë³€í™˜: $Y(\omega) \to y(t)$</li>
</ol>
<h3 id="62">6.2 ì¦ëª…<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x * h\} = \int \left[\int x(\tau) h(t - \tau) d\tau\right] e^{-j\omega t} dt$$</p>
<p>ì ë¶„ ìˆœì„œ êµí™˜:</p>
<p>$$= \int x(\tau) \left[\int h(t - \tau) e^{-j\omega t} dt\right] d\tau$$</p>
<p>ë‚´ë¶€ ì ë¶„ì—ì„œ $u = t - \tau$ë¡œ ì¹˜í™˜:</p>
<p>$$= \int x(\tau) \left[\int h(u) e^{-j\omega(u + \tau)} du\right] d\tau = \int x(\tau) e^{-j\omega\tau} d\tau \cdot \int h(u) e^{-j\omega u} du$$</p>
<p>$$= X(\omega) \cdot H(\omega)$$</p>
<h3 id="63-lti">6.3 ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ LTI ì‹œìŠ¤í…œ ë¶„ì„<a class="header-link" href="#63-lti" title="Permanent link">&para;</a></h3>
<p>ì„í„ìŠ¤ ì‘ë‹µ $h(t)$ì™€ ì…ë ¥ $x(t)$ë¥¼ ê°€ì§„ LTI ì‹œìŠ¤í…œì— ëŒ€í•´:</p>
<p>$$Y(\omega) = H(\omega) \cdot X(\omega)$$</p>
<p>ì—¬ê¸°ì„œ $H(\omega) = \mathcal{F}\{h(t)\}$ëŠ” <strong>ì£¼íŒŒìˆ˜ ì‘ë‹µ</strong> (ë˜ëŠ” <strong>ì „ë‹¬ í•¨ìˆ˜</strong>)ì…ë‹ˆë‹¤.</p>
<p>ì¶œë ¥ ìŠ¤í™íŠ¸ëŸ¼ì€ ì£¼íŒŒìˆ˜ ì‘ë‹µì— ì˜í•´ í˜•ì„±ë©ë‹ˆë‹¤:
- $|H(\omega)| > 1$ì¸ ì£¼íŒŒìˆ˜ì—ì„œ: ì¦í­
- $|H(\omega)| < 1$ì¸ ì£¼íŒŒìˆ˜ì—ì„œ: ê°ì‡ 
- $|H(\omega)| = 0$ì¸ ì£¼íŒŒìˆ˜ì—ì„œ: ì™„ì „ ì œê±° (ì˜ì )</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Convolution theorem demonstration ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Input: sum of two frequencies</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span>  <span class="c1"># Hz</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># LTI system: lowpass (exponential decay)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># time constant</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">h</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>  <span class="c1"># normalize for unity DC gain</span>

<span class="c1"># Time-domain convolution</span>
<span class="n">y_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>

<span class="c1"># Frequency-domain multiplication</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">Y_freq</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">H</span>
<span class="n">y_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">Y_freq</span><span class="p">)))</span> <span class="o">/</span> <span class="n">dt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Time domain signals</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input $x(t)$: 3 Hz + 15 Hz&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response $h(t)$: Lowpass&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Frequency domain</span>
<span class="n">f_hz</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input Spectrum $|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Response $|H(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Output comparison</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_time</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time-domain conv&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_freq</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Freq-domain mult&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output $y(t) = x * h$ (both methods agree)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_freq</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output Spectrum $|Y(</span><span class="se">\\</span><span class="s1">omega)| = |X </span><span class="se">\\</span><span class="s1">cdot H|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;convolution_theorem.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ê³±ì…ˆ ì •ë¦¬(ìœˆë„ì‰)<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ê³µì‹<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p>$$\mathcal{F}\{x(t) \cdot w(t)\} = \frac{1}{2\pi} X(\omega) * W(\omega)$$</p>
<p><strong>ì‹œê°„ ì˜ì—­ì—ì„œì˜ ê³±ì…ˆì€ ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ í•©ì„±ê³±ì…ë‹ˆë‹¤</strong> ($1/(2\pi)$ ìŠ¤ì¼€ì¼ë§).</p>
<h3 id="72-windowing">7.2 ìœˆë„ì‰(Windowing)<a class="header-link" href="#72-windowing" title="Permanent link">&para;</a></h3>
<p>ìœ í•œ êµ¬ê°„ $[-T/2, T/2]$ì—ì„œ ì‹ í˜¸ë¥¼ ê´€ì¸¡í•˜ë©´, ì•”ë¬µì ìœ¼ë¡œ ì§ì‚¬ê° ì°½ $w(t) = \text{rect}(t/T)$ë¥¼ ê³±í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<p>ê´€ì¸¡ëœ ìŠ¤í™íŠ¸ëŸ¼ì€ ì‹¤ì œ $X(\omega)$ê°€ ì•„ë‹ˆë¼ <strong>í•©ì„±ê³±ëœ</strong> (ë²ˆì ¸ì§„) ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤:</p>
<p>$$X_{\text{obs}}(\omega) = \frac{1}{2\pi} X(\omega) * W(\omega)$$</p>
<p>ì—¬ê¸°ì„œ $W(\omega) = T\,\text{sinc}(\omega T/(2\pi))$ëŠ” ì§ì‚¬ê° ì°½ì˜ ë³€í™˜ì…ë‹ˆë‹¤.</p>
<p>ì´ í•©ì„±ê³±ì€:
- ìŠ¤í™íŠ¸ëŸ¼ í”¼í¬ë¥¼ <strong>ë„“í˜</strong> (ì£¼íŒŒìˆ˜ ë¶„í•´ëŠ¥ ê°ì†Œ)
- <strong>ì‚¬ì´ë“œë¡œë¸Œ(sidelobe)</strong> ìƒì„± (sinc í•¨ìˆ˜ì˜ ìŠ¤í™íŠ¸ëŸ¼ ëˆ„ì„¤)</p>
<h3 id="73-window-functions">7.3 ì°½ í•¨ìˆ˜(Window Functions)<a class="header-link" href="#73-window-functions" title="Permanent link">&para;</a></h3>
<p>ì„œë¡œ ë‹¤ë¥¸ ì°½ í•¨ìˆ˜ë“¤ì€ ì£¼ì—½ ë„ˆë¹„(ë¶„í•´ëŠ¥)ì™€ ë¶€ì—½ ë ˆë²¨(ëˆ„ì„¤) ì‚¬ì´ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ì°½ í•¨ìˆ˜</th>
<th>ì£¼ì—½ ë„ˆë¹„</th>
<th>ì²« ë²ˆì§¸ ë¶€ì—½ (dB)</th>
<th>ì‚¬ìš© ì‚¬ë¡€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì§ì‚¬ê°í˜•(Rectangular)</td>
<td>ê°€ì¥ ì¢ìŒ</td>
<td>-13</td>
<td>ìµœëŒ€ ë¶„í•´ëŠ¥</td>
</tr>
<tr>
<td>í•´ë°(Hamming)</td>
<td>1.8x ì§ì‚¬ê°í˜•</td>
<td>-42</td>
<td>ë²”ìš©</td>
</tr>
<tr>
<td>í•´ë‹(Hanning)</td>
<td>2.0x ì§ì‚¬ê°í˜•</td>
<td>-31</td>
<td>ë²”ìš©</td>
</tr>
<tr>
<td>ë¸”ë™ë§Œ(Blackman)</td>
<td>2.9x ì§ì‚¬ê°í˜•</td>
<td>-58</td>
<td>ë‚®ì€ ëˆ„ì„¤</td>
</tr>
<tr>
<td>ì¹´ì´ì €(Kaiser) ($\beta$)</td>
<td>ê°€ë³€</td>
<td>ê°€ë³€</td>
<td>ì¡°ì • ê°€ëŠ¥í•œ íŠ¸ë ˆì´ë“œì˜¤í”„</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="c1"># --- Windowing effect on spectrum ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Signal: two close sinusoids</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">55</span>  <span class="c1"># Hz (5 Hz apart)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># Window functions</span>
<span class="n">windows</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Rectangular&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
    <span class="s1">&#39;Hamming&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
    <span class="s1">&#39;Hanning&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
    <span class="s1">&#39;Blackman&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">windows</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">x_windowed</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">w</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_windowed</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Window&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">f1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">f2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Effect of Windowing on Spectral Analysis&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;windowing_effect.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8">8. íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ê³µì‹ (ì—ë„ˆì§€ ë²„ì „)<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>$$E_x = \int_{-\infty}^{\infty} |x(t)|^2 \, dt = \frac{1}{2\pi} \int_{-\infty}^{\infty} |X(\omega)|^2 \, d\omega$$</p>
<p>ë˜ëŠ” ì¼ë°˜ ì£¼íŒŒìˆ˜ $f$ë¥¼ ì‚¬ìš©í•˜ë©´:</p>
<p>$$\int_{-\infty}^{\infty} |x(t)|^2 \, dt = \int_{-\infty}^{\infty} |X(f)|^2 \, df$$</p>
<h3 id="82">8.2 í•´ì„<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ì¢Œë³€</strong>: ì „ì²´ ì‹ í˜¸ ì—ë„ˆì§€ (ì‹œê°„ ì˜ì—­ì—ì„œ ê³„ì‚°)</li>
<li><strong>ìš°ë³€</strong>: ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„ë¡œë¶€í„° ê³„ì‚°ëœ ì „ì²´ ì—ë„ˆì§€</li>
</ul>
<p>$|X(\omega)|^2$ëŠ” <strong>ì—ë„ˆì§€ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„(ESD)</strong> â€” ê° ë¬´í•œì†Œ ì£¼íŒŒìˆ˜ ëŒ€ì—­ì— ì–¼ë§ˆë‚˜ ë§ì€ ì—ë„ˆì§€ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì•Œë ¤ì¤ë‹ˆë‹¤.</p>
<h3 id="83">8.3 ì¼ë°˜í™” íŒŒë¥´ìŠ¤ë°œ (ë ˆì¼ë¦¬ ì •ë¦¬)<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<p>ë‘ ì‹ í˜¸ì— ëŒ€í•´:</p>
<p>$$\int_{-\infty}^{\infty} x(t) y^*(t) \, dt = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(\omega) Y^*(\omega) \, d\omega$$</p>
<h3 id="84">8.4 ì£¼íŒŒìˆ˜ ëŒ€ì—­ì˜ ì—ë„ˆì§€<a class="header-link" href="#84" title="Permanent link">&para;</a></h3>
<p>ì£¼íŒŒìˆ˜ ëŒ€ì—­ $[\omega_1, \omega_2]$ì—ì„œì˜ ì—ë„ˆì§€ëŠ”:</p>
<p>$$E_{[\omega_1, \omega_2]} = \frac{1}{2\pi} \int_{\omega_1}^{\omega_2} |X(\omega)|^2 \, d\omega + \frac{1}{2\pi} \int_{-\omega_2}^{-\omega_1} |X(\omega)|^2 \, d\omega$$</p>
<p>ì¼¤ë ˆ ëŒ€ì¹­ì„ ê°€ì§„ ì‹¤ìˆ˜ ì‹ í˜¸ì— ëŒ€í•´:</p>
<p>$$E_{[\omega_1, \omega_2]} = \frac{1}{\pi} \int_{\omega_1}^{\omega_2} |X(\omega)|^2 \, d\omega$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Parseval&#39;s theorem verification ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Gaussian pulse</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Time-domain energy</span>
<span class="n">E_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># Frequency-domain energy</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">E_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="c1"># Analytical energy</span>
<span class="n">E_analytical</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Parseval&#39;s Theorem Verification ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gaussian pulse with sigma = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time-domain energy:      </span><span class="si">{</span><span class="n">E_time</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frequency-domain energy: </span><span class="si">{</span><span class="n">E_freq</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analytical energy:       </span><span class="si">{</span><span class="n">E_analytical</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error (time vs freq):    </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_freq</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Energy distribution across frequency bands</span>
<span class="n">ESD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># energy spectral density</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x(t)$: Gaussian ($</span><span class="se">\\</span><span class="s1">sigma = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Energy Spectral Density $|X(</span><span class="se">\\</span><span class="s1">omega)|^2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Cumulative energy as function of bandwidth</span>
<span class="n">omega_pos</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">omega</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ESD_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">omega</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="n">cum_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ESD_pos</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega_pos</span><span class="p">,</span> <span class="n">cum_energy</span> <span class="o">/</span> <span class="n">E_time</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;99%&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cumulative Energy vs Bandwidth (Parseval&#39;s)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f total energy&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;parseval_ctft.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 ìŠ¤í™íŠ¸ëŸ¼ì´ ì•Œë ¤ì£¼ëŠ” ê²ƒ<a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<p>í‘¸ë¦¬ì— ë³€í™˜ì€ ì‹ í˜¸ë¥¼ êµ¬ì„± ì£¼íŒŒìˆ˜ë“¤ë¡œ ë¶„í•´í•©ë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ìŠ¤í™íŠ¸ëŸ¼ íŠ¹ì§•</th>
<th>ì‹œê°„ ì˜ì—­ í•´ì„</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\omega_0$ì—ì„œì˜ í”¼í¬</td>
<td>$\omega_0$ ì£¼íŒŒìˆ˜ì—ì„œì˜ ì§€ë°°ì  ì§„ë™</td>
</tr>
<tr>
<td>ë„“ì€ ì£¼ì—½</td>
<td>ì§§ì€ ì§€ì† ì‹œê°„ í„ìŠ¤ (ì‹œê°„-ëŒ€ì—­í­ íŠ¸ë ˆì´ë“œì˜¤í”„)</td>
</tr>
<tr>
<td>ì¢ì€ ì£¼ì—½</td>
<td>ê¸´ ì§€ì† ì‹œê°„ ë˜ëŠ” ì£¼ê¸° ì‹ í˜¸</td>
</tr>
<tr>
<td>í‰íƒ„í•œ ìŠ¤í™íŠ¸ëŸ¼</td>
<td>ì„í„ìŠ¤ ì‹ í˜¸ (ëª¨ë“  ì£¼íŒŒìˆ˜ ì¡´ì¬)</td>
</tr>
<tr>
<td>ê¸‰ê²©í•œ ìœ„ìƒ ë³€í™”</td>
<td>ì‹ í˜¸ì˜ ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì „í™˜</td>
</tr>
<tr>
<td>ëŒ€ì¹­ í¬ê¸°</td>
<td>ì‹¤ìˆ˜ê°’ ì‹ í˜¸</td>
</tr>
</tbody>
</table>
<h3 id="92">9.2 ë³µí•© ì‹ í˜¸ì˜ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„<a class="header-link" href="#92" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Spectral analysis of various signals ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="n">signals</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pure tone (440 Hz)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">440</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
    <span class="s1">&#39;Two tones (440 + 880 Hz)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">440</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">880</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
    <span class="s1">&#39;AM signal (carrier 500 Hz)&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
    <span class="s1">&#39;Chirp (100 to 1000 Hz)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">450</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">duration</span><span class="p">))),</span>
    <span class="s1">&#39;Gaussian pulse (t=1s)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.01</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
    <span class="s1">&#39;White noise&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">)))</span>

<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">signals</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="c1"># Time domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Frequency domain</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Spectrum of </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spectral_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="93-lti">9.3 LTI ì‹œìŠ¤í…œ ë¶„ì„<a class="header-link" href="#93-lti" title="Permanent link">&para;</a></h3>
<p>ì£¼íŒŒìˆ˜ ì‘ë‹µ $H(\omega)$ëŠ” LTI ì‹œìŠ¤í…œì´ ê° ì£¼íŒŒìˆ˜ë¥¼ ì–´ë–»ê²Œ ìˆ˜ì •í•˜ëŠ”ì§€ ì™„ì „íˆ ì„¤ëª…í•©ë‹ˆë‹¤:</p>
<p>$$Y(\omega) = H(\omega) X(\omega)$$</p>
<p>ì¸ê³¼ 1ì°¨ ì‹œìŠ¤í…œ $y'(t) + ay(t) = x(t)$ì— ëŒ€í•´:</p>
<p>í‘¸ë¦¬ì— ë³€í™˜ ì ìš©: $j\omega Y(\omega) + aY(\omega) = X(\omega)$</p>
<p>$$H(\omega) = \frac{Y(\omega)}{X(\omega)} = \frac{1}{a + j\omega}$$</p>
<ul>
<li><strong>í¬ê¸°</strong>: $|H(\omega)| = 1/\sqrt{a^2 + \omega^2}$ (ì €ì—­í†µê³¼, ë‹¨ì¡° ê°ì†Œ)</li>
<li><strong>3 dB ì°¨ë‹¨ ì£¼íŒŒìˆ˜</strong>: $\omega_c = a$ ($|H| = 1/\sqrt{2}$)</li>
<li><strong>ê¸°ìš¸ê¸°</strong>: $\omega \gg a$ì—ì„œ $-20$ dB/decade (1ì°¨ ì‹œìŠ¤í…œ)</li>
<li><strong>ìœ„ìƒ</strong>: $\angle H(\omega) = -\arctan(\omega/a)$ (ìœ„ìƒ ì§€ì—°ì´ ì£¼íŒŒìˆ˜ì— ë”°ë¼ ì¦ê°€)</li>
</ul>
<hr />
<h2 id="10">10. ì´ìƒì ì¸ í•„í„°<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<p>$$H_{LP}(\omega) = \begin{cases} 1 & |\omega| \leq \omega_c \\ 0 & |\omega| > \omega_c \end{cases} = \text{rect}\left(\frac{\omega}{2\omega_c}\right)$$</p>
<ul>
<li>$\omega_c$ ì´í•˜ì˜ ëª¨ë“  ì£¼íŒŒìˆ˜ë¥¼ ì™œê³¡ ì—†ì´ í†µê³¼</li>
<li>$\omega_c$ ì´ìƒì˜ ëª¨ë“  ì£¼íŒŒìˆ˜ë¥¼ ì™„ì „íˆ ì œê±°</li>
<li>ì„í„ìŠ¤ ì‘ë‹µ: $h(t) = \frac{\omega_c}{\pi}\text{sinc}\left(\frac{\omega_c t}{\pi}\right)$</li>
</ul>
<blockquote>
<p>ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°ëŠ” <strong>ë¹„ì¸ê³¼ì </strong> ($t < 0$ì—ì„œ $h(t) \neq 0$)ì´ë¯€ë¡œ <strong>ë¬¼ë¦¬ì ìœ¼ë¡œ ì‹¤í˜„ ë¶ˆê°€ëŠ¥</strong>í•©ë‹ˆë‹¤. ì‹¤ì œ í•„í„°ëŠ” ì´ ì´ìƒì  í˜•íƒœë¥¼ ê·¼ì‚¬í•©ë‹ˆë‹¤.</p>
</blockquote>
<h3 id="102">10.2 ì´ìƒì ì¸ ê³ ì—­í†µê³¼ í•„í„°<a class="header-link" href="#102" title="Permanent link">&para;</a></h3>
<p>$$H_{HP}(\omega) = 1 - H_{LP}(\omega) = \begin{cases} 0 & |\omega| \leq \omega_c \\ 1 & |\omega| > \omega_c \end{cases}$$</p>
<p>ì„í„ìŠ¤ ì‘ë‹µ: $h(t) = \delta(t) - \frac{\omega_c}{\pi}\text{sinc}\left(\frac{\omega_c t}{\pi}\right)$</p>
<h3 id="103">10.3 ì´ìƒì ì¸ ëŒ€ì—­í†µê³¼ í•„í„°<a class="header-link" href="#103" title="Permanent link">&para;</a></h3>
<p>$$H_{BP}(\omega) = \begin{cases} 1 & \omega_1 \leq |\omega| \leq \omega_2 \\ 0 & \text{otherwise} \end{cases}$$</p>
<h3 id="104">10.4 ì´ìƒì ì¸ ëŒ€ì—­ì €ì§€(ë…¸ì¹˜) í•„í„°<a class="header-link" href="#104" title="Permanent link">&para;</a></h3>
<p>$$H_{BS}(\omega) = 1 - H_{BP}(\omega) = \begin{cases} 0 & \omega_1 \leq |\omega| \leq \omega_2 \\ 1 & \text{otherwise} \end{cases}$$</p>
<h3 id="105">10.5 ì´ìƒì ì¸ ì „ì—­í†µê³¼ í•„í„°<a class="header-link" href="#105" title="Permanent link">&para;</a></h3>
<p>$$|H_{AP}(\omega)| = 1, \quad \angle H_{AP}(\omega) = \phi(\omega)$$</p>
<p>í¬ê¸°ëŠ” ë³€ê²½í•˜ì§€ ì•Šê³  ìœ„ìƒë§Œ ë³€ê²½í•©ë‹ˆë‹¤. ìœ„ìƒ ë“±í™”(phase equalization)ì— ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Ideal filters and their impulse responses ---</span>

<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># cutoff frequency</span>
<span class="n">omega_1</span><span class="p">,</span> <span class="n">omega_2</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span>  <span class="c1"># bandpass edges</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="c1"># 1. Lowpass</span>
<span class="n">H_lp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">omega_c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">h_lp</span> <span class="o">=</span> <span class="n">omega_c</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">omega_c</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H_lp</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal Lowpass ($</span><span class="se">\\</span><span class="s1">omega_c = </span><span class="si">{</span><span class="n">omega_c</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|H(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h_lp</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response: $h(t) = </span><span class="se">\\</span><span class="s1">frac{</span><span class="se">\\</span><span class="s1">omega_c}{</span><span class="se">\\</span><span class="s1">pi}</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{sinc}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega_c t / </span><span class="se">\\</span><span class="s1">pi)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Highpass</span>
<span class="n">H_hp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">H_lp</span>
<span class="n">h_hp_approx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1"># delta(t) approximation + sinc</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">delta_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">h_hp_approx</span><span class="p">[</span><span class="n">delta_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span>
<span class="n">h_hp_approx</span> <span class="o">-=</span> <span class="n">h_lp</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H_hp</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal Highpass ($</span><span class="se">\\</span><span class="s1">omega_c = </span><span class="si">{</span><span class="n">omega_c</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|H(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">h_lp</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$h(t) = </span><span class="se">\\</span><span class="s1">delta(t) - h_</span><span class="si">{LP}</span><span class="s1">(t)$ (sinc part shown)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Bandpass</span>
<span class="n">H_bp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">omega_1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">omega_2</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">omega_m</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega_1</span> <span class="o">+</span> <span class="n">omega_2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">omega_2</span> <span class="o">-</span> <span class="n">omega_1</span>
<span class="n">h_bp</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">B</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega_m</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H_bp</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal Bandpass ($</span><span class="se">\\</span><span class="s1">omega_1=</span><span class="si">{</span><span class="n">omega_1</span><span class="si">}</span><span class="s1">$, $</span><span class="se">\\</span><span class="s1">omega_2=</span><span class="si">{</span><span class="n">omega_2</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|H(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h_bp</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bandpass Impulse Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. Bandstop</span>
<span class="n">H_bs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">H_bp</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H_bs</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal Bandstop (Notch)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|H(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;$h(t) = </span><span class="se">\\</span><span class="s1">delta(t) - h_</span><span class="si">{BP}</span><span class="s1">(t)$&#39;</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bandstop = All - Bandpass&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideal_filters.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-">11. ëŒ€ì—­í­ê³¼ ì‹œê°„-ëŒ€ì—­í­ ê³±<a class="header-link" href="#11-" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 ëŒ€ì—­í­ ì •ì˜<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<p>ì‹ í˜¸ì˜ ëŒ€ì—­í­ì„ ì •ì˜í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>ì •ì˜</th>
<th>ìˆ˜ì‹</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>3 dB ëŒ€ì—­í­</strong></td>
<td>$B_{3dB}$: $\|X(\omega_c)\|^2 = \frac{1}{2}\|X(0)\|^2$</td>
<td>ë°˜ì „ë ¥(half-power) ëŒ€ì—­í­</td>
</tr>
<tr>
<td><strong>ì˜ì  ê°„ ëŒ€ì—­í­</strong></td>
<td>ì²« ë²ˆì§¸ ì˜ì  ì‚¬ì´ ê±°ë¦¬</td>
<td>sinc í˜• ìŠ¤í™íŠ¸ëŸ¼ì— ì£¼ë¡œ ì‚¬ìš©</td>
</tr>
<tr>
<td><strong>ë“±ê°€ ì¡ìŒ ëŒ€ì—­í­</strong></td>
<td>$B_{eq} = \frac{\int|X(\omega)|^2 d\omega}{|X(\omega_0)|^2}$</td>
<td>ê°™ì€ í”¼í¬ì™€ ì—ë„ˆì§€ë¥¼ ê°€ì§„ ì§ì‚¬ê°í˜•</td>
</tr>
<tr>
<td><strong>RMS ëŒ€ì—­í­</strong></td>
<td>$B_{rms} = \sqrt{\frac{\int\omega^2|X(\omega)|^2 d\omega}{\int|X(\omega)|^2 d\omega}}$</td>
<td>$|X|^2$ì˜ í‘œì¤€ í¸ì°¨</td>
</tr>
<tr>
<td><strong>ë³¸ì§ˆ ëŒ€ì—­í­</strong></td>
<td>$B_{ess}$: $p$%ì˜ ì—ë„ˆì§€ í¬í•¨</td>
<td>ì£¼ë¡œ $p = 99$</td>
</tr>
</tbody>
</table>
<h3 id="112-">11.2 ì‹œê°„-ëŒ€ì—­í­ ê³± (ë¶ˆí™•ì •ì„± ì›ë¦¬)<a class="header-link" href="#112-" title="Permanent link">&para;</a></h3>
<p>ì‹ í˜¸ ì§€ì† ì‹œê°„ $\Delta t$ì™€ ëŒ€ì—­í­ $\Delta\omega$ ì‚¬ì´ì—ëŠ” ê·¼ë³¸ì ì¸ ì œì•½ì´ ìˆìŠµë‹ˆë‹¤:</p>
<p>$$\Delta t \cdot \Delta\omega \geq \frac{1}{2}$$</p>
<p>ì—¬ê¸°ì„œ $\Delta t$ì™€ $\Delta\omega$ëŠ” ì‹œê°„ê³¼ ì£¼íŒŒìˆ˜ì—ì„œì˜ RMS ì§€ì† ì‹œê°„ìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤:</p>
<p>$$\Delta t = \sqrt{\frac{\int t^2 |x(t)|^2 dt}{\int |x(t)|^2 dt}}, \quad \Delta\omega = \sqrt{\frac{\int \omega^2 |X(\omega)|^2 d\omega}{\int |X(\omega)|^2 d\omega}}$$</p>
<p><strong>ë“±í˜¸</strong> $\Delta t \cdot \Delta\omega = 1/2$ëŠ” <strong>ê°€ìš°ì‹œì•ˆ í„ìŠ¤ì—ì„œë§Œ</strong> ë‹¬ì„±ë©ë‹ˆë‹¤ â€” ì´ê²ƒì´ ì‹œê°„-ì£¼íŒŒìˆ˜ ê²°í•© ì˜ë¯¸ì—ì„œ ê°€ì¥ ì»´íŒ©íŠ¸í•œ ì‹ í˜¸ì…ë‹ˆë‹¤.</p>
<h3 id="113">11.3 ì‹¤ì œì  ì˜ë¯¸<a class="header-link" href="#113" title="Permanent link">&para;</a></h3>
<ul>
<li>ì§§ì€ í„ìŠ¤ (ì‘ì€ $\Delta t$)ëŠ” ë„“ì€ ëŒ€ì—­í­ì´ í•„ìš” (í° $\Delta\omega$)</li>
<li>í˜‘ëŒ€ì—­ ì‹ í˜¸ (ì‘ì€ $\Delta\omega$)ëŠ” ê¸´ ì§€ì† ì‹œê°„ì´ í•„ìš” (í° $\Delta t$)</li>
<li>ì‹œê°„ê³¼ ì£¼íŒŒìˆ˜ì—ì„œ ë™ì‹œì— ë§¤ìš° ì¢ê²Œ ì„¤ê³„ëœ ì‹ í˜¸ëŠ” ë§Œë“¤ ìˆ˜ ì—†ìŒ</li>
<li>ì´ê²ƒì€ ì–‘ìì—­í•™ì˜ í•˜ì´ì  ë² ë¥´í¬ ë¶ˆí™•ì •ì„± ì›ë¦¬ì™€ ìœ ì‚¬í•œ ì‹ í˜¸ ì²˜ë¦¬ ê°œë…</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Time-bandwidth product demonstration ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_time_bandwidth_product</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute RMS duration, RMS bandwidth, and their product.&quot;&quot;&quot;</span>
    <span class="c1"># Normalize energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">E</span>

    <span class="c1"># RMS duration</span>
    <span class="n">t_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">x_norm</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">t2_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_norm</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">delta_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t2_mean</span> <span class="o">-</span> <span class="n">t_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Spectrum</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">X_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="c1"># RMS bandwidth</span>
    <span class="n">omega_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">X_norm</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
    <span class="n">omega2_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">X_norm</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
    <span class="n">delta_omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega2_mean</span> <span class="o">-</span> <span class="n">omega_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_omega</span><span class="p">,</span> <span class="n">delta_t</span> <span class="o">*</span> <span class="n">delta_omega</span>

<span class="c1"># Test with different Gaussian widths</span>
<span class="n">sigmas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Time-Bandwidth Product for Gaussian Pulses ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;sigma&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Delta_t&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Delta_omega&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;TBP&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Limit (0.5)&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="n">delta_ts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">delta_omegas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sigmas</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">dt_val</span><span class="p">,</span> <span class="n">dw_val</span><span class="p">,</span> <span class="n">tbp</span> <span class="o">=</span> <span class="n">compute_time_bandwidth_product</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">delta_ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt_val</span><span class="p">)</span>
    <span class="n">delta_omegas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dw_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sigma</span><span class="si">:</span><span class="s2">&gt;8.1f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">dt_val</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">dw_val</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">tbp</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;0.5000&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Compare with rectangular pulse</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== TBP for Other Pulse Shapes ===&quot;</span><span class="p">)</span>
<span class="n">shapes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gaussian (sigma=0.5)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
    <span class="s1">&#39;Rectangular (width=1)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
    <span class="s1">&#39;Triangular (width=2)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
    <span class="s1">&#39;Exponential (a=2)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">dt_val</span><span class="p">,</span> <span class="n">dw_val</span><span class="p">,</span> <span class="n">tbp</span> <span class="o">=</span> <span class="n">compute_time_bandwidth_product</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&gt;30</span><span class="si">}</span><span class="s2">: TBP = </span><span class="si">{</span><span class="n">tbp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (limit = 0.5)&quot;</span><span class="p">)</span>

<span class="c1"># Visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gaussian Pulses (time domain)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectra (frequency domain)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Time-Bandwidth Tradeoff: Narrow in time = Wide in frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;time_bandwidth.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="12-python">12. Python ì˜ˆì œ<a class="header-link" href="#12-python" title="Permanent link">&para;</a></h2>
<h3 id="121-ctft">12.1 ì¢…í•© CTFT ë¶„ì„ íˆ´í‚·<a class="header-link" href="#121-ctft" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CTFTAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Continuous-Time Fourier Transform analysis toolkit using FFT.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">duration</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ctft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Approximate CTFT using FFT.&quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">return</span> <span class="n">omega</span><span class="p">,</span> <span class="n">X</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ictft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Approximate inverse CTFT using IFFT.&quot;&quot;&quot;</span>
        <span class="n">X_unshifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X_unshifted</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="c1"># Correct scaling</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Signal energy in time domain.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">energy_spectral_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Energy from frequency domain (Parseval&#39;s).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bandwidth_3db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute 3-dB bandwidth.&quot;&quot;&quot;</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mag</span><span class="p">)</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">above</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">mag</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">above</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">above</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">above</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Signal&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete time-frequency analysis.&quot;&quot;&quot;</span>
        <span class="n">omega</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="c1"># Time domain</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1"> â€” Time Domain&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Magnitude spectrum</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Spectrum $|X(</span><span class="se">\\</span><span class="s1">omega)|$&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Phase spectrum</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="c1"># Mask small values</span>
        <span class="n">phase</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase Spectrum $</span><span class="se">\\</span><span class="s1">angle X(</span><span class="se">\\</span><span class="s1">omega)$&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (rad)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Log magnitude (dB)</span>
        <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Log Magnitude (dB)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Energy spectral density</span>
        <span class="n">ESD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">ESD</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Energy Spectral Density $|X(</span><span class="se">\\</span><span class="s1">omega)|^2$&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Energy distribution</span>
        <span class="n">E_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">omega_pos</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">omega</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ESD_pos</span> <span class="o">=</span> <span class="n">ESD</span><span class="p">[</span><span class="n">omega</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">cum_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ESD_pos</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega_pos</span><span class="p">,</span> <span class="n">cum_energy</span> <span class="o">/</span> <span class="n">E_total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;99%&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative Energy (%)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Print statistics</span>
        <span class="n">E_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_spectral_density</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
        <span class="n">bw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth_3db</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> Analysis ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Energy (time):  </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Energy (freq):  </span><span class="si">{</span><span class="n">E_freq</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  3-dB bandwidth: </span><span class="si">{</span><span class="n">bw</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> rad/s = </span><span class="si">{</span><span class="n">bw</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ctft_analysis_</span><span class="si">{</span><span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
                    <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Demonstrate</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">CTFTAnalyzer</span><span class="p">(</span><span class="n">fs</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="c1"># Gaussian pulse</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">x_gauss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">analyzer</span><span class="o">.</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">x_gauss</span><span class="p">,</span> <span class="s2">&quot;Gaussian Pulse&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="122">12.2 ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œì˜ í•„í„°ë§<a class="header-link" href="#122" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Frequency-domain filtering ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Create a signal with multiple frequency components</span>
<span class="n">f_components</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]</span>
<span class="n">amplitudes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">amplitudes</span><span class="p">,</span> <span class="n">f_components</span><span class="p">))</span>
<span class="n">x</span> <span class="o">+=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># add noise</span>

<span class="c1"># Design filters in frequency domain</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Lowpass: keep below 800 Hz</span>
<span class="n">fc_lp</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">H_lp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">fc_lp</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="c1"># Smooth transition (Gaussian rolloff instead of brick wall)</span>
<span class="n">H_lp_smooth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq</span> <span class="o">-</span> <span class="n">fc_lp</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">50</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Bandpass: 400-600 Hz</span>
<span class="n">H_bp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">freq</span> <span class="o">-</span> <span class="mi">500</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Apply filters</span>
<span class="n">y_lp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">H_lp_smooth</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">y_bp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">H_bp</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Original</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_components</span><span class="p">:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Spectrum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Lowpass filtered</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="n">y_lp</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lowpass Filtered ($f_c = </span><span class="si">{</span><span class="n">fc_lp</span><span class="si">}</span><span class="s1">$ Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">Y_lp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y_lp</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_lp</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">H_lp_smooth</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filter&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Lowpass Output Spectrum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Bandpass filtered</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="n">y_bp</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bandpass Filtered (center = 500 Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">Y_bp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y_bp</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_bp</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">H_bp</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filter&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bandpass Output Spectrum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;freq_domain_filtering.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="123">12.3 ì„±ì§ˆ ê²€ì¦ ìŠ¤ìœ„íŠ¸<a class="header-link" href="#123" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- Systematic verification of Fourier transform properties ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">duration</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fft_ctft</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Approximate CTFT using FFT.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Test signal: Gaussian</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Fourier Transform Property Verification ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 1. Linearity</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X_linear_lhs</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span>
<span class="n">X_linear_rhs</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. Linearity:       error = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_linear_lhs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X_linear_rhs</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2. Time shifting</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">x_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X_shift_lhs</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x_shifted</span><span class="p">)</span>
<span class="n">X_shift_rhs</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">t0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Time shifting:   error = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_shift_lhs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X_shift_rhs</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. Frequency shifting</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">x_modulated</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">X_mod_lhs</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x_modulated</span><span class="p">)</span>
<span class="c1"># Shift X by omega0</span>
<span class="n">X_mod_rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">+</span> \
            <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="c1"># This is approximate due to interpolation; use a simpler check</span>
<span class="c1"># Check that the peak moved</span>
<span class="n">peak_original</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">))]</span>
<span class="n">peak_modulated</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_mod_lhs</span><span class="p">))]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3. Freq shifting:   peak moved from </span><span class="si">{</span><span class="n">peak_original</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">peak_modulated</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;(expected </span><span class="si">{</span><span class="n">peak_original</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">omega0</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># 4. Time scaling</span>
<span class="n">a_scale</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">x_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">a_scale</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X_scale_lhs</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">x_scaled</span><span class="p">)</span>
<span class="c1"># Compare with analytical: sigma/a * sqrt(2pi) * exp(-sigma^2 * omega^2 / (2*a^2))</span>
<span class="n">X_scale_analytical</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma</span> <span class="o">/</span> <span class="n">a_scale</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> \
                     <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a_scale</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Normalize for comparison</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_scale_lhs</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">X_scale_analytical</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">X_scale_analytical</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4. Time scaling:    peak ratio = </span><span class="si">{</span><span class="n">ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (expected ~1.0)&quot;</span><span class="p">)</span>

<span class="c1"># 5. Parseval&#39;s theorem</span>
<span class="n">E_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">E_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;5. Parseval&#39;s:      E_time=</span><span class="si">{</span><span class="n">E_time</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, E_freq=</span><span class="si">{</span><span class="n">E_freq</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;error=</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_time</span><span class="o">-</span><span class="n">E_freq</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 6. Convolution theorem</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">y_conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">Y_conv</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">y_conv</span><span class="p">)</span>
<span class="n">Y_mult</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">H</span>
<span class="n">conv_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_conv</span> <span class="o">-</span> <span class="n">Y_mult</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_conv</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;6. Convolution thm: relative error = </span><span class="si">{</span><span class="n">conv_error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 7. Differentiation</span>
<span class="c1"># Numerical derivative</span>
<span class="n">dx_dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">X_diff_lhs</span> <span class="o">=</span> <span class="n">fft_ctft</span><span class="p">(</span><span class="n">dx_dt</span><span class="p">)</span>
<span class="n">X_diff_rhs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
<span class="c1"># Compare (ignoring edges where gradient is inaccurate)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span>
<span class="n">diff_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_diff_lhs</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">X_diff_rhs</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_diff_rhs</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;7. Differentiation: relative error = </span><span class="si">{</span><span class="n">diff_error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="124">12.4 ë³€í™˜ ìŒ ê°¤ëŸ¬ë¦¬<a class="header-link" href="#124" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Gallery of Fourier transform pairs ---</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ctft</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">pairs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;$e^{-2t}u(t)$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{1}</span><span class="s1">{2+j</span><span class="se">\\</span><span class="s1">omega}$&#39;</span><span class="p">,</span>
     <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)),</span>

    <span class="p">(</span><span class="s1">&#39;$e^{-2|t|}$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{4}</span><span class="s1">{4+</span><span class="se">\\</span><span class="s1">omega^2}$&#39;</span><span class="p">,</span>
     <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>

    <span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{rect}</span><span class="s1">(t)$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{sinc}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">omega/(2</span><span class="se">\\</span><span class="s1">pi))$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))),</span>

    <span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{tri}</span><span class="s1">(t)$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{sinc}</span><span class="s1">^2(</span><span class="se">\\</span><span class="s1">omega/(2</span><span class="se">\\</span><span class="s1">pi))$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>

    <span class="p">(</span><span class="s1">&#39;$e^{-t^2/2}$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sqrt{2</span><span class="se">\\</span><span class="s1">pi}e^{-</span><span class="se">\\</span><span class="s1">omega^2/2}$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>

    <span class="p">(</span><span class="s1">&#39;$te^{-t}u(t)$&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
     <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{1}</span><span class="s1">{(1+j</span><span class="se">\\</span><span class="s1">omega)^2}$&#39;</span><span class="p">,</span>
     <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">t_label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">f_label</span><span class="p">,</span> <span class="n">X_analytical</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pairs</span><span class="p">):</span>
    <span class="c1"># Numerical transform</span>
    <span class="n">X_numerical</span> <span class="o">=</span> <span class="n">ctft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Time domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x(t) = $ </span><span class="si">{</span><span class="n">t_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Frequency domain (compare numerical and analytical)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_numerical</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FFT (numerical)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_analytical</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$X(</span><span class="se">\\</span><span class="s1">omega) = $ </span><span class="si">{</span><span class="n">f_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega$ (rad/s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Fourier Transform Pair Gallery: Numerical vs Analytical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;transform_pair_gallery.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="13">13. ìš”ì•½<a class="header-link" href="#13" title="Permanent link">&para;</a></h2>
<h3 id="_2">í•µì‹¬ ê°œë…<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>í•µì‹¬ ë‚´ìš©</th>
</tr>
</thead>
<tbody>
<tr>
<td>í‘¸ë¦¬ì— ë³€í™˜</td>
<td>ë¹„ì£¼ê¸° ì‹ í˜¸ë¥¼ ì—°ì† ì£¼íŒŒìˆ˜ ì„±ë¶„ìœ¼ë¡œ ë¶„í•´</td>
</tr>
<tr>
<td>ì—­ë³€í™˜</td>
<td>ìŠ¤í™íŠ¸ëŸ¼ìœ¼ë¡œë¶€í„° ì‹ í˜¸ ì¬êµ¬ì„±</td>
</tr>
<tr>
<td>í•©ì„±ê³± ì •ë¦¬</td>
<td>ì‹œê°„ì˜ í•©ì„±ê³± = ì£¼íŒŒìˆ˜ì˜ ê³±ì…ˆ</td>
</tr>
<tr>
<td>ê³±ì…ˆ ì •ë¦¬</td>
<td>ì‹œê°„ì˜ ê³±ì…ˆ = ì£¼íŒŒìˆ˜ì˜ í•©ì„±ê³±</td>
</tr>
<tr>
<td>íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬</td>
<td>ì—ë„ˆì§€ëŠ” ì‹œê°„ ì˜ì—­ê³¼ ì£¼íŒŒìˆ˜ ì˜ì—­ ì‚¬ì´ì—ì„œ ë³´ì¡´</td>
</tr>
<tr>
<td>ì‹œê°„-ëŒ€ì—­í­ ê³±</td>
<td>$\Delta t \cdot \Delta\omega \geq 1/2$ (ë¶ˆí™•ì •ì„± ì›ë¦¬)</td>
</tr>
</tbody>
</table>
<h3 id="_3">ë³€í™˜ ì„±ì§ˆ ë¹ ë¥¸ ì°¸ì¡°<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì‹œê°„ ì˜ì—­  â†â†’  ì£¼íŒŒìˆ˜ ì˜ì—­
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
x(t-tâ‚€)     â†â†’  e^{-jÏ‰tâ‚€} X(Ï‰)      ì‹œê°„ ì´ë™ = ì„ í˜• ìœ„ìƒ
x(t)e^{jÏ‰â‚€t} â†â†’  X(Ï‰-Ï‰â‚€)            ë³€ì¡° = ìŠ¤í™íŠ¸ëŸ¼ ì´ë™
x(at)        â†â†’  (1/|a|)X(Ï‰/a)       ì••ì¶• â†” íŒ½ì°½
dx/dt        â†â†’  jÏ‰ X(Ï‰)             ë¯¸ë¶„ = Ã— jÏ‰
x*h          â†â†’  XÂ·H                  í•©ì„±ê³± = ê³±ì…ˆ
xÂ·w          â†â†’  (1/2Ï€) X*W           ê³±ì…ˆ = í•©ì„±ê³±
</code></pre></div>

<h3 id="_4">ê¸‰ìˆ˜ì—ì„œ ë³€í™˜ìœ¼ë¡œ: í° ê·¸ë¦¼<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>    ì£¼ê¸° ì‹ í˜¸                    ë¹„ì£¼ê¸° ì‹ í˜¸
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    í‘¸ë¦¬ì— ê¸‰ìˆ˜                  í‘¸ë¦¬ì— ë³€í™˜
    cn (ì´ì‚°)                   X(Ï‰) (ì—°ì†)
    ì„  ìŠ¤í™íŠ¸ëŸ¼                  ì—°ì† ìŠ¤í™íŠ¸ëŸ¼
    Î£ cn e^{jnÏ‰â‚€t}             âˆ« X(Ï‰) e^{jÏ‰t} dÏ‰/(2Ï€)
         â”‚                              â”‚
         â””â”€â”€â”€â”€ Tâ‚€ â†’ âˆë¡œ ì·¨í•˜ë©´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               cn â†’ X(Ï‰)dÏ‰/(2Ï€)
               nÏ‰â‚€ â†’ Ï‰
               Î£ â†’ âˆ«
</code></pre></div>

<hr />
<h2 id="14">14. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ ë¬¸ì œ 1: ë³€í™˜ ê³„ì‚°<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì‹ í˜¸ë“¤ì˜ í‘¸ë¦¬ì— ë³€í™˜ì„ í•´ì„ì ìœ¼ë¡œ ê³„ì‚°í•˜ì„¸ìš”. Pythonìœ¼ë¡œ ê²€ì¦í•˜ì„¸ìš”.</p>
<ol>
<li>$x(t) = e^{-3t}u(t) - e^{-5t}u(t)$</li>
<li>$x(t) = te^{-2t}u(t)$ (ì£¼íŒŒìˆ˜ ë¯¸ë¶„ ì„±ì§ˆ ì‚¬ìš©)</li>
<li>$x(t) = e^{-|t|}\cos(10t)$ (ë³€ì¡° + $e^{-|t|}$ì˜ ì•Œë ¤ì§„ ë³€í™˜ ì‚¬ìš©)</li>
<li>$x(t) = \text{rect}(t) \cdot \cos(20\pi t)$ (ë³€ì¡°ëœ ì§ì‚¬ê° í„ìŠ¤)</li>
</ol>
<h3 id="2_1">ì—°ìŠµ ë¬¸ì œ 2: ì„±ì§ˆ ì‘ìš©<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>$e^{-at}u(t) \leftrightarrow 1/(a + j\omega)$ì˜ í‘¸ë¦¬ì— ë³€í™˜ê³¼ ë³€í™˜ ì„±ì§ˆë§Œì„ ì‚¬ìš©í•˜ì—¬ (ì ë¶„ìœ¼ë¡œ ë‹¤ì‹œ ìœ ë„í•˜ì§€ ë§ê³ ) ë‹¤ìŒì„ êµ¬í•˜ì„¸ìš”:</p>
<ol>
<li>$\mathcal{F}\{e^{-a(t-3)}u(t-3)\}$ (ì‹œê°„ ì´ë™)</li>
<li>$\mathcal{F}\{e^{-at}u(t) \cdot e^{j5t}\}$ (ì£¼íŒŒìˆ˜ ì´ë™)</li>
<li>$\mathcal{F}\{e^{-2at}u(2t)\}$ (ìŠ¤ì¼€ì¼ë§; ì£¼ì˜ í•„ìš”!)</li>
<li>$\mathcal{F}\{te^{-at}u(t)\}$ (ì£¼íŒŒìˆ˜ ë¯¸ë¶„)</li>
<li>$\mathcal{F}\{\frac{d}{dt}[e^{-at}u(t)]\}$ (ì‹œê°„ ë¯¸ë¶„; $t=0$ì—ì„œì˜ ë¸íƒ€ ì£¼ì˜)</li>
</ol>
<h3 id="3_1">ì—°ìŠµ ë¬¸ì œ 3: í•©ì„±ê³± ì •ë¦¬ ì‘ìš©<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<ol>
<li>ì£¼íŒŒìˆ˜ ì˜ì—­ì„ ì‚¬ìš©í•˜ì—¬ $e^{-t}u(t) * e^{-2t}u(t)$ë¥¼ ê³„ì‚°í•˜ì„¸ìš” (ë³€í™˜, ê³±ì…ˆ, ì—­ë³€í™˜). ì§ì ‘ í•©ì„±ê³±ìœ¼ë¡œ ê²€ì¦í•˜ì„¸ìš”.</li>
<li>ì…ë ¥ì´ $\omega_c = 5$ rad/sì¸ $x(t) = e^{-t}u(t)$ì¼ ë•Œ 1ì°¨ ì €ì—­í†µê³¼ ì‹œìŠ¤í…œ $H(\omega) = 1/(1 + j\omega/\omega_c)$ì˜ ì¶œë ¥ì„ êµ¬í•˜ì„¸ìš”.</li>
<li>$x(t) = \text{sinc}(Bt)$ ì‹ í˜¸ê°€ ì°¨ë‹¨ ì£¼íŒŒìˆ˜ $\omega_c$ì˜ ì´ìƒì  ì €ì—­í†µê³¼ í•„í„°ë¥¼ í†µê³¼í•  ë•Œ, (a) $\omega_c > \pi B$? (b) $\omega_c < \pi B$? ì¼ ë•Œ ì¶œë ¥ì€?</li>
</ol>
<h3 id="4_1">ì—°ìŠµ ë¬¸ì œ 4: íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<ol>
<li>íŒŒë¥´ìŠ¤ë°œ ì •ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ $x(t) = \frac{1}{1+t^2}$ì˜ ì—ë„ˆì§€ë¥¼ ê³„ì‚°í•˜ì„¸ìš” (íŒíŠ¸: ë¨¼ì € $X(\omega)$ë¥¼ êµ¬í•˜ì„¸ìš”).</li>
<li>ê°€ìš°ì‹œì•ˆ í„ìŠ¤ $e^{-t^2/(2\sigma^2)}$ì˜ ì—ë„ˆì§€ ì¤‘ ì£¼íŒŒìˆ˜ ëŒ€ì—­ $|\omega| \leq 1/\sigma$ ë‚´ì— ìˆëŠ” ë¹„ìœ¨ì€?</li>
<li>ë„ˆë¹„ $T$ì˜ ì§ì‚¬ê° í„ìŠ¤ëŠ” ì—ë„ˆì§€ê°€ $T$ì…ë‹ˆë‹¤. 99% ì—ë„ˆì§€ ê¸°ì¤€ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë§ì€ ëŒ€ì—­í­ì´ í•„ìš”í•œê°€ìš”?</li>
</ol>
<h3 id="5_1">ì—°ìŠµ ë¬¸ì œ 5: í•„í„° ì„¤ê³„<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<ol>
<li>60 Hz í—˜(hum)ê³¼ ê´‘ëŒ€ì—­ ì¡ìŒìœ¼ë¡œ ì˜¤ì—¼ëœ ì‹ í˜¸ì—ì„œ 1 kHz í†¤ì„ ì¶”ì¶œí•˜ëŠ” ì£¼íŒŒìˆ˜ ì˜ì—­ í•„í„°ë¥¼ ì„¤ê³„í•˜ì„¸ìš”. FFTë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ê³ , í…ŒìŠ¤íŠ¸ ì‹ í˜¸ì— ì ìš©í•˜ê³ , í•„í„°ë§ ì „í›„ì˜ ìŠ¤í™íŠ¸ëŸ¼ì„ ê·¸ë¦¬ì„¸ìš”.</li>
<li>FFTë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ìƒì  ë¯¸ë¶„ê¸° $H(\omega) = j\omega$ë¥¼ êµ¬í˜„í•˜ì„¸ìš”. ê°€ìš°ì‹œì•ˆ í„ìŠ¤ì— ì ìš©í•˜ê³  í•´ì„ì  ë„í•¨ìˆ˜ì™€ ë¹„êµí•˜ì„¸ìš”.</li>
<li>ì´ìƒì  ì €ì—­í†µê³¼ í•„í„°ë¥¼ ê³„ë‹¨ ì…ë ¥ì— ì ìš©í•˜ë©´ ì™œ ë§ì‰ì´ ë°œìƒí•˜ë‚˜ìš”? ê¹ìŠ¤ í˜„ìƒ(Gibbs phenomenon) ì¸¡ë©´ì—ì„œ ë§ì‰ì„ ì •ëŸ‰í™”í•˜ì„¸ìš”.</li>
</ol>
<h3 id="6-">ì—°ìŠµ ë¬¸ì œ 6: ì‹œê°„-ëŒ€ì—­í­ ê³±<a class="header-link" href="#6-" title="Permanent link">&para;</a></h3>
<ol>
<li>ë‹¤ìŒì— ëŒ€í•œ ì‹œê°„-ëŒ€ì—­í­ ê³±ì„ ê³„ì‚°í•˜ì„¸ìš”:</li>
<li>ì§ì‚¬ê° í„ìŠ¤ $\text{rect}(t/T)$</li>
<li>ê°€ìš°ì‹œì•ˆ í„ìŠ¤ $e^{-\pi t^2}$ (ì •í™•íˆ 0.5ê°€ ë‚˜ì™€ì•¼ í•¨)</li>
<li>1ì°¨ ì§€ìˆ˜ $e^{-t}u(t)$</li>
<li>ìƒìŠ¹ ì½”ì‚¬ì¸ í„ìŠ¤ $\frac{1}{2}(1 + \cos(\pi t/T))$ ($|t| \leq T$ì—ì„œ)</li>
<li>ì‹œê°„-ëŒ€ì—­í­ ê³± íš¨ìœ¨ë¡œ ì´ í„ìŠ¤ë“¤ì„ ìˆœìœ„ ë§¤ê¸°ì„¸ìš”.</li>
<li>ë ˆì´ë” ì‹œìŠ¤í…œì—ëŠ” ì–´ë–¤ í„ìŠ¤ í˜•íƒœë¥¼ ì„ íƒí•˜ê² ìŠµë‹ˆê¹Œ? í†µì‹  ì‹œìŠ¤í…œì—ëŠ”ìš”? ì„¤ëª…í•˜ì„¸ìš”.</li>
</ol>
<h3 id="7_1">ì—°ìŠµ ë¬¸ì œ 7: ìŒëŒ€ì„±<a class="header-link" href="#7_1" title="Permanent link">&para;</a></h3>
<ol>
<li>ì•Œë ¤ì§„ ìŒ $e^{-a|t|} \leftrightarrow 2a/(a^2 + \omega^2)$ë¡œë¶€í„° ìŒëŒ€ì„±ì„ ì‚¬ìš©í•˜ì—¬ $\mathcal{F}\{1/(a^2 + t^2)\}$ë¥¼ êµ¬í•˜ì„¸ìš”.</li>
<li>ì•Œë ¤ì§„ ìŒ $\text{rect}(t/\tau) \leftrightarrow \tau\,\text{sinc}(\omega\tau/(2\pi))$ë¡œë¶€í„° ìŒëŒ€ì„±ì„ ì‚¬ìš©í•˜ì—¬ $\mathcal{F}\{\text{sinc}(Wt)\}$ë¥¼ êµ¬í•˜ì„¸ìš”.</li>
<li>ë‘ ê²°ê³¼ ëª¨ë‘ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê²€ì¦í•˜ì„¸ìš”.</li>
</ol>
<h3 id="8_1">ì—°ìŠµ ë¬¸ì œ 8: ì¢…í•© ë¶„ì„<a class="header-link" href="#8_1" title="Permanent link">&para;</a></h3>
<p>ì—¬ëŸ¬ ì£¼íŒŒìˆ˜ ì„±ë¶„ì„ í¬í•¨í•˜ëŠ” ìŒì„±, ìŒì•… ë˜ëŠ” í•©ì„± ì‹ í˜¸ë¥¼ 2ì´ˆ ë…¹ìŒí•˜ê±°ë‚˜ ìƒì„±í•˜ì„¸ìš”.</p>
<ol>
<li>í¬ê¸° ìŠ¤í™íŠ¸ëŸ¼ê³¼ ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼ì„ ê³„ì‚°í•˜ê³  ê·¸ë¦¬ì„¸ìš”</li>
<li>ì§€ë°°ì ì¸ ì£¼íŒŒìˆ˜ ì„±ë¶„ì„ ì‹ë³„í•˜ì„¸ìš”</li>
<li>í•˜ë‚˜ì˜ ì„±ë¶„ì„ ì¶”ì¶œí•˜ëŠ” ëŒ€ì—­í†µê³¼ í•„í„°ë¥¼ ì„¤ê³„í•˜ê³  ì ìš©í•˜ì„¸ìš”</li>
<li>í•„í„°ë§ ì „í›„ì˜ ì—ë„ˆì§€ë¥¼ ê³„ì‚°í•˜ì„¸ìš”; í†µê³¼ ëŒ€ì—­ì— ìˆëŠ” ë¹„ìœ¨ì€?</li>
<li>ìŠ¤í™íŠ¸ëŸ¼ ê³„ì‚° ì „ì— ì‹œê°„ ì˜ì—­ ìœˆë„ì‰(í•´ë°)ì„ ì ìš©í•˜ì„¸ìš”. ìœˆë„ì‰í•˜ì§€ ì•Šì€ ê²°ê³¼ì™€ ë¹„êµí•˜ì„¸ìš”.</li>
<li>ë¶„ì„ ì°½ ê¸¸ì´ë¥¼ ë³€í™”ì‹œí‚¤ê³  ì‹œê°„-ì£¼íŒŒìˆ˜ ë¶„í•´ëŠ¥ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ê´€ì°°í•˜ì„¸ìš”</li>
</ol>
<hr />
<h2 id="15">15. ì°¸ê³  ë¬¸í—Œ<a class="header-link" href="#15" title="Permanent link">&para;</a></h2>
<ol>
<li>Oppenheim, A. V. &amp; Willsky, A. S. <em>Signals and Systems</em> (2nd ed.), Ch. 4-5. Prentice Hall, 1997.</li>
<li>Haykin, S. &amp; Van Veen, B. <em>Signals and Systems</em> (2nd ed.), Ch. 4-5. Wiley, 2003.</li>
<li>Bracewell, R. N. <em>The Fourier Transform and Its Applications</em> (3rd ed.). McGraw-Hill, 2000.</li>
<li>Lathi, B. P. &amp; Green, R. A. <em>Linear Systems and Signals</em> (3rd ed.), Ch. 7. Oxford University Press, 2018.</li>
<li>Mallat, S. <em>A Wavelet Tour of Signal Processing</em> (3rd ed.), Ch. 2. Academic Press, 2009.</li>
</ol>
<hr />
<p><a href="./03_Fourier_Series_and_Applications.md">ì´ì „: 03. í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</a> | <a href="./05_Sampling_and_Reconstruction.md">ë‹¤ìŒ: 05. í‘œë³¸í™”ì™€ ë³µì›</a> | <a href="./00_Overview.md">ê°œìš”</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/03_Fourier_Series_and_Applications.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">í‘¸ë¦¬ì— ê¸‰ìˆ˜ì™€ ì‘ìš©</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/05_Sampling_and_Reconstruction.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">í‘œë³¸í™”ì™€ ì‹ í˜¸ ë³µì›</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}