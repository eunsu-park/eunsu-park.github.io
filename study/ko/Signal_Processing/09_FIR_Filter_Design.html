{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIR í•„í„° ì„¤ê³„(FIR Filter Design) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">FIR í•„í„° ì„¤ê³„(FIR Filter Design)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>FIR í•„í„° ì„¤ê³„(FIR Filter Design)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/08_Digital_Filter_Fundamentals.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë””ì§€í„¸ í•„í„° ê¸°ì´ˆ</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/10_IIR_Filter_Design.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">IIR í•„í„° ì„¤ê³„</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1-fir">1. FIR í•„í„° ì„¤ê³„ ì‚¬ì–‘</a><ul>
<li><a href="#11">1.1 í•„í„° ìš©ì–´</a></li>
<li><a href="#12">1.2 ë°ì‹œë²¨ ì‚¬ì–‘</a></li>
<li><a href="#13-fir-vs-iir">1.3 FIR vs IIR íŠ¸ë ˆì´ë“œì˜¤í”„</a></li>
</ul>
</li>
<li><a href="#2">2. ì´ìƒì ì¸ í•„í„°ì™€ ì„í„ìŠ¤ ì‘ë‹µ</a><ul>
<li><a href="#21">2.1 ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°</a></li>
<li><a href="#22">2.2 ë‹¤ë¥¸ ì´ìƒì ì¸ í•„í„° ìœ í˜•</a></li>
</ul>
</li>
<li><a href="#3">3. ì°½í•¨ìˆ˜ë²•</a><ul>
<li><a href="#31">3.1 ê¸°ë³¸ ì›ë¦¬</a></li>
<li><a href="#32">3.2 ì°½í•¨ìˆ˜ ì ìš©ì˜ íš¨ê³¼</a></li>
<li><a href="#33-gibbs-phenomenon">3.3 ê¹ìŠ¤ í˜„ìƒ(Gibbs Phenomenon)</a></li>
</ul>
</li>
<li><a href="#4">4. ì°½í•¨ìˆ˜</a><ul>
<li><a href="#41">4.1 ì¼ë°˜ì ì¸ ì°½í•¨ìˆ˜</a><ul>
<li><a href="#rectangular-window">ì§ì‚¬ê°í˜• ì°½(Rectangular Window)</a></li>
<li><a href="#hann-hanning">í•œ(Hann) ì°½ (í•´ë‹(Hanning) ì°½)</a></li>
<li><a href="#hamming-window">í•´ë° ì°½(Hamming Window)</a></li>
<li><a href="#blackman-window">ë¸”ë™ë§Œ ì°½(Blackman Window)</a></li>
</ul>
</li>
<li><a href="#42">4.2 ì°½í•¨ìˆ˜ ë¹„êµí‘œ</a></li>
<li><a href="#43">4.3 ì°½í•¨ìˆ˜ì™€ ìŠ¤í™íŠ¸ëŸ¼ ì‹œê°í™”</a></li>
<li><a href="#44">4.4 ì°½í•¨ìˆ˜ë²• ì„¤ê³„ ì ˆì°¨</a></li>
</ul>
</li>
<li><a href="#5">5. ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„</a><ul>
<li><a href="#51">5.1 ì¹´ì´ì € ì°½í•¨ìˆ˜ ì •ì˜</a></li>
<li><a href="#52">5.2 ì¹´ì´ì €ì˜ ê²½í—˜ì  ê³µì‹</a></li>
<li><a href="#53">5.3 ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„ ì ˆì°¨</a></li>
<li><a href="#54-scipysignalkaiserord">5.4 scipy.signal.kaiserord ì‚¬ìš©</a></li>
</ul>
</li>
<li><a href="#6">6. ì£¼íŒŒìˆ˜ í‘œë³¸í™”ë²•</a><ul>
<li><a href="#61">6.1 ì›ë¦¬</a></li>
<li><a href="#62-transition-samples">6.2 ì „ì´ í‘œë³¸(Transition Samples)</a></li>
<li><a href="#63">6.3 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#7-parks-mcclellan">7. ìµœì  ë“±ë¦¬í”Œ ì„¤ê³„: Parks-McClellan ì•Œê³ ë¦¬ì¦˜</a><ul>
<li><a href="#71-minimax-optimization">7.1 ë¯¸ë‹ˆë§¥ìŠ¤ ìµœì í™”(Minimax Optimization)</a></li>
<li><a href="#72-equiripple-property">7.2 ë“±ë¦¬í”Œ íŠ¹ì„±(Equiripple Property)</a></li>
<li><a href="#73-remez">7.3 Remez êµí™˜ ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#74-scipysignalremez">7.4 scipy.signal.remezë¥¼ ì´ìš©í•œ êµ¬í˜„</a></li>
<li><a href="#75">7.5 ëŒ€ì—­í†µê³¼ í•„í„° ì˜ˆì‹œ</a></li>
</ul>
</li>
<li><a href="#8-fir">8. ì„ í˜• ìœ„ìƒ FIR í•„í„°</a><ul>
<li><a href="#81">8.1 ì„ í˜• ìœ„ìƒì˜ ì¤‘ìš”ì„±</a></li>
<li><a href="#82">8.2 ëŒ€ì¹­ ì¡°ê±´</a></li>
<li><a href="#83-fir">8.3 ì„ í˜• ìœ„ìƒ FIR í•„í„°ì˜ ë„¤ ê°€ì§€ ìœ í˜•</a></li>
<li><a href="#84">8.4 ì§„í­ ì‘ë‹µ ê³µì‹</a></li>
</ul>
</li>
<li><a href="#9">9. ì„¤ê³„ ë°©ë²• ë¹„êµ</a><ul>
<li><a href="#91">9.1 ì§ì ‘ ë¹„êµ</a></li>
<li><a href="#92">9.2 ì„¤ê³„ ë°©ë²• ìš”ì•½</a></li>
</ul>
</li>
<li><a href="#10-fir">10. FIR í•„í„° êµ¬í˜„</a><ul>
<li><a href="#101-direct-convolution">10.1 ì§ì ‘ í•©ì„±ê³±(Direct Convolution)</a></li>
<li><a href="#102-fft">10.2 FFT ê¸°ë°˜ í•„í„°ë§</a></li>
<li><a href="#103-overlap-add-method">10.3 ì¤‘ì²© ê°€ì‚°ë²•(Overlap-Add Method)</a></li>
<li><a href="#104-overlap-save-method">10.4 ì¤‘ì²© ì €ì¥ë²•(Overlap-Save Method)</a></li>
<li><a href="#105">10.5 ì„±ëŠ¥ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#11-python">11. Python êµ¬í˜„</a><ul>
<li><a href="#111">11.1 ì™„ì „í•œ ì„¤ê³„ ì˜ˆì‹œ</a></li>
<li><a href="#112">11.2 ì‹¤ì œ ì‹ í˜¸ í•„í„°ë§</a></li>
<li><a href="#113">11.3 ë‹¤ì¤‘ ëŒ€ì—­ í•„í„° ì„¤ê³„</a></li>
</ul>
</li>
<li><a href="#12_1">12. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ì—°ìŠµ ë¬¸ì œ 1: ì°½í•¨ìˆ˜ ì„ íƒ</a></li>
<li><a href="#2_1">ì—°ìŠµ ë¬¸ì œ 2: ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„</a></li>
<li><a href="#3-parks-mcclellan">ì—°ìŠµ ë¬¸ì œ 3: Parks-McClellan ëŒ€ì—­í†µê³¼ í•„í„°</a></li>
<li><a href="#4_1">ì—°ìŠµ ë¬¸ì œ 4: ì¤‘ì²© ê°€ì‚°ë²• êµ¬í˜„</a></li>
<li><a href="#5_1">ì—°ìŠµ ë¬¸ì œ 5: ì„ í˜• ìœ„ìƒ ì œì•½</a></li>
<li><a href="#6_1">ì—°ìŠµ ë¬¸ì œ 6: ë¹„êµ ì—°êµ¬</a></li>
<li><a href="#7-fir">ì—°ìŠµ ë¬¸ì œ 7: ìµœì†Œ ìœ„ìƒ FIR í•„í„°</a></li>
</ul>
</li>
<li><a href="#_3">ì°¸ê³  ë¬¸í—Œ</a></li>
<li><a href="#_4">íƒìƒ‰</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="fir-fir-filter-design">FIR í•„í„° ì„¤ê³„(FIR Filter Design)<a class="header-link" href="#fir-fir-filter-design" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ë””ì§€í„¸ í•„í„° ì„¤ê³„ì˜ ì‚¬ì–‘ê³¼ ìš©ì–´ë¥¼ ì´í•´í•œë‹¤</li>
<li>FIR í•„í„° ì„¤ê³„ë¥¼ ìœ„í•œ ì°½í•¨ìˆ˜ë²•(Window Method)ì„ ë§ˆìŠ¤í„°í•˜ê³  ì°½í•¨ìˆ˜ë“¤ì„ ë¹„êµí•œë‹¤</li>
<li>ì£¼íŒŒìˆ˜ í‘œë³¸í™”(Frequency Sampling) ë° ìµœì  ë“±ë¦¬í”Œ(Parks-McClellan) ì„¤ê³„ ë°©ë²•ì„ í•™ìŠµí•œë‹¤</li>
<li>ì„ í˜• ìœ„ìƒ(Linear Phase) FIR í•„í„° ìœ í˜•ê³¼ ê·¸ ì œì•½ ì¡°ê±´ì„ ì´í•´í•œë‹¤</li>
<li>Pythonì˜ <code>scipy.signal</code> ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ FIR í•„í„°ë¥¼ ì„¤ê³„í•œë‹¤</li>
<li>ì§ì ‘ í•©ì„±ê³±(Direct Convolution), ì¤‘ì²© ê°€ì‚°ë²•(Overlap-Add), ì¤‘ì²© ì €ì¥ë²•(Overlap-Save)ì„ ì´ìš©í•œ FIR í•„í„°ë§ì„ êµ¬í˜„í•œë‹¤</li>
<li>ì „ì´ ëŒ€ì—­í­(Transition Width), ì €ì§€ëŒ€ì—­ ê°ì‡ (Stopband Attenuation), ì—°ì‚° ë¹„ìš© ì¸¡ë©´ì—ì„œ ì„¤ê³„ ë°©ë²•ë“¤ì„ ë¹„êµí•œë‹¤</li>
</ul>
<hr />
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-fir-í•„í„°-ì„¤ê³„-ì‚¬ì–‘">FIR í•„í„° ì„¤ê³„ ì‚¬ì–‘</a></li>
<li><a href="#2-ì´ìƒì ì¸-í•„í„°ì™€-ì„í„ìŠ¤-ì‘ë‹µ">ì´ìƒì ì¸ í•„í„°ì™€ ì„í„ìŠ¤ ì‘ë‹µ</a></li>
<li><a href="#3-ì°½í•¨ìˆ˜ë²•">ì°½í•¨ìˆ˜ë²•</a></li>
<li><a href="#4-ì°½í•¨ìˆ˜">ì°½í•¨ìˆ˜</a></li>
<li><a href="#5-ì¹´ì´ì €-ì°½í•¨ìˆ˜-ì„¤ê³„">ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„</a></li>
<li><a href="#6-ì£¼íŒŒìˆ˜-í‘œë³¸í™”ë²•">ì£¼íŒŒìˆ˜ í‘œë³¸í™”ë²•</a></li>
<li><a href="#7-ìµœì -ë“±ë¦¬í”Œ-ì„¤ê³„-parks-mcclellan-ì•Œê³ ë¦¬ì¦˜">ìµœì  ë“±ë¦¬í”Œ ì„¤ê³„: Parks-McClellan ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#8-ì„ í˜•-ìœ„ìƒ-fir-í•„í„°">ì„ í˜• ìœ„ìƒ FIR í•„í„°</a></li>
<li><a href="#9-ì„¤ê³„-ë°©ë²•-ë¹„êµ">ì„¤ê³„ ë°©ë²• ë¹„êµ</a></li>
<li><a href="#10-fir-í•„í„°-êµ¬í˜„">FIR í•„í„° êµ¬í˜„</a></li>
<li><a href="#11-python-êµ¬í˜„">Python êµ¬í˜„</a></li>
<li><a href="#12-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1-fir">1. FIR í•„í„° ì„¤ê³„ ì‚¬ì–‘<a class="header-link" href="#1-fir" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 í•„í„° ìš©ì–´<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ë””ì§€í„¸ í•„í„°ëŠ” <strong>ì£¼íŒŒìˆ˜ ì‘ë‹µ(Frequency Response)</strong> $H(e^{j\omega})$ë¡œ íŠ¹ì„±í™”ë˜ë©°, ì´ëŠ” ì‹ í˜¸ì˜ ê° ì£¼íŒŒìˆ˜ ì„±ë¶„ì´ ì–´ë–»ê²Œ ë³€í˜•ë˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì£¼ìš” ì‚¬ì–‘ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>
<p><strong>ì£¼íŒŒìˆ˜ ëŒ€ì—­:</strong>
- <strong>í†µê³¼ëŒ€ì—­(Passband)</strong>: ìµœì†Œí•œì˜ ì™œê³¡ìœ¼ë¡œ í†µê³¼ì‹œì¼œì•¼ í•  ì£¼íŒŒìˆ˜, $0 \leq \omega \leq \omega_p$
- <strong>ì €ì§€ëŒ€ì—­(Stopband)</strong>: ê°ì‡ ì‹œì¼œì•¼ í•  ì£¼íŒŒìˆ˜, $\omega_s \leq \omega \leq \pi$
- <strong>ì „ì´ ëŒ€ì—­(Transition Band)</strong>: í†µê³¼ëŒ€ì—­ê³¼ ì €ì§€ëŒ€ì—­ ì‚¬ì´ì˜ ì˜ì—­, $\omega_p < \omega < \omega_s$</p>
<p><strong>í—ˆìš© ì˜¤ì°¨(Tolerances):</strong>
- <strong>í†µê³¼ëŒ€ì—­ ë¦¬í”Œ(Passband Ripple)</strong> $\delta_1$: í†µê³¼ëŒ€ì—­ì—ì„œ ë‹¨ìœ„ë¡œë¶€í„°ì˜ ìµœëŒ€ í¸ì°¨
- <strong>ì €ì§€ëŒ€ì—­ ê°ì‡ (Stopband Attenuation)</strong> $\delta_2$: ì €ì§€ëŒ€ì—­ì—ì„œì˜ ìµœëŒ€ í¬ê¸°</p>
<div class="highlight"><pre><span></span><code>ì§„í­ ì‘ë‹µ ì‚¬ì–‘(Magnitude Response Specification)
|H(e^jÏ‰)|
    â†‘
1+Î´â‚ â”€ â”€ â”€ â”€â”
    â”‚        â”‚
  1 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚        â”‚
1-Î´â‚ â”€ â”€ â”€ â”€â”˜        â•²
    â”‚                    â•²
  Î´â‚‚ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚                      â”‚
  0 â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â†’ Ï‰
    0     Ï‰p    Ï‰s        Ï€

         í†µê³¼ëŒ€ì—­â”‚ì „ì´ â”‚ ì €ì§€ëŒ€ì—­
                â”‚ëŒ€ì—­ â”‚
</code></pre></div>

<h3 id="12">1.2 ë°ì‹œë²¨ ì‚¬ì–‘<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>ì‹¤ì œë¡œ í•„í„° ì‚¬ì–‘ì€ ì¢…ì¢… ë°ì‹œë²¨(dB)ë¡œ í‘œí˜„ëœë‹¤:</p>
<p>$$A_p = -20\log_{10}(1 - \delta_1) \quad \text{(í†µê³¼ëŒ€ì—­ ë¦¬í”Œ, dB)}$$</p>
<p>$$A_s = -20\log_{10}(\delta_2) \quad \text{(ì €ì§€ëŒ€ì—­ ê°ì‡ , dB)}$$</p>
<p>ì¼ë°˜ì ì¸ ì‚¬ì–‘ ì˜ˆì‹œ:
- í†µê³¼ëŒ€ì—­ ë¦¬í”Œ: $A_p \leq 0.1$ dB ($\delta_1 \approx 0.0115$ ì˜ë¯¸)
- ì €ì§€ëŒ€ì—­ ê°ì‡ : $A_s \geq 60$ dB ($\delta_2 = 0.001$ ì˜ë¯¸)</p>
<h3 id="13-fir-vs-iir">1.3 FIR vs IIR íŠ¸ë ˆì´ë“œì˜¤í”„<a class="header-link" href="#13-fir-vs-iir" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FIR vs IIR ë¹„êµ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ íŠ¹ì„±             â”‚ FIR             â”‚ IIR               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì•ˆì •ì„±           â”‚ í•­ìƒ ì•ˆì •       â”‚ ë¶ˆì•ˆì • ê°€ëŠ¥       â”‚
â”‚ ì„ í˜• ìœ„ìƒ        â”‚ ì‰½ê²Œ ë‹¬ì„±       â”‚ ë¶ˆê°€ëŠ¥            â”‚
â”‚ í•„í„° ì°¨ìˆ˜        â”‚ ë†’ìŒ            â”‚ ë‚®ìŒ              â”‚
â”‚ ì—°ì‚°ëŸ‰           â”‚ ê³±ì…ˆ ë§ìŒ       â”‚ ê³±ì…ˆ ì ìŒ         â”‚
â”‚ ì„¤ê³„ ë°©ë²•        â”‚ Window, PM, FS  â”‚ ì•„ë‚ ë¡œê·¸ ì›í˜•     â”‚
â”‚ êµ°ì§€ì—°           â”‚ ì¼ì •            â”‚ ë¹„ì¼ì •            â”‚
â”‚ ë°˜ì˜¬ë¦¼ ì˜¤ì°¨      â”‚ ëœ ë¯¼ê°         â”‚ ë” ë¯¼ê°           â”‚
â”‚ êµ¬í˜„             â”‚ í”¼ë“œë°± ì—†ìŒ     â”‚ í”¼ë“œë°± í•„ìš”       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>ì°¨ìˆ˜ $M$ì˜ FIR í•„í„°ëŠ” ë‹¤ìŒì˜ ì „ë‹¬ í•¨ìˆ˜(Transfer Function)ë¥¼ ê°–ëŠ”ë‹¤:</p>
<p>$$H(z) = \sum_{n=0}^{M} h[n] z^{-n}$$</p>
<p>ì¶œë ¥ì€ ìœ í•œ í•©ì„±ê³±(Finite Convolution)ìœ¼ë¡œ í‘œí˜„ëœë‹¤:</p>
<p>$$y[n] = \sum_{k=0}^{M} h[k] x[n-k]$$</p>
<hr />
<h2 id="2">2. ì´ìƒì ì¸ í•„í„°ì™€ ì„í„ìŠ¤ ì‘ë‹µ<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì´ìƒì ì¸ ì €ì—­í†µê³¼ í•„í„°(Ideal Lowpass Filter)ì˜ ì£¼íŒŒìˆ˜ ì‘ë‹µì€:</p>
<p>$$H_d(e^{j\omega}) = \begin{cases} 1, & |\omega| \leq \omega_c \\ 0, & \omega_c < |\omega| \leq \pi \end{cases}$$</p>
<p>ì„í„ìŠ¤ ì‘ë‹µì€ ì—­ DTFTë¥¼ í†µí•´ êµ¬í•œë‹¤:</p>
<p>$$h_d[n] = \frac{1}{2\pi} \int_{-\pi}^{\pi} H_d(e^{j\omega}) e^{j\omega n} d\omega = \frac{\sin(\omega_c n)}{\pi n}$$</p>
<p>ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì„±ì„ ê°€ì§„ <strong>sinc í•¨ìˆ˜</strong>ì´ë‹¤:
- ì§€ì† ì‹œê°„ì´ ë¬´í•œí•˜ë‹¤ (ë¹„ì¸ê³¼ì , ì‹¤í˜„ ë¶ˆê°€)
- $n = 0$ì— ëŒ€í•´ ëŒ€ì¹­ì´ë‹¤</p>
<h3 id="22">2.2 ë‹¤ë¥¸ ì´ìƒì ì¸ í•„í„° ìœ í˜•<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p><strong>ì´ìƒì ì¸ ê³ ì—­í†µê³¼ í•„í„°(Ideal Highpass Filter):</strong></p>
<p>$$h_d[n] = \delta[n] - \frac{\sin(\omega_c n)}{\pi n}$$</p>
<p><strong>ì´ìƒì ì¸ ëŒ€ì—­í†µê³¼ í•„í„°(Ideal Bandpass Filter)</strong> ($\omega_{c1} < |\omega| < \omega_{c2}$):</p>
<p>$$h_d[n] = \frac{\sin(\omega_{c2} n)}{\pi n} - \frac{\sin(\omega_{c1} n)}{\pi n}$$</p>
<p><strong>ì´ìƒì ì¸ ëŒ€ì—­ì €ì§€ í•„í„°(Ideal Bandstop Filter):</strong></p>
<p>$$h_d[n] = \delta[n] - \frac{\sin(\omega_{c2} n)}{\pi n} + \frac{\sin(\omega_{c1} n)}{\pi n}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ideal_lowpass</span><span class="p">(</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute ideal lowpass filter impulse response (truncated).&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Handle n = 0 case (sinc(0) = omega_c / pi)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">M</span>
    <span class="n">h</span><span class="p">[</span><span class="n">center</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega_c</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="c1"># Non-zero indices</span>
    <span class="n">nonzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">center</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">center</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="n">h</span><span class="p">[</span><span class="n">nonzero</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega_c</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">nonzero</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">nonzero</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span>

<span class="c1"># Plot ideal lowpass impulse responses for different cutoff frequencies</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">wc</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
                           <span class="p">[</span><span class="s1">&#39;Ï‰c = Ï€/4&#39;</span><span class="p">,</span> <span class="s1">&#39;Ï‰c = Ï€/2&#39;</span><span class="p">,</span> <span class="s1">&#39;Ï‰c = 3Ï€/4&#39;</span><span class="p">]):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">ideal_lowpass</span><span class="p">(</span><span class="n">wc</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal LP Impulse Response (</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideal_lowpass_responses.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì°½í•¨ìˆ˜ë²•<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ê¸°ë³¸ ì›ë¦¬<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>ì°½í•¨ìˆ˜ë²•(Window Method)ì€ FIR ì„¤ê³„ì—ì„œ ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì´ë‹¤. ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ”:</p>
<ol>
<li>ì´ìƒì ì¸ (ë¬´í•œ) ì„í„ìŠ¤ ì‘ë‹µ $h_d[n]$ì—ì„œ ì‹œì‘í•œë‹¤</li>
<li>ê¸¸ì´ $N = M + 1$ì¸ ìœ í•œ ì§€ì† ì‹œê°„ ì°½í•¨ìˆ˜ $w[n]$ì„ ê³±í•œë‹¤</li>
<li>í•„í„°ë¥¼ ì¸ê³¼ì (Causal)ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ ê²°ê³¼ë¥¼ ì´ë™ì‹œí‚¨ë‹¤</li>
</ol>
<p>$$h[n] = h_d[n - M/2] \cdot w[n], \quad n = 0, 1, \ldots, M$$</p>
<p>ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ì´ ê³±ì…ˆì€ í•©ì„±ê³±(Convolution)ì— í•´ë‹¹í•œë‹¤:</p>
<p>$$H(e^{j\omega}) = \frac{1}{2\pi} H_d(e^{j\omega}) * W(e^{j\omega})$$</p>
<h3 id="32">3.2 ì°½í•¨ìˆ˜ ì ìš©ì˜ íš¨ê³¼<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>ì°½í•¨ìˆ˜ì˜ ì£¼íŒŒìˆ˜ ì‘ë‹µ $W(e^{j\omega})$ì€ ë‹¤ìŒì„ ê²°ì •í•œë‹¤:</p>
<ol>
<li><strong>ì£¼ì—½ í­(Mainlobe Width)</strong>: ì „ì´ ëŒ€ì—­í­ì„ ì œì–´í•œë‹¤ -- ì£¼ì—½ì´ ë„“ì„ìˆ˜ë¡ ì „ì´ ëŒ€ì—­ì´ ë„“ì–´ì§„ë‹¤</li>
<li><strong>ë¶€ì—½ ë ˆë²¨(Sidelobe Level)</strong>: ì €ì§€ëŒ€ì—­ ê°ì‡ ë¥¼ ê²°ì •í•œë‹¤ -- ë¶€ì—½ì´ ë†’ì„ìˆ˜ë¡ ì €ì§€ëŒ€ì—­ ê°ì‡ ê°€ ì‘ì•„ì§„ë‹¤</li>
<li><strong>ë¶€ì—½ ê°ì†Œìœ¨(Sidelobe Decay Rate)</strong>: ì£¼íŒŒìˆ˜ì— ë”°ë¼ ë¶€ì—½ì´ ì–¼ë§ˆë‚˜ ë¹¨ë¦¬ ê°ì†Œí•˜ëŠ”ì§€</li>
</ol>
<div class="highlight"><pre><span></span><code>ì°½í•¨ìˆ˜ ìŠ¤í™íŠ¸ëŸ¼ íŠ¹ì„±(Window Spectrum Properties)
|W(e^jÏ‰)|
    â†‘
    â”‚   â•±â•²        ì£¼ì—½(Mainlobe)
    â”‚  â•±  â•²       í­ = Î”Ï‰_ML
    â”‚ â•±    â•²
    â”‚â•±      â•²  â•±â•²
    â”‚        â•²â•±  â•²  â•±â•²       ìµœëŒ€ ë¶€ì—½
    â”‚         â”‚   â•²â•±  â•²      ë ˆë²¨ (dB)
    â”‚         â”‚    â”‚   â•²â•±â•²
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Ï‰
    0      Î”Ï‰_ML/2          Ï€
</code></pre></div>

<h3 id="33-gibbs-phenomenon">3.3 ê¹ìŠ¤ í˜„ìƒ(Gibbs Phenomenon)<a class="header-link" href="#33-gibbs-phenomenon" title="Permanent link">&para;</a></h3>
<p>ì§ì‚¬ê°í˜• ì°½(Rectangular Window)ìœ¼ë¡œ ì´ìƒì ì¸ ì„í„ìŠ¤ ì‘ë‹µì„ ì ˆë‹¨í•˜ë©´ ê¹ìŠ¤ í˜„ìƒ(Gibbs Phenomenon)ì´ ë°œìƒí•˜ì—¬ í•„í„° ì°¨ìˆ˜ $M$ì— ê´€ê³„ì—†ì´ ëŒ€ì—­ ê²½ê³„ì—ì„œ ì•½ 9%ì˜ ì˜¤ë²„ìŠˆíŠ¸(ì•½ $-21$ dB ì €ì§€ëŒ€ì—­ ê°ì‡ )ê°€ ë°œìƒí•œë‹¤. í•„í„° ì°¨ìˆ˜ $M$ì„ ëŠ˜ë¦¬ë©´ ì „ì´ í­ì€ ì¢ì•„ì§€ì§€ë§Œ ë¦¬í”Œ ì§„í­ì€ ì¤„ì–´ë“¤ì§€ ì•ŠëŠ”ë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">windowed_lowpass</span><span class="p">(</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">window_type</span><span class="o">=</span><span class="s1">&#39;rectangular&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Design lowpass FIR filter using window method.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Delay for linear phase</span>

    <span class="c1"># Ideal lowpass impulse response (shifted for causality)</span>
    <span class="n">h_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">alpha</span><span class="p">:</span>
            <span class="n">h_d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega_c</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h_d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span>

    <span class="c1"># Apply window</span>
    <span class="k">if</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;rectangular&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;hamming&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;hanning&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;blackman&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">h_d</span> <span class="o">*</span> <span class="n">w</span>
    <span class="k">return</span> <span class="n">h</span>

<span class="c1"># Demonstrate Gibbs phenomenon with rectangular window</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">windowed_lowpass</span><span class="p">(</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="s1">&#39;rectangular&#39;</span><span class="p">)</span>

    <span class="c1"># Frequency response</span>
    <span class="n">w_freq</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_freq</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-21 dB (Gibbs)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ï‰c = Ï€/2&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€ rad/sample)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rectangular Window, M = </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Gibbs Phenomenon: Stopband ripple remains ~-21 dB&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gibbs_phenomenon.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4">4. ì°½í•¨ìˆ˜<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ì¼ë°˜ì ì¸ ì°½í•¨ìˆ˜<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>ê° ì°½í•¨ìˆ˜ëŠ” ì£¼ì—½ í­ê³¼ ë¶€ì—½ ë ˆë²¨ ì‚¬ì´ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ì¡°ì ˆí•œë‹¤. ë” ë§¤ë„ëŸ¬ìš´ ì°½í•¨ìˆ˜ì¼ìˆ˜ë¡ ì£¼ì—½ì´ ë„“ì§€ë§Œ ë¶€ì—½ì€ ë‚®ë‹¤.</p>
<h4 id="rectangular-window">ì§ì‚¬ê°í˜• ì°½(Rectangular Window)<a class="header-link" href="#rectangular-window" title="Permanent link">&para;</a></h4>
<p>$$w[n] = 1, \quad 0 \leq n \leq M$$</p>
<ul>
<li><strong>ì£¼ì—½ í­</strong>: $\Delta\omega_\text{ML} = 4\pi / (M+1)$</li>
<li><strong>ìµœëŒ€ ë¶€ì—½</strong>: $-13$ dB</li>
<li><strong>ìµœì†Œ ì €ì§€ëŒ€ì—­ ê°ì‡ </strong>: $-21$ dB</li>
<li><strong>ì „ì´ í­</strong>: $\Delta\omega \approx 0.92 \cdot 2\pi / (M+1)$</li>
</ul>
<h4 id="hann-hanning">í•œ(Hann) ì°½ (í•´ë‹(Hanning) ì°½)<a class="header-link" href="#hann-hanning" title="Permanent link">&para;</a></h4>
<p>$$w[n] = 0.5 - 0.5\cos\left(\frac{2\pi n}{M}\right), \quad 0 \leq n \leq M$$</p>
<ul>
<li><strong>ì£¼ì—½ í­</strong>: $\Delta\omega_\text{ML} = 8\pi / (M+1)$</li>
<li><strong>ìµœëŒ€ ë¶€ì—½</strong>: $-31$ dB</li>
<li><strong>ìµœì†Œ ì €ì§€ëŒ€ì—­ ê°ì‡ </strong>: $-44$ dB</li>
<li><strong>ì „ì´ í­</strong>: $\Delta\omega \approx 3.11 \cdot 2\pi / (M+1)$</li>
</ul>
<h4 id="hamming-window">í•´ë° ì°½(Hamming Window)<a class="header-link" href="#hamming-window" title="Permanent link">&para;</a></h4>
<p>$$w[n] = 0.54 - 0.46\cos\left(\frac{2\pi n}{M}\right), \quad 0 \leq n \leq M$$</p>
<ul>
<li><strong>ì£¼ì—½ í­</strong>: $\Delta\omega_\text{ML} = 8\pi / (M+1)$</li>
<li><strong>ìµœëŒ€ ë¶€ì—½</strong>: $-41$ dB</li>
<li><strong>ìµœì†Œ ì €ì§€ëŒ€ì—­ ê°ì‡ </strong>: $-53$ dB</li>
<li><strong>ì „ì´ í­</strong>: $\Delta\omega \approx 3.32 \cdot 2\pi / (M+1)$</li>
</ul>
<h4 id="blackman-window">ë¸”ë™ë§Œ ì°½(Blackman Window)<a class="header-link" href="#blackman-window" title="Permanent link">&para;</a></h4>
<p>$$w[n] = 0.42 - 0.5\cos\left(\frac{2\pi n}{M}\right) + 0.08\cos\left(\frac{4\pi n}{M}\right), \quad 0 \leq n \leq M$$</p>
<ul>
<li><strong>ì£¼ì—½ í­</strong>: $\Delta\omega_\text{ML} = 12\pi / (M+1)$</li>
<li><strong>ìµœëŒ€ ë¶€ì—½</strong>: $-57$ dB</li>
<li><strong>ìµœì†Œ ì €ì§€ëŒ€ì—­ ê°ì‡ </strong>: $-74$ dB</li>
<li><strong>ì „ì´ í­</strong>: $\Delta\omega \approx 5.56 \cdot 2\pi / (M+1)$</li>
</ul>
<h3 id="42">4.2 ì°½í•¨ìˆ˜ ë¹„êµí‘œ<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì°½í•¨ìˆ˜      â”‚ ìµœëŒ€ ë¶€ì—½    â”‚ ìµœì†Œ ì €ì§€ëŒ€ì—­ â”‚ ê·¼ì‚¬ ì „ì´í­       â”‚
â”‚             â”‚ ë ˆë²¨ (dB)   â”‚ ê°ì‡  (dB)     â”‚ (rad)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rectangular â”‚ -13          â”‚ -21           â”‚ 0.92Â·(2Ï€/M)       â”‚
â”‚ Hann        â”‚ -31          â”‚ -44           â”‚ 3.11Â·(2Ï€/M)       â”‚
â”‚ Hamming     â”‚ -41          â”‚ -53           â”‚ 3.32Â·(2Ï€/M)       â”‚
â”‚ Blackman    â”‚ -57          â”‚ -74           â”‚ 5.56Â·(2Ï€/M)       â”‚
â”‚ Kaiser(Î²=6) â”‚ -44          â”‚ -60           â”‚ adjustable        â”‚
â”‚ Kaiser(Î²=9) â”‚ -69          â”‚ -90           â”‚ adjustable        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="43">4.3 ì°½í•¨ìˆ˜ì™€ ìŠ¤í™íŠ¸ëŸ¼ ì‹œê°í™”<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_windows</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare common window functions in time and frequency domains.&quot;&quot;&quot;</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Rectangular&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;Hann&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;Hamming&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;Blackman&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

    <span class="c1"># Time domain</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">windows</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">w</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample n&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;w[n]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Window Functions (Time Domain)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Frequency domain (log magnitude)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">4096</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">windows</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
        <span class="n">W_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
        <span class="n">W_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W_shift</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W_shift</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">W_dB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€ rad/sample)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Window Spectra (Frequency Domain)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;window_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">compare_windows</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div>

<h3 id="44">4.4 ì°½í•¨ìˆ˜ë²• ì„¤ê³„ ì ˆì°¨<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ì‚¬ì–‘ ê²°ì •</strong>: $\omega_p$, $\omega_s$, $\delta_1$, $\delta_2$</li>
<li><strong>ì°½í•¨ìˆ˜ ìœ í˜• ì„ íƒ</strong>: ìš”êµ¬ë˜ëŠ” ì €ì§€ëŒ€ì—­ ê°ì‡ ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„ íƒ</li>
<li><strong>ì „ì´ í­ ê³„ì‚°</strong>: $\Delta\omega = \omega_s - \omega_p$</li>
<li><strong>í•„í„° ì°¨ìˆ˜ ê²°ì •</strong>: ì°½í•¨ìˆ˜ì˜ ì „ì´ í­ ê³µì‹ìœ¼ë¡œë¶€í„° $M$ ê²°ì •</li>
<li><strong>ì°¨ë‹¨ ì£¼íŒŒìˆ˜ ì„¤ì •</strong>: $\omega_c = (\omega_p + \omega_s) / 2$</li>
<li><strong>ì´ìƒì ì¸ ì„í„ìŠ¤ ì‘ë‹µ ê³„ì‚°</strong>: $M/2$ë§Œí¼ ì´ë™ëœ $h_d[n]$ ê³„ì‚°</li>
<li><strong>ì°½í•¨ìˆ˜ ì ìš©</strong>: $h[n] = h_d[n] \cdot w[n]$ ê³„ì‚°</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">design_fir_window</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">delta_s</span><span class="p">,</span> <span class="n">window_type</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design FIR lowpass filter using window method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        wp: passband edge (normalized, 0 to pi)</span>
<span class="sd">        ws: stopband edge (normalized, 0 to pi)</span>
<span class="sd">        delta_s: stopband attenuation (linear)</span>
<span class="sd">        window_type: &#39;rectangular&#39;, &#39;hann&#39;, &#39;hamming&#39;, or &#39;blackman&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: filter coefficients</span>
<span class="sd">        M: filter order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Transition width</span>
    <span class="n">delta_w</span> <span class="o">=</span> <span class="n">ws</span> <span class="o">-</span> <span class="n">wp</span>

    <span class="c1"># Cutoff frequency (midpoint)</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="p">(</span><span class="n">wp</span> <span class="o">+</span> <span class="n">ws</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Determine filter order M from window type</span>
    <span class="n">transition_coefficients</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;rectangular&#39;</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="s1">&#39;hann&#39;</span><span class="p">:</span>        <span class="mf">3.11</span><span class="p">,</span>
        <span class="s1">&#39;hamming&#39;</span><span class="p">:</span>     <span class="mf">3.32</span><span class="p">,</span>
        <span class="s1">&#39;blackman&#39;</span><span class="p">:</span>    <span class="mf">5.56</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">coeff</span> <span class="o">=</span> <span class="n">transition_coefficients</span><span class="p">[</span><span class="n">window_type</span><span class="p">]</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">coeff</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">delta_w</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Ensure even order for Type I filter</span>

    <span class="c1"># Compute windowed ideal lowpass</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">h_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">n</span> <span class="o">==</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">wc</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">wc</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="c1"># Apply window</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;rectangular&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;hann&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;hamming&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;blackman&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">windows</span><span class="p">[</span><span class="n">window_type</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h_d</span> <span class="o">*</span> <span class="n">w</span>

    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">M</span>

<span class="c1"># Example: design lowpass filter</span>
<span class="n">wp</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># Passband edge</span>
<span class="n">ws</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># Stopband edge</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">window_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rectangular&#39;</span><span class="p">,</span> <span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;blackman&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">wtype</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">window_types</span><span class="p">):</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">design_fir_window</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">wtype</span><span class="p">)</span>
    <span class="n">w_freq</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_freq</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ï‰p = 0.3Ï€&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ï‰s = 0.5Ï€&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€ rad/sample)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wtype</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> Window, M = </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;FIR Lowpass Filter Design: Window Method Comparison&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fir_window_method.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5">5. ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ì¹´ì´ì € ì°½í•¨ìˆ˜ ì •ì˜<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>ì¹´ì´ì € ì°½í•¨ìˆ˜(Kaiser Window)ëŠ” ì£¼ì—½ í­ê³¼ ë¶€ì—½ ë ˆë²¨ ì‚¬ì´ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ì œì–´í•˜ëŠ” <strong>ì—°ì† ì¡°ì ˆ ê°€ëŠ¥í•œ</strong> íŒŒë¼ë¯¸í„° $\beta$ë¥¼ ì œê³µí•œë‹¤:</p>
<p>$$w[n] = \frac{I_0\left(\beta\sqrt{1 - \left(\frac{2n}{M} - 1\right)^2}\right)}{I_0(\beta)}, \quad 0 \leq n \leq M$$</p>
<p>ì—¬ê¸°ì„œ $I_0(\cdot)$ëŠ” ì œ1ì¢… 0ì°¨ ë³€í˜• ë² ì…€ í•¨ìˆ˜(Zeroth-Order Modified Bessel Function of the First Kind)ì´ë‹¤.</p>
<h3 id="52">5.2 ì¹´ì´ì €ì˜ ê²½í—˜ì  ê³µì‹<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p>ì›í•˜ëŠ” ì €ì§€ëŒ€ì—­ ê°ì‡  $A_s$ (dB)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ:</p>
<p><strong>íŒŒë¼ë¯¸í„° $\beta$:</strong></p>
<p>$$\beta = \begin{cases} 0.1102(A_s - 8.7), & A_s > 50 \\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21), & 21 \leq A_s \leq 50 \\ 0, & A_s < 21 \end{cases}$$</p>
<p><strong>í•„í„° ì°¨ìˆ˜ $M$:</strong></p>
<p>$$M = \left\lceil \frac{A_s - 7.95}{2.285 \cdot \Delta\omega} \right\rceil$$</p>
<p>ì—¬ê¸°ì„œ $\Delta\omega = \omega_s - \omega_p$ëŠ” ì „ì´ í­ì´ë‹¤.</p>
<h3 id="53">5.3 ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„ ì ˆì°¨<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kaiser_fir_design</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design FIR lowpass filter using Kaiser window.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        wp: passband edge (normalized, 0 to pi)</span>
<span class="sd">        ws: stopband edge (normalized, 0 to pi)</span>
<span class="sd">        As_dB: stopband attenuation in dB</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: filter coefficients</span>
<span class="sd">        M: filter order</span>
<span class="sd">        beta: Kaiser window parameter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Transition width</span>
    <span class="n">delta_w</span> <span class="o">=</span> <span class="n">ws</span> <span class="o">-</span> <span class="n">wp</span>

    <span class="c1"># Cutoff frequency</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="p">(</span><span class="n">wp</span> <span class="o">+</span> <span class="n">ws</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Kaiser&#39;s empirical formula for beta</span>
    <span class="k">if</span> <span class="n">As_dB</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1102</span> <span class="o">*</span> <span class="p">(</span><span class="n">As_dB</span> <span class="o">-</span> <span class="mf">8.7</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">As_dB</span> <span class="o">&gt;=</span> <span class="mi">21</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5842</span> <span class="o">*</span> <span class="p">(</span><span class="n">As_dB</span> <span class="o">-</span> <span class="mi">21</span><span class="p">)</span><span class="o">**</span><span class="mf">0.4</span> <span class="o">+</span> <span class="mf">0.07886</span> <span class="o">*</span> <span class="p">(</span><span class="n">As_dB</span> <span class="o">-</span> <span class="mi">21</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># Filter order</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">As_dB</span> <span class="o">-</span> <span class="mf">7.95</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.285</span> <span class="o">*</span> <span class="n">delta_w</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Ensure even order for Type I</span>

    <span class="c1"># Ideal lowpass impulse response</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">h_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">n</span> <span class="o">==</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">wc</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">wc</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="c1"># Kaiser window</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">h_d</span> <span class="o">*</span> <span class="n">w</span>
    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">beta</span>

<span class="c1"># Design filters with different stopband attenuations</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">specs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">As</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">specs</span><span class="p">):</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">kaiser_fir_design</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">As</span><span class="p">)</span>
    <span class="n">w_freq</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_freq</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">As</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€ rad/sample)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Kaiser: As=</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB, Î²=</span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">As</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Kaiser Window FIR Design: Varying Stopband Attenuation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;kaiser_design.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="54-scipysignalkaiserord">5.4 scipy.signal.kaiserord ì‚¬ìš©<a class="header-link" href="#54-scipysignalkaiserord" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scipy provides convenient functions for Kaiser window design</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">kaiserord</span><span class="p">,</span> <span class="n">firwin</span>

<span class="c1"># Specification</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c1"># Sample rate (Hz)</span>
<span class="n">f_pass</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Passband edge (Hz)</span>
<span class="n">f_stop</span> <span class="o">=</span> <span class="mi">1500</span>  <span class="c1"># Stopband edge (Hz)</span>
<span class="n">A_stop</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># Stopband attenuation (dB)</span>

<span class="c1"># Compute transition width in normalized frequency</span>
<span class="n">nyquist</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_stop</span> <span class="o">-</span> <span class="n">f_pass</span><span class="p">)</span> <span class="o">/</span> <span class="n">nyquist</span>  <span class="c1"># Normalized transition width</span>

<span class="c1"># Kaiser window parameters</span>
<span class="n">numtaps</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">kaiserord</span><span class="p">(</span><span class="n">A_stop</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="k">if</span> <span class="n">numtaps</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">numtaps</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># firwin needs odd number of taps for Type I</span>

<span class="c1"># Design the filter</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_pass</span> <span class="o">+</span> <span class="n">f_stop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">nyquist</span>  <span class="c1"># Normalized cutoff</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filter order: </span><span class="si">{</span><span class="n">numtaps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of taps: </span><span class="si">{</span><span class="n">numtaps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kaiser beta: </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Frequency response</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Magnitude response</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">A_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">A_stop</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fp=</span><span class="si">{</span><span class="n">f_pass</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fs=</span><span class="si">{</span><span class="n">f_stop</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Impulse response</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Impulse Response (M=</span><span class="si">{</span><span class="n">numtaps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;kaiser_scipy.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì£¼íŒŒìˆ˜ í‘œë³¸í™”ë²•<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ì›ë¦¬<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>ì£¼íŒŒìˆ˜ í‘œë³¸í™”ë²•(Frequency Sampling Method)ì€ $N$ê°œì˜ ë“±ê°„ê²© ì£¼íŒŒìˆ˜ ì ì—ì„œ ì›í•˜ëŠ” ì£¼íŒŒìˆ˜ ì‘ë‹µì„ ì§€ì •í•˜ê³  ì—­ DFTë¥¼ í†µí•´ í•„í„° ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ì—¬ FIR í•„í„°ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì´ë‹¤:</p>
<p>$$H[k] = H(e^{j 2\pi k / N}), \quad k = 0, 1, \ldots, N-1$$</p>
<p>$$h[n] = \frac{1}{N} \sum_{k=0}^{N-1} H[k] e^{j 2\pi k n / N}, \quad n = 0, 1, \ldots, N-1$$</p>
<h3 id="62-transition-samples">6.2 ì „ì´ í‘œë³¸(Transition Samples)<a class="header-link" href="#62-transition-samples" title="Permanent link">&para;</a></h3>
<p>í•µì‹¬ ì•„ì´ë””ì–´ëŠ” <strong>ì „ì´ ëŒ€ì—­ í‘œë³¸ì„ ìµœì í™”</strong>í•˜ì—¬ ì €ì§€ëŒ€ì—­ ë¦¬í”Œì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. 1ì—ì„œ 0ìœ¼ë¡œ ê¸‰ê²©íˆ ì „í™˜í•˜ëŠ” ëŒ€ì‹ , ì¤‘ê°„ ê°’ $T_1, T_2, \ldots$ë¥¼ ì „ì´ ëŒ€ì—­ì— ë°°ì¹˜í•œë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">ì£¼íŒŒìˆ˜</span><span class="w"> </span><span class="n">í‘œë³¸</span><span class="w"> </span><span class="n">H</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="err">:</span>
<span class="n">H</span><span class="o">[</span><span class="n">k</span><span class="o">]</span>
<span class="w">  </span><span class="err">â†‘</span>
<span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w">                   </span><span class="err">â•²</span>
<span class="n">Tâ‚</span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â—</span><span class="w">   </span><span class="err">â†</span><span class="w"> </span><span class="n">ì „ì´</span><span class="w"> </span><span class="n">í‘œë³¸</span><span class="w"> </span><span class="p">(</span><span class="n">ìµœì í™”ë¨</span><span class="p">)</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w">                      </span><span class="err">â•²</span>
<span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â”€â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span><span class="w"> </span><span class="err">â”€</span><span class="w"> </span><span class="err">â—</span>
<span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’</span><span class="w"> </span><span class="n">k</span>
</code></pre></div>

<h3 id="63">6.3 êµ¬í˜„<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">freq_sampling_lowpass</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cutoff_bin</span><span class="p">,</span> <span class="n">transition_values</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FIR filter design via frequency sampling.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        N: number of samples (filter length)</span>
<span class="sd">        cutoff_bin: passband ends at bin index cutoff_bin</span>
<span class="sd">        transition_values: list of transition band sample values</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: filter coefficients (real)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1"># Passband (bins 0 to cutoff_bin)</span>
    <span class="n">H</span><span class="p">[:</span><span class="n">cutoff_bin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Mirror for negative frequencies (ensure real h[n])</span>
    <span class="n">H</span><span class="p">[</span><span class="n">N</span> <span class="o">-</span> <span class="n">cutoff_bin</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Transition band samples</span>
    <span class="k">if</span> <span class="n">transition_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transition_values</span><span class="p">):</span>
            <span class="n">H</span><span class="p">[</span><span class="n">cutoff_bin</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
            <span class="n">H</span><span class="p">[</span><span class="n">N</span> <span class="o">-</span> <span class="n">cutoff_bin</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>

    <span class="c1"># Inverse DFT to get filter coefficients</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>

    <span class="c1"># Circular shift for causal filter</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">h</span>

<span class="c1"># Compare with and without optimized transition samples</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">33</span>
<span class="n">cutoff_bin</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Without transition samples</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">freq_sampling_lowpass</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cutoff_bin</span><span class="p">)</span>
<span class="n">w1</span><span class="p">,</span> <span class="n">H1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

<span class="c1"># With optimized transition sample</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">freq_sampling_lowpass</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cutoff_bin</span><span class="p">,</span> <span class="n">transition_values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">w2</span><span class="p">,</span> <span class="n">H2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

<span class="c1"># With two optimized transition samples</span>
<span class="n">h3</span> <span class="o">=</span> <span class="n">freq_sampling_lowpass</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cutoff_bin</span><span class="p">,</span> <span class="n">transition_values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">])</span>
<span class="n">w3</span><span class="p">,</span> <span class="n">H3</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h3</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No transition&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=[0.5]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w3</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=[0.59, 0.11]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€ rad/sample)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Sampling: Effect of Transition Values&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">h3</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response (Optimized Transition)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;freq_sampling.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-parks-mcclellan">7. ìµœì  ë“±ë¦¬í”Œ ì„¤ê³„: Parks-McClellan ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#7-parks-mcclellan" title="Permanent link">&para;</a></h2>
<h3 id="71-minimax-optimization">7.1 ë¯¸ë‹ˆë§¥ìŠ¤ ìµœì í™”(Minimax Optimization)<a class="header-link" href="#71-minimax-optimization" title="Permanent link">&para;</a></h3>
<p>Parks-McClellan (PM) ì•Œê³ ë¦¬ì¦˜ì€ Remez êµí™˜ ì•Œê³ ë¦¬ì¦˜(Remez Exchange Algorithm)ìœ¼ë¡œë„ ì•Œë ¤ì ¸ ìˆìœ¼ë©°, ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ìµœëŒ€ ê°€ì¤‘ ì˜¤ì°¨ë¥¼ ìµœì†Œí™”í•˜ëŠ” FIR í•„í„°ë¥¼ ì„¤ê³„í•œë‹¤:</p>
<p>$$\min_{h} \max_{\omega \in \text{bands}} \left| W(\omega) \left[ H_d(\omega) - H(\omega) \right] \right|$$</p>
<p>ì—¬ê¸°ì„œ:
- $H_d(\omega)$ëŠ” ì›í•˜ëŠ” ì£¼íŒŒìˆ˜ ì‘ë‹µ
- $H(\omega) = \sum_{n=0}^{M} h[n] e^{-j\omega n}$ëŠ” ì‹¤ì œ ì‘ë‹µ
- $W(\omega)$ëŠ” ê°€ì¤‘ í•¨ìˆ˜</p>
<h3 id="72-equiripple-property">7.2 ë“±ë¦¬í”Œ íŠ¹ì„±(Equiripple Property)<a class="header-link" href="#72-equiripple-property" title="Permanent link">&para;</a></h3>
<p>ì²´ë¹„ì‡¼í”„ ì •ë¦¬(Chebyshev Theorem)ëŠ” ìµœì  í•´ê°€ <strong>ë“±ë¦¬í”Œ(Equiripple)</strong> ì˜¤ì°¨ë¥¼ ë‚˜íƒ€ëƒ„ì„ ë³´ì¥í•œë‹¤ -- ì˜¤ì°¨ëŠ” ì§€ì •ëœ ëª¨ë“  ëŒ€ì—­ì—ì„œ ë™ì¼í•œ ì§„í­ìœ¼ë¡œ $\pm\delta$ ì‚¬ì´ë¥¼ ì§„ë™í•œë‹¤:</p>
<div class="highlight"><pre><span></span><code>ë“±ë¦¬í”Œ ì˜¤ì°¨ ê±°ë™:
          í†µê³¼ëŒ€ì—­                      ì €ì§€ëŒ€ì—­
    â†‘    +Î´â‚ â”€ â”€ â”€ â•±â•²    â•±â•²
H(Ï‰)â”‚          â•±  â•² â•±  â•²
    â”‚    â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â•²â•±â”€â”€â”€â”€â•²â”€â”€â”€â”€ 1.0
    â”‚
    â”‚                                     â•±â•²    â•±â•²    â•±â•²
    â”‚     -Î´â‚ â”€ â”€ â”€               â”€â”€â•²â”€â”€â•±â”€â”€â•²â”€â”€â•±â”€â”€â•²â”€â”€â•±â”€â”€
    â”‚                          +Î´â‚‚ â”€ â”€â•²â•±â”€ â”€ â•²â•±â”€ â”€ â•²â•±â”€
    â”‚                          -Î´â‚‚ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Ï‰
</code></pre></div>

<h3 id="73-remez">7.3 Remez êµí™˜ ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#73-remez" title="Permanent link">&para;</a></h3>
<p>ì•Œê³ ë¦¬ì¦˜ì€ ë°˜ë³µì ìœ¼ë¡œ:</p>
<ol>
<li>$(M/2 + 2)$ê°œì˜ ê·¹ì  ì£¼íŒŒìˆ˜(Extremal Frequency) ì ìœ¼ë¡œ <strong>ì´ˆê¸°í™”</strong>í•œë‹¤</li>
<li>ë“±ë¦¬í”Œ ê±°ë™ì„ ë§Œë“¤ì–´ë‚´ëŠ” ë‹¤í•­ì‹ì„ êµ¬í•˜ëŠ” ë³´ê°„ ë¬¸ì œë¥¼ <strong>í’€ì´</strong>í•œë‹¤</li>
<li>ì˜¤ì°¨ê°€ ìµœëŒ€ì¸ ìƒˆë¡œìš´ ê·¹ì ì„ <strong>íƒìƒ‰</strong>í•œë‹¤</li>
<li>í˜„ì¬ ê·¹ì  ì§‘í•©ì„ ìƒˆ ì§‘í•©ìœ¼ë¡œ <strong>êµí™˜</strong>í•œë‹¤</li>
<li>ìˆ˜ë ´í•  ë•Œê¹Œì§€ (ê·¹ì ì´ ì•ˆì •ë  ë•Œê¹Œì§€) <strong>ë°˜ë³µ</strong>í•œë‹¤</li>
</ol>
<h3 id="74-scipysignalremez">7.4 scipy.signal.remezë¥¼ ì´ìš©í•œ êµ¬í˜„<a class="header-link" href="#74-scipysignalremez" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">remez</span><span class="p">,</span> <span class="n">freqz</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parks_mcclellan_lowpass</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">fs_hz</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design lowpass FIR filter using Parks-McClellan algorithm.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        numtaps: number of filter taps (M + 1)</span>
<span class="sd">        fp: passband edge frequency (Hz)</span>
<span class="sd">        fs_freq: stopband edge frequency (Hz)</span>
<span class="sd">        fs_hz: sampling frequency (Hz)</span>
<span class="sd">        weight: weighting [W_pass, W_stop]</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: filter coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Bands: [0, fp, fs, fs_hz/2]</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">fs_hz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">desired</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Passband = 1, Stopband = 0</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">remez</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">desired</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_hz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span>

<span class="c1"># Example: lowpass filter design</span>
<span class="n">fs_hz</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">numtaps</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">fp</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Passband edge (Hz)</span>
<span class="n">f_stop</span> <span class="o">=</span> <span class="mi">1500</span>  <span class="c1"># Stopband edge (Hz)</span>

<span class="c1"># Different weighting schemes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Equal weight&#39;</span><span class="p">),</span>
    <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;Stopband 10Ã— weight&#39;</span><span class="p">),</span>
    <span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Passband 10Ã— weight&#39;</span><span class="p">),</span>
    <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;Stopband 100Ã— weight&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">parks_mcclellan_lowpass</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">fs_hz</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_hz</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fp=</span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fs=</span><span class="si">{</span><span class="n">f_stop</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PM Design: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Parks-McClellan Filter Design with Different Weights&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;parks_mcclellan.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="75">7.5 ëŒ€ì—­í†µê³¼ í•„í„° ì˜ˆì‹œ<a class="header-link" href="#75" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Bandpass filter using Parks-McClellan</span>
<span class="n">fs_hz</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">numtaps</span> <span class="o">=</span> <span class="mi">101</span>

<span class="c1"># Bandpass: pass 1000-2000 Hz, stop below 500 and above 2500</span>
<span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="n">fs_hz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">desired</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">weight</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">h_bp</span> <span class="o">=</span> <span class="n">remez</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">desired</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_hz</span><span class="p">)</span>

<span class="c1"># Frequency response</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">H_bp</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h_bp</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_hz</span><span class="p">)</span>
<span class="n">H_bp_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_bp</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">H_bp_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passband&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bandpass FIR (Parks-McClellan)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_bp</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passband&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|H(f)|&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Response (Linear)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bandpass_pm.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8-fir">8. ì„ í˜• ìœ„ìƒ FIR í•„í„°<a class="header-link" href="#8-fir" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ì„ í˜• ìœ„ìƒì˜ ì¤‘ìš”ì„±<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>í•„í„°ê°€ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„ë  ìˆ˜ ìˆì„ ë•Œ <strong>ì„ í˜• ìœ„ìƒ(Linear Phase)</strong>ì„ ê°–ëŠ”ë‹¤ê³  í•œë‹¤:</p>
<p>$$H(e^{j\omega}) = |H(e^{j\omega})| \cdot e^{-j\omega \tau}$$</p>
<p>ì—¬ê¸°ì„œ $\tau$ëŠ” ì¼ì •í•œ êµ°ì§€ì—°(Group Delay)ì´ë‹¤. ì„ í˜• ìœ„ìƒì€ ëª¨ë“  ì£¼íŒŒìˆ˜ ì„±ë¶„ì´ ë™ì¼í•œ ì‹œê°„ë§Œí¼ ì§€ì—°ë¨ì„ ì˜ë¯¸í•˜ë©°, íŒŒí˜• ëª¨ì–‘ì„ ë³´ì¡´í•œë‹¤.</p>
<p><strong>êµ°ì§€ì—°:</strong></p>
<p>$$\tau(\omega) = -\frac{d\angle H(e^{j\omega})}{d\omega} = \text{ìƒìˆ˜} = \frac{M}{2}$$</p>
<h3 id="82">8.2 ëŒ€ì¹­ ì¡°ê±´<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<p>ì„ í˜• ìœ„ìƒ FIR í•„í„°ëŠ” ëŒ€ì¹­ ë˜ëŠ” ë°˜ëŒ€ì¹­ ì„í„ìŠ¤ ì‘ë‹µì„ í•„ìš”ë¡œ í•œë‹¤:</p>
<p><strong>ëŒ€ì¹­(Symmetric)</strong> (íƒ€ì… I ë° II): $h[n] = h[M - n]$</p>
<p><strong>ë°˜ëŒ€ì¹­(Antisymmetric)</strong> (íƒ€ì… III ë° IV): $h[n] = -h[M - n]$</p>
<h3 id="83-fir">8.3 ì„ í˜• ìœ„ìƒ FIR í•„í„°ì˜ ë„¤ ê°€ì§€ ìœ í˜•<a class="header-link" href="#83-fir" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìœ í˜•   â”‚ ëŒ€ì¹­ì„±       â”‚ ì°¨ìˆ˜ M               â”‚ ì í•©í•œ í•„í„° ìœ í˜•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ I      â”‚ ëŒ€ì¹­         â”‚ ì§ìˆ˜                 â”‚ ëª¨ë“  í•„í„° ìœ í˜•    â”‚
â”‚ II     â”‚ ëŒ€ì¹­         â”‚ í™€ìˆ˜                 â”‚ ì €ì—­í†µê³¼, ëŒ€ì—­í†µê³¼â”‚
â”‚ III    â”‚ ë°˜ëŒ€ì¹­       â”‚ ì§ìˆ˜                 â”‚ ëŒ€ì—­í†µê³¼, íë²„íŠ¸, â”‚
â”‚        â”‚              â”‚                      â”‚ ë¯¸ë¶„ê¸°            â”‚
â”‚ IV     â”‚ ë°˜ëŒ€ì¹­       â”‚ í™€ìˆ˜                 â”‚ ê³ ì—­í†µê³¼, ëŒ€ì—­í†µê³¼â”‚
â”‚        â”‚              â”‚                      â”‚ íë²„íŠ¸            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>íƒ€ì… I</strong> (ì§ìˆ˜ ì°¨ìˆ˜, ëŒ€ì¹­):
- $H(e^{j0}) = \sum h[n]$ (ì œì•½ ì—†ìŒ)
- $H(e^{j\pi}) = \sum (-1)^n h[n]$ (ì œì•½ ì—†ìŒ)
- ëª¨ë“  í•„í„° ìœ í˜•ì— ì í•©</p>
<p><strong>íƒ€ì… II</strong> (í™€ìˆ˜ ì°¨ìˆ˜, ëŒ€ì¹­):
- $H(e^{j\pi}) = 0$ í•­ìƒ ì„±ë¦½
- ê³ ì—­í†µê³¼(Highpass) ë˜ëŠ” ëŒ€ì—­ì €ì§€(Bandstop) í•„í„°ì— ì‚¬ìš© ë¶ˆê°€</p>
<p><strong>íƒ€ì… III</strong> (ì§ìˆ˜ ì°¨ìˆ˜, ë°˜ëŒ€ì¹­):
- $H(e^{j0}) = 0$ ë° $H(e^{j\pi}) = 0$ í•­ìƒ ì„±ë¦½
- ëŒ€ì—­í†µê³¼, íë²„íŠ¸ ë³€í™˜(Hilbert Transform), ë¯¸ë¶„ê¸°(Differentiator)ì— ì í•©</p>
<p><strong>íƒ€ì… IV</strong> (í™€ìˆ˜ ì°¨ìˆ˜, ë°˜ëŒ€ì¹­):
- $H(e^{j0}) = 0$ í•­ìƒ ì„±ë¦½
- ì €ì—­í†µê³¼ í•„í„°ì— ì‚¬ìš© ë¶ˆê°€</p>
<h3 id="84">8.4 ì§„í­ ì‘ë‹µ ê³µì‹<a class="header-link" href="#84" title="Permanent link">&para;</a></h3>
<p>íƒ€ì… I í•„í„° (ì§ìˆ˜ $M$, ëŒ€ì¹­)ì˜ ê²½ìš°, ì£¼íŒŒìˆ˜ ì‘ë‹µì€:</p>
<p>$$H(e^{j\omega}) = e^{-j\omega M/2} A(\omega)$$</p>
<p>ì—¬ê¸°ì„œ <strong>ì§„í­ ì‘ë‹µ(Amplitude Response)</strong>ì€:</p>
<p>$$A(\omega) = h[M/2] + 2 \sum_{k=1}^{M/2} h[M/2 - k] \cos(k\omega)$$</p>
<p>ì´ëŠ” ì‹¤ìˆ˜ ê°’ í•¨ìˆ˜ë¡œ, í†µê³¼ëŒ€ì—­/ì €ì§€ëŒ€ì—­ ê±°ë™ ë¶„ì„ì´ ìš©ì´í•˜ë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_linear_phase</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze linear phase properties of FIR filter.&quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Check symmetry</span>
    <span class="n">is_symmetric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">is_antisymmetric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">is_symmetric</span> <span class="ow">and</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">&quot;Type I&quot;</span>
    <span class="k">elif</span> <span class="n">is_symmetric</span> <span class="ow">and</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">&quot;Type II&quot;</span>
    <span class="k">elif</span> <span class="n">is_antisymmetric</span> <span class="ow">and</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">&quot;Type III&quot;</span>
    <span class="k">elif</span> <span class="n">is_antisymmetric</span> <span class="ow">and</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">&quot;Type IV&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="s2">&quot;Not linear phase&quot;</span>

    <span class="c1"># Frequency response</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

    <span class="c1"># Group delay</span>
    <span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">w</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Magnitude</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ftype</span><span class="si">}</span><span class="s1">: Magnitude Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Phase</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">)),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (radians)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ftype</span><span class="si">}</span><span class="s1">: Phase Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Group delay</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_gd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">gd</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">M</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;M/2 = </span><span class="si">{</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Group Delay (samples)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Group Delay&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Impulse response (with symmetry visualization)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">M</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Center of symmetry&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Impulse Response (M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span> <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;Sample n&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Linear Phase Analysis: </span><span class="si">{</span><span class="n">ftype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ftype</span>

<span class="c1"># Example: Type I lowpass</span>
<span class="n">h_type1</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>  <span class="c1"># 50th order, symmetric</span>
<span class="n">ftype</span> <span class="o">=</span> <span class="n">analyze_linear_phase</span><span class="p">(</span><span class="n">h_type1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;linear_phase_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected filter type: </span><span class="si">{</span><span class="n">ftype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì„¤ê³„ ë°©ë²• ë¹„êµ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 ì§ì ‘ ë¹„êµ<a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_design_methods</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">wp</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare window, Kaiser, and Parks-McClellan methods for the same specs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wc_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">wp</span> <span class="o">+</span> <span class="n">ws</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Cutoff for window methods</span>

    <span class="c1"># Method 1: Hamming window</span>
    <span class="n">h_hamming</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">wc_norm</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>

    <span class="c1"># Method 2: Kaiser window (60 dB attenuation)</span>
    <span class="n">h_kaiser</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">wc_norm</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="mf">5.65</span><span class="p">))</span>

    <span class="c1"># Method 3: Parks-McClellan</span>
    <span class="n">h_pm</span> <span class="o">=</span> <span class="n">remez</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">wp</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ws</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Frequency responses</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;Hamming Window&#39;</span><span class="p">,</span> <span class="n">h_hamming</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Kaiser Window (Î²=5.65)&#39;</span><span class="p">,</span> <span class="n">h_kaiser</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Parks-McClellan&#39;</span><span class="p">,</span> <span class="n">h_pm</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

    <span class="c1"># Overlay magnitude responses</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Response Comparison&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Passband detail</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Passband Detail&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wp</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Transition band detail</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|H(f)|&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Transition Band Detail&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">wp</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">ws</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Impulse responses</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">numtaps</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample n&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Responses&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FIR Design Comparison (N=</span><span class="si">{</span><span class="n">numtaps</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;design_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">compare_design_methods</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">wp</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<h3 id="92">9.2 ì„¤ê³„ ë°©ë²• ìš”ì•½<a class="header-link" href="#92" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°©ë²•             â”‚ ìµœì ì„±       â”‚ ì œì–´           â”‚ ìµœì  ìš©ë„        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì°½í•¨ìˆ˜ë²•         â”‚ ì¤€ìµœì        â”‚ ì œí•œì          â”‚ ë¹ ë¥¸ ì„¤ê³„,       â”‚
â”‚                  â”‚              â”‚ (ì´ì‚° ì°½í•¨ìˆ˜   â”‚ êµìœ¡ìš©           â”‚
â”‚                  â”‚              â”‚  ì„ íƒ)         â”‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¹´ì´ì € ì°½í•¨ìˆ˜    â”‚ ì¤€ìµœì ì— ê·¼ì ‘â”‚ ì—°ì† Î²         â”‚ ì œì–´ì™€ ë‹¨ìˆœì„±ì˜  â”‚
â”‚                  â”‚              â”‚ íŒŒë¼ë¯¸í„°       â”‚ ì¢‹ì€ ê· í˜•        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì£¼íŒŒìˆ˜ í‘œë³¸í™”    â”‚ ì¤€ìµœì        â”‚ ì „ì´ í‘œë³¸      â”‚ í•˜ë“œì›¨ì–´ êµ¬í˜„,   â”‚
â”‚                  â”‚              â”‚                â”‚ DFT ê¸°ë°˜ í•„í„°    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Parks-McClellan  â”‚ ìµœì          â”‚ ê°€ì¤‘ í•¨ìˆ˜,     â”‚ ì‹¤ì œ ì œí’ˆ,       â”‚
â”‚                  â”‚ (ë¯¸ë‹ˆë§¥ìŠ¤)   â”‚ ë‹¤ì¤‘ ëŒ€ì—­      â”‚ ì—„ê²©í•œ ì‚¬ì–‘      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>í•µì‹¬ ì¸ì‚¬ì´íŠ¸</strong>: ë™ì¼í•œ í•„í„° ì°¨ìˆ˜ì—ì„œ Parks-McClellanì€ ê°€ì¥ ì‘ì€ ìµœëŒ€ ì˜¤ì°¨(ë“±ë¦¬í”Œ)ë¥¼ ë‹¬ì„±í•œë‹¤. ì°½í•¨ìˆ˜ë²•ì€ ë” ë†’ì€ ì£¼íŒŒìˆ˜ì—ì„œ ë‹¨ì¡° ì¦ê°€í•˜ëŠ” ì €ì§€ëŒ€ì—­ ê°ì‡ ë¥¼ ê°–ëŠ” í•„í„°ë¥¼ ìƒì„±í•˜ëŠ”ë°, ì´ëŠ” ë†’ì€ ì£¼íŒŒìˆ˜ì—ì„œì˜ ê°ì‡ ë¥¼ "ë‚­ë¹„"í•˜ëŠ” ì…ˆì´ë‹¤.</p>
<hr />
<h2 id="10-fir">10. FIR í•„í„° êµ¬í˜„<a class="header-link" href="#10-fir" title="Permanent link">&para;</a></h2>
<h3 id="101-direct-convolution">10.1 ì§ì ‘ í•©ì„±ê³±(Direct Convolution)<a class="header-link" href="#101-direct-convolution" title="Permanent link">&para;</a></h3>
<p>ê°€ì¥ ê°„ë‹¨í•œ êµ¬í˜„ ë°©ë²•ì€ ì¶œë ¥ì„ ì§ì ‘ í•©ì„±ê³±ìœ¼ë¡œ ê³„ì‚°í•œë‹¤:</p>
<p>$$y[n] = \sum_{k=0}^{M} h[k] x[n-k]$$</p>
<p><strong>ë³µì¡ë„</strong>: $M$ì°¨ í•„í„°ë¡œ $N$ê°œì˜ í‘œë³¸ì„ í•„í„°ë§í•˜ëŠ” ë° $O(MN)$.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fir_direct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Direct-form FIR filter implementation.&quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">y</span>

<span class="c1"># Using numpy&#39;s convolve (optimized)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">y_direct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">, Filter length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">}</span><span class="s2">, Output length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_direct</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="102-fft">10.2 FFT ê¸°ë°˜ í•„í„°ë§<a class="header-link" href="#102-fft" title="Permanent link">&para;</a></h3>
<p>ê¸´ ì‹ í˜¸ì˜ ê²½ìš° FFT ê¸°ë°˜ í•©ì„±ê³±ì´ í›¨ì”¬ ë¹ ë¥´ë‹¤:</p>
<p>$$y = \text{IFFT}[\text{FFT}(x) \cdot \text{FFT}(h)]$$</p>
<p><strong>ë³µì¡ë„</strong>: $O(MN)$ ëŒ€ì‹  $O(N \log N)$.</p>
<p>FFTê°€ ë” ë¹¨ë¼ì§€ëŠ” êµì°¨ì ì€ ì¼ë°˜ì ìœ¼ë¡œ $M \approx 50-100$ì´ë‹¤.</p>
<h3 id="103-overlap-add-method">10.3 ì¤‘ì²© ê°€ì‚°ë²•(Overlap-Add Method)<a class="header-link" href="#103-overlap-add-method" title="Permanent link">&para;</a></h3>
<p>ì…ë ¥ì´ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ë„ì°©í•˜ëŠ” ì‹¤ì‹œê°„ ë˜ëŠ” ë¸”ë¡ ê¸°ë°˜ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë°©ë²•:</p>
<ol>
<li>ì…ë ¥ $x[n]$ì„ ê¸¸ì´ $L$ì˜ ë¹„ì¤‘ì²© ë¸”ë¡ìœ¼ë¡œ <strong>ë¶„í• </strong>í•œë‹¤</li>
<li>ê° ë¸”ë¡ì„ ê¸¸ì´ $L + M$ìœ¼ë¡œ <strong>ì˜ íŒ¨ë”©</strong>í•œë‹¤</li>
<li>ê° ë¸”ë¡ì„ í•„í„° $h[n]$ê³¼ <strong>FFT í•©ì„±ê³±</strong>í•œë‹¤</li>
<li>ì¸ì ‘ ì¶œë ¥ ë¸”ë¡ë“¤ì„ <strong>ì¤‘ì²© ê°€ì‚°</strong>í•œë‹¤ (ë§ˆì§€ë§‰ $M$ê°œì˜ í‘œë³¸ì´ ì¤‘ì²©ë¨)</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">overlap_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Overlap-add FIR filtering.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        h: FIR filter coefficients</span>
<span class="sd">        L: block size</span>

<span class="sd">    Returns:</span>
<span class="sd">        y: filtered output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">N_fft</span> <span class="o">=</span> <span class="n">L</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Zero-pad filter to FFT length</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>

    <span class="c1"># Output array</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Process blocks</span>
    <span class="n">num_blocks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">L</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_blocks</span><span class="p">):</span>
        <span class="c1"># Extract block</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">L</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">x_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="n">x_block</span><span class="p">[:</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>

        <span class="c1"># FFT convolution</span>
        <span class="n">X_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x_block</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
        <span class="n">y_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X_block</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>

        <span class="c1"># Overlap-add</span>
        <span class="n">y</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span> <span class="o">+</span> <span class="n">N_fft</span><span class="p">]</span> <span class="o">+=</span> <span class="n">y_block</span>

    <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Verify overlap-add produces same result as direct convolution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">y_direct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">y_ola</span> <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>

<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_direct</span> <span class="o">-</span> <span class="n">y_ola</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum error between direct and overlap-add: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="104-overlap-save-method">10.4 ì¤‘ì²© ì €ì¥ë²•(Overlap-Save Method)<a class="header-link" href="#104-overlap-save-method" title="Permanent link">&para;</a></h3>
<p>ì¤‘ì²© ê°€ì‚°ë²•ì˜ ëŒ€ì•ˆ:</p>
<ol>
<li>ì…ë ¥ ë¸”ë¡ì„ $M-1$ê°œì˜ í‘œë³¸ë§Œí¼ <strong>ì¤‘ì²©</strong>ì‹œí‚¨ë‹¤ (ê° ë¸”ë¡ì— ì´ì „ ë¸”ë¡ì˜ $M-1$ê°œ í‘œë³¸ í¬í•¨)</li>
<li>ì›í˜• í•©ì„±ê³±(Circular Convolution)ì„ ì´ìš©í•˜ì—¬ <strong>FFT í•©ì„±ê³±</strong>í•œë‹¤ (ê¸¸ì´ $L+M-1$)</li>
<li>ê° ì¶œë ¥ ë¸”ë¡ì˜ ì²« $M-1$ê°œ í‘œë³¸ì„ <strong>ë²„ë¦°ë‹¤</strong> (ì›í˜• ê°ê¹€ì— ì˜í•´ ì˜¤ì—¼ë¨)</li>
<li>ë‚˜ë¨¸ì§€ í‘œë³¸ë“¤ì„ <strong>ì—°ê²°</strong>í•œë‹¤</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">overlap_save</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Overlap-save FIR filtering.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        h: FIR filter coefficients</span>
<span class="sd">        L: block size (output samples per block)</span>

<span class="sd">    Returns:</span>
<span class="sd">        y: filtered output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">N_fft</span> <span class="o">=</span> <span class="n">L</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Zero-pad filter to FFT length</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>

    <span class="c1"># Prepend M-1 zeros to input</span>
    <span class="n">x_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">])</span>
    <span class="n">N_padded</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_padded</span><span class="p">)</span>

    <span class="c1"># Output</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">output_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">block_start</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">block_start</span> <span class="o">&lt;</span> <span class="n">N_padded</span><span class="p">:</span>
        <span class="c1"># Extract overlapping block of length N_fft</span>
        <span class="n">block_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">block_start</span> <span class="o">+</span> <span class="n">N_fft</span><span class="p">,</span> <span class="n">N_padded</span><span class="p">)</span>
        <span class="n">x_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_fft</span><span class="p">)</span>
        <span class="n">x_block</span><span class="p">[:</span><span class="n">block_end</span> <span class="o">-</span> <span class="n">block_start</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_padded</span><span class="p">[</span><span class="n">block_start</span><span class="p">:</span><span class="n">block_end</span><span class="p">]</span>

        <span class="c1"># Circular convolution via FFT</span>
        <span class="n">X_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x_block</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
        <span class="n">y_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X_block</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>

        <span class="c1"># Keep only valid samples (discard first M-1)</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="n">y_block</span><span class="p">[</span><span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="n">valid_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">),</span> <span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">output_idx</span><span class="p">)</span>
        <span class="n">y</span><span class="p">[</span><span class="n">output_idx</span><span class="p">:</span><span class="n">output_idx</span> <span class="o">+</span> <span class="n">valid_len</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid</span><span class="p">[:</span><span class="n">valid_len</span><span class="p">]</span>

        <span class="n">output_idx</span> <span class="o">+=</span> <span class="n">L</span>
        <span class="n">block_start</span> <span class="o">+=</span> <span class="n">L</span>  <span class="c1"># Advance by L (not N_fft)</span>

    <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Verify overlap-save</span>
<span class="n">y_ols</span> <span class="o">=</span> <span class="n">overlap_save</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">error_ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_direct</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_ols</span><span class="p">)]</span> <span class="o">-</span> <span class="n">y_ols</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_direct</span><span class="p">)]))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum error between direct and overlap-save: </span><span class="si">{</span><span class="n">error_ols</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="105">10.5 ì„±ëŠ¥ ë¹„êµ<a class="header-link" href="#105" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark_methods</span><span class="p">(</span><span class="n">signal_lengths</span><span class="p">,</span> <span class="n">filter_order</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Benchmark different FIR filtering methods.&quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">filter_order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Direct (np.convolve)&#39;</span><span class="p">,</span> <span class="s1">&#39;Overlap-Add&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy.fftconvolve&#39;</span><span class="p">]}</span>

    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">signal_lengths</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1"># Direct convolution</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Direct (np.convolve)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>

        <span class="c1"># Overlap-add</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Overlap-Add&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>

        <span class="c1"># scipy FFT convolve</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">fftconvolve</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">fftconvolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;scipy.fftconvolve&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="n">signal_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">benchmark_methods</span><span class="p">(</span><span class="n">signal_lengths</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">times</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">signal_lengths</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Signal Length N&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FIR Filtering: Performance Comparison&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fir_performance.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-python">11. Python êµ¬í˜„<a class="header-link" href="#11-python" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 ì™„ì „í•œ ì„¤ê³„ ì˜ˆì‹œ<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span><span class="p">,</span> <span class="n">remez</span><span class="p">,</span> <span class="n">freqz</span><span class="p">,</span> <span class="n">kaiserord</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">complete_fir_design</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">A_stop_dB</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;kaiser&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Complete FIR lowpass filter design workflow.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fs: sampling frequency (Hz)</span>
<span class="sd">        f_pass: passband edge (Hz)</span>
<span class="sd">        f_stop: stopband edge (Hz)</span>
<span class="sd">        A_stop_dB: stopband attenuation (dB)</span>
<span class="sd">        method: &#39;kaiser&#39;, &#39;hamming&#39;, or &#39;remez&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: filter coefficients</span>
<span class="sd">        info: design information dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nyq</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;kaiser&#39;</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_stop</span> <span class="o">-</span> <span class="n">f_pass</span><span class="p">)</span> <span class="o">/</span> <span class="n">nyq</span>
        <span class="n">numtaps</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">kaiserord</span><span class="p">(</span><span class="n">A_stop_dB</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">numtaps</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numtaps</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_pass</span> <span class="o">+</span> <span class="n">f_stop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">nyq</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Kaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;numtaps&#39;</span><span class="p">:</span> <span class="n">numtaps</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">beta</span><span class="p">}</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hamming&#39;</span><span class="p">:</span>
        <span class="c1"># Estimate order from transition width</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_stop</span> <span class="o">-</span> <span class="n">f_pass</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">numtaps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">3.32</span> <span class="o">/</span> <span class="n">delta_f</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">numtaps</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numtaps</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_pass</span> <span class="o">+</span> <span class="n">f_stop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">nyq</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;numtaps&#39;</span><span class="p">:</span> <span class="n">numtaps</span><span class="p">}</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;remez&#39;</span><span class="p">:</span>
        <span class="c1"># Start with estimated order, iterate if needed</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_stop</span> <span class="o">-</span> <span class="n">f_pass</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">numtaps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.001</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">))</span> <span class="o">-</span> <span class="mi">13</span><span class="p">)</span> <span class="o">/</span>
                              <span class="p">(</span><span class="mf">14.6</span> <span class="o">*</span> <span class="n">delta_f</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">numtaps</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numtaps</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">delta_s</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">A_stop_dB</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">delta_s</span><span class="p">]</span>  <span class="c1"># Weight stopband more</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">remez</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">nyq</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">weight</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Parks-McClellan&#39;</span><span class="p">,</span> <span class="s1">&#39;numtaps&#39;</span><span class="p">:</span> <span class="n">numtaps</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">info</span>

<span class="c1"># Design and analyze</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">16000</span>
<span class="n">f_pass</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">f_stop</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">A_stop</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;remez&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">methods</span><span class="p">):</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">complete_fir_design</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">A_stop</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="c1"># Frequency response</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="c1"># Magnitude</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">A_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">A_stop</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (N=</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;numtaps&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Group delay</span>
    <span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">w</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Group Delay (samples)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: Group Delay&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Complete FIR Filter Design Comparison&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;complete_fir_design.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="112">11.2 ì‹¤ì œ ì‹ í˜¸ í•„í„°ë§<a class="header-link" href="#112" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_filtering</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate FIR filtering on a multi-tone signal.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Create signal: 200 Hz + 800 Hz + 2000 Hz + noise</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">800</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>

    <span class="c1"># Design lowpass filter (cutoff ~1000 Hz)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>

    <span class="c1"># Apply filter</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Compensate for group delay</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Time domain</span>
    <span class="n">t_ms</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ms</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ms</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered (delay compensated)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrum comparison</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">))[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">))[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cutoff&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrogram</span>
    <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
    <span class="n">f_spec_f</span><span class="p">,</span> <span class="n">t_spec_f</span><span class="p">,</span> <span class="n">Syy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                        <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrogram (Original Signal)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fir_filtering_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">demonstrate_filtering</span><span class="p">()</span>
</code></pre></div>

<h3 id="113">11.3 ë‹¤ì¤‘ ëŒ€ì—­ í•„í„° ì„¤ê³„<a class="header-link" href="#113" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Design a multi-band filter using firwin2</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin2</span>

<span class="c1"># Arbitrary magnitude response</span>
<span class="n">numtaps</span> <span class="o">=</span> <span class="mi">201</span>
<span class="n">freq_points</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">gain_points</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">h_multiband</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">freq_points</span><span class="p">,</span> <span class="n">gain_points</span><span class="p">)</span>

<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">h_multiband</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
<span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Desired vs actual</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">freq_points</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gain_points</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span>
             <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Desired&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Multi-band Filter: Magnitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Multi-band Filter: dB Scale&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multiband_fir.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="1">ì—°ìŠµ ë¬¸ì œ 1: ì°½í•¨ìˆ˜ ì„ íƒ<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì‚¬ì–‘ìœ¼ë¡œ ì €ì—­í†µê³¼ FIR í•„í„°ë¥¼ ì„¤ê³„í•˜ë¼:
- í‘œë³¸í™” ì£¼íŒŒìˆ˜: $f_s = 10000$ Hz
- í†µê³¼ëŒ€ì—­ ê²½ê³„: $f_p = 1500$ Hz
- ì €ì§€ëŒ€ì—­ ê²½ê³„: $f_s = 2000$ Hz
- ìµœì†Œ ì €ì§€ëŒ€ì—­ ê°ì‡ : $60$ dB</p>
<p>(a) ì–´ë–¤ ì°½í•¨ìˆ˜ ìœ í˜•ì´ ì €ì§€ëŒ€ì—­ ì‚¬ì–‘ì„ ì¶©ì¡±í•  ìˆ˜ ìˆëŠ”ê°€?</p>
<p>(b) ê° ê°€ëŠ¥í•œ ì°½í•¨ìˆ˜ì— ëŒ€í•´ í•„ìš”í•œ í•„í„° ì°¨ìˆ˜ $M$ì„ ê³„ì‚°í•˜ë¼.</p>
<p>(c) <code>scipy.signal.firwin</code>ì„ ì‚¬ìš©í•˜ì—¬ í•„í„°ë¥¼ ì„¤ê³„í•˜ê³  ì‚¬ì–‘ì´ ì¶©ì¡±ë˜ëŠ”ì§€ ê²€ì¦í•˜ë¼.</p>
<p>(d) í†µê³¼ëŒ€ì—­ ë¦¬í”Œê³¼ ì „ì´ í­ ì¸¡ë©´ì—ì„œ ê²°ê³¼ í•„í„°ë“¤ì„ ë¹„êµí•˜ë¼.</p>
<h3 id="2_1">ì—°ìŠµ ë¬¸ì œ 2: ì¹´ì´ì € ì°½í•¨ìˆ˜ ì„¤ê³„<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ë””ì§€í„¸ í•„í„°ê°€ ë‹¤ìŒì„ ë§Œì¡±í•´ì•¼ í•œë‹¤:
- í†µê³¼ëŒ€ì—­: $0 \leq f \leq 3$ kHz, ë¦¬í”Œ $\leq 0.1$ dB
- ì €ì§€ëŒ€ì—­: $f \geq 4$ kHz, ê°ì‡  $\geq 50$ dB
- í‘œë³¸í™”ìœ¨: $f_s = 20$ kHz</p>
<p>(a) ê²½í—˜ì  ê³µì‹ì„ ì´ìš©í•˜ì—¬ ì¹´ì´ì € ì°½í•¨ìˆ˜ íŒŒë¼ë¯¸í„° $\beta$ë¥¼ ê³„ì‚°í•˜ë¼.</p>
<p>(b) ìµœì†Œ í•„í„° ì°¨ìˆ˜ $M$ì„ ê³„ì‚°í•˜ë¼.</p>
<p>(c) í•„í„°ë¥¼ ì„¤ê³„í•˜ê³  ì§„í­ ì‘ë‹µ, ìœ„ìƒ ì‘ë‹µ, êµ°ì§€ì—°ì„ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë¼.</p>
<p>(d) ì‹¤ì œ í†µê³¼ëŒ€ì—­ ë¦¬í”Œê³¼ ì €ì§€ëŒ€ì—­ ê°ì‡ ë¥¼ ì¸¡ì •í•˜ì—¬ ì„¤ê³„ê°€ ì‚¬ì–‘ì„ ì¶©ì¡±í•˜ëŠ”ì§€ ê²€ì¦í•˜ë¼.</p>
<h3 id="3-parks-mcclellan">ì—°ìŠµ ë¬¸ì œ 3: Parks-McClellan ëŒ€ì—­í†µê³¼ í•„í„°<a class="header-link" href="#3-parks-mcclellan" title="Permanent link">&para;</a></h3>
<p>Parks-McClellan ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ì—­í†µê³¼ FIR í•„í„°ë¥¼ ì„¤ê³„í•˜ë¼:
- $f_s = 44100$ Hz (CD ì˜¤ë””ì˜¤ ë ˆì´íŠ¸)
- ì €ì§€ëŒ€ì—­ 1: $0$ì—ì„œ $800$ Hz (ê°ì‡  $\geq 40$ dB)
- í†µê³¼ëŒ€ì—­: $1000$ì—ì„œ $3000$ Hz (ë¦¬í”Œ $\leq 0.5$ dB)
- ì €ì§€ëŒ€ì—­ 2: $3500$ì—ì„œ $22050$ Hz (ê°ì‡  $\geq 40$ dB)</p>
<p>(a) ì–‘ìª½ ì €ì§€ëŒ€ì—­ì—ì„œ ë“±ë¦¬í”Œì„ ìœ„í•œ ì ì ˆí•œ ê°€ì¤‘ì¹˜ë¥¼ ì„ íƒí•˜ë¼.</p>
<p>(b) ìµœì†Œ í•„í„° ì°¨ìˆ˜ë¥¼ ê²°ì •í•˜ë¼.</p>
<p>(c) ì§„í­ ì‘ë‹µì„ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ê³  ì‚¬ì–‘ì„ ê²€ì¦í•˜ë¼.</p>
<p>(d) ì²˜í”„ ì‹ í˜¸(100 Hzì—ì„œ 10 kHzë¡œ ìŠ¤ìœ•)ì— í•„í„°ë¥¼ ì ìš©í•˜ê³  í•„í„°ë§ ì „í›„ì˜ ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì„ í‘œì‹œí•˜ë¼.</p>
<h3 id="4_1">ì—°ìŠµ ë¬¸ì œ 4: ì¤‘ì²© ê°€ì‚°ë²• êµ¬í˜„<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<p>ì¤‘ì²© ê°€ì‚°ë²•ì„ ì‚¬ìš©í•˜ëŠ” ì‹¤ì‹œê°„ FIR í•„í„° í”„ë¡œì„¸ì„œë¥¼ êµ¬í˜„í•˜ë¼:</p>
<p>(a) ë¸”ë¡ ë‹¨ìœ„ë¡œ ì˜¤ë””ì˜¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” <code>StreamingFIRFilter</code> í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ë¼.</p>
<p>(b) 64, 256, 1024, 4096 í‘œë³¸ì˜ ë¸”ë¡ í¬ê¸°ë¡œ í…ŒìŠ¤íŠ¸í•˜ë¼.</p>
<p>(c) ì¶œë ¥ì´ ì§ì ‘ í•©ì„±ê³± (<code>np.convolve</code>)ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•˜ë¼.</p>
<p>(d) ë¸”ë¡ í¬ê¸°ì˜ í•¨ìˆ˜ë¡œ ë¸”ë¡ë‹¹ ì²˜ë¦¬ ì‹œê°„ì„ ì¸¡ì •í•˜ê³  ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë¼.</p>
<p>(e) 44100 Hzì—ì„œ 10ì´ˆ ì˜¤ë””ì˜¤ ì‹ í˜¸ì— 200íƒ­ í•„í„°ë¥¼ ì ìš©í•  ë•Œ ìµœì  ë¸”ë¡ í¬ê¸°ë¥¼ ì°¾ì•„ë¼.</p>
<h3 id="5_1">ì—°ìŠµ ë¬¸ì œ 5: ì„ í˜• ìœ„ìƒ ì œì•½<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>(a) íƒ€ì… II FIR í•„í„° (í™€ìˆ˜ ì°¨ìˆ˜, ëŒ€ì¹­ ê³„ìˆ˜)ê°€ í•­ìƒ $H(e^{j\pi}) = 0$ì„ì„ ì¦ëª…í•˜ë¼. ì™œ ì´ê²ƒì´ ê³ ì—­í†µê³¼ í•„í„° ì„¤ê³„ì— ë¶€ì í•©í•œê°€?</p>
<p>(b) ì°¨ë‹¨ ì£¼íŒŒìˆ˜ $0.6\pi$ì—ì„œ ê³ ì—­í†µê³¼ FIR í•„í„°ë¥¼ ë‹¤ìŒìœ¼ë¡œ ì„¤ê³„í•˜ë¼:
   - íƒ€ì… I (ì§ìˆ˜ ì°¨ìˆ˜)
   - íƒ€ì… IV (í™€ìˆ˜ ì°¨ìˆ˜, ë°˜ëŒ€ì¹­)</p>
<p>ê²°ê³¼ë¥¼ ë¹„êµí•˜ë¼. ì–´ëŠ ê²ƒì´ $\omega = \pi$ ê·¼ì²˜ì—ì„œ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì´ëŠ”ê°€?</p>
<p>(c) ì°¨ìˆ˜ 30ì˜ íë²„íŠ¸ ë³€í™˜ í•„í„°(íƒ€ì… III)ë¥¼ ì„¤ê³„í•˜ë¼. ì§„í­ ë° ìœ„ìƒ ì‘ë‹µì„ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë¼. $\omega = 0$ê³¼ $\omega = \pi$ì—ì„œ ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ëŠ”ê°€?</p>
<h3 id="6_1">ì—°ìŠµ ë¬¸ì œ 6: ë¹„êµ ì—°êµ¬<a class="header-link" href="#6_1" title="Permanent link">&para;</a></h3>
<p>ì‚¬ì–‘: $f_s = 16000$ Hz, $f_p = 2000$ Hz, $f_\text{stop} = 2500$ Hz, $A_s = 50$ dB:</p>
<p>(a) (i) í•´ë° ì°½í•¨ìˆ˜, (ii) ì¹´ì´ì € ì°½í•¨ìˆ˜, (iii) Parks-McClellanì„ ì‚¬ìš©í•˜ì—¬ í•„í„°ë¥¼ ì„¤ê³„í•˜ë¼.</p>
<p>(b) ê° ë°©ë²•ì— ëŒ€í•´ ë‹¤ìŒì„ ë³´ê³ í•˜ë¼: í•„í„° ì°¨ìˆ˜, í†µê³¼ëŒ€ì—­ ë¦¬í”Œ (dB), ì‹¤ì œ ì €ì§€ëŒ€ì—­ ê°ì‡  (dB), ì „ì´ í­ (Hz).</p>
<p>(c) 4ê°œì˜ ì„œë¸Œí”Œë¡¯ì´ í¬í•¨ëœ ë‹¨ì¼ ê·¸ë¦¼ì„ ìƒì„±í•˜ë¼: ì§„í­ ì‘ë‹µ ì˜¤ë²„ë ˆì´, í†µê³¼ëŒ€ì—­ ìƒì„¸, ì„í„ìŠ¤ ì‘ë‹µ, ì˜ì -ê·¹ì  ì„ ë„(Pole-Zero Plot).</p>
<p>(d) ì–´ë–¤ ë°©ë²•ì´ ê°€ì¥ ë‚®ì€ í•„í„° ì°¨ìˆ˜ì—ì„œ ìµœì„ ì˜ ê²°ê³¼ë¥¼ ì œê³µí•˜ëŠ”ê°€? ë‹µì„ ì •ë‹¹í™”í•˜ë¼.</p>
<h3 id="7-fir">ì—°ìŠµ ë¬¸ì œ 7: ìµœì†Œ ìœ„ìƒ FIR í•„í„°<a class="header-link" href="#7-fir" title="Permanent link">&para;</a></h3>
<p>(a) í•´ë° ì°½í•¨ìˆ˜ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì°¨ìˆ˜ 40ì˜ ì„ í˜• ìœ„ìƒ ì €ì—­í†µê³¼ FIR í•„í„°ë¥¼ ì„¤ê³„í•˜ë¼.</p>
<p>(b) ì¼‘ìŠ¤íŠ¸ëŸ¼ ë°©ë²•(Cepstral Method)ì„ ì‚¬ìš©í•˜ì—¬ ìµœì†Œ ìœ„ìƒ(Minimum-Phase) FIR í•„í„°ë¡œ ë³€í™˜í•˜ë¼:
   - ì¼‘ìŠ¤íŠ¸ëŸ¼ $\hat{h}[n] = \text{IFFT}(\log|\text{FFT}(h)|)$ ê³„ì‚°
   - ìµœì†Œ ìœ„ìƒ ë²„ì „ êµ¬ì„±</p>
<p>(c) ë‘ í•„í„°ì˜ ì§„í­ ì‘ë‹µ, ìœ„ìƒ ì‘ë‹µ, êµ°ì§€ì—°ì„ ë¹„êµí•˜ë¼.</p>
<p>(d) ì–¸ì œ ìµœì†Œ ìœ„ìƒì„ ì„ í˜• ìœ„ìƒë³´ë‹¤ ì„ í˜¸í•˜ëŠ”ê°€? ì˜ˆì‹œë¥¼ ë“¤ì–´ ë…¼ì˜í•˜ë¼.</p>
<hr />
<h2 id="_3">ì°¸ê³  ë¬¸í—Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Oppenheim, A. V., &amp; Schafer, R. W. (2010).</strong> <em>Discrete-Time Signal Processing</em> (3rd ed.). Pearson. Chapters 7-8.</li>
<li><strong>Proakis, J. G., &amp; Manolakis, D. G. (2007).</strong> <em>Digital Signal Processing</em> (4th ed.). Pearson. Chapter 10.</li>
<li><strong>Parks, T. W., &amp; Burrus, C. S. (1987).</strong> <em>Digital Filter Design</em>. Wiley.</li>
<li><strong>Kaiser, J. F. (1974).</strong> "Nonrecursive Digital Filter Design Using the I0-sinh Window Function." <em>Proceedings of the 1974 IEEE International Symposium on Circuits and Systems</em>.</li>
<li><strong>McClellan, J. H., Parks, T. W., &amp; Rabiner, L. R. (1973).</strong> "A Computer Program for Designing Optimum FIR Linear Phase Digital Filters." <em>IEEE Trans. Audio Electroacoustics</em>, 21(6), 506-526.</li>
<li><strong>SciPy Documentation</strong> -- <code>scipy.signal</code> module: https://docs.scipy.org/doc/scipy/reference/signal.html</li>
</ol>
<hr />
<h2 id="_4">íƒìƒ‰<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li>ì´ì „: <a href="08_Z_Transform_and_Transfer_Functions.md">08. Z ë³€í™˜ê³¼ ì „ë‹¬ í•¨ìˆ˜</a></li>
<li>ë‹¤ìŒ: <a href="10_IIR_Filter_Design.md">10. IIR í•„í„° ì„¤ê³„</a></li>
<li><a href="00_Overview.md">ê°œìš”ë¡œ ëŒì•„ê°€ê¸°</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/08_Digital_Filter_Fundamentals.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë””ì§€í„¸ í•„í„° ê¸°ì´ˆ</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/10_IIR_Filter_Design.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">IIR í•„í„° ì„¤ê³„</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}