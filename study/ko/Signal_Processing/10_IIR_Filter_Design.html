{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIR í•„í„° ì„¤ê³„ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">IIR í•„í„° ì„¤ê³„</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>IIR í•„í„° ì„¤ê³„</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/09_FIR_Filter_Design.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">FIR í•„í„° ì„¤ê³„(FIR Filter Design)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/11_Multirate_Processing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1-iir">1. IIR í•„í„° ì„¤ê³„ ì†Œê°œ</a><ul>
<li><a href="#11-iir">1.1 IIR í•„í„° êµ¬ì¡°</a></li>
<li><a href="#12">1.2 ì„¤ê³„ ì ‘ê·¼ë²•</a></li>
<li><a href="#13">1.3 ì•„ë‚ ë¡œê·¸ ì›í˜•ì—ì„œ ì‹œì‘í•˜ëŠ” ì´ìœ </a></li>
</ul>
</li>
<li><a href="#2">2. ì•„ë‚ ë¡œê·¸ ì›í˜• í•„í„°</a><ul>
<li><a href="#21">2.1 ì•„ë‚ ë¡œê·¸ í•„í„° ê·œê²©</a></li>
<li><a href="#22">2.2 ì •ê·œí™”ëœ ì €ì—­ í†µê³¼ ì›í˜•</a></li>
</ul>
</li>
<li><a href="#3">3. ë²„í„°ì›ŒìŠ¤ í•„í„°</a><ul>
<li><a href="#31">3.1 í¬ê¸° ì‘ë‹µ</a></li>
<li><a href="#32">3.2 ê·¹ì  ìœ„ì¹˜</a></li>
<li><a href="#33">3.3 ì°¨ìˆ˜ ê²°ì •</a></li>
<li><a href="#34">3.4 í¬ê¸° ì‘ë‹µ ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#4-type-i">4. ì²´ë¹„ì‡¼í”„ Type I í•„í„°</a><ul>
<li><a href="#41">4.1 í¬ê¸° ì‘ë‹µ</a></li>
<li><a href="#42">4.2 ì²´ë¹„ì‡¼í”„ ë‹¤í•­ì‹</a></li>
<li><a href="#43">4.3 ì°¨ìˆ˜ ê²°ì •</a></li>
<li><a href="#44">4.4 ê·¹ì  ìœ„ì¹˜</a></li>
</ul>
</li>
<li><a href="#5-type-ii">5. ì²´ë¹„ì‡¼í”„ Type II í•„í„°</a><ul>
<li><a href="#51">5.1 í¬ê¸° ì‘ë‹µ</a></li>
<li><a href="#52-type-i">5.2 Type Iê³¼ì˜ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#6">6. íƒ€ì›í˜•(ì½”ì–´) í•„í„°</a><ul>
<li><a href="#61">6.1 í¬ê¸° ì‘ë‹µ</a></li>
<li><a href="#62">6.2 ì°¨ìˆ˜ ìš°ìœ„</a></li>
<li><a href="#63">6.3 íƒ€ì›í˜• í•„í„° ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#7-">7. ì•„ë‚ ë¡œê·¸-ë””ì§€í„¸ ë³€í™˜</a><ul>
<li><a href="#71">7.1 ë°©ë²• ê°œìš”</a></li>
</ul>
</li>
<li><a href="#8">8. ìŒì¼ì°¨ ë³€í™˜</a><ul>
<li><a href="#81">8.1 ë§¤í•‘</a></li>
<li><a href="#82">8.2 ì£¼ìš” íŠ¹ì„±</a></li>
<li><a href="#83">8.3 ì£¼íŒŒìˆ˜ ì›Œí•‘</a></li>
<li><a href="#84-pre-warping">8.4 ì‚¬ì „ ì›Œí•‘(Pre-warping)</a></li>
<li><a href="#85-blt">8.5 ë‹¨ê³„ë³„ BLT ì„¤ê³„</a></li>
</ul>
</li>
<li><a href="#9">9. ì„í„ìŠ¤ ë¶ˆë³€ ë°©ë²•</a><ul>
<li><a href="#91">9.1 ì›ë¦¬</a></li>
<li><a href="#92">9.2 ë§¤í•‘</a></li>
<li><a href="#93">9.3 ì—ì¼ë¦¬ì–´ì‹± ë¬¸ì œ</a></li>
<li><a href="#94">9.4 êµ¬í˜„ ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#10-iir">10. ì™„ì „í•œ IIR ì„¤ê³„ ì ˆì°¨</a><ul>
<li><a href="#101">10.1 ë‹¨ê³„ë³„ ì ˆì°¨</a></li>
<li><a href="#102-scipysignal">10.2 scipy.signal ì§ì ‘ ì„¤ê³„ í•¨ìˆ˜ ì‚¬ìš©</a></li>
</ul>
</li>
<li><a href="#11">11. ì•ˆì •ì„± ë¶„ì„</a><ul>
<li><a href="#111">11.1 ì•ˆì •ì„± ê¸°ì¤€</a></li>
<li><a href="#112-2-sos">11.2 ìˆ˜ì¹˜ì  ì•ˆì •ì„±ì„ ìœ„í•œ 2ì°¨ ì„¹ì…˜(SOS)</a></li>
<li><a href="#113-tf-vs-sos">11.3 ìˆ˜ì¹˜ì  ë¹„êµ: tf vs SOS</a></li>
</ul>
</li>
<li><a href="#12_1">12. í•„í„° ìœ í˜• ë¹„êµ</a><ul>
<li><a href="#121">12.1 ìš”ì•½ í‘œ</a></li>
<li><a href="#122">12.2 ì¢…í•© ì‹œê°ì  ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#13-python">13. Python êµ¬í˜„</a><ul>
<li><a href="#131-iir">13.1 ì™„ì „í•œ IIR ì„¤ê³„ ì›Œí¬í”Œë¡œìš°</a></li>
<li><a href="#132-sos-iir">13.2 SOSë¥¼ ì‚¬ìš©í•œ ì‹¤ì‹œê°„ IIR í•„í„°ë§</a></li>
</ul>
</li>
<li><a href="#14">14. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ì—°ìŠµ 1: ë²„í„°ì›ŒìŠ¤ í•„í„° ì„¤ê³„</a></li>
<li><a href="#2_1">ì—°ìŠµ 2: ì²´ë¹„ì‡¼í”„ í•„í„° ë¹„êµ</a></li>
<li><a href="#3_1">ì—°ìŠµ 3: ì˜¤ë””ì˜¤ìš© íƒ€ì›í˜• í•„í„°</a></li>
<li><a href="#4">ì—°ìŠµ 4: ìˆ˜ì‘ì—… ìŒì¼ì°¨ ë³€í™˜</a></li>
<li><a href="#5">ì—°ìŠµ 5: ì•ˆì •ì„± ì¡°ì‚¬</a></li>
<li><a href="#6-iir-vs-fir">ì—°ìŠµ 6: IIR vs FIR ë¹„êµ</a></li>
<li><a href="#7">ì—°ìŠµ 7: ëŒ€ì—­ ì €ì§€(ë…¸ì¹˜) í•„í„°</a></li>
</ul>
</li>
<li><a href="#_3">ì°¸ê³ ë¬¸í—Œ</a></li>
<li><a href="#_4">íƒìƒ‰</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="iir">IIR í•„í„° ì„¤ê³„<a class="header-link" href="#iir" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ê³ ì „ì ì¸ ì•„ë‚ ë¡œê·¸ ì›í˜• í•„í„°(ë²„í„°ì›ŒìŠ¤(Butterworth), ì²´ë¹„ì‡¼í”„(Chebyshev), íƒ€ì›í˜•(Elliptic))ì˜ íŠ¹ì„± ì´í•´</li>
<li>ì•„ë‚ ë¡œê·¸-ë””ì§€í„¸ ë³€í™˜ì„ ìœ„í•œ ìŒì¼ì°¨ ë³€í™˜(bilinear transform)ê³¼ ì„í„ìŠ¤ ë¶ˆë³€ ë°©ë²•(impulse invariance) ë§ˆìŠ¤í„°</li>
<li>ì£¼íŒŒìˆ˜ ì˜ì—­ ê·œê²©ìœ¼ë¡œë¶€í„° í•„í„° ì°¨ìˆ˜ ê²°ì • ë°©ë²• í•™ìŠµ</li>
<li>Pythonì˜ <code>scipy.signal</code> ëª¨ë“ˆì„ ì‚¬ìš©í•œ IIR ë””ì§€í„¸ í•„í„° ì„¤ê³„</li>
<li>ê·¹-ì˜ì  ë¶„ì„(pole-zero analysis)ì„ í†µí•œ í•„í„° ì•ˆì •ì„± ê²€ì¦</li>
<li>í•„í„° ìœ í˜• ë¹„êµ ë° íŠ¹ì • ì‘ìš©ì— ì í•©í•œ ì„¤ê³„ ì„ íƒ</li>
</ul>
<hr />
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-iir-í•„í„°-ì„¤ê³„-ì†Œê°œ">IIR í•„í„° ì„¤ê³„ ì†Œê°œ</a></li>
<li><a href="#2-ì•„ë‚ ë¡œê·¸-ì›í˜•-í•„í„°">ì•„ë‚ ë¡œê·¸ ì›í˜• í•„í„°</a></li>
<li><a href="#3-ë²„í„°ì›ŒìŠ¤-í•„í„°">ë²„í„°ì›ŒìŠ¤ í•„í„°</a></li>
<li><a href="#4-ì²´ë¹„ì‡¼í”„-type-i-í•„í„°">ì²´ë¹„ì‡¼í”„ Type I í•„í„°</a></li>
<li><a href="#5-ì²´ë¹„ì‡¼í”„-type-ii-í•„í„°">ì²´ë¹„ì‡¼í”„ Type II í•„í„°</a></li>
<li><a href="#6-íƒ€ì›í˜•ì½”ì–´-í•„í„°">íƒ€ì›í˜•(ì½”ì–´) í•„í„°</a></li>
<li><a href="#7-ì•„ë‚ ë¡œê·¸-ë””ì§€í„¸-ë³€í™˜">ì•„ë‚ ë¡œê·¸-ë””ì§€í„¸ ë³€í™˜</a></li>
<li><a href="#8-ìŒì¼ì°¨-ë³€í™˜">ìŒì¼ì°¨ ë³€í™˜</a></li>
<li><a href="#9-ì„í„ìŠ¤-ë¶ˆë³€-ë°©ë²•">ì„í„ìŠ¤ ë¶ˆë³€ ë°©ë²•</a></li>
<li><a href="#10-ì™„ì „í•œ-iir-ì„¤ê³„-ì ˆì°¨">ì™„ì „í•œ IIR ì„¤ê³„ ì ˆì°¨</a></li>
<li><a href="#11-ì•ˆì •ì„±-ë¶„ì„">ì•ˆì •ì„± ë¶„ì„</a></li>
<li><a href="#12-í•„í„°-ìœ í˜•-ë¹„êµ">í•„í„° ìœ í˜• ë¹„êµ</a></li>
<li><a href="#13-python-êµ¬í˜„">Python êµ¬í˜„</a></li>
<li><a href="#14-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1-iir">1. IIR í•„í„° ì„¤ê³„ ì†Œê°œ<a class="header-link" href="#1-iir" title="Permanent link">&para;</a></h2>
<h3 id="11-iir">1.1 IIR í•„í„° êµ¬ì¡°<a class="header-link" href="#11-iir" title="Permanent link">&para;</a></h3>
<p>IIR(ë¬´í•œ ì„í„ìŠ¤ ì‘ë‹µ(Infinite Impulse Response)) í•„í„°ëŠ” ìˆœë°©í–¥(feedforward)ê³¼ í”¼ë“œë°±(feedback) ê²½ë¡œë¥¼ ëª¨ë‘ ê°–ìŠµë‹ˆë‹¤. ì „ë‹¬ í•¨ìˆ˜ëŠ” ë‹¤í•­ì‹ì˜ ë¹„ìœ¨ë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:</p>
<p>$$H(z) = \frac{B(z)}{A(z)} = \frac{\sum_{k=0}^{M} b_k z^{-k}}{1 + \sum_{k=1}^{N} a_k z^{-k}}$$</p>
<p>ì°¨ë¶„ ë°©ì •ì‹(difference equation)ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>$$y[n] = \sum_{k=0}^{M} b_k x[n-k] - \sum_{k=1}^{N} a_k y[n-k]$$</p>
<h3 id="12">1.2 ì„¤ê³„ ì ‘ê·¼ë²•<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>FIR í•„í„°(ì´ì‚° ì˜ì—­ì—ì„œ ì§ì ‘ ì„¤ê³„)ì™€ ë‹¬ë¦¬, IIR í•„í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ê³„í•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ì˜ ì•Œë ¤ì§„ íŠ¹ì„±ì„ ê°–ëŠ” ì•„ë‚ ë¡œê·¸ ì›í˜•</strong> $H_a(s)$ì—ì„œ ì‹œì‘</li>
<li>ì•„ë‚ ë¡œê·¸ í•„í„°ë¥¼ ë””ì§€í„¸ í•„í„° $H(z)$ë¡œ <strong>ë³€í™˜</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="nx">IIR</span><span class="w"> </span><span class="nx">Filter</span><span class="w"> </span><span class="nx">Design</span><span class="w"> </span><span class="nx">Pipeline</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Digital</span><span class="w"> </span><span class="nx">Specs</span><span class="w">     </span><span class="nx">Analog</span><span class="w"> </span><span class="nx">Specs</span><span class="w">     </span><span class="nx">Analog</span><span class="w"> </span><span class="nx">Filter</span><span class="w">    </span><span class="nx">Digital</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Ï‰p</span><span class="p">,</span><span class="w"> </span><span class="nx">Ï‰s</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Î©p</span><span class="p">,</span><span class="w"> </span><span class="nx">Î©s</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Ha</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”€â”€â–¶â”‚</span><span class="w"> </span><span class="nx">H</span><span class="p">(</span><span class="nx">z</span><span class="p">)</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Î´â‚</span><span class="p">,</span><span class="w"> </span><span class="nx">Î´â‚‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Î´â‚</span><span class="p">,</span><span class="w"> </span><span class="nx">Î´â‚‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Step</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">           </span><span class="nx">Step</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w">          </span><span class="nx">Step</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span><span class="w">         </span><span class="nx">Step</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Specify</span><span class="w"> </span><span class="nx">digital</span><span class="w">   </span><span class="nx">Pre</span><span class="o">-</span><span class="nx">warp</span><span class="w"> </span><span class="nx">to</span><span class="w">      </span><span class="nx">Design</span><span class="w"> </span><span class="nx">analog</span><span class="w">   </span><span class="nx">Apply</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">requirements</span><span class="w">      </span><span class="nx">analog</span><span class="w"> </span><span class="nx">specs</span><span class="w">     </span><span class="nx">prototype</span><span class="w">       </span><span class="nx">BLT</span><span class="o">/</span><span class="nx">IIM</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="13">1.3 ì•„ë‚ ë¡œê·¸ ì›í˜•ì—ì„œ ì‹œì‘í•˜ëŠ” ì´ìœ <a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ìˆ˜ì‹­ ë…„ì˜ ì´ë¡ </strong>: ë²„í„°ì›ŒìŠ¤(Butterworth), ì²´ë¹„ì‡¼í”„(Chebyshev), íƒ€ì›í˜• í•„í„° ì„¤ê³„ëŠ” ì˜ ì •ë¦½ë˜ì–´ ìˆìŒ</li>
<li><strong>ë‹«íŒ í˜•íƒœì˜ í•´</strong>: ê·¹ì (pole)/ì˜ì (zero) ìœ„ì¹˜ë¥¼ í•´ì„ì ìœ¼ë¡œ ê³„ì‚° ê°€ëŠ¥</li>
<li><strong>ìµœì  íŠ¹ì„±</strong>: ê° ìœ í˜•ì€ íŠ¹ì • ì˜ë¯¸ì—ì„œ ìµœì  (í‰íƒ„ë„, ë“±ë¦¬í”Œ, ìµœì†Œ ì°¨ìˆ˜)</li>
<li><strong>ì£¼íŒŒìˆ˜ ë³€í™˜</strong>: ì €ì—­ í†µê³¼(lowpass) ì›í˜•ì„ ê³ ì—­ í†µê³¼(highpass), ëŒ€ì—­ í†µê³¼(bandpass), ëŒ€ì—­ ì €ì§€(bandstop)ë¡œ ë³€í™˜ ê°€ëŠ¥</li>
</ul>
<hr />
<h2 id="2">2. ì•„ë‚ ë¡œê·¸ ì›í˜• í•„í„°<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì•„ë‚ ë¡œê·¸ í•„í„° ê·œê²©<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì•„ë‚ ë¡œê·¸ ì €ì—­ í†µê³¼ í•„í„° ê·œê²©ì€ ë‹¤ìŒìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:</p>
<ul>
<li><strong>í†µê³¼ëŒ€ì—­ ì—£ì§€ ì£¼íŒŒìˆ˜(passband edge frequency)</strong> $\Omega_p$</li>
<li><strong>ì €ì§€ëŒ€ì—­ ì—£ì§€ ì£¼íŒŒìˆ˜(stopband edge frequency)</strong> $\Omega_s$</li>
<li><strong>í†µê³¼ëŒ€ì—­ ë¦¬í”Œ(passband ripple)</strong> $R_p$ (dB) ë˜ëŠ” í—ˆìš©ì˜¤ì°¨ $\epsilon$</li>
<li><strong>ì €ì§€ëŒ€ì—­ ê°ì‡ (stopband attenuation)</strong> $A_s$ (dB)</li>
</ul>
<p>ë¦¬í”Œ íŒŒë¼ë¯¸í„° $\epsilon$ê³¼ í†µê³¼ëŒ€ì—­ ë¦¬í”Œì˜ ê´€ê³„:</p>
<p>$$R_p = 10\log_{10}(1 + \epsilon^2) \quad \text{dB}$$</p>
<h3 id="22">2.2 ì •ê·œí™”ëœ ì €ì—­ í†µê³¼ ì›í˜•<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>ëª¨ë“  ê³ ì „ì  ì„¤ê³„ëŠ” í†µê³¼ëŒ€ì—­ ì—£ì§€ê°€ $\Omega_p = 1$ rad/sì¸ <strong>ì •ê·œí™”ëœ ì €ì—­ í†µê³¼ ì›í˜•(normalized lowpass prototype)</strong>ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤. ì´í›„ ì›í˜•ì„ ì£¼íŒŒìˆ˜ ìŠ¤ì¼€ì¼ë§í•˜ê³  ì›í•˜ëŠ” í•„í„° ìœ í˜•ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
<p><strong>ì„ íƒë„ ì¸ìˆ˜(selectivity factor):</strong></p>
<p>$$k = \frac{\Omega_p}{\Omega_s} < 1$$</p>
<p>$k$ê°€ ì‘ì„ìˆ˜ë¡ ì „ì´ëŒ€ì—­(transition band)ì´ í†µê³¼ëŒ€ì—­ì— ë¹„í•´ ë„“ì–´ì ¸ ì„¤ê³„ê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤.</p>
<hr />
<h2 id="3">3. ë²„í„°ì›ŒìŠ¤ í•„í„°<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 í¬ê¸° ì‘ë‹µ<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>ë²„í„°ì›ŒìŠ¤(Butterworth) í•„í„°ëŠ” í†µê³¼ëŒ€ì—­ì—ì„œ <strong>ìµœëŒ€ í‰íƒ„ í¬ê¸° ì‘ë‹µ(maximally flat magnitude response)</strong>ì„ ì œê³µí•©ë‹ˆë‹¤. ì œê³± í¬ê¸° ì‘ë‹µì€:</p>
<p>$$|H_a(j\Omega)|^2 = \frac{1}{1 + \left(\Omega / \Omega_c\right)^{2N}}$$</p>
<p>ì—¬ê¸°ì„œ $N$ì€ í•„í„° ì°¨ìˆ˜, $\Omega_c$ëŠ” $-3$ dB ì°¨ë‹¨ ì£¼íŒŒìˆ˜ì…ë‹ˆë‹¤.</p>
<p><strong>íŠ¹ì„±:</strong>
- $|H_a(j\Omega)|^2$ì˜ $2N-1$ì°¨ê¹Œì§€ ëª¨ë“  ë¯¸ë¶„ê°’ì´ $\Omega = 0$ì—ì„œ 0
- ë‹¨ì¡° ê°ì†Œ(monotonically decreasing) í¬ê¸°
- ì°¨ë‹¨ ì£¼íŒŒìˆ˜ì—ì„œ $|H_a(j\Omega_c)|^2 = 1/2$ ($-3$ dB)
- ë¡¤ì˜¤í”„(rolloff) ì†ë„: ì €ì§€ëŒ€ì—­ì—ì„œ $-20N$ dB/decade</p>
<h3 id="32">3.2 ê·¹ì  ìœ„ì¹˜<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>ë²„í„°ì›ŒìŠ¤ í•„í„°ì˜ ê·¹ì ì€ $s$-í‰ë©´ì—ì„œ ë°˜ì§€ë¦„ $\Omega_c$ì¸ ì› ìœ„ì— ë“±ê°„ê²©ìœ¼ë¡œ ìœ„ì¹˜í•©ë‹ˆë‹¤:</p>
<p>$$s_k = \Omega_c \exp\left[j\frac{\pi}{2N}(2k + N - 1)\right], \quad k = 0, 1, \ldots, 2N-1$$</p>
<p>ì•ˆì •ì (ì¸ê³¼ì ) í•„í„°ë¥¼ ìœ„í•´ ì¢Œë°˜í‰ë©´(left-half-plane) ê·¹ì ($\text{Re}(s_k) < 0$)ë§Œ ì„ íƒí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">butterworth_poles</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Omega_c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute Butterworth filter poles in the s-plane.&quot;&quot;&quot;</span>
    <span class="n">poles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">s_k</span> <span class="o">=</span> <span class="n">Omega_c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">s_k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Left-half plane only</span>
            <span class="n">poles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">poles</span><span class="p">)</span>

<span class="c1"># Visualize pole locations for different orders</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]):</span>
    <span class="n">poles</span> <span class="o">=</span> <span class="n">butterworth_poles</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="c1"># Unit circle</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="c1"># Poles</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">poles</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">poles</span><span class="p">),</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Butterworth N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> Poles&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;butterworth_poles.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="33">3.3 ì°¨ìˆ˜ ê²°ì •<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p>ê·œê²© $(\Omega_p, \Omega_s, R_p, A_s)$ê°€ ì£¼ì–´ì§€ë©´ ìµœì†Œ ë²„í„°ì›ŒìŠ¤ ì°¨ìˆ˜ëŠ”:</p>
<p>$$N \geq \frac{\log\left(\frac{10^{A_s/10} - 1}{10^{R_p/10} - 1}\right)}{2\log(\Omega_s / \Omega_p)}$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">butterworth_order</span><span class="p">(</span><span class="n">Omega_p</span><span class="p">,</span> <span class="n">Omega_s</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute minimum Butterworth filter order.&quot;&quot;&quot;</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">As_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Rp_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Omega_s</span> <span class="o">/</span> <span class="n">Omega_p</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">N</span>

<span class="c1"># Example</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">butterworth_order</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum Butterworth order: N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Compare with scipy</span>
<span class="n">N_scipy</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;scipy.signal.buttord: N = </span><span class="si">{</span><span class="n">N_scipy</span><span class="si">}</span><span class="s2">, Wn = </span><span class="si">{</span><span class="n">Wn</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="34">3.4 í¬ê¸° ì‘ë‹µ ì‹œê°í™”<a class="header-link" href="#34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Different orders</span>
<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Butterworth: Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-3 dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|H(jÎ©)|&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Butterworth: Magnitude (Linear)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-3 dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;butterworth_responses.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-type-i">4. ì²´ë¹„ì‡¼í”„ Type I í•„í„°<a class="header-link" href="#4-type-i" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 í¬ê¸° ì‘ë‹µ<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>ì²´ë¹„ì‡¼í”„(Chebyshev) Type I í•„í„°ëŠ” <strong>ë“±ë¦¬í”Œ í†µê³¼ëŒ€ì—­(equiripple passband)</strong>ê³¼ ë‹¨ì¡° ì €ì§€ëŒ€ì—­ì„ ê°–ìŠµë‹ˆë‹¤:</p>
<p>$$|H_a(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 T_N^2(\Omega / \Omega_p)}$$</p>
<p>ì—¬ê¸°ì„œ $T_N(\cdot)$ëŠ” $N$ì°¨ ì œ1ì¢… ì²´ë¹„ì‡¼í”„ ë‹¤í•­ì‹(Chebyshev polynomial of the first kind)ì…ë‹ˆë‹¤:</p>
<p>$$T_N(x) = \begin{cases} \cos(N \cos^{-1}(x)), & |x| \leq 1 \\ \cosh(N \cosh^{-1}(x)), & |x| > 1 \end{cases}$$</p>
<p><strong>íŠ¹ì„±:</strong>
- ë¦¬í”Œ $\epsilon$ì˜ ë“±ë¦¬í”Œ í†µê³¼ëŒ€ì—­
- í†µê³¼ëŒ€ì—­ ë¦¬í”Œ: $R_p = 10\log_{10}(1 + \epsilon^2)$ dB
- ë™ì¼ ì°¨ìˆ˜ì—ì„œ ë²„í„°ì›ŒìŠ¤ë³´ë‹¤ ê¸‰ê²©í•œ ì „ì´
- ë‹¨ì¡° ê°ì†Œ ì €ì§€ëŒ€ì—­</p>
<h3 id="42">4.2 ì²´ë¹„ì‡¼í”„ ë‹¤í•­ì‹<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p>ì²˜ìŒ ëª‡ ê°œì˜ ì²´ë¹„ì‡¼í”„ ë‹¤í•­ì‹:</p>
<p>$$T_0(x) = 1, \quad T_1(x) = x, \quad T_2(x) = 2x^2 - 1$$</p>
<p>$$T_3(x) = 4x^3 - 3x, \quad T_4(x) = 8x^4 - 8x^2 + 1$$</p>
<p>ì í™”ì‹(recurrence relation): $T_{N+1}(x) = 2x \cdot T_N(x) - T_{N-1}(x)$</p>
<h3 id="43">4.3 ì°¨ìˆ˜ ê²°ì •<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<p>$$N \geq \frac{\cosh^{-1}\left(\sqrt{\frac{10^{A_s/10} - 1}{10^{R_p/10} - 1}}\right)}{\cosh^{-1}(\Omega_s / \Omega_p)}$$</p>
<h3 id="44">4.4 ê·¹ì  ìœ„ì¹˜<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<p>ì²´ë¹„ì‡¼í”„ Type I í•„í„°ì˜ ê·¹ì ì€ $s$-í‰ë©´ì—ì„œ íƒ€ì› ìœ„ì— ìœ„ì¹˜í•©ë‹ˆë‹¤:</p>
<p>$$s_k = \sigma_k + j\omega_k$$</p>
<p>ì—¬ê¸°ì„œ:</p>
<p>$$\sigma_k = -\sinh\left(\frac{1}{N}\sinh^{-1}\left(\frac{1}{\epsilon}\right)\right) \sin\left(\frac{(2k-1)\pi}{2N}\right)$$</p>
<p>$$\omega_k = \cosh\left(\frac{1}{N}\sinh^{-1}\left(\frac{1}{\epsilon}\right)\right) \cos\left(\frac{(2k-1)\pi}{2N}\right)$$</p>
<p>$k = 1, 2, \ldots, N$ì— ëŒ€í•´.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">chebyshev1_analysis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze Chebyshev Type I filter.&quot;&quot;&quot;</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Rp_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Pole locations</span>
    <span class="n">poles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">theta_k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">sigma_k</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_k</span><span class="p">)</span>
        <span class="n">omega_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_k</span><span class="p">)</span>
        <span class="n">poles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma_k</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega_k</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">poles</span><span class="p">),</span> <span class="n">epsilon</span>

<span class="c1"># Compare Butterworth and Chebyshev</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
    <span class="c1"># Chebyshev Type I (1 dB ripple)</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chebyshev Type I (Rp = 1 dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Pole-zero plot for N=4</span>
<span class="n">poles_butter</span> <span class="o">=</span> <span class="n">butterworth_poles</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">poles_cheby</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chebyshev1_analysis</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unit circle&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">poles_butter</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">poles_butter</span><span class="p">),</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span>
             <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">poles_cheby</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">poles_cheby</span><span class="p">),</span> <span class="s1">&#39;r+&#39;</span><span class="p">,</span>
             <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chebyshev I&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pole Locations: Butterworth vs Chebyshev I (N=4)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;chebyshev1_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5-type-ii">5. ì²´ë¹„ì‡¼í”„ Type II í•„í„°<a class="header-link" href="#5-type-ii" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 í¬ê¸° ì‘ë‹µ<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>ì²´ë¹„ì‡¼í”„ Type II(ì—­ ì²´ë¹„ì‡¼í”„(inverse Chebyshev)) í•„í„°ëŠ” <strong>í‰íƒ„í•œ í†µê³¼ëŒ€ì—­</strong>ê³¼ <strong>ë“±ë¦¬í”Œ ì €ì§€ëŒ€ì—­</strong>ì„ ê°–ìŠµë‹ˆë‹¤:</p>
<p>$$|H_a(j\Omega)|^2 = \frac{1}{1 + \frac{1}{\epsilon^2 T_N^2(\Omega_s / \Omega)}}$$</p>
<p><strong>íŠ¹ì„±:</strong>
- ë‹¨ì¡° ê°ì†Œ(í‰íƒ„) í†µê³¼ëŒ€ì—­
- ì €ì§€ëŒ€ì—­ì—ì„œ ë“±ë¦¬í”Œ ë™ì‘
- ê·¹ì ê³¼ ì˜ì  ëª¨ë‘ ì¡´ì¬ (Type Iì€ ê·¹ì ë§Œ)
- ì˜ì ì´ $j\Omega$ ì¶•ì— ìœ„ì¹˜í•˜ì—¬ ì €ì§€ëŒ€ì—­ì— ë…¸ì¹˜(null) ìƒì„±</p>
<h3 id="52-type-i">5.2 Type Iê³¼ì˜ ë¹„êµ<a class="header-link" href="#52-type-i" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Chebyshev Type I (1 dB ripple)</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">w1</span><span class="p">,</span> <span class="n">H1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>

<span class="c1"># Chebyshev Type II (40 dB stopband attenuation)</span>
<span class="n">b2</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">w2</span><span class="p">,</span> <span class="n">H2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>

<span class="c1"># Butterworth (same order)</span>
<span class="n">b_bw</span><span class="p">,</span> <span class="n">a_bw</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">w_bw</span><span class="p">,</span> <span class="n">H_bw</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b_bw</span><span class="p">,</span> <span class="n">a_bw</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>

<span class="c1"># dB plot</span>
<span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">w_bw</span><span class="p">,</span> <span class="n">H_bw</span><span class="p">,</span> <span class="s1">&#39;Butterworth&#39;</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">H1</span><span class="p">,</span> <span class="s1">&#39;Chebyshev I&#39;</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="s1">&#39;Chebyshev II&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="n">style</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Filter Comparison (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Passband detail (linear scale)</span>
<span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">w_bw</span><span class="p">,</span> <span class="n">H_bw</span><span class="p">,</span> <span class="s1">&#39;Butterworth&#39;</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">H1</span><span class="p">,</span> <span class="s1">&#39;Chebyshev I&#39;</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="s1">&#39;Chebyshev II&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|H(jÎ©)|&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Passband Detail&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;chebyshev2_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6">6. íƒ€ì›í˜•(ì½”ì–´) í•„í„°<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 í¬ê¸° ì‘ë‹µ<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>íƒ€ì›í˜•(Elliptic, Cauer) í•„í„°ëŠ” í†µê³¼ëŒ€ì—­ê³¼ ì €ì§€ëŒ€ì—­ ëª¨ë‘ì— ë¦¬í”Œì„ ë¶„ì‚°ì‹œì¼œ ì£¼ì–´ì§„ ê·œê²©ì— ëŒ€í•´ <strong>ìµœì†Œ ì°¨ìˆ˜</strong>ë¥¼ ë‹¬ì„±í•©ë‹ˆë‹¤:</p>
<p>$$|H_a(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 R_N^2(\Omega / \Omega_p)}$$</p>
<p>ì—¬ê¸°ì„œ $R_N(\cdot)$ì€ ìœ ë¦¬ ì²´ë¹„ì‡¼í”„(ì•¼ì½”ë¹„ íƒ€ì›(Jacobian elliptic)) í•¨ìˆ˜ì…ë‹ˆë‹¤.</p>
<p><strong>íŠ¹ì„±:</strong>
- í†µê³¼ëŒ€ì—­ê³¼ ì €ì§€ëŒ€ì—­ ëª¨ë‘ ë“±ë¦¬í”Œ
- ì£¼ì–´ì§„ ì°¨ìˆ˜ì— ëŒ€í•´ ê°€ì¥ ê¸‰ê²©í•œ ì „ì´
- ì°¨ìˆ˜ ëŒ€ ê·œê²© ë©´ì—ì„œ ê°€ì¥ íš¨ìœ¨ì 
- ê·¹ì ê³¼ ì˜ì  ëª¨ë‘ ì¡´ì¬</p>
<h3 id="62">6.2 ì°¨ìˆ˜ ìš°ìœ„<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>ë™ì¼í•œ ê·œê²©ì— ëŒ€í•´ í•„ìš”í•œ í•„í„° ì°¨ìˆ˜ëŠ”:</p>
<p>$$N_\text{Elliptic} \leq N_\text{Chebyshev} \leq N_\text{Butterworth}$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_filter_orders</span><span class="p">(</span><span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare required orders for different filter types.&quot;&quot;&quot;</span>
    <span class="c1"># Butterworth</span>
    <span class="n">N_butter</span><span class="p">,</span> <span class="n">Wn_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Chebyshev Type I</span>
    <span class="n">N_cheby1</span><span class="p">,</span> <span class="n">Wn_cheby1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Chebyshev Type II</span>
    <span class="n">N_cheby2</span><span class="p">,</span> <span class="n">Wn_cheby2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Elliptic</span>
    <span class="n">N_ellip</span><span class="p">,</span> <span class="n">Wn_ellip</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Specifications: Rp=</span><span class="si">{</span><span class="n">Rp_dB</span><span class="si">}</span><span class="s2"> dB, As=</span><span class="si">{</span><span class="n">As_dB</span><span class="si">}</span><span class="s2"> dB, wp=</span><span class="si">{</span><span class="n">wp</span><span class="si">}</span><span class="s2">, ws=</span><span class="si">{</span><span class="n">ws</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Filter Type&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Order N&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Natural Freq&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Butterworth&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">N_butter</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Wn_butter</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Chebyshev I&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">N_cheby1</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Wn_cheby1</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Chebyshev II&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">N_cheby2</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Wn_cheby2</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Elliptic&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">N_ellip</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Wn_ellip</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">N_butter</span><span class="p">,</span> <span class="n">N_cheby1</span><span class="p">,</span> <span class="n">N_cheby2</span><span class="p">,</span> <span class="n">N_ellip</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">compare_filter_orders</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</code></pre></div>

<h3 id="63">6.3 íƒ€ì›í˜• í•„í„° ì‹œê°í™”<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Same specifications, different filter types</span>
<span class="n">Rp</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># dB</span>
<span class="n">As</span> <span class="o">=</span> <span class="mi">60</span>   <span class="c1"># dB</span>
<span class="n">wp</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># rad/s</span>
<span class="n">ws</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">1300</span>  <span class="c1"># rad/s</span>

<span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Chebyshev I&#39;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Chebyshev II&#39;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Elliptic&#39;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ord_func</span><span class="p">,</span> <span class="n">design_func</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">ord_func</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;Chebyshev I&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">design_func</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;Chebyshev II&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">design_func</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;Elliptic&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">design_func</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">design_func</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">ws</span><span class="p">,</span> <span class="mi">5000</span><span class="p">))</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">Rp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">Rp</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">As</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">wp</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ws</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Filter Type Comparison (Rp=</span><span class="si">{</span><span class="n">Rp</span><span class="si">}</span><span class="s1"> dB, As=</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;filter_type_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-">7. ì•„ë‚ ë¡œê·¸-ë””ì§€í„¸ ë³€í™˜<a class="header-link" href="#7-" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ë°©ë²• ê°œìš”<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p>ì•„ë‚ ë¡œê·¸ í•„í„° $H_a(s)$ë¥¼ ë””ì§€í„¸ í•„í„° $H(z)$ë¡œ ë³€í™˜í•˜ëŠ” ì„¸ ê°€ì§€ ì£¼ìš” ë°©ë²•:</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">            </span><span class="n">Analog</span><span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="n">Digital</span><span class="w"> </span><span class="n">Conversion</span><span class="w"> </span><span class="n">Methods</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="k">Method</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Mapping</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">z</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Bilinear</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">)(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Transform</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="n">aliasing</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Frequency</span><span class="w"> </span><span class="n">warping</span><span class="w"> </span><span class="p">(</span><span class="n">correctable</span><span class="p">)</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Most</span><span class="w"> </span><span class="n">widely</span><span class="w"> </span><span class="n">used</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Impulse</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="err">Â·</span><span class="w"> </span><span class="n">h_a</span><span class="p">(</span><span class="n">nT</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Invariance</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Preserves</span><span class="w"> </span><span class="n">impulse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">shape</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Aliasing</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="k">domain</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Only</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">bandlimited</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="p">(</span><span class="n">LP</span><span class="p">,</span><span class="w"> </span><span class="n">BP</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Matched</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="k">Map</span><span class="w"> </span><span class="nl">poles</span><span class="p">:</span><span class="w"> </span><span class="n">s_k</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">z_k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">s_k</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Z</span><span class="o">-</span><span class="n">Transform</span><span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="k">Map</span><span class="w"> </span><span class="nl">zeros</span><span class="p">:</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">mapping</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Simple</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">formal</span><span class="w"> </span><span class="n">optimality</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="8">8. ìŒì¼ì°¨ ë³€í™˜<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ë§¤í•‘<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>ìŒì¼ì°¨ ë³€í™˜(bilinear transform, BLT)ì€ $s$-í‰ë©´ ì „ì²´ë¥¼ $z$-í‰ë©´ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë§¤í•‘í•©ë‹ˆë‹¤:</p>
<p>$$s = \frac{2}{T} \cdot \frac{z - 1}{z + 1}$$</p>
<p>ë˜ëŠ” ë™ë“±í•˜ê²Œ:</p>
<p>$$z = \frac{1 + (T/2)s}{1 - (T/2)s}$$</p>
<p>ì—¬ê¸°ì„œ $T$ëŠ” ìƒ˜í”Œë§ ì£¼ê¸°ì…ë‹ˆë‹¤.</p>
<h3 id="82">8.2 ì£¼ìš” íŠ¹ì„±<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<p><strong>ì•ˆì •ì„± ë³´ì¡´</strong>: $s$-í‰ë©´ì˜ ì¢Œë°˜í‰ë©´ì´ $z$-í‰ë©´ì˜ ë‹¨ìœ„ì› ë‚´ë¶€ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì•ˆì •ì ì¸ ì•„ë‚ ë¡œê·¸ í•„í„°ëŠ” í•­ìƒ ì•ˆì •ì ì¸ ë””ì§€í„¸ í•„í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><strong>ì£¼íŒŒìˆ˜ ë§¤í•‘</strong>: í—ˆìˆ˜ì¶•($s = j\Omega$)ì€ ë¹„ì„ í˜• ì£¼íŒŒìˆ˜ ì›Œí•‘(frequency warping)ìœ¼ë¡œ ë‹¨ìœ„ì›($z = e^{j\omega}$)ìœ¼ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤:</p>
<p>$$\omega = 2\arctan\left(\frac{\Omega T}{2}\right) \quad \Leftrightarrow \quad \Omega = \frac{2}{T}\tan\left(\frac{\omega}{2}\right)$$</p>
<h3 id="83">8.3 ì£¼íŒŒìˆ˜ ì›Œí•‘<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Bilinear Transform Frequency Warping:

Î© (analog)     Ï‰ (digital)
   â†‘              â†‘
   â”‚     â•±       Ï€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±
   â”‚   â•±          â”‚              â•±
   â”‚  â•±           â”‚            â•±
   â”‚ â•±            â”‚         â•±      Nonlinear
   â”‚â•±             â”‚      â•±        compression
 0 â”œâ”€â”€â”€â†’ Ï‰     0 â”œâ”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Î©
   0    Ï€         0

- Low frequencies: Î© â‰ˆ Ï‰ (nearly linear)
- High frequencies: compressed into [0, Ï€]
- Î© = âˆ maps to Ï‰ = Ï€
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Visualize frequency warping</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Sampling period</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLT mapping&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">Omega</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear (ideal)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Analog Frequency Î© (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Digital Frequency Ï‰/Ï€&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bilinear Transform: Frequency Warping&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Warping effect at different frequencies</span>
<span class="n">freq_analog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="n">freq_digital</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">freq_analog</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq_analog</span><span class="p">)),</span>
            <span class="n">freq_digital</span> <span class="o">/</span> <span class="p">(</span><span class="n">freq_analog</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">tick_label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">freq_analog</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Analog Frequency Î© (rad/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Warping Error (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Warping Error&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bilinear_warping.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="84-pre-warping">8.4 ì‚¬ì „ ì›Œí•‘(Pre-warping)<a class="header-link" href="#84-pre-warping" title="Permanent link">&para;</a></h3>
<p>ì„ê³„ ì£¼íŒŒìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ë§¤í•‘ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ ì•„ë‚ ë¡œê·¸ ê·œê²©ì„ <strong>ì‚¬ì „ ì›Œí•‘(pre-warp)</strong>í•©ë‹ˆë‹¤:</p>
<p>$$\Omega_p' = \frac{2}{T}\tan\left(\frac{\omega_p}{2}\right), \quad \Omega_s' = \frac{2}{T}\tan\left(\frac{\omega_s}{2}\right)$$</p>
<p>ê·¸ëŸ° ë‹¤ìŒ ì‚¬ì „ ì›Œí•‘ëœ ì£¼íŒŒìˆ˜ë¡œ ì•„ë‚ ë¡œê·¸ í•„í„°ë¥¼ ì„¤ê³„í•˜ê³  ìŒì¼ì°¨ ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.</p>
<h3 id="85-blt">8.5 ë‹¨ê³„ë³„ BLT ì„¤ê³„<a class="header-link" href="#85-blt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">iir_design_blt</span><span class="p">(</span><span class="n">wp_digital</span><span class="p">,</span> <span class="n">ws_digital</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Complete IIR design using bilinear transform with pre-warping.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        wp_digital: digital passband edge (Hz)</span>
<span class="sd">        ws_digital: digital stopband edge (Hz)</span>
<span class="sd">        Rp_dB: passband ripple (dB)</span>
<span class="sd">        As_dB: stopband attenuation (dB)</span>
<span class="sd">        fs: sampling frequency (Hz)</span>
<span class="sd">        ftype: &#39;butter&#39;, &#39;cheby1&#39;, &#39;cheby2&#39;, or &#39;ellip&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        b, a: digital filter coefficients</span>
<span class="sd">        N: filter order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Step 1: Pre-warp digital frequencies to analog</span>
    <span class="n">Omega_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">wp_digital</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">Omega_s</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ws_digital</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pre-warped frequencies: Î©p = </span><span class="si">{</span><span class="n">Omega_p</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Î©s = </span><span class="si">{</span><span class="n">Omega_s</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>

    <span class="c1"># Step 2: Determine order</span>
    <span class="k">if</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s1">&#39;butter&#39;</span><span class="p">:</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">Omega_p</span><span class="p">,</span> <span class="n">Omega_s</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Step 3: Design analog prototype</span>
        <span class="n">ba</span><span class="p">,</span> <span class="n">aa</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s1">&#39;cheby1&#39;</span><span class="p">:</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">Omega_p</span><span class="p">,</span> <span class="n">Omega_s</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ba</span><span class="p">,</span> <span class="n">aa</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s1">&#39;cheby2&#39;</span><span class="p">:</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">Omega_p</span><span class="p">,</span> <span class="n">Omega_s</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ba</span><span class="p">,</span> <span class="n">aa</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s1">&#39;ellip&#39;</span><span class="p">:</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">Omega_p</span><span class="p">,</span> <span class="n">Omega_s</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ba</span><span class="p">,</span> <span class="n">aa</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp_dB</span><span class="p">,</span> <span class="n">As_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analog filter order: N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Step 4: Bilinear transform</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">bilinear</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N</span>

<span class="c1"># Example</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">wp</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Hz</span>
<span class="n">ws</span> <span class="o">=</span> <span class="mi">1500</span>  <span class="c1"># Hz</span>
<span class="n">Rp</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># dB</span>
<span class="n">As</span> <span class="o">=</span> <span class="mi">60</span>    <span class="c1"># dB</span>

<span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">iir_design_blt</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;ellip&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Digital filter coefficients:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;b = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Magnitude</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">Rp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">Rp</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">As</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elliptic IIR (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">): Magnitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Phase</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Group delay</span>
<span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">w</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Group Delay (samples)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Group Delay (Non-constant!)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Pole-zero plot</span>
<span class="n">z_zeros</span><span class="p">,</span> <span class="n">z_poles</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">z_zeros</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">z_zeros</span><span class="p">),</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zeros&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">z_poles</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">z_poles</span><span class="p">),</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Poles&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pole-Zero Plot&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IIR Filter Design via Bilinear Transform&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;iir_blt_design.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì„í„ìŠ¤ ë¶ˆë³€ ë°©ë²•<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 ì›ë¦¬<a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<p>ì„í„ìŠ¤ ë¶ˆë³€(impulse invariance) ë°©ë²•ì€ ë””ì§€í„¸ í•„í„°ì˜ ì„í„ìŠ¤ ì‘ë‹µì„ ì•„ë‚ ë¡œê·¸ ì„í„ìŠ¤ ì‘ë‹µì˜ ìƒ˜í”Œê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•©ë‹ˆë‹¤:</p>
<p>$$h[n] = T \cdot h_a(nT)$$</p>
<p>ì—¬ê¸°ì„œ $h_a(t)$ëŠ” ì•„ë‚ ë¡œê·¸ ì„í„ìŠ¤ ì‘ë‹µ, $T$ëŠ” ìƒ˜í”Œë§ ì£¼ê¸°ì…ë‹ˆë‹¤.</p>
<h3 id="92">9.2 ë§¤í•‘<a class="header-link" href="#92" title="Permanent link">&para;</a></h3>
<p>ì•„ë‚ ë¡œê·¸ í•„í„°ê°€ ë¶€ë¶„ ë¶„ìˆ˜ ì „ê°œ(partial fraction expansion)ë¥¼ ê°€ì§ˆ ë•Œ:</p>
<p>$$H_a(s) = \sum_{k=1}^{N} \frac{A_k}{s - s_k}$$</p>
<p>ë””ì§€í„¸ í•„í„°ëŠ”:</p>
<p>$$H(z) = T \sum_{k=1}^{N} \frac{A_k}{1 - e^{s_k T} z^{-1}}$$</p>
<p>ê° ì•„ë‚ ë¡œê·¸ ê·¹ì  $s_k$ëŠ” ë””ì§€í„¸ ê·¹ì  $z_k = e^{s_k T}$ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤.</p>
<h3 id="93">9.3 ì—ì¼ë¦¬ì–´ì‹± ë¬¸ì œ<a class="header-link" href="#93" title="Permanent link">&para;</a></h3>
<p>ë””ì§€í„¸ í•„í„°ì˜ ì£¼íŒŒìˆ˜ ì‘ë‹µì€ ì•„ë‚ ë¡œê·¸ ì‘ë‹µì˜ ì´ë™ëœ ë³µì‚¬ë³¸ë“¤ì˜ í•©ì…ë‹ˆë‹¤:</p>
<p>$$H(e^{j\omega}) = \frac{1}{T} \sum_{k=-\infty}^{\infty} H_a\left(j\frac{\omega - 2\pi k}{T}\right)$$</p>
<p>ì´ë¡œ ì¸í•´ $H_a(j\Omega)$ê°€ ëŒ€ì—­ ì œí•œ(bandlimited)ë˜ì§€ ì•Šìœ¼ë©´ <strong>ì—ì¼ë¦¬ì–´ì‹±(aliasing)</strong>ì´ ë°œìƒí•˜ë¯€ë¡œ, ì„í„ìŠ¤ ë¶ˆë³€ ë°©ë²•ì€ ê³ ì—­ í†µê³¼ ë° ëŒ€ì—­ ì €ì§€ í•„í„°ì— ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<h3 id="94">9.4 êµ¬í˜„ ì˜ˆì œ<a class="header-link" href="#94" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">impulse_invariance</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply impulse invariance method to convert analog filter to digital.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ba, aa: analog filter coefficients (transfer function form)</span>
<span class="sd">        fs: sampling frequency</span>

<span class="sd">    Returns:</span>
<span class="sd">        bd, ad: digital filter coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Convert to zeros, poles, gain form</span>
    <span class="n">z_a</span><span class="p">,</span> <span class="n">p_a</span><span class="p">,</span> <span class="n">k_a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">)</span>

    <span class="c1"># Partial fraction expansion</span>
    <span class="n">residues</span><span class="p">,</span> <span class="n">poles</span><span class="p">,</span> <span class="n">direct</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">residue</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">)</span>

    <span class="c1"># Map poles: z_k = exp(s_k * T)</span>
    <span class="n">z_poles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">poles</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>

    <span class="c1"># Construct digital transfer function</span>
    <span class="c1"># H(z) = T * sum(A_k / (1 - e^(s_k*T) * z^-1))</span>
    <span class="n">bd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
    <span class="n">ad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">A_k</span><span class="p">,</span> <span class="n">z_k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="n">z_poles</span><span class="p">):</span>
        <span class="c1"># Each term: T * A_k / (1 - z_k * z^-1)</span>
        <span class="n">bd_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T</span> <span class="o">*</span> <span class="n">A_k</span><span class="p">])</span>
        <span class="n">ad_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">z_k</span><span class="p">])</span>

        <span class="c1"># Combine fractions</span>
        <span class="n">bd_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">bd</span><span class="p">,</span> <span class="n">ad_k</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">bd_k</span><span class="p">,</span> <span class="n">ad</span><span class="p">)</span>
        <span class="n">ad_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">ad_k</span><span class="p">)</span>
        <span class="n">bd</span> <span class="o">=</span> <span class="n">bd_new</span>
        <span class="n">ad</span> <span class="o">=</span> <span class="n">ad_new</span>

    <span class="c1"># Ensure real coefficients</span>
    <span class="n">bd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">bd</span><span class="p">)</span>
    <span class="n">ad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bd</span><span class="p">,</span> <span class="n">ad</span>

<span class="c1"># Compare BLT and impulse invariance for a Butterworth lowpass</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Cutoff frequency (Hz)</span>

<span class="c1"># Analog prototype</span>
<span class="n">Omega_c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span>
<span class="n">ba</span><span class="p">,</span> <span class="n">aa</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Omega_c</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Method 1: Bilinear transform</span>
<span class="n">bd_blt</span><span class="p">,</span> <span class="n">ad_blt</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">bilinear</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Method 2: Impulse invariance</span>
<span class="n">bd_ii</span><span class="p">,</span> <span class="n">ad_ii</span> <span class="o">=</span> <span class="n">impulse_invariance</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Compare frequency responses</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">w_blt</span><span class="p">,</span> <span class="n">H_blt</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">bd_blt</span><span class="p">,</span> <span class="n">ad_blt</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">w_ii</span><span class="p">,</span> <span class="n">H_ii</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">bd_ii</span><span class="p">,</span> <span class="n">ad_ii</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># Also plot the analog response for reference</span>
<span class="n">w_a</span><span class="p">,</span> <span class="n">H_a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4096</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_a</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_a</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
             <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analog&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_blt</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_blt</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
             <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bilinear Transform&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_ii</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_ii</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
             <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impulse Invariance&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BLT vs Impulse Invariance&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Near Nyquist detail</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_blt</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_blt</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
             <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLT&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_ii</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_ii</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
             <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impulse Invariance&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detail Near Nyquist (aliasing visible)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;impulse_invariance.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10-iir">10. ì™„ì „í•œ IIR ì„¤ê³„ ì ˆì°¨<a class="header-link" href="#10-iir" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 ë‹¨ê³„ë³„ ì ˆì°¨<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="nx">IIR</span><span class="w"> </span><span class="nx">Filter</span><span class="w"> </span><span class="nx">Design</span><span class="w"> </span><span class="nx">Steps</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Specify</span><span class="w"> </span><span class="nx">digital</span><span class="w"> </span><span class="nx">requirements</span><span class="p">:</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Passband</span><span class="o">/</span><span class="nx">stopband</span><span class="w"> </span><span class="nx">edges</span><span class="w"> </span><span class="p">(</span><span class="nx">Ï‰p</span><span class="p">,</span><span class="w"> </span><span class="nx">Ï‰s</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">fp</span><span class="p">,</span><span class="w"> </span><span class="nx">fs</span><span class="p">)</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Passband</span><span class="w"> </span><span class="nx">ripple</span><span class="w"> </span><span class="nx">Rp</span><span class="w"> </span><span class="p">(</span><span class="nx">dB</span><span class="p">)</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Stopband</span><span class="w"> </span><span class="nx">attenuation</span><span class="w"> </span><span class="nx">As</span><span class="w"> </span><span class="p">(</span><span class="nx">dB</span><span class="p">)</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">filter</span><span class="w"> </span><span class="k">type</span><span class="p">:</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Butterworth</span><span class="p">:</span><span class="w"> </span><span class="nx">maximally</span><span class="w"> </span><span class="nx">flat</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Chebyshev</span><span class="w"> </span><span class="nx">I</span><span class="p">:</span><span class="w"> </span><span class="nx">equiripple</span><span class="w"> </span><span class="nx">passband</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Chebyshev</span><span class="w"> </span><span class="nx">II</span><span class="p">:</span><span class="w"> </span><span class="nx">equiripple</span><span class="w"> </span><span class="nx">stopband</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Elliptic</span><span class="p">:</span><span class="w"> </span><span class="nx">minimum</span><span class="w"> </span><span class="nx">order</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">conversion</span><span class="w"> </span><span class="nx">method</span><span class="w"> </span><span class="p">(</span><span class="nx">usually</span><span class="w"> </span><span class="nx">BLT</span><span class="p">)</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">Pre</span><span class="o">-</span><span class="nx">warp</span><span class="w"> </span><span class="nx">critical</span><span class="w"> </span><span class="nx">frequencies</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">5</span><span class="p">.</span><span class="w"> </span><span class="nx">Determine</span><span class="w"> </span><span class="nx">minimum</span><span class="w"> </span><span class="nx">analog</span><span class="w"> </span><span class="nx">filter</span><span class="w"> </span><span class="nx">order</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">6</span><span class="p">.</span><span class="w"> </span><span class="nx">Design</span><span class="w"> </span><span class="nx">analog</span><span class="w"> </span><span class="nx">prototype</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">7</span><span class="p">.</span><span class="w"> </span><span class="nx">Apply</span><span class="w"> </span><span class="nx">analog</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">digital</span><span class="w"> </span><span class="nx">transformation</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">8</span><span class="p">.</span><span class="w"> </span><span class="nx">Verify</span><span class="w"> </span><span class="nx">specifications</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Check</span><span class="w"> </span><span class="nx">passband</span><span class="w"> </span><span class="nx">ripple</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Check</span><span class="w"> </span><span class="nx">stopband</span><span class="w"> </span><span class="nx">attenuation</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Check</span><span class="w"> </span><span class="nx">stability</span><span class="w"> </span><span class="p">(</span><span class="nx">all</span><span class="w"> </span><span class="nx">poles</span><span class="w"> </span><span class="nx">inside</span><span class="w"> </span><span class="nx">unit</span><span class="w"> </span><span class="nx">circle</span><span class="p">)</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">9</span><span class="p">.</span><span class="w"> </span><span class="nx">Implement</span><span class="w"> </span><span class="p">(</span><span class="nx">Direct</span><span class="w"> </span><span class="nx">Form</span><span class="w"> </span><span class="nx">II</span><span class="p">,</span><span class="w"> </span><span class="nx">SOS</span><span class="w"> </span><span class="nx">cascade</span><span class="p">,</span><span class="w"> </span><span class="nx">etc</span><span class="p">.)</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="102-scipysignal">10.2 scipy.signal ì§ì ‘ ì„¤ê³„ í•¨ìˆ˜ ì‚¬ìš©<a class="header-link" href="#102-scipysignal" title="Permanent link">&para;</a></h3>
<p>SciPyëŠ” ì‚¬ì „ ì›Œí•‘ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê³ ìˆ˜ì¤€ í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">design_all_types</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Design IIR lowpass filter using all four types.&quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Direct digital design (scipy handles pre-warping internally)</span>
    <span class="c1"># Butterworth</span>
    <span class="n">N_b</span><span class="p">,</span> <span class="n">Wn_b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">b_b</span><span class="p">,</span> <span class="n">a_b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N_b</span><span class="p">,</span> <span class="n">Wn_b</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_b</span><span class="p">,</span> <span class="n">a_b</span><span class="p">,</span> <span class="n">N_b</span><span class="p">)</span>

    <span class="c1"># Chebyshev Type I</span>
    <span class="n">N_c1</span><span class="p">,</span> <span class="n">Wn_c1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">b_c1</span><span class="p">,</span> <span class="n">a_c1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N_c1</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Wn_c1</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Chebyshev I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_c1</span><span class="p">,</span> <span class="n">a_c1</span><span class="p">,</span> <span class="n">N_c1</span><span class="p">)</span>

    <span class="c1"># Chebyshev Type II</span>
    <span class="n">N_c2</span><span class="p">,</span> <span class="n">Wn_c2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">b_c2</span><span class="p">,</span> <span class="n">a_c2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N_c2</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn_c2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Chebyshev II&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_c2</span><span class="p">,</span> <span class="n">a_c2</span><span class="p">,</span> <span class="n">N_c2</span><span class="p">)</span>

    <span class="c1"># Elliptic</span>
    <span class="n">N_e</span><span class="p">,</span> <span class="n">Wn_e</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">b_e</span><span class="p">,</span> <span class="n">a_e</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N_e</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn_e</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Elliptic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_e</span><span class="p">,</span> <span class="n">a_e</span><span class="p">,</span> <span class="n">N_e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># Design and compare</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">16000</span>
<span class="n">f_pass</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">f_stop</span> <span class="o">=</span> <span class="mi">2500</span>
<span class="n">Rp</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">As</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">design_all_types</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">Rp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Rp = -</span><span class="si">{</span><span class="n">Rp</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">As</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;As = -</span><span class="si">{</span><span class="n">As</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_stop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;IIR Filter Comparison (fp=</span><span class="si">{</span><span class="n">f_pass</span><span class="si">}</span><span class="s1"> Hz, fs_stop=</span><span class="si">{</span><span class="n">f_stop</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;iir_all_types.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Print summary</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;Filter Type&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Order&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Actual Rp (dB)&#39;</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Actual As (dB)&#39;</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">55</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">H_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">w</span>

    <span class="c1"># Passband ripple</span>
    <span class="n">pass_idx</span> <span class="o">=</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="n">f_pass</span>
    <span class="n">Rp_actual</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">H_mag</span><span class="p">[</span><span class="n">pass_idx</span><span class="p">]))</span>

    <span class="c1"># Stopband attenuation</span>
    <span class="n">stop_idx</span> <span class="o">=</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">f_stop</span>
    <span class="n">As_actual</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">H_mag</span><span class="p">[</span><span class="n">stop_idx</span><span class="p">]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">N</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Rp_actual</span><span class="si">:</span><span class="s2">&lt;16.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">As_actual</span><span class="si">:</span><span class="s2">&lt;16.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="11">11. ì•ˆì •ì„± ë¶„ì„<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 ì•ˆì •ì„± ê¸°ì¤€<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<p>ë””ì§€í„¸ IIR í•„í„°ëŠ” $H(z)$ì˜ ëª¨ë“  ê·¹ì ì´ ë‹¨ìœ„ì› ë‚´ë¶€ì— ì—„ê²©íˆ ìœ„ì¹˜í•  ë•Œë§Œ <strong>ì•ˆì •(stable)</strong>í•©ë‹ˆë‹¤:</p>
<p>$$|z_k| < 1, \quad \forall k$$</p>
<h3 id="112-2-sos">11.2 ìˆ˜ì¹˜ì  ì•ˆì •ì„±ì„ ìœ„í•œ 2ì°¨ ì„¹ì…˜(SOS)<a class="header-link" href="#112-2-sos" title="Permanent link">&para;</a></h3>
<p>ì§ì ‘ í˜•ì‹(direct form)ìœ¼ë¡œ êµ¬í˜„ëœ ê³ ì°¨ IIR í•„í„°ëŠ” ê³„ìˆ˜ ì–‘ìí™”(coefficient quantization) ë° ìˆ˜ì¹˜ ì •ë°€ë„ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ê²°ì±…ì€ <strong>2ì°¨ ì„¹ì…˜(second-order sections, biquads)ì˜ ì¢…ì† ì—°ê²°(cascade)</strong>ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:</p>
<p>$$H(z) = \prod_{i=1}^{L} \frac{b_{0i} + b_{1i}z^{-1} + b_{2i}z^{-2}}{1 + a_{1i}z^{-1} + a_{2i}z^{-2}}$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stability_analysis</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze IIR filter stability.&quot;&quot;&quot;</span>
    <span class="c1"># Poles and zeros</span>
    <span class="n">zeros</span><span class="p">,</span> <span class="n">poles</span><span class="p">,</span> <span class="n">gain</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="c1"># Check stability</span>
    <span class="n">pole_mags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">poles</span><span class="p">)</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">pole_mags</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">max_pole_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pole_mags</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filter: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Number of poles: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">poles</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Number of zeros: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zeros</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Maximum pole magnitude: </span><span class="si">{</span><span class="n">max_pole_mag</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Stability margin: </span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">max_pole_mag</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Pole-zero plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unit circle&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">zeros</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">zeros</span><span class="p">),</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Zeros (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zeros</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">poles</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">poles</span><span class="p">),</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Poles (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">poles</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Color poles by stability</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">poles</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="mf">0.03</span><span class="p">,</span>
                            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pole-Zero Plot: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="s1">(Stable: </span><span class="si">{</span><span class="n">is_stable</span><span class="si">}</span><span class="s1">, &#39;</span>
                 <span class="sa">f</span><span class="s1">&#39;Max |pole| = </span><span class="si">{</span><span class="n">max_pole_mag</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">is_stable</span>

<span class="c1"># Design a high-order filter and check stability</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">b_high</span><span class="p">,</span> <span class="n">a_high</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># 12th-order Butterworth</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">stable</span> <span class="o">=</span> <span class="n">stability_analysis</span><span class="p">(</span><span class="n">b_high</span><span class="p">,</span> <span class="n">a_high</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Butterworth N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stability_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Convert to SOS form for better numerical stability</span>
<span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2sos</span><span class="p">(</span><span class="n">b_high</span><span class="p">,</span> <span class="n">a_high</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SOS representation: </span><span class="si">{</span><span class="n">sos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> second-order sections&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOS coefficients:</span><span class="se">\n</span><span class="si">{</span><span class="n">sos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="113-tf-vs-sos">11.3 ìˆ˜ì¹˜ì  ë¹„êµ: tf vs SOS<a class="header-link" href="#113-tf-vs-sos" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_tf_vs_sos</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare direct form vs SOS implementation for high-order filter.&quot;&quot;&quot;</span>
    <span class="c1"># Design high-order filter</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>

    <span class="c1"># Test signal</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Filter using tf form</span>
    <span class="n">y_tf</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Filter using SOS form</span>
    <span class="n">y_sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Compare</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Frequency response comparison</span>
    <span class="n">w_tf</span><span class="p">,</span> <span class="n">H_tf</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">w_sos</span><span class="p">,</span> <span class="n">H_sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_tf</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_tf</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                     <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tf form&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_sos</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_sos</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                     <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOS form&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Output comparison</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_tf</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tf form&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_sos</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOS form&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Output&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output Signal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Difference</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_tf</span> <span class="o">-</span> <span class="n">y_sos</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|y_tf - y_sos|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Numerical Difference (max: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Pole magnitudes</span>
    <span class="n">zeros_tf</span><span class="p">,</span> <span class="n">poles_tf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">poles_tf</span><span class="p">),</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unit circle&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pole Index&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|pole|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pole Magnitudes (N=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Direct Form vs SOS (Order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;tf_vs_sos.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">compare_tf_vs_sos</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. í•„í„° ìœ í˜• ë¹„êµ<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="121">12.1 ìš”ì•½ í‘œ<a class="header-link" href="#121" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                     </span><span class="nv">IIR</span><span class="w"> </span><span class="nv">Filter</span><span class="w"> </span><span class="nv">Type</span><span class="w"> </span><span class="nv">Comparison</span><span class="w">                          </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">Butterworth</span><span class="w"> </span>â”‚<span class="w"> </span><span class="nv">Chebyshev</span><span class="w"> </span><span class="nv">I</span>â”‚<span class="w"> </span><span class="nv">Chebyshev</span><span class="w"> </span><span class="nv">II</span>â”‚<span class="w"> </span><span class="nv">Elliptic</span><span class="w">      </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Passband</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Maximally</span><span class="w">   </span>â”‚<span class="w"> </span><span class="nv">Equiripple</span><span class="w"> </span>â”‚<span class="w"> </span><span class="nv">Monotonic</span><span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Equiripple</span><span class="w">    </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">flat</span><span class="w">        </span>â”‚<span class="w">            </span>â”‚<span class="w">            </span>â”‚<span class="w">               </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Stopband</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Monotonic</span><span class="w">   </span>â”‚<span class="w"> </span><span class="nv">Monotonic</span><span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Equiripple</span><span class="w"> </span>â”‚<span class="w"> </span><span class="nv">Equiripple</span><span class="w">    </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Transition</span><span class="w">   </span>â”‚<span class="w"> </span><span class="nv">Widest</span><span class="w">      </span>â”‚<span class="w"> </span><span class="nv">Medium</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Medium</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Sharpest</span><span class="w">      </span>â”‚
â”‚<span class="w"> </span><span class="nv">band</span><span class="w">         </span>â”‚<span class="w">             </span>â”‚<span class="w">            </span>â”‚<span class="w">            </span>â”‚<span class="w">               </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Order</span><span class="w"> </span><span class="k">for</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Highest</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Medium</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Medium</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Lowest</span><span class="w">        </span>â”‚
â”‚<span class="w"> </span><span class="nv">given</span><span class="w"> </span><span class="nv">specs</span><span class="w">  </span>â”‚<span class="w">             </span>â”‚<span class="w">            </span>â”‚<span class="w">            </span>â”‚<span class="w">               </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Group</span><span class="w"> </span><span class="nv">delay</span><span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Most</span><span class="w">        </span>â”‚<span class="w"> </span><span class="nv">Less</span><span class="w">       </span>â”‚<span class="w"> </span><span class="nv">Better</span><span class="w"> </span><span class="nv">than</span>â”‚<span class="w"> </span><span class="nv">Most</span><span class="w">          </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">uniform</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">uniform</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Type</span><span class="w"> </span><span class="nv">I</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">non</span><span class="o">-</span><span class="nv">uniform</span><span class="w">   </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Use</span><span class="w"> </span><span class="nv">case</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">General</span>,<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Sharp</span><span class="w">      </span>â”‚<span class="w"> </span><span class="nv">Flat</span><span class="w">       </span>â”‚<span class="w"> </span><span class="nv">Minimum</span><span class="w"> </span><span class="nv">order</span>,â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">smooth</span><span class="w">      </span>â”‚<span class="w"> </span><span class="nv">cutoff</span>,<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">passband</span>,<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">tight</span><span class="w"> </span><span class="nv">specs</span><span class="w">   </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">response</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">ok</span><span class="w"> </span><span class="nv">ripple</span><span class="w">  </span>â”‚<span class="w"> </span><span class="nv">ok</span><span class="w"> </span><span class="nv">stopband</span>â”‚<span class="w">               </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="122">12.2 ì¢…í•© ì‹œê°ì  ë¹„êµ<a class="header-link" href="#122" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">comprehensive_comparison</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete comparison of all four IIR filter types.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">16000</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">fstop</span> <span class="o">=</span> <span class="mi">3000</span>
    <span class="n">Rp</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">As</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Butterworth</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fstop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Chebyshev I</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fstop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;Chebyshev I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Chebyshev II</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fstop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;Chebyshev II&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Elliptic</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fstop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">filters</span><span class="p">[</span><span class="s1">&#39;Elliptic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Chebyshev I&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Chebyshev II&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Elliptic&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">}</span>

    <span class="c1"># Magnitude response overlay</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">Rp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="n">As</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Response&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Passband detail</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Passband Detail&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fp</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Group delay</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sos2tf</span><span class="p">(</span><span class="n">sos</span><span class="p">)</span>
        <span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">w</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_gd</span><span class="p">,</span> <span class="n">gd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Group Delay (samples)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Group Delay&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Step response</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Step Response&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comprehensive IIR Filter Comparison&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;comprehensive_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">comprehensive_comparison</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="13-python">13. Python êµ¬í˜„<a class="header-link" href="#13-python" title="Permanent link">&para;</a></h2>
<h3 id="131-iir">13.1 ì™„ì „í•œ IIR ì„¤ê³„ ì›Œí¬í”Œë¡œìš°<a class="header-link" href="#131-iir" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">complete_iir_workflow</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">band_type</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Complete IIR filter design and analysis workflow.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fs: sampling frequency (Hz)</span>
<span class="sd">        filter_type: &#39;butter&#39;, &#39;cheby1&#39;, &#39;cheby2&#39;, &#39;ellip&#39;</span>
<span class="sd">        band_type: &#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;</span>
<span class="sd">        freqs: (f_pass, f_stop) or ((fp1, fp2), (fs1, fs2)) for bandpass/stop</span>
<span class="sd">        Rp: passband ripple (dB)</span>
<span class="sd">        As: stopband attenuation (dB)</span>

<span class="sd">    Returns:</span>
<span class="sd">        sos: second-order sections</span>
<span class="sd">        info: design information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span> <span class="o">=</span> <span class="n">freqs</span>

    <span class="c1"># Order determination</span>
    <span class="n">ord_funcs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;butter&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">,</span>
        <span class="s1">&#39;cheby1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">,</span>
        <span class="s1">&#39;cheby2&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">,</span>
        <span class="s1">&#39;ellip&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">ord_funcs</span><span class="p">[</span><span class="n">filter_type</span><span class="p">](</span><span class="n">f_pass</span><span class="p">,</span> <span class="n">f_stop</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Design</span>
    <span class="n">design_funcs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;butter&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="n">band_type</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cheby1&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="n">band_type</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cheby2&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="n">band_type</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">),</span>
        <span class="s1">&#39;ellip&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">As</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="n">band_type</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">design_funcs</span><span class="p">[</span><span class="n">filter_type</span><span class="p">]()</span>

    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;filter_type&#39;</span><span class="p">:</span> <span class="n">filter_type</span><span class="p">,</span>
        <span class="s1">&#39;band_type&#39;</span><span class="p">:</span> <span class="n">band_type</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
        <span class="s1">&#39;Wn&#39;</span><span class="p">:</span> <span class="n">Wn</span><span class="p">,</span>
        <span class="s1">&#39;Rp&#39;</span><span class="p">:</span> <span class="n">Rp</span><span class="p">,</span>
        <span class="s1">&#39;As&#39;</span><span class="p">:</span> <span class="n">As</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">sos</span><span class="p">,</span> <span class="n">info</span>

<span class="c1"># Example: Bandpass filter</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>
<span class="n">sos_bp</span><span class="p">,</span> <span class="n">info_bp</span> <span class="o">=</span> <span class="n">complete_iir_workflow</span><span class="p">(</span>
    <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span>
    <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;ellip&#39;</span><span class="p">,</span>
    <span class="n">band_type</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span>
    <span class="n">freqs</span><span class="o">=</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">3500</span><span class="p">]),</span>
    <span class="n">Rp</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">As</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bandpass filter: </span><span class="si">{</span><span class="n">info_bp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Apply to signal</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="c1"># Speech-like signal: mix of tones + noise</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>    <span class="c1"># Low freq</span>
     <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">1000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># Mid freq (passband)</span>
     <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>     <span class="c1"># Mid freq (passband)</span>
     <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>     <span class="c1"># High freq</span>
     <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>      <span class="c1"># Noise</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos_bp</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Time domain</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">y</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain: Bandpass Filtering&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Spectrum</span>
<span class="n">N_fft</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_fft</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_fft</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_fft</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passband&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Filter frequency response</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos_bp</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passband&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Filter Response (Elliptic N=</span><span class="si">{</span><span class="n">info_bp</span><span class="p">[</span><span class="s2">&quot;order&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;iir_bandpass_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="132-sos-iir">13.2 SOSë¥¼ ì‚¬ìš©í•œ ì‹¤ì‹œê°„ IIR í•„í„°ë§<a class="header-link" href="#132-sos-iir" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RealtimeIIRFilter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real-time IIR filter using second-order sections.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sos</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize with SOS coefficients.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            sos: second-order sections array (L x 6)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># State variables: 2 delay elements per section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sections</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a single input sample.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sections</span><span class="p">):</span>
            <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Direct Form II Transposed</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">y</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>  <span class="c1"># Output of this section is input to next</span>

        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_block</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a block of samples.&quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_block</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_block</span><span class="p">)):</span>
            <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_sample</span><span class="p">(</span><span class="n">x_block</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset filter state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sections</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># Demonstration</span>
<span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
<span class="n">filt</span> <span class="o">=</span> <span class="n">RealtimeIIRFilter</span><span class="p">(</span><span class="n">sos</span><span class="p">)</span>

<span class="c1"># Process in blocks (simulating real-time)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">block_size</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">y_realtime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">block_size</span><span class="p">):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">block_size</span><span class="p">]</span>
    <span class="n">y_realtime</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)]</span> <span class="o">=</span> <span class="n">filt</span><span class="o">.</span><span class="n">process_block</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

<span class="c1"># Compare with scipy batch processing</span>
<span class="n">y_batch</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_realtime</span> <span class="o">-</span> <span class="n">y_batch</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum error between real-time and batch: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="14">14. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#14" title="Permanent link">&para;</a></h2>
<h3 id="1">ì—°ìŠµ 1: ë²„í„°ì›ŒìŠ¤ í•„í„° ì„¤ê³„<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ê·œê²©ì˜ ë””ì§€í„¸ ë²„í„°ì›ŒìŠ¤ ì €ì—­ í†µê³¼ í•„í„°ë¥¼ ì„¤ê³„í•˜ì„¸ìš”:
- ìƒ˜í”Œë§ ì£¼íŒŒìˆ˜: $f_s = 10000$ Hz
- í†µê³¼ëŒ€ì—­ ì—£ì§€: $f_p = 1500$ Hz, ë¦¬í”Œ $\leq 0.5$ dB
- ì €ì§€ëŒ€ì—­ ì—£ì§€: $f_s = 2000$ Hz, ê°ì‡  $\geq 40$ dB</p>
<p>(a) ë²„í„°ì›ŒìŠ¤ ì°¨ìˆ˜ ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ í•„ìš”í•œ í•„í„° ì°¨ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”.</p>
<p>(b) ë””ì§€í„¸ ì£¼íŒŒìˆ˜ë¥¼ ì•„ë‚ ë¡œê·¸ ì£¼íŒŒìˆ˜ë¡œ ì‚¬ì „ ì›Œí•‘í•˜ì„¸ìš”.</p>
<p>(c) ì•„ë‚ ë¡œê·¸ ë²„í„°ì›ŒìŠ¤ ì›í˜•ì„ ì„¤ê³„í•˜ê³  ìŒì¼ì°¨ ë³€í™˜ì„ ì ìš©í•˜ì„¸ìš”.</p>
<p>(d) ì„¤ê³„ê°€ ê·œê²©ì„ ì¶©ì¡±í•˜ëŠ”ì§€ ê²€ì¦í•˜ì„¸ìš”. í¬ê¸° ì‘ë‹µ, ìœ„ìƒ ì‘ë‹µ, êµ° ì§€ì—°(group delay), ê·¹-ì˜ì  ë‹¤ì´ì–´ê·¸ë¨ì„ ê·¸ë¦¬ì„¸ìš”.</p>
<p>(e) ìˆ˜ë™ ì„¤ê³„ë¥¼ <code>scipy.signal.butter</code>ì™€ ë¹„êµí•˜ì„¸ìš”. ê²°ê³¼ê°€ ë™ì¼í•œê°€ìš”?</p>
<h3 id="2_1">ì—°ìŠµ 2: ì²´ë¹„ì‡¼í”„ í•„í„° ë¹„êµ<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ê·œê²©: $f_s = 8000$ Hz, $f_p = 1000$ Hz, $f_\text{stop} = 1200$ Hz, $R_p = 1$ dB, $A_s = 50$ dBì— ëŒ€í•´:</p>
<p>(a) ì²´ë¹„ì‡¼í”„ Type Iê³¼ Type II í•„í„°ë¥¼ ëª¨ë‘ ì„¤ê³„í•˜ì„¸ìš”.</p>
<p>(b) ë‹¨ì¼ ê·¸ë˜í”„ì—ì„œ ì£¼íŒŒìˆ˜ ì‘ë‹µì„ ë¹„êµí•˜ì„¸ìš”.</p>
<p>(c) í†µê³¼ëŒ€ì—­ì—ì„œ ì–´ëŠ ê²ƒì´ êµ° ì§€ì—° í‰íƒ„ë„ê°€ ë” ì¢‹ì€ê°€ìš”? ì •ëŸ‰ì ìœ¼ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.</p>
<p>(d) ë‘ í•„í„°ë¥¼ ì²˜í”„(chirp) ì‹ í˜¸(100 Hzì—ì„œ 4000 Hz ìŠ¤ìœ•)ì— ì ìš©í•˜ê³  ì¶œë ¥ì„ ë¹„êµí•˜ì„¸ìš”.</p>
<h3 id="3_1">ì—°ìŠµ 3: ì˜¤ë””ì˜¤ìš© íƒ€ì›í˜• í•„í„°<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>ì˜¤ë””ì˜¤ ì•ˆí‹°ì—ì¼ë¦¬ì–´ì‹±(anti-aliasing)ì„ ìœ„í•œ íƒ€ì›í˜• ì €ì—­ í†µê³¼ í•„í„°ë¥¼ ì„¤ê³„í•˜ì„¸ìš”:
- ì…ë ¥ ìƒ˜í”Œë§ ì†ë„: 96 kHz (48 kHzë¡œ ë‹¤ìš´ìƒ˜í”Œë§ ì˜ˆì •)
- í†µê³¼ëŒ€ì—­: 0~20 kHz, ë¦¬í”Œ $\leq 0.01$ dB
- ì €ì§€ëŒ€ì—­: 24 kHz~48 kHz, ê°ì‡  $\geq 96$ dB (16ë¹„íŠ¸ ì •ë°€ë„)</p>
<p>(a) ìµœì†Œ í•„í„° ì°¨ìˆ˜ë¥¼ ê²°ì •í•˜ì„¸ìš”.</p>
<p>(b) SOS í˜•ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ì„¸ìš”.</p>
<p>(c) ì„ í˜• ë° dB ìŠ¤ì¼€ì¼ ëª¨ë‘ì—ì„œ í¬ê¸° ì‘ë‹µì„ ê·¸ë¦¬ì„¸ìš”.</p>
<p>(d) êµ° ì§€ì—°ì„ ê³„ì‚°í•˜ê³  ê·¸ë¦¬ì„¸ìš”. ì˜¤ë””ì˜¤ì—ì„œ êµ° ì§€ì—° ë³€ë™ì´ í—ˆìš© ê°€ëŠ¥í•œê°€ìš”?</p>
<h3 id="4">ì—°ìŠµ 4: ìˆ˜ì‘ì—… ìŒì¼ì°¨ ë³€í™˜<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>1ì°¨ ì•„ë‚ ë¡œê·¸ ì €ì—­ í†µê³¼ í•„í„°ê°€ ì£¼ì–´ì¡Œì„ ë•Œ:</p>
<p>$$H_a(s) = \frac{\Omega_c}{s + \Omega_c}$$</p>
<p>(a) ìŒì¼ì°¨ ë³€í™˜ $s = \frac{2}{T}\frac{z-1}{z+1}$ì„ ì ìš©í•˜ì—¬ $H(z)$ë¥¼ ìœ ë„í•˜ì„¸ìš”.</p>
<p>(b) $\Omega_c = 2\pi \times 1000$ rad/s, $f_s = 8000$ Hzì— ëŒ€í•´ ë””ì§€í„¸ í•„í„° ê³„ìˆ˜ $b_0, b_1, a_0, a_1$ì„ ê³„ì‚°í•˜ì„¸ìš”.</p>
<p>(c) $H(z)$ì˜ ì£¼íŒŒìˆ˜ ì‘ë‹µê³¼ ì›Œí•‘ëœ ì•„ë‚ ë¡œê·¸ ì‘ë‹µì„ ë¹„êµí•˜ì—¬ ê²€ì¦í•˜ì„¸ìš”.</p>
<p>(d) ë™ì¼í•œ ì°¨ë‹¨ ì£¼íŒŒìˆ˜ì˜ 2ì°¨ ë²„í„°ì›ŒìŠ¤ í•„í„°ì— ëŒ€í•´ ë°˜ë³µí•˜ì„¸ìš”.</p>
<h3 id="5">ì—°ìŠµ 5: ì•ˆì •ì„± ì¡°ì‚¬<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>(a) 16ì°¨ ì²´ë¹„ì‡¼í”„ Type I í•„í„°($R_p = 3$ dB, $\omega_c = 0.1\pi$)ë¥¼ <code>tf</code>ì™€ <code>sos</code> í˜•ì‹ìœ¼ë¡œ ì„¤ê³„í•˜ì„¸ìš”.</p>
<p>(b) ë‘ í‘œí˜„ì— ëŒ€í•´ ê·¹ì  í¬ê¸°ë¥¼ ê³„ì‚°í•˜ê³  í‘œì‹œí•˜ì„¸ìš”.</p>
<p>(c) ë‘ í‘œí˜„ì„ ì‚¬ìš©í•˜ì—¬ ë°±ìƒ‰ ì¡ìŒ ì‹ í˜¸ë¥¼ í•„í„°ë§í•˜ì„¸ìš”. <code>tf</code> í˜•ì‹ ì¶œë ¥ì´ ìœ íš¨í•œê°€ìš”?</p>
<p>(d) ì²´ë¹„ì‡¼í”„ Type I í•„í„°ì—ì„œ <code>tf</code> í˜•ì‹ì´ ì¼ë°˜ì ìœ¼ë¡œ ì–´ëŠ ì°¨ìˆ˜ì—ì„œ ë¬´ë„ˆì§€ê¸° ì‹œì‘í•˜ë‚˜ìš”? ì°¨ìˆ˜ 4, 8, 12, 16, 20, 24ë¡œ ì‹¤í—˜í•´ë³´ì„¸ìš”.</p>
<h3 id="6-iir-vs-fir">ì—°ìŠµ 6: IIR vs FIR ë¹„êµ<a class="header-link" href="#6-iir-vs-fir" title="Permanent link">&para;</a></h3>
<p>ê·œê²©: $f_s = 16000$ Hz, $f_p = 3000$ Hz, $f_\text{stop} = 3500$ Hz, $A_s = 60$ dBì— ëŒ€í•´:</p>
<p>(a) IIR(íƒ€ì›í˜•)ê³¼ FIR(Parks-McClellan) í•„í„° ëª¨ë‘ ì„¤ê³„í•˜ì„¸ìš”.</p>
<p>(b) ë‹¤ìŒì„ ë¹„êµí•˜ì„¸ìš”: í•„í„° ì°¨ìˆ˜, ìƒ˜í”Œë‹¹ ê³„ì‚° ë¹„ìš©, êµ° ì§€ì—°, í¬ê¸° ì‘ë‹µ.</p>
<p>(c) ìŒì„±ê³¼ ìœ ì‚¬í•œ ì‹ í˜¸(100, 200, ..., 5000 Hzì˜ ê³ ì¡°íŒŒ í•©ì‚°)ë¥¼ í•„í„°ë§í•˜ì„¸ìš”. ì‹œê°„ ì˜ì—­ ì¶œë ¥ì„ ì‹œê°ì ìœ¼ë¡œ ë¹„êµí•˜ê³  SNR ê°œì„ ì„ ê³„ì‚°í•˜ì„¸ìš”.</p>
<p>(d) IIRì„ FIRë³´ë‹¤ ì„ íƒí•´ì•¼ í•˜ëŠ” ì‘ìš© ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë¬´ì—‡ì¸ì§€, ê·¸ ë°˜ëŒ€ëŠ” ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•˜ì„¸ìš”?</p>
<h3 id="7">ì—°ìŠµ 7: ëŒ€ì—­ ì €ì§€(ë…¸ì¹˜) í•„í„°<a class="header-link" href="#7" title="Permanent link">&para;</a></h3>
<p>ì‹¬ì „ë„(ECG) ì‹ í˜¸ì—ì„œ 60 Hz ì „ì›ì„  ê°„ì„­(powerline interference)ì„ ì œê±°í•˜ê¸° ìœ„í•œ ì¢ì€ ëŒ€ì—­ ì €ì§€ í•„í„°ë¥¼ ì„¤ê³„í•˜ì„¸ìš”:
- ìƒ˜í”Œë§ ì£¼íŒŒìˆ˜: 500 Hz
- ì œê±° ëŒ€ìƒ: 59-61 Hz
- í†µê³¼ëŒ€ì—­: 0-55 Hz ë° 65-250 Hz
- í†µê³¼ëŒ€ì—­ ë¦¬í”Œ: $\leq 0.1$ dB
- ì €ì§€ëŒ€ì—­ ê°ì‡ : $\geq 30$ dB</p>
<p>(a) íƒ€ì›í˜• ì›í˜•ì„ ì‚¬ìš©í•˜ì—¬ ì„¤ê³„í•˜ì„¸ìš”. ì–´ë–¤ ì°¨ìˆ˜ê°€ í•„ìš”í•œê°€ìš”?</p>
<p>(b) 60 Hz ì£¼ë³€ì„ í™•ëŒ€í•œ ë·°ë¡œ í¬ê¸° ì‘ë‹µì„ ê·¸ë¦¬ì„¸ìš”.</p>
<p>(c) 60 Hz ì˜¤ì—¼ì´ ìˆëŠ” í•©ì„± ECG ì‹ í˜¸ë¥¼ ìƒì„±í•˜ê³  í•„í„°ì˜ íš¨ê³¼ë¥¼ ì‹œì—°í•˜ì„¸ìš”.</p>
<p>(d) ë²„í„°ì›ŒìŠ¤ ëŒ€ íƒ€ì›í˜• êµ¬í˜„ì˜ êµ° ì§€ì—°ì„ ê³„ì‚°í•˜ê³  ë¹„êµí•˜ì„¸ìš”.</p>
<hr />
<h2 id="_3">ì°¸ê³ ë¬¸í—Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Oppenheim, A. V., &amp; Schafer, R. W. (2010).</strong> <em>Discrete-Time Signal Processing</em> (3rd ed.). Pearson. Chapter 7.</li>
<li><strong>Proakis, J. G., &amp; Manolakis, D. G. (2007).</strong> <em>Digital Signal Processing</em> (4th ed.). Pearson. Chapter 11.</li>
<li><strong>Parks, T. W., &amp; Burrus, C. S. (1987).</strong> <em>Digital Filter Design</em>. Wiley.</li>
<li><strong>Antoniou, A. (2006).</strong> <em>Digital Signal Processing: Signals, Systems, and Filters</em>. McGraw-Hill.</li>
<li><strong>SciPy Documentation</strong> -- Filter design functions: https://docs.scipy.org/doc/scipy/reference/signal.html</li>
<li><strong>Smith, S. W. (1997).</strong> <em>The Scientist and Engineer's Guide to Digital Signal Processing</em>. Available free at http://www.dspguide.com/</li>
</ol>
<hr />
<h2 id="_4">íƒìƒ‰<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li>ì´ì „: <a href="09_FIR_Filter_Design.md">09. FIR í•„í„° ì„¤ê³„</a></li>
<li>ë‹¤ìŒ: <a href="11_Multirate_Processing.md">11. ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬</a></li>
<li><a href="00_Overview.md">ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/09_FIR_Filter_Design.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">FIR í•„í„° ì„¤ê³„(FIR Filter Design)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/11_Multirate_Processing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}