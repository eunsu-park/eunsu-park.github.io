{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/10_IIR_Filter_Design.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">IIR í•„í„° ì„¤ê³„</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/12_Spectral_Analysis.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ë‹¤ì¤‘ë¥  ì‹œìŠ¤í…œ ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ì™œ ë‹¤ì¤‘ë¥  ì²˜ë¦¬ì¸ê°€?</a></li>
<li><a href="#12">1.2 ê¸°ë³¸ ì—°ì‚°</a></li>
</ul>
</li>
<li><a href="#2">2. ë‹¤ìš´ìƒ˜í”Œë§ (ë°ì‹œë©”ì´ì…˜)</a><ul>
<li><a href="#21">2.1 ì‹œê°„ ì˜ì—­ ì—°ì‚°</a></li>
<li><a href="#22">2.2 ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„</a></li>
<li><a href="#23">2.3 ì•¨ë¦¬ì–´ì‹± ì‹œì—°</a></li>
</ul>
</li>
<li><a href="#3">3. ì—…ìƒ˜í”Œë§ (ë³´ê°„)</a><ul>
<li><a href="#31">3.1 ì‹œê°„ ì˜ì—­ ì—°ì‚°</a></li>
<li><a href="#32">3.2 ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„</a></li>
<li><a href="#33">3.3 ì´ë¯¸ì§• ì‹œì—°</a></li>
</ul>
</li>
<li><a href="#4">4. ë°ì‹œë©”ì´ì…˜ ë° ë³´ê°„ í•„í„°</a><ul>
<li><a href="#41">4.1 ë°ì‹œë©”ì´ì…˜ í•„í„° ìš”êµ¬ì‚¬í•­</a></li>
<li><a href="#42">4.2 ë³´ê°„ í•„í„° ìš”êµ¬ì‚¬í•­</a></li>
<li><a href="#43">4.3 ë°ì‹œë©”ì´ì…˜ìš© í•„í„° ì„¤ê³„</a></li>
</ul>
</li>
<li><a href="#5">5. ë…¸ë¸” í•­ë“±ì‹</a><ul>
<li><a href="#51">5.1 í•­ë“±ì‹</a></li>
<li><a href="#52">5.2 ë…¸ë¸” í•­ë“±ì‹ì´ ì¤‘ìš”í•œ ì´ìœ </a></li>
</ul>
</li>
<li><a href="#6">6. í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´</a><ul>
<li><a href="#61">6.1 ê°œë…</a></li>
<li><a href="#62">6.2 í´ë¦¬í˜ì´ì¦ˆ ë°ì‹œë©”ì´ì…˜</a></li>
<li><a href="#63">6.3 í´ë¦¬í˜ì´ì¦ˆ ë³´ê°„</a></li>
<li><a href="#64">6.4 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#7">7. ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜</a><ul>
<li><a href="#71-lm">7.1 L/Mì— ì˜í•œ ë¥  ë³€ê²½</a></li>
<li><a href="#72-441-khz-48-khz">7.2 ì˜ˆì œ: 44.1 kHzì—ì„œ 48 kHzë¡œ ë³€í™˜</a></li>
<li><a href="#73">7.3 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#8">8. ë‹¤ë‹¨ê³„ ë¥  ë³€í™˜</a><ul>
<li><a href="#81">8.1 ë™ê¸°</a></li>
<li><a href="#82">8.2 ìµœì  ë‹¨ê³„ í• ë‹¹</a></li>
<li><a href="#83">8.3 êµ¬í˜„ ë° ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#9">9. í•„í„° ë±…í¬</a><ul>
<li><a href="#91-">9.1 ë¶„ì„-í•©ì„± í•„í„° ë±…í¬</a></li>
<li><a href="#92-2">9.2 2ì±„ë„ í•„í„° ë±…í¬</a></li>
<li><a href="#93-qmf">9.3 ì§êµ ë¯¸ëŸ¬ í•„í„° (QMF)</a></li>
<li><a href="#94-cqf">9.4 ì¼¤ë ˆ ì§êµ í•„í„° (CQF)</a></li>
</ul>
</li>
<li><a href="#10">10. ì‘ìš©</a><ul>
<li><a href="#101">10.1 ì˜¤ë””ì˜¤ ìƒ˜í”Œë¥  ë³€í™˜</a></li>
<li><a href="#102-adc">10.2 ì‹œê·¸ë§ˆ-ë¸íƒ€ ADC ê°œë…</a></li>
</ul>
</li>
<li><a href="#11-python">11. Python êµ¬í˜„</a><ul>
<li><a href="#111-scipysignal">11.1 ë‹¤ì¤‘ë¥  ì²˜ë¦¬ë¥¼ ìœ„í•œ scipy.signal ì‚¬ìš©</a></li>
<li><a href="#112">11.2 ì™„ì „í•œ ë‹¤ì¤‘ë¥  ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸</a></li>
</ul>
</li>
<li><a href="#12_1">12. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ 1: ë‹¤ìš´ìƒ˜í”Œë§ ë¶„ì„</a></li>
<li><a href="#2_1">ì—°ìŠµ 2: ë³´ê°„ í’ˆì§ˆ</a></li>
<li><a href="#3_1">ì—°ìŠµ 3: í´ë¦¬í˜ì´ì¦ˆ êµ¬í˜„</a></li>
<li><a href="#4_1">ì—°ìŠµ 4: ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜</a></li>
<li><a href="#5_1">ì—°ìŠµ 5: ë‹¤ë‹¨ê³„ ë°ì‹œë©”ì´ì…˜ ìµœì í™”</a></li>
<li><a href="#6-qmf">ì—°ìŠµ 6: QMF í•„í„° ë±…í¬</a></li>
<li><a href="#7-cic">ì—°ìŠµ 7: CIC í•„í„°</a></li>
</ul>
</li>
<li><a href="#_3">ì°¸ê³ ë¬¸í—Œ</a></li>
<li><a href="#_4">íƒìƒ‰</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="multirate-signal-processing">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)<a class="header-link" href="#multirate-signal-processing" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ë°ì‹œë©”ì´ì…˜(Decimation, ë‹¤ìš´ìƒ˜í”Œë§)ê³¼ ë³´ê°„(Interpolation, ì—…ìƒ˜í”Œë§)ì˜ ê¸°ì´ˆ ì´í•´</li>
<li>ìƒ˜í”Œë¥  ë³€ê²½ì´ ìŠ¤í™íŠ¸ëŸ¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¶„ì„</li>
<li>íš¨ìœ¨ì ì¸ ë‹¤ì¤‘ë¥  êµ¬í˜„ì„ ìœ„í•œ ë…¸ë¸” í•­ë“±ì‹(Noble Identities) ìŠµë“</li>
<li>ë¥  ë³€í™˜ì„ ìœ„í•œ ì•¤í‹°ì•¨ë¦¬ì–´ì‹±(anti-aliasing) ë° ì•¤í‹°ì´ë¯¸ì§•(anti-imaging) í•„í„° ì„¤ê³„</li>
<li>ê³„ì‚° íš¨ìœ¨ì ì¸ í•„í„°ë§ì„ ìœ„í•œ í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´(polyphase decomposition) êµ¬í˜„</li>
<li>ì—°ì†ëœ ë³´ê°„ê³¼ ë°ì‹œë©”ì´ì…˜ì„ ì´ìš©í•œ ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜(rational rate conversion) ì ìš©</li>
<li>ì§êµ ë¯¸ëŸ¬ í•„í„°(QMF, Quadrature Mirror Filters)ë¥¼ í¬í•¨í•œ í•„í„° ë±…í¬ êµ¬ì¡° ì´í•´</li>
<li>Pythonì˜ <code>scipy.signal</code> ëª¨ë“ˆì„ ì‚¬ìš©í•œ ë‹¤ì¤‘ë¥  ì‹œìŠ¤í…œ êµ¬í˜„</li>
</ul>
<hr />
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ë‹¤ì¤‘ë¥ -ì‹œìŠ¤í…œ-ì†Œê°œ">ë‹¤ì¤‘ë¥  ì‹œìŠ¤í…œ ì†Œê°œ</a></li>
<li><a href="#2-ë‹¤ìš´ìƒ˜í”Œë§-ë°ì‹œë©”ì´ì…˜">ë‹¤ìš´ìƒ˜í”Œë§ (ë°ì‹œë©”ì´ì…˜)</a></li>
<li><a href="#3-ì—…ìƒ˜í”Œë§-ë³´ê°„">ì—…ìƒ˜í”Œë§ (ë³´ê°„)</a></li>
<li><a href="#4-ë°ì‹œë©”ì´ì…˜-ë°-ë³´ê°„-í•„í„°">ë°ì‹œë©”ì´ì…˜ ë° ë³´ê°„ í•„í„°</a></li>
<li><a href="#5-ë…¸ë¸”-í•­ë“±ì‹">ë…¸ë¸” í•­ë“±ì‹</a></li>
<li><a href="#6-í´ë¦¬í˜ì´ì¦ˆ-ë¶„í•´">í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´</a></li>
<li><a href="#7-ìœ ë¦¬ìˆ˜-ë¥ -ë³€í™˜">ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜</a></li>
<li><a href="#8-ë‹¤ë‹¨ê³„-ë¥ -ë³€í™˜">ë‹¤ë‹¨ê³„ ë¥  ë³€í™˜</a></li>
<li><a href="#9-í•„í„°-ë±…í¬">í•„í„° ë±…í¬</a></li>
<li><a href="#10-ì‘ìš©">ì‘ìš©</a></li>
<li><a href="#11-python-êµ¬í˜„">Python êµ¬í˜„</a></li>
<li><a href="#12-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1">1. ë‹¤ì¤‘ë¥  ì‹œìŠ¤í…œ ì†Œê°œ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì™œ ë‹¤ì¤‘ë¥  ì²˜ë¦¬ì¸ê°€?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate signal processing)ëŠ” ë‘˜ ì´ìƒì˜ ìƒ˜í”Œë¥ ë¡œ ë™ì‘í•˜ëŠ” ì‹œìŠ¤í…œì„ ë‹¤ë£¹ë‹ˆë‹¤. ì£¼ëœ ë™ê¸°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<ul>
<li><strong>ìƒ˜í”Œë¥  ë³€í™˜</strong>: 44.1 kHz(CD)ì™€ 48 kHz(ì „ë¬¸ ì˜¤ë””ì˜¤) ê°„ì˜ ì˜¤ë””ì˜¤ ë³€í™˜</li>
<li><strong>ê³„ì‚° íš¨ìœ¨ì„±</strong>: ê° ë‹¨ê³„ì— í•„ìš”í•œ ìµœì € ë¥ ë¡œ ì²˜ë¦¬</li>
<li><strong>ëŒ€ì—­í­ ê°ì†Œ</strong>: í˜‘ëŒ€ì—­ ì‹ í˜¸ë¥¼ ë°ì‹œë©”ì´ì…˜í•˜ì—¬ ë°ì´í„° ë¥  ê°ì†Œ</li>
<li><strong>ì„œë¸Œë°´ë“œ ì½”ë”©(Subband coding)</strong>: íš¨ìœ¨ì ì¸ ì••ì¶•ì„ ìœ„í•´ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ëŒ€ì—­ìœ¼ë¡œ ë¶„í• </li>
<li><strong>ì‹œê·¸ë§ˆ-ë¸íƒ€(Sigma-delta) ADC/DAC</strong>: ì†ë„ì™€ í•´ìƒë„ë¥¼ êµí™˜í•˜ëŠ” ì˜¤ë²„ìƒ˜í”Œë§ ë³€í™˜ê¸°</li>
</ul>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Multirate System Building Blocks                    â”‚
â”‚                                                                  â”‚
â”‚  Downsampler (â†“M):          Upsampler (â†‘L):                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚  â†“M   â”‚  Keep every      â”‚  â†‘L   â”‚  Insert (L-1)             â”‚
â”‚  â”‚       â”‚  M-th sample     â”‚       â”‚  zeros between             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”˜  samples                   â”‚
â”‚                                                                  â”‚
â”‚  Decimator:                 Interpolator:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚Anti-   â”‚â†’ â”‚  â†“M   â”‚     â”‚  â†‘L   â”‚â†’ â”‚Anti-   â”‚               â”‚
â”‚  â”‚alias   â”‚  â”‚       â”‚     â”‚       â”‚  â”‚image   â”‚               â”‚
â”‚  â”‚filter  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚filter  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12">1.2 ê¸°ë³¸ ì—°ì‚°<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>ë‹¤ì¤‘ë¥  ì²˜ë¦¬ì—ì„œ ë‘ ê°€ì§€ ê¸°ë³¸ ì—°ì‚°:</p>
<p><strong>ì¸ìˆ˜ $M$ë§Œí¼ ë‹¤ìš´ìƒ˜í”Œë§</strong> ($M$ë²ˆì§¸ ìƒ˜í”Œë§ˆë‹¤ ìœ ì§€):</p>
<p>$$y[n] = x[nM]$$</p>
<p><strong>ì¸ìˆ˜ $L$ë§Œí¼ ì—…ìƒ˜í”Œë§</strong> (ìƒ˜í”Œ ì‚¬ì´ì— $L-1$ê°œì˜ ì˜(zero) ì‚½ì…):</p>
<p>$$y[n] = \begin{cases} x[n/L], & n = 0, \pm L, \pm 2L, \ldots \\ 0, & \text{otherwise} \end{cases}$$</p>
<hr />
<h2 id="2">2. ë‹¤ìš´ìƒ˜í”Œë§ (ë°ì‹œë©”ì´ì…˜)<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì‹œê°„ ì˜ì—­ ì—°ì‚°<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì •ìˆ˜ ì¸ìˆ˜ $M$ë§Œí¼ ë‹¤ìš´ìƒ˜í”Œë§í•˜ë©´ $M$ë²ˆì§¸ ìƒ˜í”Œë§ˆë‹¤ ìœ ì§€ë©ë‹ˆë‹¤:</p>
<p>$$x_d[n] = x[nM]$$</p>
<p>ì¶œë ¥ ìƒ˜í”Œë¥ ì€ $f_s' = f_s / M$ì…ë‹ˆë‹¤.</p>
<h3 id="22">2.2 ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìš´ìƒ˜í”Œëœ ì‹ í˜¸ì˜ DTFT(ì´ì‚° ì‹œê°„ í‘¸ë¦¬ì— ë³€í™˜)ëŠ”:</p>
<p>$$X_d(e^{j\omega}) = \frac{1}{M} \sum_{k=0}^{M-1} X\left(e^{j(\omega - 2\pi k)/M}\right)$$</p>
<p>ì´ ê³µì‹ì€ ë‘ ê°€ì§€ íš¨ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:
1. <strong>ì£¼íŒŒìˆ˜ ìŠ¤ì¼€ì¼ë§</strong>: ìŠ¤í™íŠ¸ëŸ¼ì´ $M$ë°° ëŠ˜ì–´ë‚©ë‹ˆë‹¤ (ì£¼íŒŒìˆ˜ê°€ $[-\pi, \pi]$ë¡œ ì••ì¶•ë¨)
2. <strong>ì•¨ë¦¬ì–´ì‹±(Aliasing)</strong>: $M$ê°œì˜ ì´ë™ëœ ìŠ¤í™íŠ¸ëŸ¼ ë³µì‚¬ë³¸ì´ ì¤‘ì²©ë©ë‹ˆë‹¤</p>
<div class="highlight"><pre><span></span><code><span class="n">Downsampling</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">Spectral</span><span class="w"> </span><span class="n">Effect</span>

<span class="n">Original</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">jÏ‰</span><span class="p">):</span>
<span class="w">         </span><span class="err">â•±â•²</span>
<span class="w">        </span><span class="err">â•±</span><span class="w">  </span><span class="err">â•²</span>
<span class="w">       </span><span class="err">â•±</span><span class="w">    </span><span class="err">â•²</span>
<span class="err">â”€â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â”€â”€â”€</span>
<span class="w">   </span><span class="o">-</span><span class="err">Ï€</span><span class="w">    </span><span class="mi">0</span><span class="w">    </span><span class="err">Ï€</span>

<span class="n">After</span><span class="w"> </span><span class="err">â†“</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">X_d</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">jÏ‰</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)[</span><span class="n">X</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">jÏ‰</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">j</span><span class="p">(</span><span class="err">Ï‰</span><span class="o">-</span><span class="mi">2</span><span class="err">Ï€</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))]:</span>

<span class="w">              </span><span class="err">â•±â•²</span>
<span class="n">Stretched</span><span class="p">:</span><span class="w">   </span><span class="err">â•±</span><span class="w">  </span><span class="err">â•²</span>
<span class="w">            </span><span class="err">â•±</span><span class="w">    </span><span class="err">â•²</span>
<span class="w"> </span><span class="err">â•²</span><span class="w">         </span><span class="err">â•±</span><span class="w">      </span><span class="err">â•²</span><span class="w">         </span><span class="err">â•±</span><span class="w">  </span><span class="n">Aliased</span><span class="w"> </span><span class="n">copies</span><span class="w"> </span><span class="n">overlap</span><span class="o">!</span>
<span class="w">  </span><span class="err">â•²</span><span class="w">       </span><span class="err">â•±</span><span class="w">        </span><span class="err">â•²</span><span class="w">       </span><span class="err">â•±</span>
<span class="err">â”€â”€â”€â•²â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â”€â”€â•±â”€â”€â”€</span>
<span class="w">   </span><span class="o">-</span><span class="err">Ï€</span><span class="w">    </span><span class="mi">0</span><span class="w">           </span><span class="err">Ï€</span>

<span class="n">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">bandlimited</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">|</span><span class="err">Ï‰</span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="err">Ï€</span><span class="o">/</span><span class="n">M</span><span class="p">,</span>
<span class="n">no</span><span class="w"> </span><span class="n">aliasing</span><span class="w"> </span><span class="n">occurs</span><span class="o">.</span>
</code></pre></div>

<h3 id="23">2.3 ì•¨ë¦¬ì–´ì‹± ì‹œì—°<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_downsampling</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the spectral effects of downsampling.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Create signal with multiple tones</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1500</span>  <span class="c1"># Hz</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Downsample without anti-aliasing filter</span>
    <span class="n">x_down_nofilter</span> <span class="o">=</span> <span class="n">x</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>
    <span class="n">fs_down</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">M</span>

    <span class="c1"># Downsample with anti-aliasing filter</span>
    <span class="c1"># Cutoff at fs/(2M) to prevent aliasing</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">fs</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">M</span><span class="p">),</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">x_filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x_down_filtered</span> <span class="o">=</span> <span class="n">x_filtered</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># Original signal</span>
    <span class="n">freq_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Original Signal (fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_orig</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X_orig</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Downsampled without filter (aliased)</span>
    <span class="n">N_down</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_down_nofilter</span><span class="p">)</span>
    <span class="n">freq_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_down</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_down</span><span class="p">)</span>
    <span class="n">X_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_down_nofilter</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_down</span>

    <span class="n">t_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_down</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs_down</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_down</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_down_nofilter</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;r-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Downsampled â†“</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1"> (NO filter) fs = </span><span class="si">{</span><span class="n">fs_down</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_down</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X_down</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum (Aliased!)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_down</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fs_down</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nyquist = </span><span class="si">{</span><span class="n">fs_down</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Downsampled with anti-aliasing filter</span>
    <span class="n">N_down_f</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_down_filtered</span><span class="p">)</span>
    <span class="n">freq_down_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_down_f</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_down</span><span class="p">)</span>
    <span class="n">X_down_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_down_filtered</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_down_f</span>

    <span class="n">t_down_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_down_f</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs_down</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_down_f</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_down_filtered</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;g-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decimated â†“</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1"> (WITH anti-alias filter)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_down_f</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X_down_f</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum (No aliasing)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_down</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Downsampling by M = </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;downsampling_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">demonstrate_downsampling</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì—…ìƒ˜í”Œë§ (ë³´ê°„)<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì‹œê°„ ì˜ì—­ ì—°ì‚°<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>ì¸ìˆ˜ $L$ë§Œí¼ ì—…ìƒ˜í”Œë§í•˜ë©´ ì—°ì†ëœ ìƒ˜í”Œ ì‚¬ì´ì— $L-1$ê°œì˜ ì˜ì„ ì‚½ì…í•©ë‹ˆë‹¤:</p>
<p>$$x_u[n] = \begin{cases} x[n/L], & n = 0, \pm L, \pm 2L, \ldots \\ 0, & \text{otherwise} \end{cases}$$</p>
<p>ì¶œë ¥ ìƒ˜í”Œë¥ ì€ $f_s' = L \cdot f_s$ì…ë‹ˆë‹¤.</p>
<h3 id="32">3.2 ì£¼íŒŒìˆ˜ ì˜ì—­ ë¶„ì„<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>ì—…ìƒ˜í”Œëœ ì‹ í˜¸ì˜ DTFTëŠ”:</p>
<p>$$X_u(e^{j\omega}) = X(e^{j\omega L})$$</p>
<p>ì´ëŠ” ìŠ¤í™íŠ¸ëŸ¼ì„ $L$ë°° ì••ì¶•í•˜ì—¬ $[0, 2\pi]$ ë²”ìœ„ì— $L-1$ê°œì˜ ìŠ¤í™íŠ¸ëŸ¼ ì´ë¯¸ì§€(ì´ë¯¸ì§•, imaging) ë³µì‚¬ë³¸ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Upsampling by L=3: Spectral Effect

Original X(e^jÏ‰):
         â•±â•²
        â•±  â•²
       â•±    â•²
â”€â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â”€â”€â”€
   -Ï€    0    Ï€

After â†‘3, X_u(e^jÏ‰) = X(e^(j3Ï‰)):

   â•±â•²    â•±â•²    â•±â•²       Images (unwanted copies)
  â•±  â•²  â•±  â•²  â•±  â•²
 â•±    â•²â•±    â•²â•±    â•²
â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²
-Ï€    -Ï€/3   0   Ï€/3    Ï€

Apply lowpass filter at Ï‰ = Ï€/3 to remove images!
</code></pre></div>

<h3 id="33">3.3 ì´ë¯¸ì§• ì‹œì—°<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_upsampling</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the spectral effects of upsampling.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Create a bandlimited signal</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># Hz</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Upsample: insert zeros</span>
    <span class="n">x_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">x_up</span><span class="p">[::</span><span class="n">L</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">fs_up</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">*</span> <span class="n">L</span>

    <span class="c1"># Apply anti-imaging (interpolation) filter</span>
    <span class="c1"># Lowpass at fs/2 with gain L</span>
    <span class="n">h_interp</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_up</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span>
    <span class="n">x_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x_up</span><span class="p">,</span> <span class="n">h_interp</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># Original</span>
    <span class="n">freq_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">30</span><span class="p">],</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span>
                     <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Original (fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_orig</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Upsampled (with zero-insertion, before filtering)</span>
    <span class="n">N_up</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_up</span><span class="p">)</span>
    <span class="n">freq_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_up</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_up</span><span class="p">)</span>
    <span class="n">X_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_up</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_up</span>

    <span class="n">t_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_up</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs_up</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t_up</span><span class="p">[:</span><span class="mi">120</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_up</span><span class="p">[:</span><span class="mi">120</span><span class="p">],</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                     <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Upsampled â†‘</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s1"> (zero-inserted)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_up</span><span class="p">,</span> <span class="n">X_up</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum (Imaging artifacts visible)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">fs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_up</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Interpolated (after anti-imaging filter)</span>
    <span class="n">X_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_interp</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_up</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_up</span><span class="p">[:</span><span class="mi">120</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_interp</span><span class="p">[:</span><span class="mi">120</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Interpolated (after LP filter, gain = </span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_up</span><span class="p">,</span> <span class="n">X_interp</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum (Images removed)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_up</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Upsampling by L = </span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;upsampling_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">demonstrate_upsampling</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4">4. ë°ì‹œë©”ì´ì…˜ ë° ë³´ê°„ í•„í„°<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ë°ì‹œë©”ì´ì…˜ í•„í„° ìš”êµ¬ì‚¬í•­<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>$M$ë§Œí¼ ë‹¤ìš´ìƒ˜í”Œë§í•˜ê¸° ì „ì—, <strong>ì•¤í‹°ì•¨ë¦¬ì–´ì‹± í•„í„°(anti-aliasing filter)</strong>ê°€ ì•¨ë¦¬ì–´ì‹±ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‹ í˜¸ ëŒ€ì—­í­ì„ ì œí•œí•´ì•¼ í•©ë‹ˆë‹¤:</p>
<p>$$H_\text{dec}(e^{j\omega}) = \begin{cases} 1, & |\omega| < \pi/M \\ 0, & \pi/M \leq |\omega| \leq \pi \end{cases}$$</p>
<p>ì™„ì „í•œ ë°ì‹œë©”ì´í„°:</p>
<p>$$y[n] = \left[\sum_{k} h[k] \cdot x[nM - k]\right]$$</p>
<p>ì°¸ê³ : ë¨¼ì € í•„í„°ë§í•œ í›„ ë‹¤ìš´ìƒ˜í”Œë§í•©ë‹ˆë‹¤. í•„í„°ëŠ” <strong>ë†’ì€</strong> ìƒ˜í”Œë¥ ì—ì„œ ë™ì‘í•©ë‹ˆë‹¤.</p>
<h3 id="42">4.2 ë³´ê°„ í•„í„° ìš”êµ¬ì‚¬í•­<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p>$L$ë§Œí¼ ì—…ìƒ˜í”Œë§í•œ í›„, <strong>ì•¤í‹°ì´ë¯¸ì§• í•„í„°(anti-imaging filter)</strong>ê°€ ìŠ¤í™íŠ¸ëŸ¼ ì´ë¯¸ì§€ë¥¼ ì œê±°í•©ë‹ˆë‹¤:</p>
<p>$$H_\text{interp}(e^{j\omega}) = \begin{cases} L, & |\omega| < \pi/L \\ 0, & \pi/L \leq |\omega| \leq \pi \end{cases}$$</p>
<p>ì´ë“(gain) $L$ì€ ì˜ ì‚½ì…ìœ¼ë¡œ ì¸í•œ ì§„í­ ê°ì†Œë¥¼ ë³´ìƒí•©ë‹ˆë‹¤.</p>
<h3 id="43">4.3 ë°ì‹œë©”ì´ì…˜ìš© í•„í„° ì„¤ê³„<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">design_decimation_filter</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">filter_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transition_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design anti-aliasing filter for decimation by factor M.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        M: decimation factor</span>
<span class="sd">        filter_order: FIR filter order (auto-computed if None)</span>
<span class="sd">        transition_width: normalized transition width (relative to pi/M)</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: FIR filter coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Cutoff frequency: pi/M (with some transition)</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">transition_width</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span>

    <span class="k">if</span> <span class="n">filter_order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Estimate order for 60 dB stopband attenuation</span>
        <span class="n">filter_order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">60</span> <span class="o">/</span> <span class="p">(</span><span class="mi">22</span> <span class="o">*</span> <span class="n">transition_width</span> <span class="o">/</span> <span class="n">M</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">filter_order</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span>

<span class="c1"># Design filters for different decimation factors</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">design_decimation_filter</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">filter_order</span><span class="o">=</span><span class="mi">129</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ï€/</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1"> (cutoff)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency (Ã—Ï€)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Anti-aliasing Filter for â†“</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Decimation Filter Design&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;decimation_filters.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5">5. ë…¸ë¸” í•­ë“±ì‹<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 í•­ë“±ì‹<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>ë…¸ë¸” í•­ë“±ì‹(Noble Identities)ì€ í•„í„°ë¥¼ ë¥  ë³€ê²½ ì—°ì‚° ì „í›„ë¡œ ì´ë™í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ íš¨ìœ¨ì ì¸ êµ¬í˜„ì— í•µì‹¬ì ì…ë‹ˆë‹¤:</p>
<p><strong>í•­ë“±ì‹ 1</strong> (ë‹¤ìš´ìƒ˜í”ŒëŸ¬):</p>
<p>$$\boxed{H(z^M) \rightarrow \downarrow M \equiv \downarrow M \rightarrow H(z)}$$</p>
<p>$M$ë§Œí¼ ë‹¤ìš´ìƒ˜í”Œë§ ë’¤ì˜ í•„í„° $H(z^M)$ì€ ë¨¼ì € ë‹¤ìš´ìƒ˜í”Œë§í•œ í›„ $H(z)$ë¡œ í•„í„°ë§í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•©ë‹ˆë‹¤.</p>
<p><strong>í•­ë“±ì‹ 2</strong> (ì—…ìƒ˜í”ŒëŸ¬):</p>
<p>$$\boxed{\uparrow L \rightarrow H(z^L) \equiv H(z) \rightarrow \uparrow L}$$</p>
<p>$L$ë§Œí¼ ì—…ìƒ˜í”Œë§ ë’¤ì˜ í•„í„° $H(z^L)$ì€ ë¨¼ì € $H(z)$ë¡œ í•„í„°ë§í•œ í›„ ì—…ìƒ˜í”Œë§í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">Noble</span><span class="w"> </span><span class="k">Identity</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">Downsampler</span><span class="p">)</span><span class="err">:</span>

<span class="w">  </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">                </span><span class="err">â‰¡</span>
<span class="w">  </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>

<span class="n">Noble</span><span class="w"> </span><span class="k">Identity</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Upsampler</span><span class="p">)</span><span class="err">:</span>

<span class="w">  </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">                </span><span class="err">â‰¡</span>
<span class="w">  </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
</code></pre></div>

<h3 id="52">5.2 ë…¸ë¸” í•­ë“±ì‹ì´ ì¤‘ìš”í•œ ì´ìœ <a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ê³„ì‚° ì ˆê°</strong>: í•„í„°ë¥¼ ë‚®ì€ ë¥  ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ ê³±ì…ˆ-ëˆ„ì‚°(multiply-accumulate) ì—°ì‚° ìˆ˜ê°€ $M$ (ë˜ëŠ” $L$)ë°° ê°ì†Œ</li>
<li><strong>í´ë¦¬í˜ì´ì¦ˆì˜ ê¸°ì´ˆ</strong>: í•­ë“±ì‹ì´ í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•¨</li>
<li><strong>ì£¼ì˜</strong>: í•­ë“±ì‹ì€ $H(z^M)$ ë˜ëŠ” $H(z^L)$ì—ë§Œ ì ìš©ë˜ë©°, ì„ì˜ì˜ $H(z)$ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_noble_identity</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify Noble Identity 1 by comparing both implementations.&quot;&quot;&quot;</span>
    <span class="c1"># Design a filter H(z)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># Original filter</span>

    <span class="c1"># Create H(z^M) by inserting M-1 zeros between coefficients</span>
    <span class="n">h_stretched</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">M</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">h_stretched</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>

    <span class="c1"># Input signal</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

    <span class="c1"># Implementation 1: H(z^M) then â†“M</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_stretched</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
    <span class="n">y1_down</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>

    <span class="c1"># Implementation 2: â†“M then H(z)</span>
    <span class="n">x_down</span> <span class="o">=</span> <span class="n">x</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x_down</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>

    <span class="c1"># Compare (trim to same length)</span>
    <span class="n">min_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y1_down</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1_down</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span> <span class="o">-</span> <span class="n">y2</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Noble Identity verification (M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max error: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Operations saved: </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2">x fewer multiplies in low-rate version&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y1_down</span><span class="p">[:</span><span class="n">min_len</span><span class="p">],</span> <span class="n">y2</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span>

<span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">verify_noble_identity</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6">6. í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ê°œë…<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p><strong>í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´(polyphase decomposition)</strong>ëŠ” í•„í„°ë¥¼ $M$ (ë˜ëŠ” $L$)ê°œì˜ ì„œë¸Œí•„í„°ë¡œ ë¶„í• í•˜ë©°, ê° ì„œë¸Œí•„í„°ëŠ” ë” ë‚®ì€ ìƒ˜í”Œë¥ ì—ì„œ ë™ì‘í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ì¤‘ë¥  í•„í„°ë§ì˜ ê°€ì¥ íš¨ìœ¨ì ì¸ êµ¬í˜„ ë°©ë²•ì…ë‹ˆë‹¤.</p>
<p>í•„í„° $H(z) = \sum_{n=0}^{N-1} h[n] z^{-n}$ì— ëŒ€í•´, Type I í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´ëŠ”:</p>
<p>$$H(z) = \sum_{k=0}^{M-1} z^{-k} E_k(z^M)$$</p>
<p>ì—¬ê¸°ì„œ ê° í´ë¦¬í˜ì´ì¦ˆ ì„±ë¶„ì€:</p>
<p>$$E_k(z) = \sum_{n=0}^{\lfloor (N-1)/M \rfloor} h[nM + k] z^{-n}, \quad k = 0, 1, \ldots, M-1$$</p>
<h3 id="62">6.2 í´ë¦¬í˜ì´ì¦ˆ ë°ì‹œë©”ì´ì…˜<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Standard</span><span class="w"> </span><span class="nl">Decimation</span><span class="p">:</span><span class="w">                  </span><span class="n">Polyphase</span><span class="w"> </span><span class="nl">Decimation</span><span class="p">:</span>
<span class="w">                                      </span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">efficient</span><span class="err">!</span><span class="p">)</span>

<span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w">         </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”¬â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Eâ‚€</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”¬</span>
<span class="w">                                            </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="w">  </span><span class="n">Computes</span><span class="w"> </span><span class="n">M</span><span class="err">Â·</span><span class="n">N</span><span class="w">                              </span><span class="err">â”œâ”€â–¶</span><span class="w"> </span><span class="n">z</span><span class="err">â»</span><span class="n">Â¹</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Eâ‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”¤</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Î£</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">  </span><span class="n">multiplies</span><span class="w"> </span><span class="n">per</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="w">  </span><span class="k">output</span><span class="w"> </span><span class="n">sample</span><span class="w">                             </span><span class="err">â”œâ”€â–¶</span><span class="w"> </span><span class="n">z</span><span class="err">â»</span><span class="n">Â²</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Eâ‚‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”¤</span>
<span class="w">                                            </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="w">                                            </span><span class="err">â””â”€â–¶</span><span class="w"> </span><span class="n">z</span><span class="err">â»</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="err">â”€â–¶â†“</span><span class="n">M</span><span class="err">â”€â–¶</span><span class="n">E_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w"> </span><span class="err">â”˜</span>

<span class="w">                                      </span><span class="n">Computes</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">multiplies</span><span class="w"> </span><span class="n">per</span>
<span class="w">                                      </span><span class="k">output</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="p">(</span><span class="n">M</span><span class="err">Ã—</span><span class="w"> </span><span class="n">savings</span><span class="err">!</span><span class="p">)</span>
</code></pre></div>

<h3 id="63">6.3 í´ë¦¬í˜ì´ì¦ˆ ë³´ê°„<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Standard</span><span class="w"> </span><span class="nl">Interpolation</span><span class="p">:</span><span class="w">               </span><span class="n">Polyphase</span><span class="w"> </span><span class="nl">Interpolation</span><span class="p">:</span>

<span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w">          </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”¬â”€â–¶</span><span class="w"> </span><span class="n">Râ‚€</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”¬</span>
<span class="w">                                             </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="w">  </span><span class="n">Computes</span><span class="w"> </span><span class="n">L</span><span class="err">Â·</span><span class="n">N</span><span class="w">                               </span><span class="err">â”œâ”€â–¶</span><span class="w"> </span><span class="n">Râ‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">z</span><span class="err">â»</span><span class="n">Â¹</span><span class="err">â”¤â”€â–¶</span><span class="w"> </span><span class="n">Î£</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">  </span><span class="n">multiplies</span><span class="w"> </span><span class="n">per</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="w">  </span><span class="k">input</span><span class="w"> </span><span class="n">sample</span><span class="w">                               </span><span class="err">â”œâ”€â–¶</span><span class="w"> </span><span class="n">Râ‚‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">z</span><span class="err">â»</span><span class="n">Â²</span><span class="err">â”¤</span>
<span class="w">                                             </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="w">                                             </span><span class="err">â””â”€â–¶</span><span class="w"> </span><span class="n">R_</span><span class="err">{</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w"> </span><span class="err">â”€â–¶â†‘</span><span class="n">L</span><span class="err">â”€â–¶</span><span class="n">z</span><span class="err">â»</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="err">â”˜</span>
</code></pre></div>

<h3 id="64">6.4 êµ¬í˜„<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PolyphaseDecimator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Efficient decimation using polyphase decomposition.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            h: prototype lowpass filter coefficients</span>
<span class="sd">            M: decimation factor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="c1"># Pad h to a multiple of M</span>
        <span class="n">pad_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span>
        <span class="n">h_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">h</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pad_len</span><span class="p">)])</span>

        <span class="c1"># Polyphase decomposition: E_k[n] = h[nM + k]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">E_k</span> <span class="o">=</span> <span class="n">h_padded</span><span class="p">[</span><span class="n">k</span><span class="p">::</span><span class="n">M</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_k</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subfilter_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decimate input signal x.&quot;&quot;&quot;</span>
        <span class="n">N_out</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span>

        <span class="c1"># Create polyphase input components</span>
        <span class="c1"># Trim to multiple of M</span>
        <span class="n">x_trimmed</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="n">N_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">]</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_out</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfilter_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">):</span>
            <span class="c1"># k-th polyphase input: x[nM + k] (already at low rate)</span>
            <span class="n">x_k</span> <span class="o">=</span> <span class="n">x_trimmed</span><span class="p">[</span><span class="n">k</span><span class="p">::</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">]</span>
            <span class="c1"># Filter with k-th polyphase component</span>
            <span class="n">y_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x_k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">y</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_k</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">y_k</span>

        <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N_out</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print polyphase decomposition info.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decimation factor: M = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original filter length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of polyphase filters: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subfilter length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">subfilter_len</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computational savings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PolyphaseInterpolator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Efficient interpolation using polyphase decomposition.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            h: prototype lowpass filter coefficients (with gain L)</span>
<span class="sd">            L: interpolation factor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="c1"># Pad h to a multiple of L</span>
        <span class="n">pad_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">%</span> <span class="n">L</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span>
        <span class="n">h_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">h</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pad_len</span><span class="p">)])</span>

        <span class="c1"># Polyphase decomposition for interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
            <span class="n">R_k</span> <span class="o">=</span> <span class="n">h_padded</span><span class="p">[</span><span class="n">k</span><span class="p">::</span><span class="n">L</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R_k</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subfilter_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate input signal x.&quot;&quot;&quot;</span>
        <span class="n">N_in</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">N_out</span> <span class="o">=</span> <span class="n">N_in</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_out</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subfilter_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">):</span>
            <span class="c1"># Filter with k-th polyphase component</span>
            <span class="n">y_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyphase_filters</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="c1"># Place at correct positions in output</span>
            <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">::</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">][:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">y_k</span>

        <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N_out</span><span class="p">]</span>


<span class="c1"># Verify polyphase implementation</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="c1"># Design anti-aliasing filter</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span>

<span class="c1"># Input signal</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Standard decimation</span>
<span class="n">x_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">y_standard</span> <span class="o">=</span> <span class="n">x_filtered</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>

<span class="c1"># Polyphase decimation</span>
<span class="n">decimator</span> <span class="o">=</span> <span class="n">PolyphaseDecimator</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">decimator</span><span class="o">.</span><span class="n">get_info</span><span class="p">()</span>
<span class="n">y_polyphase</span> <span class="o">=</span> <span class="n">decimator</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Compare</span>
<span class="n">min_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_standard</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_polyphase</span><span class="p">))</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_standard</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_polyphase</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Max error between standard and polyphase: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot comparison</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_standard</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_polyphase</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Polyphase&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Decimation Output Comparison&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_standard</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_polyphase</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]),</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absolute Difference (max: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;polyphase_verification.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-lm">7.1 L/Mì— ì˜í•œ ë¥  ë³€ê²½<a class="header-link" href="#71-lm" title="Permanent link">&para;</a></h3>
<p>ìƒ˜í”Œë¥ ì„ ìœ ë¦¬ìˆ˜ ì¸ìˆ˜ $L/M$ìœ¼ë¡œ ë³€í™˜í•˜ë ¤ë©´:</p>
<ol>
<li><strong>ì—…ìƒ˜í”Œë§</strong>: $L$ë§Œí¼ ($L-1$ê°œì˜ ì˜ ì‚½ì…)</li>
<li><strong>í•„í„°ë§</strong>: ì°¨ë‹¨ ì£¼íŒŒìˆ˜ $\omega_c = \min(\pi/L, \pi/M)$ì˜ ì €ì—­í†µê³¼ í•„í„° ì ìš©</li>
<li><strong>ë‹¤ìš´ìƒ˜í”Œë§</strong>: $M$ë§Œí¼ ($M$ë²ˆì§¸ ìƒ˜í”Œë§ˆë‹¤ ìœ ì§€)</li>
</ol>
<p>ì—°ì‚° ìˆœì„œê°€ ì¤‘ìš”í•©ë‹ˆë‹¤: <strong>ë¨¼ì € ë³´ê°„í•œ í›„ ë°ì‹œë©”ì´ì…˜</strong>í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">Rational</span><span class="w"> </span><span class="n">Rate</span><span class="w"> </span><span class="n">Conversion</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="err">:</span>

<span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">L</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">  </span><span class="n">fs</span><span class="w">              </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">Ï€</span><span class="o">/</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Ï€</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="w">       </span><span class="n">fs</span><span class="err">&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="n">L</span><span class="o">/</span><span class="n">M</span>
</code></pre></div>

<h3 id="72-441-khz-48-khz">7.2 ì˜ˆì œ: 44.1 kHzì—ì„œ 48 kHzë¡œ ë³€í™˜<a class="header-link" href="#72-441-khz-48-khz" title="Permanent link">&para;</a></h3>
<p>CD ì˜¤ë””ì˜¤(44.1 kHz)ë¥¼ ì „ë¬¸ ì˜¤ë””ì˜¤(48 kHz)ë¡œ ë³€í™˜:</p>
<p>$$\frac{48000}{44100} = \frac{480}{441} = \frac{160}{147}$$</p>
<p>ë”°ë¼ì„œ $L = 160$, $M = 147$ì…ë‹ˆë‹¤.</p>
<h3 id="73">7.3 êµ¬í˜„<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rational_rate_convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">filter_order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert sampling rate by rational factor L/M.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        L: interpolation factor</span>
<span class="sd">        M: decimation factor</span>
<span class="sd">        filter_order: FIR filter order (auto if None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        y: resampled signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filter_order</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># Design lowpass filter at min(pi/L, pi/M)</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">L</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">filter_order</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span>  <span class="c1"># Gain of L for interpolation</span>

    <span class="c1"># Step 1: Upsample by L</span>
    <span class="n">x_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">x_up</span><span class="p">[::</span><span class="n">L</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

    <span class="c1"># Step 2: Filter</span>
    <span class="n">x_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x_up</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="c1"># Step 3: Downsample by M</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x_filtered</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">y</span>

<span class="c1"># Example: 44100 to 48000 Hz (simplified to L=160, M=147)</span>
<span class="c1"># For demonstration, use smaller factors: 48/44.1 â‰ˆ 320/294 = 160/147</span>
<span class="c1"># Simplify further for demo: approximate as 8/7 â‰ˆ 1.143</span>
<span class="n">L</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">147</span>

<span class="c1"># Create test signal at 44100 Hz</span>
<span class="n">fs_in</span> <span class="o">=</span> <span class="mi">44100</span>
<span class="n">fs_out</span> <span class="o">=</span> <span class="n">fs_in</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">M</span>
<span class="n">t_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_in</span><span class="p">)</span>

<span class="c1"># Test with 1 kHz sine</span>
<span class="n">f_test</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_test</span> <span class="o">*</span> <span class="n">t_in</span><span class="p">)</span>

<span class="c1"># Resample</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rational_rate_convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">filter_order</span><span class="o">=</span><span class="mi">2001</span><span class="p">)</span>

<span class="c1"># Also use scipy.signal.resample for comparison</span>
<span class="n">y_scipy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">M</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples at </span><span class="si">{</span><span class="n">fs_in</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples at </span><span class="si">{</span><span class="n">fs_out</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate conversion factor: </span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">L</span><span class="o">/</span><span class="n">M</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">fs_out</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

<span class="c1"># Verify frequency preservation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Time domain</span>
<span class="n">t_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs_out</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_in</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Input (</span><span class="si">{</span><span class="n">fs_in</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_out</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="n">M</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">y</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="n">M</span><span class="p">)],</span> <span class="s1">&#39;r-o&#39;</span><span class="p">,</span>
              <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Output (</span><span class="si">{</span><span class="n">fs_out</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample Rate Conversion: Time Domain&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Frequency domain</span>
<span class="n">N_in</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">N_out</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">freq_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_in</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_in</span><span class="p">)</span>
<span class="n">freq_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_out</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_out</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_in</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_out</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_in</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_out</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Output&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;rational_conversion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8">8. ë‹¤ë‹¨ê³„ ë¥  ë³€í™˜<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ë™ê¸°<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>í° ë¥  ë³€ê²½ ì¸ìˆ˜(ì˜ˆ: $M = 100$)ì˜ ê²½ìš°, ë‹¨ì¼ ë‹¨ê³„ ë°ì‹œë©”ì´í„°ëŠ” ë§¤ìš° ë‚ ì¹´ë¡œìš´(ê³ ì°¨) ì•¤í‹°ì•¨ë¦¬ì–´ì‹± í•„í„°ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. <strong>ë‹¤ë‹¨ê³„ ë°ì‹œë©”ì´ì…˜(Multistage decimation)</strong>ì€ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ë°ì‹œë©”ì´ì…˜ ë‹¨ê³„ë¥¼ ì—°ì†ìœ¼ë¡œ ì—°ê²°í•˜ì—¬ ì´ ê³„ì‚° ë¹„ìš©ì„ ì¤„ì…ë‹ˆë‹¤.</p>
<p>$M = M_1 \cdot M_2 \cdot \ldots \cdot M_K$ì´ë©´, ê° ë‹¨ê³„ì—ì„œ ë” ë‹¨ìˆœí•œ í•„í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Single-stage: x â”€â”€â–¶ H(z) â”€â”€â–¶ â†“100 â”€â”€â–¶ y
              Very sharp filter, high order

Multistage:   x â”€â”€â–¶ Hâ‚(z) â”€â”€â–¶ â†“10 â”€â”€â–¶ Hâ‚‚(z) â”€â”€â–¶ â†“10 â”€â”€â–¶ y
              Two moderate filters, lower total order
</code></pre></div>

<h3 id="82">8.2 ìµœì  ë‹¨ê³„ í• ë‹¹<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<p>$M$ì˜ ìµœì  ì¸ìˆ˜ë¶„í•´ëŠ” ì‚¬ì–‘ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì¼ë°˜ì ì¸ íœ´ë¦¬ìŠ¤í‹±ì€ ì¸ìˆ˜ë¥¼ ê°€ëŠ¥í•œ í•œ ê· ë“±í•˜ê²Œ ë¶„ë°°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<p>$M = M_1 \cdot M_2$ì˜ ê²½ìš°:
- ë‹¨ê³„ 1 í•„í„°: ìƒ˜í”Œë¥  $f_s$ì—ì„œ $\pi / M$ì— ì°¨ë‹¨ ì£¼íŒŒìˆ˜
- ë‹¨ê³„ 2 í•„í„°: ìƒ˜í”Œë¥  $f_s / M_1$ì—ì„œ $\pi / M_2$ì— ì°¨ë‹¨ ì£¼íŒŒìˆ˜</p>
<h3 id="83">8.3 êµ¬í˜„ ë° ë¹„êµ<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multistage_decimation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">factors</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multistage decimation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        factors: list of decimation factors [M1, M2, ...]</span>
<span class="sd">        fs: input sampling frequency</span>

<span class="sd">    Returns:</span>
<span class="sd">        y: decimated signal</span>
<span class="sd">        total_ops: estimated total multiply operations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">current_fs</span> <span class="o">=</span> <span class="n">fs</span>
    <span class="n">total_filter_taps</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
        <span class="c1"># Design filter for this stage</span>
        <span class="n">overall_M_remaining</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">factors</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">overall_M_remaining</span>

        <span class="c1"># Estimate filter order (60 dB attenuation)</span>
        <span class="n">transition</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="o">*</span> <span class="mf">0.2</span>
        <span class="n">numtaps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">60</span> <span class="o">/</span> <span class="p">(</span><span class="mi">22</span> <span class="o">*</span> <span class="n">transition</span><span class="p">)))</span> <span class="o">|</span> <span class="mi">1</span>  <span class="c1"># Ensure odd</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">)</span>
        <span class="n">total_filter_taps</span> <span class="o">+=</span> <span class="n">numtaps</span>

        <span class="c1"># Filter and decimate</span>
        <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y_filtered</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>
        <span class="n">current_fs</span> <span class="o">/=</span> <span class="n">M</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Stage </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: â†“</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2">, filter order=</span><span class="si">{</span><span class="n">numtaps</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;rate=</span><span class="si">{</span><span class="n">current_fs</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> Hz, output samples=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">total_filter_taps</span>

<span class="c1"># Compare single-stage vs multistage for M=16</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">16000</span>
<span class="n">M_total</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Single-stage decimation (M=16):&quot;</span><span class="p">)</span>
<span class="n">h_single</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">513</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">M_total</span><span class="p">)</span>
<span class="n">x_single</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_single</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)[::</span><span class="n">M_total</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Filter order: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">h_single</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">, output samples: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x_single</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Two-stage decimation (4Ã—4):&quot;</span><span class="p">)</span>
<span class="n">y_2stage</span><span class="p">,</span> <span class="n">taps_2</span> <span class="o">=</span> <span class="n">multistage_decimation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">fs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Three-stage decimation (2Ã—2Ã—4):&quot;</span><span class="p">)</span>
<span class="n">y_3stage</span><span class="p">,</span> <span class="n">taps_3</span> <span class="o">=</span> <span class="n">multistage_decimation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">fs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Four-stage decimation (2Ã—2Ã—2Ã—2):&quot;</span><span class="p">)</span>
<span class="n">y_4stage</span><span class="p">,</span> <span class="n">taps_4</span> <span class="o">=</span> <span class="n">multistage_decimation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Compare spectra</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fs_out</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">M_total</span>

<span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Single stage (â†“16)&#39;</span><span class="p">,</span> <span class="n">x_single</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Two stages (â†“4, â†“4)&#39;</span><span class="p">,</span> <span class="n">y_2stage</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Three stages (â†“2, â†“2, â†“4)&#39;</span><span class="p">,</span> <span class="n">y_3stage</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Four stages (â†“2, â†“2, â†“2, â†“2)&#39;</span><span class="p">,</span> <span class="n">y_4stage</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
    <span class="n">N_y</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N_y</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_out</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">N_y</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Multistage Decimation Comparison (M=</span><span class="si">{</span><span class="n">M_total</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multistage_decimation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9">9. í•„í„° ë±…í¬<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91-">9.1 ë¶„ì„-í•©ì„± í•„í„° ë±…í¬<a class="header-link" href="#91-" title="Permanent link">&para;</a></h3>
<p><strong>í•„í„° ë±…í¬(filter bank)</strong>ëŠ” ì‹ í˜¸ë¥¼ ì—¬ëŸ¬ ì£¼íŒŒìˆ˜ ì„œë¸Œë°´ë“œë¡œ ë¶„í• í•˜ê³  ì¬êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì˜¤ë””ì˜¤ ì½”ë”©(MP3, AAC), ì´ë¯¸ì§€ ì••ì¶•(JPEG2000), ê·¸ë¦¬ê³  ë‹¤ë¥¸ ë§ì€ ì‘ìš©ì˜ ê¸°ë°˜ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">Analysis</span><span class="w"> </span><span class="p">(</span><span class="n">Decomposition</span><span class="p">)</span><span class="err">:</span><span class="w">              </span><span class="n">Synthesis</span><span class="w"> </span><span class="p">(</span><span class="n">Reconstruction</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="err">â”Œâ”€</span><span class="w"> </span><span class="n">Hâ‚€</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">vâ‚€</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Gâ‚€</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”</span>
<span class="w">        </span><span class="err">â”‚</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â”¤â”€</span><span class="w"> </span><span class="n">Hâ‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">vâ‚</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">Gâ‚</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">â”€â”€â”¼â”€â”€â–¶</span><span class="w"> </span><span class="n">Î£</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">x</span><span class="err">Ì‚</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">        </span><span class="err">â”‚</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="w">        </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">H_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">v_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="n">M</span><span class="w"> </span><span class="err">â”€â–¶</span><span class="w"> </span><span class="n">G_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}â”˜</span>

<span class="n">Analysis</span><span class="w"> </span><span class="nl">filters</span><span class="p">:</span><span class="w"> </span><span class="n">Hâ‚€</span><span class="p">,</span><span class="w"> </span><span class="n">Hâ‚</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">H_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span>
<span class="n">Synthesis</span><span class="w"> </span><span class="nl">filters</span><span class="p">:</span><span class="w"> </span><span class="n">Gâ‚€</span><span class="p">,</span><span class="w"> </span><span class="n">Gâ‚</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">G_</span><span class="err">{</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="err">}</span>
</code></pre></div>

<p><strong>ì™„ì „ ì¬êµ¬ì„±(Perfect Reconstruction, PR)</strong>ì„ ìœ„í•œ ì¡°ê±´:</p>
<p>$$\hat{X}(z) = X(z) \quad \text{(with some delay)}$$</p>
<h3 id="92-2">9.2 2ì±„ë„ í•„í„° ë±…í¬<a class="header-link" href="#92-2" title="Permanent link">&para;</a></h3>
<p>ê°€ì¥ ë‹¨ìˆœí•œ ê²½ìš°: ì €ì—­í†µê³¼($H_0$)ì™€ ê³ ì—­í†µê³¼($H_1$) í•„í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” $M = 2$.</p>
<p><strong>ì™„ì „ ì¬êµ¬ì„± ì¡°ê±´ (2ì±„ë„):</strong></p>
<ol>
<li><strong>ì•¨ë¦¬ì–´ì‹± ì—†ìŒ</strong>: $H_0(-z)G_0(z) + H_1(-z)G_1(z) = 0$</li>
<li><strong>ì™œê³¡ ì—†ìŒ</strong>: $H_0(z)G_0(z) + H_1(z)G_1(z) = 2z^{-d}$ (ìˆœìˆ˜ ì§€ì—°)</li>
</ol>
<h3 id="93-qmf">9.3 ì§êµ ë¯¸ëŸ¬ í•„í„° (QMF)<a class="header-link" href="#93-qmf" title="Permanent link">&para;</a></h3>
<p>QMF ë±…í¬ì—ì„œ ê³ ì—­í†µê³¼ í•„í„°ëŠ” ì €ì—­í†µê³¼ í•„í„°ë¥¼ ë³€ì¡°í•˜ì—¬ ì–»ìŠµë‹ˆë‹¤:</p>
<p>$$H_1(z) = H_0(-z) \quad \Rightarrow \quad h_1[n] = (-1)^n h_0[n]$$</p>
<p>ì´ëŠ” ì•¨ë¦¬ì–´ì‹± ì†Œê±° ì¡°ê±´ì„ ìë™ìœ¼ë¡œ ë§Œì¡±í•©ë‹ˆë‹¤. í•©ì„± í•„í„°ì˜ ê²½ìš°:</p>
<p>$$G_0(z) = H_0(z), \quad G_1(z) = -H_1(z) = -H_0(-z)$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">qmf_filter_bank</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Two-channel QMF analysis-synthesis filter bank.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        h0: lowpass analysis filter</span>
<span class="sd">        x: input signal</span>

<span class="sd">    Returns:</span>
<span class="sd">        x_hat: reconstructed signal</span>
<span class="sd">        v0, v1: subband signals</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h0</span><span class="p">)</span>

    <span class="c1"># Analysis filters</span>
    <span class="c1"># h0: lowpass (given)</span>
    <span class="c1"># h1: highpass (modulated version)</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h0</span><span class="p">)))</span>

    <span class="c1"># Synthesis filters (for QMF)</span>
    <span class="n">g0</span> <span class="o">=</span> <span class="n">h0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="o">-</span><span class="n">h1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Analysis: filter then downsample</span>
    <span class="n">x_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
    <span class="n">x_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>

    <span class="c1"># Downsample by 2</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="n">x_low</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">x_high</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Synthesis: upsample then filter</span>
    <span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">u0</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">u1</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span>

    <span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>

    <span class="c1"># Sum</span>
    <span class="n">min_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>
    <span class="n">x_hat</span> <span class="o">=</span> <span class="n">y0</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span> <span class="o">+</span> <span class="n">y1</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">x_hat</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span>

<span class="c1"># Design QMF lowpass filter</span>
<span class="n">h0</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>

<span class="c1"># Test with a signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">x_hat</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">qmf_filter_bank</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Compare</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Original</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="mi">300</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Subbands</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v0</span><span class="p">[:</span><span class="mi">150</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Lowpass Subband (v0)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v1</span><span class="p">[:</span><span class="mi">150</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Highpass Subband (v1)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Reconstructed</span>
<span class="n">delay</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Account for filter delay</span>
<span class="n">x_hat_aligned</span> <span class="o">=</span> <span class="n">x_hat</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="mi">300</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_hat_aligned</span><span class="p">[:</span><span class="mi">300</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstruction Comparison&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Reconstruction error</span>
<span class="n">recon_error</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hat_aligned</span><span class="p">))]</span> <span class="o">-</span> <span class="n">x_hat_aligned</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hat_aligned</span><span class="p">))]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recon_error</span><span class="p">[:</span><span class="mi">300</span><span class="p">],</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reconstruction Error (max: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">recon_error</span><span class="p">))</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Spectra</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Spectrum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Two-Channel QMF Filter Bank&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;qmf_filter_bank.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="94-cqf">9.4 ì¼¤ë ˆ ì§êµ í•„í„° (CQF)<a class="header-link" href="#94-cqf" title="Permanent link">&para;</a></h3>
<p>2ì±„ë„ ì‹œìŠ¤í…œì—ì„œ ì™„ì „ ì¬êµ¬ì„±ì„ ìœ„í•´ <strong>CQF(Conjugate Quadrature Filters)</strong>(Johnston í•„í„°ë¼ê³ ë„ í•¨)ëŠ” ë‹¤ìŒì„ ë§Œì¡±í•©ë‹ˆë‹¤:</p>
<p>$$|H_0(e^{j\omega})|^2 + |H_0(e^{j(\omega - \pi)})|^2 = 1$$</p>
<p>ì´ê²ƒì´ <strong>ì „ë ¥ ìƒë³´(power complementary)</strong> ì¡°ê±´ìœ¼ë¡œ, ì •í™•í•œ ì™„ì „ ì¬êµ¬ì„±ì„ ì´ëŒì–´ëƒ…ë‹ˆë‹¤.</p>
<hr />
<h2 id="10">10. ì‘ìš©<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 ì˜¤ë””ì˜¤ ìƒ˜í”Œë¥  ë³€í™˜<a class="header-link" href="#101" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">audio_sample_rate_conversion</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate audio sample rate conversion.&quot;&quot;&quot;</span>
    <span class="c1"># Simulate a simple audio signal at 44100 Hz</span>
    <span class="n">fs_in</span> <span class="o">=</span> <span class="mi">44100</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_in</span><span class="p">)</span>

    <span class="c1"># Chirp signal (frequency sweep)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">f1</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;logarithmic&#39;</span><span class="p">)</span>

    <span class="c1"># Convert to 48000 Hz using scipy.signal.resample_poly</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span>  <span class="c1"># Upsample factor</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">147</span>  <span class="c1"># Downsample factor (48000/44100 = 160/147)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">fs_out</span> <span class="o">=</span> <span class="n">fs_in</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">M</span>

    <span class="c1"># Convert to 22050 Hz (downsample by 2)</span>
    <span class="n">y_half</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fs_half</span> <span class="o">=</span> <span class="n">fs_in</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Spectrograms</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">fs_sig</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">fs_in</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Original (</span><span class="si">{</span><span class="n">fs_in</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs_out</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Resampled to </span><span class="si">{</span><span class="n">fs_out</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_half</span><span class="p">,</span> <span class="n">fs_half</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Resampled to </span><span class="si">{</span><span class="n">fs_half</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">),</span>
    <span class="p">]:</span>
        <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs_sig</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                       <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Audio Sample Rate Conversion&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;audio_src.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">audio_sample_rate_conversion</span><span class="p">()</span>
</code></pre></div>

<h3 id="102-adc">10.2 ì‹œê·¸ë§ˆ-ë¸íƒ€ ADC ê°œë…<a class="header-link" href="#102-adc" title="Permanent link">&para;</a></h3>
<p>ì‹œê·¸ë§ˆ-ë¸íƒ€($\Sigma\Delta$) ADCëŠ” ì˜¤ë²„ìƒ˜í”Œë§(oversampling)ê³¼ ì¡ìŒ ì„±í˜•(noise shaping)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ì˜¤ë²„ìƒ˜í”Œë§</strong>: ë¥  $f_s = R \cdot f_\text{Nyquist}$ë¡œ ìƒ˜í”Œë§ (ì—¬ê¸°ì„œ $R$ì€ ì˜¤ë²„ìƒ˜í”Œë§ ë¹„ìœ¨, ì˜ˆ: 64 ë˜ëŠ” 256)</li>
<li><strong>ì¡ìŒ ì„±í˜•</strong>: ì–‘ìí™” ì¡ìŒì„ ê³ ì£¼íŒŒ ì˜ì—­ìœ¼ë¡œ ë°€ì–´ëƒ„</li>
<li><strong>ë°ì‹œë©”ì´ì…˜</strong>: ë‹¤ì¤‘ë¥  ì²´ì¸ì„ ì‚¬ìš©í•˜ì—¬ ë‚˜ì´í€´ìŠ¤íŠ¸(Nyquist) ë¥ ì—ì„œ ìµœì¢… ì¶œë ¥ íšë“</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigma_delta_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simplified sigma-delta ADC demonstration.&quot;&quot;&quot;</span>
    <span class="c1"># Analog-like signal (oversampled)</span>
    <span class="n">OSR</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># Oversampling ratio</span>
    <span class="n">fs_nyquist</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">fs_oversampled</span> <span class="o">=</span> <span class="n">fs_nyquist</span> <span class="o">*</span> <span class="n">OSR</span>

    <span class="n">duration</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_oversampled</span><span class="p">)</span>

    <span class="c1"># Clean signal</span>
    <span class="n">f_sig</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_sig</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># First-order sigma-delta modulator</span>
    <span class="n">y_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">integrator</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">integrator</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_sd</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">y_sd</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">integrator</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mf">1.0</span>

    <span class="c1"># Decimate the 1-bit stream</span>
    <span class="c1"># Use a CIC-like filter (simple averaging)</span>
    <span class="n">h_dec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">OSR</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">OSR</span><span class="p">)</span>
    <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_sd</span><span class="p">,</span> <span class="n">h_dec</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">y_decimated</span> <span class="o">=</span> <span class="n">y_filtered</span><span class="p">[::</span><span class="n">OSR</span><span class="p">]</span>

    <span class="n">fs_out</span> <span class="o">=</span> <span class="n">fs_oversampled</span> <span class="o">/</span> <span class="n">OSR</span>
    <span class="n">t_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_decimated</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs_out</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Original signal</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input Signal (</span><span class="si">{</span><span class="n">f_sig</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Sigma-delta output (1-bit)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">y_sd</span><span class="p">[:</span><span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sigma-Delta 1-bit Output (fs = </span><span class="si">{</span><span class="n">fs_oversampled</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> kHz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Decimated output</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_out</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_out</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>
                 <span class="n">y_decimated</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_decimated</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decimated Output (fs = </span><span class="si">{</span><span class="n">fs_out</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> kHz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Sigma-Delta ADC: Oversampling + Decimation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sigma_delta.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">sigma_delta_demo</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-python">11. Python êµ¬í˜„<a class="header-link" href="#11-python" title="Permanent link">&para;</a></h2>
<h3 id="111-scipysignal">11.1 ë‹¤ì¤‘ë¥  ì²˜ë¦¬ë¥¼ ìœ„í•œ scipy.signal ì‚¬ìš©<a class="header-link" href="#111-scipysignal" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scipy.signal provides convenient functions for multirate processing</span>

<span class="c1"># 1. Simple decimation</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">1000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5000</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Decimate by 4 (includes anti-aliasing filter)</span>
<span class="n">y_dec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">decimate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;fir&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decimated: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_dec</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>

<span class="c1"># 2. Resample to arbitrary rate</span>
<span class="n">y_resample</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">44100</span> <span class="o">/</span> <span class="mi">48000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resampled 48k-&gt;44.1k: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_resample</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>

<span class="c1"># 3. Polyphase resampling (most efficient)</span>
<span class="n">y_poly</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>  <span class="c1"># 48000 * 441/480 = 44100</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polyphase resample: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_poly</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>

<span class="c1"># 4. Upfirdn: combined upsample-filter-downsample</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">y_upfirdn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">upfirdn</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">up</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">down</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;upfirdn (up=3, down=4): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_upfirdn</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="112">11.2 ì™„ì „í•œ ë‹¤ì¤‘ë¥  ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸<a class="header-link" href="#112" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multirate_pipeline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs_in</span><span class="p">,</span> <span class="n">fs_out</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Complete sample rate conversion pipeline.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        fs_in: input sampling rate</span>
<span class="sd">        fs_out: output sampling rate</span>

<span class="sd">    Returns:</span>
<span class="sd">        y: resampled signal</span>
<span class="sd">        info: processing information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">gcd</span>

    <span class="c1"># Find rational approximation</span>
    <span class="c1"># Use exact ratio if both are integers</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fs_out</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs_in</span><span class="p">))</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs_out</span><span class="p">)</span> <span class="o">//</span> <span class="n">g</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs_in</span><span class="p">)</span> <span class="o">//</span> <span class="n">g</span>

    <span class="c1"># Simplify if factors are too large</span>
    <span class="n">max_factor</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="k">while</span> <span class="n">L</span> <span class="o">&gt;</span> <span class="n">max_factor</span> <span class="ow">or</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="n">max_factor</span><span class="p">:</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">g2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">//=</span> <span class="n">g2</span>
            <span class="n">M</span> <span class="o">//=</span> <span class="n">g2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Approximate</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">fs_out</span> <span class="o">/</span> <span class="n">fs_in</span>
            <span class="n">best_L</span><span class="p">,</span> <span class="n">best_M</span><span class="p">,</span> <span class="n">best_error</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">test_M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_factor</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">test_L</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">ratio</span> <span class="o">*</span> <span class="n">test_M</span><span class="p">)</span>
                <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">test_L</span> <span class="o">&lt;=</span> <span class="n">max_factor</span><span class="p">:</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">test_L</span> <span class="o">/</span> <span class="n">test_M</span> <span class="o">-</span> <span class="n">ratio</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="n">best_error</span><span class="p">:</span>
                        <span class="n">best_L</span><span class="p">,</span> <span class="n">best_M</span><span class="p">,</span> <span class="n">best_error</span> <span class="o">=</span> <span class="n">test_L</span><span class="p">,</span> <span class="n">test_M</span><span class="p">,</span> <span class="n">error</span>
            <span class="n">L</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">best_L</span><span class="p">,</span> <span class="n">best_M</span>
            <span class="k">break</span>

    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="n">L</span><span class="p">,</span>
        <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="n">M</span><span class="p">,</span>
        <span class="s1">&#39;actual_ratio&#39;</span><span class="p">:</span> <span class="n">L</span> <span class="o">/</span> <span class="n">M</span><span class="p">,</span>
        <span class="s1">&#39;desired_ratio&#39;</span><span class="p">:</span> <span class="n">fs_out</span> <span class="o">/</span> <span class="n">fs_in</span><span class="p">,</span>
        <span class="s1">&#39;ratio_error&#39;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">M</span> <span class="o">-</span> <span class="n">fs_out</span><span class="o">/</span><span class="n">fs_in</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate conversion: </span><span class="si">{</span><span class="n">fs_in</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">fs_out</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  L/M = </span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">L</span><span class="o">/</span><span class="n">M</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Desired ratio: </span><span class="si">{</span><span class="n">fs_out</span><span class="o">/</span><span class="n">fs_in</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Error: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ratio_error&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Use scipy&#39;s efficient polyphase resampler</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;input_samples&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;output_samples&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">info</span>

<span class="c1"># Test various conversions</span>
<span class="n">test_rates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="mi">48000</span><span class="p">,</span> <span class="s1">&#39;CD to Pro Audio&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">48000</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="s1">&#39;Pro Audio to CD&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="mi">22050</span><span class="p">,</span> <span class="s1">&#39;CD to Half Rate&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">16000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="s1">&#39;Wideband to Narrowband&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">96000</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="s1">&#39;Hi-Res to CD&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">fs_source</span> <span class="o">=</span> <span class="mi">44100</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_source</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">15000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_rates</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">test_rates</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">fs_in</span><span class="p">,</span> <span class="n">fs_out</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">test_rates</span><span class="p">):</span>
    <span class="c1"># Generate at source rate</span>
    <span class="n">t_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_in</span><span class="p">)</span>
    <span class="n">x_in</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t_in</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">15000</span><span class="p">,</span> <span class="n">fs_in</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="n">y</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">multirate_pipeline</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">fs_in</span><span class="p">,</span> <span class="n">fs_out</span><span class="p">)</span>

    <span class="c1"># Plot spectrum</span>
    <span class="n">freq_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_out</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_out</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">fs_in</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">fs_out</span><span class="si">}</span><span class="s1"> Hz (L=</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multirate_pipeline.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ 1: ë‹¤ìš´ìƒ˜í”Œë§ ë¶„ì„<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>ì‹ í˜¸ $x[n] = \cos(0.2\pi n) + \cos(0.7\pi n)$ì´ $f_s = 10$ kHzë¡œ ìƒ˜í”Œë§ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
<p>(a) $x[n]$ì˜ DTFTë¥¼ ìŠ¤ì¼€ì¹˜í•˜ì‹œì˜¤.</p>
<p>(b) $M = 2$ë¡œ ë‹¤ìš´ìƒ˜í”Œë§í•˜ì‹œì˜¤. ì–´ëŠ ì£¼íŒŒìˆ˜ ì„±ë¶„ì´ ì•¨ë¦¬ì–´ì‹±ë˜ëŠ”ì§€, ê²°ê³¼ ìŠ¤í™íŠ¸ëŸ¼ì´ ì–´ë–»ê²Œ ë³´ì´ëŠ”ì§€ ë¶„ì„ì ìœ¼ë¡œ ê²°ì •í•˜ì‹œì˜¤.</p>
<p>(c) $M = 4$ë¡œ ë‹¤ìš´ìƒ˜í”Œë§í•˜ì‹œì˜¤. ì•¨ë¦¬ì–´ì‹±ì´ ë°œìƒí•©ë‹ˆê¹Œ? ì–´ë–¤ ì„±ë¶„ì´ ê²¹ì¹©ë‹ˆê¹Œ?</p>
<p>(d) Pythonìœ¼ë¡œ êµ¬í˜„: ì›ë³¸ ì‹ í˜¸ì™€ ë‘ ë‹¤ìš´ìƒ˜í”Œë§ ë²„ì „ì˜ ìŠ¤í™íŠ¸ëŸ¼ì„ ê·¸ë¦¬ì‹œì˜¤. ë¶„ì„ì  ì˜ˆì¸¡ì„ ê²€ì¦í•˜ì‹œì˜¤.</p>
<p>(e) $0.2\pi$ ì„±ë¶„ì„ ì™œê³¡í•˜ì§€ ì•Šê³  $M = 4$ ë°ì‹œë©”ì´ì…˜ì„ í—ˆìš©í•˜ëŠ” ì•¤í‹°ì•¨ë¦¬ì–´ì‹± í•„í„°ë¥¼ ì„¤ê³„í•˜ì‹œì˜¤.</p>
<h3 id="2_1">ì—°ìŠµ 2: ë³´ê°„ í’ˆì§ˆ<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>8 kHzë¡œ ìƒ˜í”Œë§ëœ 1 kHz ì‚¬ì¸íŒŒì—ì„œ ì‹œì‘í•˜ì—¬:</p>
<p>(a) ì˜ ì‚½ì…ë§Œ ì‚¬ìš©í•˜ì—¬ $L = 4$ë¡œ ì—…ìƒ˜í”Œë§í•˜ì‹œì˜¤. ìŠ¤í™íŠ¸ëŸ¼ì„ ê·¸ë¦¬ê³  ì´ë¯¸ì§• ì•„í‹°íŒ©íŠ¸ë¥¼ ì‹ë³„í•˜ì‹œì˜¤.</p>
<p>(b) ì„¸ ê°€ì§€ ë‹¤ë¥¸ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ë³´ê°„ì„ ì ìš©í•˜ì‹œì˜¤:
   - ì„ í˜• ë³´ê°„(Linear interpolation)
   - FIR ì €ì—­í†µê³¼ í•„í„° (32íƒ­)
   - FIR ì €ì—­í†µê³¼ í•„í„° (128íƒ­)</p>
<p>(c) ê³ í’ˆì§ˆ ì°¸ì¡°(ì˜ˆ: <code>scipy.signal.resample</code>)ì— ëŒ€í•œ ê° ë°©ë²•ì˜ SNRì„ ê³„ì‚°í•˜ì—¬ ë³´ê°„ í’ˆì§ˆì„ ë¹„êµí•˜ì‹œì˜¤.</p>
<p>(d) ì´ìƒì ì¸ ì—°ì† ì‚¬ì¸íŒŒì— ì¤‘ì²©ëœ ëª¨ë“  ë°©ë²•ì˜ ì‹œê°„ ì˜ì—­ íŒŒí˜•ì„ ê·¸ë¦¬ì‹œì˜¤.</p>
<h3 id="3_1">ì—°ìŠµ 3: í´ë¦¬í˜ì´ì¦ˆ êµ¬í˜„<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>128íƒ­ FIR í•„í„°ì™€ ë°ì‹œë©”ì´ì…˜ ì¸ìˆ˜ $M = 8$ì´ ì£¼ì–´ì¡Œì„ ë•Œ:</p>
<p>(a) í´ë¦¬í˜ì´ì¦ˆ ë¶„í•´ë¥¼ ìˆ˜ë™ìœ¼ë¡œ êµ¬í˜„í•˜ì‹œì˜¤. ì„œë¸Œí•„í„°ëŠ” ëª‡ ê°œì…ë‹ˆê¹Œ? ê° ê¸¸ì´ëŠ” ì–¼ë§ˆì…ë‹ˆê¹Œ?</p>
<p>(b) ë¸”ë¡ ë‹¨ìœ„ë¡œ ì‹ í˜¸ë¥¼ ì²˜ë¦¬í•˜ëŠ”(ìŠ¤íŠ¸ë¦¬ë° ì‹œë®¬ë ˆì´ì…˜) <code>PolyphaseDecimator</code> í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ì‹œì˜¤.</p>
<p>(c) ì¶œë ¥ì´ <code>scipy.signal.decimate</code>ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•˜ì‹œì˜¤.</p>
<p>(d) í‘œì¤€ vs í´ë¦¬í˜ì´ì¦ˆ êµ¬í˜„ì„ ë²¤ì¹˜ë§ˆí¬í•˜ì‹œì˜¤. ì†ë„ í–¥ìƒ ì¸ìˆ˜ë¥¼ ì¸¡ì •í•˜ì‹œì˜¤.</p>
<h3 id="4_1">ì—°ìŠµ 4: ìœ ë¦¬ìˆ˜ ë¥  ë³€í™˜<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<p>11025 Hzì—ì„œ 8000 Hzë¡œ ì‹ í˜¸ë¥¼ ë³€í™˜í•˜ì‹œì˜¤.</p>
<p>(a) ê°€ì¥ ë‹¨ìˆœí•œ $L/M$ ë¹„ìœ¨ì„ ì°¾ìœ¼ì‹œì˜¤. íŒíŠ¸: $8000/11025 = ?$</p>
<p>(b) í•„ìš”í•œ ì•¤í‹°ì•¨ë¦¬ì–´ì‹±/ì•¤í‹°ì´ë¯¸ì§• í•„í„°ë¥¼ ì„¤ê³„í•˜ì‹œì˜¤.</p>
<p>(c) <code>signal.resample_poly</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³€í™˜ì„ êµ¬í˜„í•˜ì‹œì˜¤.</p>
<p>(d) 500, 1000, 2000, 3500 Hzì˜ í†¤ì„ í¬í•¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‹ í˜¸ë¥¼ ìƒì„±í•˜ì‹œì˜¤. ë³€í™˜ í›„ ì–´ë–¤ í†¤ì´ ì‚´ì•„ë‚¨ê³  ì–´ë–¤ ê²ƒì´ ê°ì‡ ë˜ì–´ì•¼ í•©ë‹ˆê¹Œ? ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ìœ¼ë¡œ ê²€ì¦í•˜ì‹œì˜¤.</p>
<h3 id="5_1">ì—°ìŠµ 5: ë‹¤ë‹¨ê³„ ë°ì‹œë©”ì´ì…˜ ìµœì í™”<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>$M = 48$ë¡œ ë°ì‹œë©”ì´ì…˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>(a) 48ì„ 2~4 ë‹¨ê³„ë¡œ ì¸ìˆ˜ë¶„í•´í•˜ëŠ” ëª¨ë“  ê°€ëŠ¥í•œ ë°©ë²•ì„ ë‚˜ì—´í•˜ì‹œì˜¤ (ì˜ˆ: $48 = 2 \times 24$, $48 = 2 \times 4 \times 6$ ë“±).</p>
<p>(b) ê° ì¸ìˆ˜ë¶„í•´ì— ëŒ€í•´ ì¶œë ¥ ìƒ˜í”Œë‹¹ ì´ ê³±ì…ˆ-ëˆ„ì‚° ì—°ì‚° ìˆ˜ë¥¼ ì¶”ì •í•˜ì‹œì˜¤. ê° ë‹¨ê³„ì˜ í•„í„° ì°¨ìˆ˜ëŠ” $10 \times M_\text{stage}$ë¡œ ê°€ì •í•©ë‹ˆë‹¤.</p>
<p>(c) ì–´ë–¤ ì¸ìˆ˜ë¶„í•´ê°€ ìµœì ì…ë‹ˆê¹Œ? êµ¬í˜„í•˜ê³  ì¶œë ¥ í’ˆì§ˆì„ ê²€ì¦í•˜ì‹œì˜¤.</p>
<p>(d) ê³„ì‚° ì‹œê°„ ë° ì¶œë ¥ SNR ì¸¡ë©´ì—ì„œ ë‹¨ì¼ ë‹¨ê³„ ë°ì‹œë©”ì´ì…˜ê³¼ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="6-qmf">ì—°ìŠµ 6: QMF í•„í„° ë±…í¬<a class="header-link" href="#6-qmf" title="Permanent link">&para;</a></h3>
<p>ì˜¤ë””ì˜¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ 2ì±„ë„ QMF í•„í„° ë±…í¬ë¥¼ ì„¤ê³„í•˜ì‹œì˜¤:</p>
<p>(a) QMFì— ì í•©í•œ 32íƒ­ ì €ì—­í†µê³¼ í”„ë¡œí† íƒ€ì… í•„í„°ë¥¼ ì„¤ê³„í•˜ì‹œì˜¤.</p>
<p>(b) ê³ ì—­í†µê³¼ ë¶„ì„ í•„í„°ì™€ ë‘ í•©ì„± í•„í„°ë¥¼ êµ¬ì„±í•˜ì‹œì˜¤.</p>
<p>(c) ìŒì•…ê³¼ ìœ ì‚¬í•œ ì‹ í˜¸(ë°°ìŒì˜ í•©)ë¥¼ ì²˜ë¦¬í•˜ê³  ê±°ì˜ ì™„ì „í•œ ì¬êµ¬ì„±ì„ ê²€ì¦í•˜ì‹œì˜¤.</p>
<p>(d) í•„í„° ì°¨ìˆ˜ì˜ í•¨ìˆ˜ë¡œ ì¬êµ¬ì„± ì˜¤ì°¨ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤ (8, 16, 32, 64, 128íƒ­ ì‹œë„).</p>
<p>(e) ì„œë¸Œë°´ë“œ ì½”ë”© êµ¬í˜„: ì €ì—­í†µê³¼ ì„œë¸Œë°´ë“œë¥¼ 16ë¹„íŠ¸ë¡œ, ê³ ì—­í†µê³¼ ì„œë¸Œë°´ë“œë¥¼ 8ë¹„íŠ¸ë¡œ ì–‘ìí™”í•˜ì‹œì˜¤. ì¬êµ¬ì„±í•˜ê³  SNRì„ ì¸¡ì •í•˜ì‹œì˜¤.</p>
<h3 id="7-cic">ì—°ìŠµ 7: CIC í•„í„°<a class="header-link" href="#7-cic" title="Permanent link">&para;</a></h3>
<p><strong>CIC(Cascaded Integrator-Comb, ì—°ì† ì ë¶„ê¸°-ë¹— í•„í„°)</strong>ëŠ” ìŠ¹ìˆ˜ê°€ ì—†ëŠ” ê³„ì‚° íš¨ìœ¨ì ì¸ ë°ì‹œë©”ì´ì…˜ í•„í„°ì…ë‹ˆë‹¤.</p>
<p>(a) $M$ë§Œí¼ ë°ì‹œë©”ì´ì…˜í•˜ê¸° ìœ„í•œ ë‹¨ì¼ ë‹¨ê³„ CIC í•„í„°(ì ë¶„ê¸° + ë¹—)ë¥¼ êµ¬í˜„í•˜ì‹œì˜¤.</p>
<p>(b) CIC í•„í„°ì˜ ì£¼íŒŒìˆ˜ ì‘ë‹µì„ ìœ ë„í•˜ì‹œì˜¤: $H(z) = \frac{1}{M}\frac{1 - z^{-M}}{1 - z^{-1}}$.</p>
<p>(c) $M = 8, 16, 32$ì— ëŒ€í•œ í¬ê¸° ì‘ë‹µì„ ê·¸ë¦¬ê³  ì´ìƒì ì¸ ì €ì—­í†µê³¼ì™€ ë¹„êµí•˜ì‹œì˜¤.</p>
<p>(d) ë‹¤ë‹¨ê³„ CIC í•„í„°($K$ê°œ ì—°ì† ë‹¨ê³„)ë¥¼ êµ¬í˜„í•˜ê³  $K$ê°€ ì¦ê°€í•¨ì— ë”°ë¼ í†µê³¼ëŒ€ì—­ ë“œë£¹(droop)ê³¼ ì €ì§€ëŒ€ì—­ ê°ì‡ ê°€ ì–´ë–»ê²Œ ê°œì„ ë˜ëŠ”ì§€ ë³´ì´ì‹œì˜¤.</p>
<p>(e) ì‹œê·¸ë§ˆ-ë¸íƒ€ ADCë¥¼ ìœ„í•œ CIC ê¸°ë°˜ ë°ì‹œë©”ì´ì…˜ ì²´ì¸ì„ ì„¤ê³„í•˜ì‹œì˜¤: 64ë°° ì˜¤ë²„ìƒ˜í”Œë§ í›„ CIC ë°ì‹œë©”ì´ì…˜ìœ¼ë¡œ ìµœì¢… ë¥ ì— ë„ë‹¬.</p>
<hr />
<h2 id="_3">ì°¸ê³ ë¬¸í—Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Vaidyanathan, P. P. (1993).</strong> <em>Multirate Systems and Filter Banks</em>. Prentice Hall. [ê¶Œìœ„ ìˆëŠ” ì°¸ê³ ì„œ]</li>
<li><strong>Oppenheim, A. V., &amp; Schafer, R. W. (2010).</strong> <em>Discrete-Time Signal Processing</em> (3rd ed.). Pearson. Chapter 4.</li>
<li><strong>Crochiere, R. E., &amp; Rabiner, L. R. (1983).</strong> <em>Multirate Digital Signal Processing</em>. Prentice Hall.</li>
<li><strong>Lyons, R. G. (2010).</strong> <em>Understanding Digital Signal Processing</em> (3rd ed.). Pearson. Chapter 10.</li>
<li><strong>Fliege, N. J. (1994).</strong> <em>Multirate Digital Signal Processing</em>. Wiley.</li>
<li><strong>SciPy Documentation</strong> -- <code>scipy.signal.resample_poly</code>, <code>scipy.signal.decimate</code>: https://docs.scipy.org/doc/scipy/reference/signal.html</li>
</ol>
<hr />
<h2 id="_4">íƒìƒ‰<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li>ì´ì „: <a href="10_IIR_Filter_Design.md">10. IIR í•„í„° ì„¤ê³„</a></li>
<li>ë‹¤ìŒ: <a href="12_Spectral_Analysis.md">12. ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„</a></li>
<li><a href="00_Overview.md">ê°œìš”ë¡œ ëŒì•„ê°€ê¸°</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/10_IIR_Filter_Design.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">IIR í•„í„° ì„¤ê³„</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/12_Spectral_Analysis.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}