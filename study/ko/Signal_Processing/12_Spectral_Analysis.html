{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/11_Multirate_Processing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/13_Adaptive_Filters.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">13. ì ì‘ í•„í„°</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ë¬¸ì œ ì •ì˜</a></li>
<li><a href="#12">1.2 ì‘ìš© ë¶„ì•¼</a></li>
<li><a href="#13">1.3 ë‘ ê°€ì§€ ì ‘ê·¼ë²•</a></li>
</ul>
</li>
<li><a href="#2">2. ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„</a><ul>
<li><a href="#21">2.1 ëœë¤ ê³¼ì •ì— ëŒ€í•œ ì •ì˜</a></li>
<li><a href="#22-psd">2.2 PSDì˜ ì„±ì§ˆ</a></li>
<li><a href="#23-psd">2.3 í•„í„°ë§ëœ ê³¼ì •ì˜ PSD</a></li>
</ul>
</li>
<li><a href="#3-">3. ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬</a><ul>
<li><a href="#31">3.1 ì •ë¦¬ ë‚´ìš©</a></li>
<li><a href="#32">3.2 ì¤‘ìš”ì„±</a></li>
<li><a href="#33">3.3 ìˆ˜ì¹˜ ê²€ì¦</a></li>
</ul>
</li>
<li><a href="#4">4. ì£¼ê¸°ë„</a><ul>
<li><a href="#41">4.1 ì •ì˜</a></li>
<li><a href="#42">4.2 í†µê³„ì  ì„±ì§ˆ</a></li>
<li><a href="#43">4.3 êµ¬í˜„ ë° ì‹œì—°</a></li>
<li><a href="#44">4.4 ì£¼ê¸°ë„ ë¶„ì‚° ì‹œì—°</a></li>
</ul>
</li>
<li><a href="#5-bartlett">5. Bartlett ë°©ë²•</a><ul>
<li><a href="#51">5.1 ì›ë¦¬</a></li>
<li><a href="#52">5.2 ì„±ì§ˆ</a></li>
<li><a href="#53">5.3 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#6-welch">6. Welch ë°©ë²•</a><ul>
<li><a href="#61-bartlett">6.1 Bartlett ë°©ë²•ê³¼ì˜ ì°¨ì´ì </a></li>
<li><a href="#62">6.2 ì„±ì§ˆ</a></li>
<li><a href="#63">6.3 êµ¬í˜„ ë° ë¶„ì„</a></li>
<li><a href="#64">6.4 ìœˆë„ìš° íš¨ê³¼</a></li>
</ul>
</li>
<li><a href="#7-blackman-tukey">7. Blackman-Tukey ë°©ë²•</a><ul>
<li><a href="#71">7.1 ì›ë¦¬</a></li>
<li><a href="#72">7.2 ìê¸°ìƒê´€ ì¶”ì •</a></li>
<li><a href="#73">7.3 ì§€ì—° ìœˆë„ìš°</a></li>
<li><a href="#74">7.4 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#8-">8. í•´ìƒë„-ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„</a><ul>
<li><a href="#81">8.1 ê·¼ë³¸ì  í•œê³„</a></li>
<li><a href="#82">8.2 ì •ëŸ‰ì  ë¶„ì„</a></li>
<li><a href="#83">8.3 ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#9-ar">9. ëª¨ìˆ˜ì  ë°©ë²•: AR ëª¨ë¸</a><ul>
<li><a href="#91-ar">9.1 ìê¸°íšŒê·€(AR) ëª¨ë¸</a></li>
<li><a href="#92-ar">9.2 AR ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ </a></li>
<li><a href="#93-yule-walker">9.3 Yule-Walker ë°©ì •ì‹</a></li>
<li><a href="#94-levinson-durbin">9.4 Levinson-Durbin ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#95-ar">9.5 AR ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •</a></li>
<li><a href="#96-burg">9.6 Burg ë°©ë²•</a></li>
</ul>
</li>
<li><a href="#10-ma-arma">10. ëª¨ìˆ˜ì  ë°©ë²•: MA ë° ARMA</a><ul>
<li><a href="#101-ma">10.1 ì´ë™ í‰ê· (MA) ëª¨ë¸</a></li>
<li><a href="#102-arma">10.2 ARMA ëª¨ë¸</a></li>
<li><a href="#103-arma">10.3 ARMA íŒŒë¼ë¯¸í„° ì¶”ì •</a></li>
</ul>
</li>
<li><a href="#11_1">11. ëª¨ë¸ ì°¨ìˆ˜ ì„ íƒ</a><ul>
<li><a href="#111">11.1 ë¬¸ì œ</a></li>
<li><a href="#112">11.2 ì •ë³´ ê¸°ì¤€</a></li>
<li><a href="#113-fpe">11.3 ìµœì¢… ì˜ˆì¸¡ ì˜¤ì°¨(FPE)</a></li>
<li><a href="#114">11.4 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#12_1">12. êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ê³¼ ì½”íˆëŸ°ìŠ¤</a><ul>
<li><a href="#121">12.1 êµì°¨ ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„</a></li>
<li><a href="#122">12.2 ì½”íˆëŸ°ìŠ¤</a></li>
<li><a href="#123">12.3 ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼</a></li>
<li><a href="#124">12.4 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#13_1">13. ìŠ¤í™íŠ¸ë¡œê·¸ë¨</a><ul>
<li><a href="#131-">13.1 ì‹œê°„-ì£¼íŒŒìˆ˜ ë¶„ì„</a></li>
<li><a href="#132">13.2 íŒŒë¼ë¯¸í„°</a></li>
<li><a href="#133-">13.3 ì‹œê°„-ì£¼íŒŒìˆ˜ í•´ìƒë„</a></li>
<li><a href="#134">13.4 êµ¬í˜„</a></li>
<li><a href="#135">13.5 ëŒ€í™”í˜• ìŠ¤í™íŠ¸ë¡œê·¸ë¨ ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#14-python">14. Python êµ¬í˜„</a><ul>
<li><a href="#141">14.1 ì¢…í•© ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ íˆ´í‚·</a></li>
<li><a href="#142">14.2 ì‹¤ì„¸ê³„ ì˜ˆì œ: ì§„ë™ ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#15">15. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-vs-welch">ì—°ìŠµ ë¬¸ì œ 1: ì£¼ê¸°ë„ vs Welch</a></li>
<li><a href="#2-ar">ì—°ìŠµ ë¬¸ì œ 2: AR ëª¨ë¸ ì‹ë³„</a></li>
<li><a href="#3">ì—°ìŠµ ë¬¸ì œ 3: êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„</a></li>
<li><a href="#4_1">ì—°ìŠµ ë¬¸ì œ 4: ë°•ì¥ ë°˜í–¥ ìœ„ì¹˜ ì¸¡ì • ìŠ¤í™íŠ¸ë¡œê·¸ë¨</a></li>
<li><a href="#5">ì—°ìŠµ ë¬¸ì œ 5: í•´ìƒë„ í•œê³„</a></li>
<li><a href="#6-eeg">ì—°ìŠµ ë¬¸ì œ 6: ì‹¤ì„¸ê³„ ì‘ìš©: EEG ë¶„ì„</a></li>
<li><a href="#7-burg-vs-welch">ì—°ìŠµ ë¬¸ì œ 7: ì§§ì€ ë°ì´í„°ì—ì„œ Burg vs Welch</a></li>
</ul>
</li>
<li><a href="#_3">ì°¸ê³ ë¬¸í—Œ</a></li>
<li><a href="#_4">ë‚´ë¹„ê²Œì´ì…˜</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="spectral-analysis">ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Spectral Analysis)<a class="header-link" href="#spectral-analysis" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„(Power Spectral Density, PSD)ì˜ ì •ì˜ì™€ ì„±ì§ˆ ì´í•´</li>
<li>ìê¸°ìƒê´€ê³¼ PSDë¥¼ ì—°ê²°í•˜ëŠ” ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬(Wiener-Khinchin theorem) ë§ˆìŠ¤í„°</li>
<li>ë¹„ëª¨ìˆ˜ì  ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì • ë°©ë²•(ì£¼ê¸°ë„, Bartlett, Welch, Blackman-Tukey) í•™ìŠµ</li>
<li>ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •ì—ì„œì˜ í•´ìƒë„-ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„(resolution-variance tradeoff) ì´í•´</li>
<li>ëª¨ìˆ˜ì  ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì • ë°©ë²•(AR, MA, ARMA ëª¨ë¸) í•™ìŠµ</li>
<li>ëª¨ë¸ ì°¨ìˆ˜ ì„ íƒ ê¸°ì¤€(AIC, BIC) ì ìš©</li>
<li>êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„(Cross-spectral analysis) ë° ì½”íˆëŸ°ìŠ¤(coherence) ê³„ì‚°</li>
<li>ì‹œë³€ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ì„ ìœ„í•œ ìŠ¤í™íŠ¸ë¡œê·¸ë¨(spectrogram) ìƒì„± ë° í•´ì„</li>
<li>Pythonì˜ <code>scipy.signal</code>ê³¼ <code>matplotlib</code>ì„ ì‚¬ìš©í•œ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ êµ¬í˜„</li>
</ul>
<hr />
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ìŠ¤í™íŠ¸ëŸ¼-ë¶„ì„-ì†Œê°œ">ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ ì†Œê°œ</a></li>
<li><a href="#2-ì „ë ¥-ìŠ¤í™íŠ¸ëŸ¼-ë°€ë„">ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„</a></li>
<li><a href="#3-ìœ„ë„ˆ-í‚¨ì¹œ-ì •ë¦¬">ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬</a></li>
<li><a href="#4-ì£¼ê¸°ë„">ì£¼ê¸°ë„</a></li>
<li><a href="#5-bartlett-ë°©ë²•">Bartlett ë°©ë²•</a></li>
<li><a href="#6-welch-ë°©ë²•">Welch ë°©ë²•</a></li>
<li><a href="#7-blackman-tukey-ë°©ë²•">Blackman-Tukey ë°©ë²•</a></li>
<li><a href="#8-í•´ìƒë„-ë¶„ì‚°-íŠ¸ë ˆì´ë“œì˜¤í”„">í•´ìƒë„-ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„</a></li>
<li><a href="#9-ëª¨ìˆ˜ì -ë°©ë²•-ar-ëª¨ë¸">ëª¨ìˆ˜ì  ë°©ë²•: AR ëª¨ë¸</a></li>
<li><a href="#10-ëª¨ìˆ˜ì -ë°©ë²•-ma-ë°-arma">ëª¨ìˆ˜ì  ë°©ë²•: MA ë° ARMA</a></li>
<li><a href="#11-ëª¨ë¸-ì°¨ìˆ˜-ì„ íƒ">ëª¨ë¸ ì°¨ìˆ˜ ì„ íƒ</a></li>
<li><a href="#12-êµì°¨-ìŠ¤í™íŠ¸ëŸ¼-ë¶„ì„ê³¼-ì½”íˆëŸ°ìŠ¤">êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ê³¼ ì½”íˆëŸ°ìŠ¤</a></li>
<li><a href="#13-ìŠ¤í™íŠ¸ë¡œê·¸ë¨">ìŠ¤í™íŠ¸ë¡œê·¸ë¨</a></li>
<li><a href="#14-python-êµ¬í˜„">Python êµ¬í˜„</a></li>
<li><a href="#15-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1">1. ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ ì†Œê°œ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ë¬¸ì œ ì •ì˜<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ìœ í•œí•œ ê´€ì¸¡ êµ¬ê°„ì˜ ëœë¤ ë˜ëŠ” ê²°ì •ë¡ ì  ì‹ í˜¸ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ì‹ í˜¸ì˜ ì „ë ¥(ë˜ëŠ” ì—ë„ˆì§€)ì´ ì£¼íŒŒìˆ˜ì— ë”°ë¼ ì–´ë–»ê²Œ ë¶„í¬í•˜ëŠ”ì§€ ì¶”ì •í•˜ê³ ì í•œë‹¤. ì´ê²ƒì´ <strong>ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •(spectral estimation)</strong> ë¬¸ì œì´ë‹¤.</p>
<p>ìœ í•œí•œ ê²°ì •ë¡ ì  ì‹ í˜¸ì˜ ì •í™•í•œ ìŠ¤í™íŠ¸ëŸ¼ í‘œí˜„ì„ ê³„ì‚°í•˜ëŠ” DFTì™€ ë‹¬ë¦¬, ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ì€ ë‹¤ìŒì„ ë‹¤ë£¬ë‹¤:
- <strong>ëœë¤ ê³¼ì •(random processes)</strong>: ì •í™•í•œ ê°’ì´ ì•„ë‹Œ í†µê³„ì  ì„±ì§ˆì„ ê°–ëŠ” ì‹ í˜¸
- <strong>ìœ í•œ ë°ì´í„°</strong>: ë¬´í•œ ì§€ì† ì‹œê°„ ê³¼ì •ì˜ $N$ê°œ ìƒ˜í”Œë§Œ ê´€ì¸¡
- <strong>ì¶”ì • ë¶ˆí™•ì‹¤ì„±</strong>: ëª¨ë“  ì¶”ì •ì¹˜ëŠ” í¸í–¥(bias)ê³¼ ë¶„ì‚°(variance)ì„ ê°€ì§</p>
<h3 id="12">1.2 ì‘ìš© ë¶„ì•¼<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                </span><span class="n">Spectral</span><span class="w"> </span><span class="n">Analysis</span><span class="w"> </span><span class="n">Applications</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Audio</span><span class="o">/</span><span class="n">Speech</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Pitch</span><span class="w"> </span><span class="n">detection</span><span class="p">,</span><span class="w"> </span><span class="n">formant</span><span class="w"> </span><span class="n">analysis</span><span class="p">,</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">noise</span><span class="w"> </span><span class="n">characterization</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Communications</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Channel</span><span class="w"> </span><span class="n">characterization</span><span class="p">,</span><span class="w"> </span><span class="n">interference</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">detection</span><span class="p">,</span><span class="w"> </span><span class="n">modulation</span><span class="w"> </span><span class="n">classification</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Biomedical</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">EEG</span><span class="o">/</span><span class="n">ECG</span><span class="w"> </span><span class="n">analysis</span><span class="p">,</span><span class="w"> </span><span class="n">sleep</span><span class="w"> </span><span class="n">staging</span><span class="p">,</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">heart</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">variability</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Radar</span><span class="o">/</span><span class="n">Sonar</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Target</span><span class="w"> </span><span class="n">detection</span><span class="p">,</span><span class="w"> </span><span class="n">Doppler</span><span class="w"> </span><span class="n">estimation</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Vibration</span><span class="w"> </span><span class="n">Analysis</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Machine</span><span class="w"> </span><span class="n">health</span><span class="w"> </span><span class="n">monitoring</span><span class="p">,</span><span class="w"> </span><span class="n">modal</span><span class="w"> </span><span class="n">analysis</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Geophysics</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Seismic</span><span class="w"> </span><span class="n">analysis</span><span class="p">,</span><span class="w"> </span><span class="n">ocean</span><span class="w"> </span><span class="n">wave</span><span class="w"> </span><span class="n">spectra</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Astrophysics</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Pulsar</span><span class="w"> </span><span class="n">timing</span><span class="p">,</span><span class="w"> </span><span class="n">gravitational</span><span class="w"> </span><span class="n">wave</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="13">1.3 ë‘ ê°€ì§€ ì ‘ê·¼ë²•<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p><strong>ë¹„ëª¨ìˆ˜ì  ë°©ë²•(Non-parametric methods)</strong>: ì‹ í˜¸ì— ëŒ€í•œ ê°€ì •ì„ ìµœì†Œí™”í•œë‹¤. ë°ì´í„°ë¡œë¶€í„° PSDë¥¼ ì§ì ‘ ì¶”ì •í•œë‹¤(ì˜ˆ: ì£¼ê¸°ë„, Welch ë°©ë²•).</p>
<p><strong>ëª¨ìˆ˜ì  ë°©ë²•(Parametric methods)</strong>: ì‹ í˜¸ê°€ íŠ¹ì • ëª¨ë¸(ì˜ˆ: AR, MA, ARMA)ì— ì˜í•´ ìƒì„±ëœë‹¤ê³  ê°€ì •í•œë‹¤. ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•œ í›„, ëª¨ë¸ë¡œë¶€í„° PSDë¥¼ ê³„ì‚°í•œë‹¤.</p>
<hr />
<h2 id="2">2. ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ëœë¤ ê³¼ì •ì— ëŒ€í•œ ì •ì˜<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ê´‘ì˜ ì •ìƒ(Wide-Sense Stationary, WSS) ëœë¤ ê³¼ì • $x[n]$ì— ëŒ€í•´, <strong>ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„(Power Spectral Density, PSD)</strong>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤:</p>
<p>$$S_x(e^{j\omega}) = \sum_{k=-\infty}^{\infty} r_{xx}[k] e^{-j\omega k}$$</p>
<p>ì—¬ê¸°ì„œ $r_{xx}[k] = E\{x[n] x^*[n-k]\}$ëŠ” <strong>ìê¸°ìƒê´€ ìˆ˜ì—´(autocorrelation sequence)</strong>ì´ë‹¤.</p>
<h3 id="22-psd">2.2 PSDì˜ ì„±ì§ˆ<a class="header-link" href="#22-psd" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ì‹¤ìˆ˜ê°’</strong>: $S_x(e^{j\omega}) \in \mathbb{R}$, ëª¨ë“  $\omega$ì—ì„œ</li>
<li><strong>ë¹„ìŒìˆ˜</strong>: $S_x(e^{j\omega}) \geq 0$, ëª¨ë“  $\omega$ì—ì„œ</li>
<li><strong>ì£¼ê¸°ì„±</strong>: $S_x(e^{j\omega}) = S_x(e^{j(\omega + 2\pi)})$</li>
<li><strong>ìš°í•¨ìˆ˜ ëŒ€ì¹­</strong> (ì‹¤ìˆ˜ $x[n]$ì¸ ê²½ìš°): $S_x(e^{j\omega}) = S_x(e^{-j\omega})$</li>
<li><strong>ì´ ì „ë ¥</strong>: $r_{xx}[0] = E\{|x[n]|^2\} = \frac{1}{2\pi} \int_{-\pi}^{\pi} S_x(e^{j\omega}) d\omega$</li>
</ol>
<h3 id="23-psd">2.3 í•„í„°ë§ëœ ê³¼ì •ì˜ PSD<a class="header-link" href="#23-psd" title="Permanent link">&para;</a></h3>
<p>$y[n] = h[n] * x[n]$ (LTI í•„í„°ë§)ì´ë©´:</p>
<p>$$S_y(e^{j\omega}) = |H(e^{j\omega})|^2 S_x(e^{j\omega})$$</p>
<p>ì´ëŠ” ì…ë ¥ê³¼ ì¶œë ¥ ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ê°„ì˜ ê·¼ë³¸ì ì¸ ê´€ê³„ì´ë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>

<span class="k">def</span><span class="w"> </span><span class="nf">psd_of_filtered_noise</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate PSD of filtered white noise.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># White noise: flat PSD</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># Design bandpass filter</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Estimate PSDs using Welch&#39;s method</span>
    <span class="n">f_x</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">f_y</span><span class="p">,</span> <span class="n">Pyy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

    <span class="c1"># Theoretical: |H(f)|^2 * Pxx</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">f_x</span><span class="p">),</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">Pyy_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Pxx</span><span class="p">)</span>  <span class="c1"># Pxx â‰ˆ constant for white noise</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Input PSD</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_x</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input PSD (White Noise)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Filter response</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;|H(f)|Â² (Bandpass Filter)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Output PSD: measured vs theoretical</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_y</span><span class="p">,</span> <span class="n">Pyy</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">Pyy_theory</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output PSD: Sy = |H|Â² Â· Sx&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Time domain</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Output&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;PSD of Filtered Process: Sy(f) = |H(f)|Â² Sx(f)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;psd_filtered_noise.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">psd_of_filtered_noise</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3-">3. ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬<a class="header-link" href="#3-" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì •ë¦¬ ë‚´ìš©<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬(Wiener-Khinchin theorem)</strong>ëŠ” ê´‘ì˜ ì •ìƒ ê³¼ì •ì— ëŒ€í•´, ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„ì™€ ìê¸°ìƒê´€ í•¨ìˆ˜ê°€ í‘¸ë¦¬ì— ë³€í™˜ ìŒì„ ì´ë£¬ë‹¤ê³  ë§í•œë‹¤:</p>
<p>$$S_x(e^{j\omega}) = \sum_{k=-\infty}^{\infty} r_{xx}[k] e^{-j\omega k} \quad \text{(DTFT)}$$</p>
<p>$$r_{xx}[k] = \frac{1}{2\pi} \int_{-\pi}^{\pi} S_x(e^{j\omega}) e^{j\omega k} d\omega \quad \text{(ì—­ DTFT)}$$</p>
<h3 id="32">3.2 ì¤‘ìš”ì„±<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>ì´ ì •ë¦¬ëŠ” ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •ì— ë‘ ê°€ì§€ ê·¼ë³¸ì ì¸ ì ‘ê·¼ë²•ì„ ì œê³µí•œë‹¤:</p>
<ol>
<li><strong>ì§ì ‘ ì ‘ê·¼ë²•</strong>: ë°ì´í„°ë¡œë¶€í„° PSDë¥¼ ì§ì ‘ ì¶”ì • (ì£¼ê¸°ë„ ë°©ë²•)</li>
<li><strong>ê°„ì ‘ ì ‘ê·¼ë²•</strong>: ë¨¼ì € ìê¸°ìƒê´€ $\hat{r}_{xx}[k]$ë¥¼ ì¶”ì •í•œ í›„ í‘¸ë¦¬ì— ë³€í™˜ (Blackman-Tukey ë°©ë²•)</li>
</ol>
<h3 id="33">3.3 ìˆ˜ì¹˜ ê²€ì¦<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_wiener_khinchin</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify the Wiener-Khinchin theorem numerically.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">50000</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Generate colored noise (AR process)</span>
    <span class="c1"># x[n] = 0.9*x[n-1] + w[n]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.9</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="c1"># Method 1: Direct PSD estimation (periodogram)</span>
    <span class="n">f_direct</span><span class="p">,</span> <span class="n">Pxx_direct</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Method 2: Via autocorrelation (Wiener-Khinchin)</span>
    <span class="n">max_lag</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">r_xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">max_lag</span><span class="p">:</span><span class="n">N</span><span class="o">+</span><span class="n">max_lag</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">max_lag</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># DTFT of autocorrelation</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_direct</span><span class="p">))</span>
    <span class="n">Pxx_wk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega</span><span class="p">):</span>
        <span class="n">Pxx_wk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_xx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w_val</span> <span class="o">*</span> <span class="n">lags</span><span class="p">)))</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Theoretical PSD for AR(1): sigma_w^2 / |1 - a*e^(-jw)|^2</span>
    <span class="n">sigma_w</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">Pxx_theory</span> <span class="o">=</span> <span class="n">sigma_w</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Autocorrelation</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">r_xx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estimated Autocorrelation r_xx[k]&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lag k&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r_xx[k]&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Theoretical autocorrelation: r_xx[k] = sigma_w^2 * a^|k| / (1-a^2)</span>
    <span class="n">r_theory</span> <span class="o">=</span> <span class="n">sigma_w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">r_xx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">r_theory</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation: Estimated vs Theoretical&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lag k&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># PSD comparison</span>
    <span class="n">f_hz</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_direct</span><span class="p">,</span> <span class="n">Pxx_direct</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="n">Pxx_wk</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wiener-Khinchin&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="n">Pxx_theory</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PSD Comparison&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># PSD in dB</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Pxx_wk</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wiener-Khinchin&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_hz</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Pxx_theory</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PSD (dB Scale)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (dB/Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Wiener-Khinchin Theorem Verification&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wiener_khinchin.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">verify_wiener_khinchin</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4">4. ì£¼ê¸°ë„<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ì •ì˜<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>ì£¼ê¸°ë„(periodogram)</strong>ëŠ” DFT í¬ê¸°ì˜ ì œê³±ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ PSD ì¶”ì •ëŸ‰ì´ë‹¤:</p>
<p>$$\hat{S}_x^{(\text{per})}(f_k) = \frac{1}{N f_s} |X[k]|^2 = \frac{1}{N f_s} \left| \sum_{n=0}^{N-1} x[n] e^{-j 2\pi k n / N} \right|^2$$</p>
<p>ì—¬ê¸°ì„œ $f_k = k f_s / N$ì´ê³  $k = 0, 1, \ldots, N-1$ì´ë‹¤.</p>
<h3 id="42">4.2 í†µê³„ì  ì„±ì§ˆ<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>í¸í–¥(Bias)</strong>: ì£¼ê¸°ë„ì˜ ê¸°ëŒ“ê°’ì€ Fejer ì»¤ë„ê³¼ í•©ì„±ê³±ëœ ì°¸ PSDì´ë‹¤:</p>
<p>$$E\left\{\hat{S}_x^{(\text{per})}(e^{j\omega})\right\} = \frac{1}{2\pi} S_x(e^{j\omega}) * W_N(e^{j\omega})$$</p>
<p>ì—¬ê¸°ì„œ $W_N(e^{j\omega}) = \frac{1}{N}\left|\frac{\sin(N\omega/2)}{\sin(\omega/2)}\right|^2$ëŠ” Fejer ì»¤ë„(Dirichlet ì»¤ë„ì˜ ì œê³±)ì´ë‹¤.</p>
<ul>
<li>$N \to \infty$ì¼ìˆ˜ë¡ í¸í–¥ì´ ê°ì†Œí•œë‹¤ (ì ê·¼ì ìœ¼ë¡œ ë¹„í¸í–¥)</li>
<li>ìœ í•œ $N$ì—ì„œëŠ” ìœ í•œ ê´€ì¸¡ ìœˆë„ìš°ë¡œ ì¸í•œ ìŠ¤í™íŠ¸ëŸ¼ ëˆ„ì„¤(spectral leakage)ì´ ì¡´ì¬í•œë‹¤</li>
</ul>
<p><strong>ë¶„ì‚°(Variance)</strong>: ì£¼ê¸°ë„ëŠ” <strong>ì¼ì¹˜ ì¶”ì •ëŸ‰ì´ ì•„ë‹ˆë‹¤</strong> -- ë¶„ì‚°ì€ $N$ì´ ì¦ê°€í•´ë„ ê°ì†Œí•˜ì§€ ì•ŠëŠ”ë‹¤:</p>
<p>$$\text{Var}\left\{\hat{S}_x^{(\text{per})}(e^{j\omega})\right\} \approx S_x^2(e^{j\omega})$$</p>
<p>ì´ëŠ” ë°ì´í„° ê¸¸ì´ì— ìƒê´€ì—†ì´ ì£¼ê¸°ë„ê°€ í¬ê²Œ ë³€ë™í•¨ì„ ì˜ë¯¸í•˜ë©°, ë§¤ë„ëŸ¬ìš´ PSD ì¶”ì •ì—ëŠ” ì‹ ë¢°í•  ìˆ˜ ì—†ë‹¤.</p>
<h3 id="43">4.3 êµ¬í˜„ ë° ì‹œì—°<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">periodogram_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze the properties of the periodogram estimator.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># True signal: two sinusoids in noise</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span>  <span class="c1"># Hz (close frequencies)</span>
    <span class="n">A1</span><span class="p">,</span> <span class="n">A2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Different data lengths</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">4096</span><span class="p">]):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">A1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
             <span class="n">A2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
             <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Periodogram</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

        <span class="c1"># Mark true frequencies</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f1</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f2</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

        <span class="c1"># Frequency resolution</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">N</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">, Î”f = </span><span class="si">{</span><span class="n">delta_f</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> Hz &#39;</span>
                     <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="s2">&quot;resolved&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">delta_f</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">f2</span><span class="o">-</span><span class="n">f1</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;NOT resolved&quot;</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Periodogram: Effect of Data Length on Resolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;periodogram_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">periodogram_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="44">4.4 ì£¼ê¸°ë„ ë¶„ì‚° ì‹œì—°<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">periodogram_variance</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show that periodogram variance doesn&#39;t decrease with N.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># AR(1) process (known PSD)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.9</span>
    <span class="n">sigma_w</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">num_realizations</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">4096</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_realizations</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma_w</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

            <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Theoretical PSD</span>
        <span class="n">f_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_theory</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">Pxx_theory</span> <span class="o">=</span> <span class="n">sigma_w</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">omega</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_theory</span><span class="p">,</span> <span class="n">Pxx_theory</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True PSD&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">num_realizations</span><span class="si">}</span><span class="s1"> realizations)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Periodogram Variance Does NOT Decrease with N&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;periodogram_variance.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">periodogram_variance</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5-bartlett">5. Bartlett ë°©ë²•<a class="header-link" href="#5-bartlett" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ì›ë¦¬<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p><strong>Bartlett ë°©ë²•(Bartlett's method)</strong> (1948)ì€ ì—¬ëŸ¬ ì£¼ê¸°ë„ë¥¼ í‰ê· í•˜ì—¬ ë¶„ì‚°ì„ ì¤„ì¸ë‹¤:</p>
<ol>
<li>ë°ì´í„°ë¥¼ ê¸¸ì´ $L$ì˜ $K$ê°œ ë¹„ì¤‘ì²© êµ¬ê°„ìœ¼ë¡œ ë¶„í• í•œë‹¤ ($N = KL$)</li>
<li>ê° êµ¬ê°„ì˜ ì£¼ê¸°ë„ë¥¼ ê³„ì‚°í•œë‹¤</li>
<li>$K$ê°œ ì£¼ê¸°ë„ì˜ í‰ê· ì„ êµ¬í•œë‹¤</li>
</ol>
<p>$$\hat{S}_x^{(\text{Bartlett})}(f) = \frac{1}{K} \sum_{i=0}^{K-1} \hat{S}_{x_i}^{(\text{per})}(f)$$</p>
<h3 id="52">5.2 ì„±ì§ˆ<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>ë¶„ì‚° ê°ì†Œ</strong>: $K$ê°œì˜ ë…ë¦½ì ì¸ ì£¼ê¸°ë„ë¥¼ í‰ê· í•˜ë©´:</p>
<p>$$\text{Var}\left\{\hat{S}_x^{(\text{Bartlett})}\right\} \approx \frac{1}{K} S_x^2(e^{j\omega})$$</p>
<p><strong>í•´ìƒë„ ì†ì‹¤</strong>: ê° êµ¬ê°„ì´ ë” ì§§ìœ¼ë¯€ë¡œ ($L = N/K$), ì£¼íŒŒìˆ˜ í•´ìƒë„ëŠ”:</p>
<p>$$\Delta f = \frac{f_s}{L} = \frac{K f_s}{N}$$</p>
<p>ì´ê²ƒì´ <strong>í•´ìƒë„-ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„</strong>ì´ë‹¤: ë¶„ì‚°ì„ $K$ë°° ì¤„ì´ë©´ í•´ìƒë„ê°€ $K$ë°° ë‚˜ë¹ ì§„ë‹¤.</p>
<h3 id="53">5.3 êµ¬í˜„<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bartlett_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bartlett&#39;s method for PSD estimation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        fs: sampling frequency</span>
<span class="sd">        K: number of non-overlapping segments</span>

<span class="sd">    Returns:</span>
<span class="sd">        f: frequency vector</span>
<span class="sd">        Pxx: PSD estimate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">K</span>  <span class="c1"># Segment length</span>

    <span class="c1"># Compute periodogram of each segment</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">Pxx_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">L</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">]</span>
        <span class="n">X_seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">Pxx_seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_seg</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
        <span class="n">Pxx_sum</span> <span class="o">+=</span> <span class="n">Pxx_seg</span>

    <span class="n">Pxx</span> <span class="o">=</span> <span class="n">Pxx_sum</span> <span class="o">/</span> <span class="n">K</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span>

<span class="c1"># Compare periodogram vs Bartlett with different K</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># AR(1) process</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Periodogram (K=1)&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Bartlett (K=4)&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Bartlett (K=16)&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;Bartlett (K=64)&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Theoretical PSD</span>
<span class="n">f_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_theory</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">Pxx_theory</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">omega</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">bartlett_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">K</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimate&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_theory</span><span class="p">,</span> <span class="n">Pxx_theory</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True PSD&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">, L=</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s1">, Î”f=</span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="n">L</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bartlett&#39;s Method: Resolution-Variance Tradeoff&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bartlett_method.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-welch">6. Welch ë°©ë²•<a class="header-link" href="#6-welch" title="Permanent link">&para;</a></h2>
<h3 id="61-bartlett">6.1 Bartlett ë°©ë²•ê³¼ì˜ ì°¨ì´ì <a class="header-link" href="#61-bartlett" title="Permanent link">&para;</a></h3>
<p><strong>Welch ë°©ë²•(Welch's method)</strong> (1967)ì€ ë‘ ê°€ì§€ í•µì‹¬ ê°œì„ ì„ í†µí•´ Bartlett ë°©ë²•ì„ í™•ì¥í•œë‹¤:</p>
<ol>
<li><strong>ì¤‘ì²© êµ¬ê°„(Overlapping segments)</strong>: êµ¬ê°„ì´ ì¼ì • ë¹„ìœ¨(ë³´í†µ 50%)ë§Œí¼ ì¤‘ì²©ë˜ì–´, ë™ì¼í•œ ë°ì´í„°ì—ì„œ ë” ë§ì€ êµ¬ê°„ì„ ì–»ëŠ”ë‹¤</li>
<li><strong>ìœˆë„ì‰(Windowing)</strong>: ê° êµ¬ê°„ì— ìœˆë„ìš° í•¨ìˆ˜(ì˜ˆ: Hanning)ë¥¼ ê³±í•˜ì—¬ ìŠ¤í™íŠ¸ëŸ¼ ëˆ„ì„¤ì„ ì¤„ì¸ë‹¤</li>
</ol>
<p>$$\hat{S}_x^{(\text{Welch})}(f) = \frac{1}{K} \sum_{i=0}^{K-1} \frac{1}{L U} \left| \sum_{n=0}^{L-1} w[n] x_i[n] e^{-j2\pi f n / f_s} \right|^2$$</p>
<p>ì—¬ê¸°ì„œ $U = \frac{1}{L}\sum_{n=0}^{L-1} w^2[n]$ì€ ìœˆë„ìš° ì „ë ¥ ì •ê·œí™”ì´ë‹¤.</p>
<h3 id="62">6.2 ì„±ì§ˆ<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ë” ë§ì€ êµ¬ê°„</strong>: 50% ì¤‘ì²©ê³¼ $N$ ì „ì²´ ìƒ˜í”Œë¡œ $K \approx 2N/L - 1$ê°œì˜ êµ¬ê°„ íšë“ (Bartlettì˜ ì•½ ë‘ ë°°)</li>
<li><strong>ë‚®ì€ ë¶„ì‚°</strong>: ë” ë§ì€ í‰ê· í™”ì™€ ìœˆë„ì‰ëœ ëˆ„ì„¤ ê°ì†Œ</li>
<li><strong>ë™ì¼í•œ í•´ìƒë„</strong>: êµ¬ê°„ ê¸¸ì´ $L$ì— ì˜í•´ ê²°ì •</li>
</ul>
<h3 id="63">6.3 êµ¬í˜„ ë° ë¶„ì„<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">welch_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive Welch&#39;s method analysis.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">8192</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Signal: two closely spaced tones + broadband noise</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">108</span>  <span class="c1"># 8 Hz apart</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># 1. Effect of segment length (nperseg)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nperseg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">2048</span><span class="p">]):</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">nperseg</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;nperseg = </span><span class="si">{</span><span class="n">nperseg</span><span class="si">}</span><span class="s1">, Î”f = </span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="n">nperseg</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># 2. Effect of overlap</span>
    <span class="n">nperseg</span> <span class="o">=</span> <span class="mi">512</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">overlap_frac</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]):</span>
        <span class="n">noverlap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nperseg</span> <span class="o">*</span> <span class="n">overlap_frac</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">)</span>
        <span class="n">n_segs</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">noverlap</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">nperseg</span> <span class="o">-</span> <span class="n">noverlap</span><span class="p">)</span> <span class="k">if</span> <span class="n">noverlap</span> <span class="o">&lt;</span> <span class="n">nperseg</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overlap = </span><span class="si">{</span><span class="n">overlap_frac</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%, &#39;</span>
                              <span class="sa">f</span><span class="s1">&#39;K â‰ˆ </span><span class="si">{</span><span class="n">n_segs</span><span class="si">}</span><span class="s1"> segments&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Welch&#39;s Method: Segment Length and Overlap Effects&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;welch_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">welch_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="64">6.4 ìœˆë„ìš° íš¨ê³¼<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">welch_window_comparison</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare different windows in Welch&#39;s method.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">4096</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Signal with a weak tone near a strong one</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.01</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">130</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># 40 dB weaker</span>
         <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="n">windows</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;boxcar&#39;</span><span class="p">,</span> <span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;blackman&#39;</span><span class="p">,</span> <span class="s1">&#39;blackmanharris&#39;</span><span class="p">]</span>
    <span class="n">nperseg</span> <span class="o">=</span> <span class="mi">512</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
                               <span class="n">noverlap</span><span class="o">=</span><span class="n">nperseg</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Pxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (dB/Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Window Function Effect: Detecting a Weak Tone (-40 dB)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;welch_windows.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">welch_window_comparison</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-blackman-tukey">7. Blackman-Tukey ë°©ë²•<a class="header-link" href="#7-blackman-tukey" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ì›ë¦¬<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p><strong>Blackman-Tukey ë°©ë²•(Blackman-Tukey method)</strong> (1958)ì€ ìœ„ë„ˆ-í‚¨ì¹œ ì •ë¦¬ì— ê¸°ë°˜í•œ ê°„ì ‘ì  ì ‘ê·¼ë²•ì´ë‹¤:</p>
<ol>
<li>ìê¸°ìƒê´€ ìˆ˜ì—´ $\hat{r}_{xx}[k]$ë¥¼ ì¶”ì •í•œë‹¤</li>
<li>ìê¸°ìƒê´€ì— ìœˆë„ìš° $w[k]$ë¥¼ ì ìš©í•œë‹¤ (ì§€ì—° ë²”ìœ„ë¥¼ ì œí•œí•˜ê¸° ìœ„í•´)</li>
<li>ìœˆë„ì‰ëœ ìê¸°ìƒê´€ì˜ DTFTë¥¼ ê³„ì‚°í•œë‹¤</li>
</ol>
<p>$$\hat{S}_x^{(\text{BT})}(e^{j\omega}) = \sum_{k=-(M-1)}^{M-1} w[k] \hat{r}_{xx}[k] e^{-j\omega k}$$</p>
<p>ì—¬ê¸°ì„œ $M$ì€ ìµœëŒ€ ì§€ì—°(maximum lag)ì´ë‹¤.</p>
<h3 id="72">7.2 ìê¸°ìƒê´€ ì¶”ì •<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<p><strong>í¸í–¥(biased)</strong> ìê¸°ìƒê´€ ì¶”ì •ì¹˜:</p>
<p>$$\hat{r}_{xx}[k] = \frac{1}{N} \sum_{n=0}^{N-1-|k|} x[n+|k|] x^*[n], \quad |k| \leq N-1$$</p>
<p><strong>ë¹„í¸í–¥(unbiased)</strong> ì¶”ì •ì¹˜:</p>
<p>$$\hat{r}_{xx}^{(\text{unbiased})}[k] = \frac{1}{N - |k|} \sum_{n=0}^{N-1-|k|} x[n+|k|] x^*[n]$$</p>
<p>í¸í–¥ ì¶”ì •ì¹˜ê°€ ì„ í˜¸ë˜ëŠ”ë°, ì´ëŠ” ìŒì´ ì•„ë‹Œ PSDë¥¼ ë³´ì¥í•˜ëŠ” ë°˜ë©´ ë¹„í¸í–¥ ì¶”ì •ì¹˜ëŠ” ìŒìˆ˜ PSD ê°’ì„ ìƒì„±í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p>
<h3 id="73">7.3 ì§€ì—° ìœˆë„ìš°<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<p>ì§€ì—° ìœˆë„ìš°(lag window) $w[k]$ëŠ” PSD ì¶”ì •ì— ì ìš©ë˜ëŠ” í‰í™œí™”ë¥¼ ì œì–´í•œë‹¤:
- <strong>ì¢ì€ ìœˆë„ìš°</strong> ($M$ ì‘ìŒ): ë§¤ë„ëŸ¬ìš´ PSD, ë‚®ì€ ë¶„ì‚°, ë‚®ì€ í•´ìƒë„
- <strong>ë„“ì€ ìœˆë„ìš°</strong> ($M$ í¼): ê±°ì¹œ PSD, ë†’ì€ ë¶„ì‚°, ë†’ì€ í•´ìƒë„</p>
<p>ì¼ë°˜ì ì¸ ì§€ì—° ìœˆë„ìš°: Bartlett (ì‚¼ê°í˜•), Parzen, Tukey (ì½”ì‚¬ì¸ í…Œì´í¼).</p>
<h3 id="74">7.4 êµ¬í˜„<a class="header-link" href="#74" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">blackman_tukey_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;bartlett&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Blackman-Tukey PSD estimation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        fs: sampling frequency</span>
<span class="sd">        max_lag: maximum lag for autocorrelation</span>
<span class="sd">        window: lag window type</span>

<span class="sd">    Returns:</span>
<span class="sd">        f: frequency vector</span>
<span class="sd">        Pxx: PSD estimate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Biased autocorrelation estimate</span>
    <span class="n">r_xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">r_xx_lags</span> <span class="o">=</span> <span class="n">r_xx</span><span class="p">[</span><span class="n">center</span> <span class="o">-</span> <span class="n">max_lag</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">max_lag</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Apply lag window</span>
    <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="s1">&#39;bartlett&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_lag</span>
    <span class="k">elif</span> <span class="n">window</span> <span class="o">==</span> <span class="s1">&#39;parzen&#39;</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_lag</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span>
                     <span class="mi">1</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
                     <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">window</span> <span class="o">==</span> <span class="s1">&#39;tukey&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">lags</span> <span class="o">/</span> <span class="n">max_lag</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lags</span><span class="p">))</span>

    <span class="n">r_windowed</span> <span class="o">=</span> <span class="n">r_xx_lags</span> <span class="o">*</span> <span class="n">w</span>

    <span class="c1"># Compute PSD via DTFT</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">2048</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="n">Pxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega</span><span class="p">):</span>
        <span class="n">Pxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_windowed</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w_val</span> <span class="o">*</span> <span class="n">lags</span><span class="p">)))</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Ensure non-negative</span>
    <span class="n">Pxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Pxx</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span>

<span class="c1"># Compare with different max_lag values</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Theoretical</span>
<span class="n">f_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">omega_t</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_theory</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">Pxx_theory</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">omega_t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">max_lag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]):</span>
    <span class="n">f_bt</span><span class="p">,</span> <span class="n">Pxx_bt</span> <span class="o">=</span> <span class="n">blackman_tukey_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;bartlett&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_bt</span><span class="p">,</span> <span class="n">Pxx_bt</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BT estimate&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_theory</span><span class="p">,</span> <span class="n">Pxx_theory</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True PSD&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Blackman-Tukey (max_lag = </span><span class="si">{</span><span class="n">max_lag</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (VÂ²/Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Blackman-Tukey Method: Effect of Maximum Lag&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;blackman_tukey.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8-">8. í•´ìƒë„-ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„<a class="header-link" href="#8-" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ê·¼ë³¸ì  í•œê³„<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>ëª¨ë“  ë¹„ëª¨ìˆ˜ì  ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •ëŸ‰ì€ ê·¼ë³¸ì ì¸ íŠ¸ë ˆì´ë“œì˜¤í”„ì— ì§ë©´í•œë‹¤:</p>
<p>$$\text{í•´ìƒë„} \times \text{ë¶„ì‚°} \approx \text{ìƒìˆ˜}$$</p>
<ul>
<li>ë” ë‚˜ì€ ì£¼íŒŒìˆ˜ í•´ìƒë„ë¥¼ ìœ„í•´ì„œëŠ” ë” ê¸´ ê´€ì¸¡ ìœˆë„ìš°ê°€ í•„ìš”í•˜ê³ , ì´ëŠ” í‰ê·  ìˆ˜ê°€ ì¤„ì–´ë“¤ì–´ ë¶„ì‚°ì´ ë†’ì•„ì§ì„ ì˜ë¯¸í•œë‹¤</li>
<li>ë‚®ì€ ë¶„ì‚°ì„ ìœ„í•´ì„œëŠ” ë” ë§ì€ í‰ê· í™”ê°€ í•„ìš”í•˜ê³ , ì´ëŠ” ë” ì§§ì€ êµ¬ê°„ê³¼ ë‚®ì€ í•´ìƒë„ë¥¼ ì˜ë¯¸í•œë‹¤</li>
</ul>
<h3 id="82">8.2 ì •ëŸ‰ì  ë¶„ì„<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<p>ê¸¸ì´ $L$ì˜ $K$ê°œ êµ¬ê°„ì„ ì‚¬ìš©í•˜ëŠ” Welch ë°©ë²•ì—ì„œ:</p>
<ul>
<li><strong>í•´ìƒë„</strong>: $\Delta f = f_s / L$</li>
<li><strong>ì •ê·œí™” ë¶„ì‚°</strong>: $\text{Var}\{\hat{S}\} / S^2 \approx 1/K$</li>
<li><strong>ê³±</strong>: $\Delta f \times \text{Var}\{\hat{S}\} / S^2 \approx f_s / (KL) = f_s / N$</li>
</ul>
<p><strong>í•´ìƒë„ ëŒ€ì—­í­(Resolution Bandwidth, RBW)</strong>ê³¼ <strong>ë“±ê°€ ììœ ë„(Equivalent Degrees of Freedom, EDOF)</strong>ê°€ ì´ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ íŠ¹ì„±í™”í•œë‹¤:</p>
<p>$$\text{EDOF} \approx 2K \quad \text{(ë¹„ì¤‘ì²© êµ¬ê°„ì˜ ê²½ìš°)}$$</p>
<h3 id="83">8.3 ì‹œê°í™”<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolution_variance_tradeoff</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize the resolution-variance tradeoff.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">8192</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Two tones: 100 Hz and 110 Hz (10 Hz apart)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">110</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># Sweep segment length</span>
    <span class="n">nperseg_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">4096</span><span class="p">]</span>
    <span class="n">resolutions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">variances</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nperseg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nperseg_values</span><span class="p">):</span>
        <span class="c1"># Multiple realizations to estimate variance</span>
        <span class="n">psds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
            <span class="n">x_trial</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">110</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                       <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x_trial</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
                                   <span class="n">noverlap</span><span class="o">=</span><span class="n">nperseg</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">psds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pxx</span><span class="p">)</span>

        <span class="n">psds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psds</span><span class="p">)</span>
        <span class="n">mean_psd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">std_psd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">psds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">resolutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="n">nperseg</span><span class="p">)</span>
        <span class="n">variances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">std_psd</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">mean_psd</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mean_psd</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mean_psd</span> <span class="o">-</span> <span class="n">std_psd</span><span class="p">,</span> <span class="n">mean_psd</span> <span class="o">+</span> <span class="n">std_psd</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L=</span><span class="si">{</span><span class="n">nperseg</span><span class="si">}</span><span class="s1">, Î”f=</span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="n">nperseg</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Freq (Hz)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Summary plot</span>
    <span class="n">ax_summary</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">ax_summary</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">resolutions</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_summary</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Resolution Î”f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax_summary</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Variance&#39;</span><span class="p">)</span>
    <span class="n">ax_summary</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Resolution-Variance Tradeoff&#39;</span><span class="p">)</span>
    <span class="n">ax_summary</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Resolution vs Variance Tradeoff in Welch</span><span class="se">\&#39;</span><span class="s1">s Method&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;resolution_variance.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">resolution_variance_tradeoff</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9-ar">9. ëª¨ìˆ˜ì  ë°©ë²•: AR ëª¨ë¸<a class="header-link" href="#9-ar" title="Permanent link">&para;</a></h2>
<h3 id="91-ar">9.1 ìê¸°íšŒê·€(AR) ëª¨ë¸<a class="header-link" href="#91-ar" title="Permanent link">&para;</a></h3>
<p>ì°¨ìˆ˜ $p$ì˜ AR ê³¼ì •ì€ ë‹¤ìŒì„ ë§Œì¡±í•œë‹¤:</p>
<p>$$x[n] = -\sum_{k=1}^{p} a_k x[n-k] + w[n]$$</p>
<p>ì—¬ê¸°ì„œ $w[n]$ì€ ë¶„ì‚° $\sigma_w^2$ì¸ ë°±ìƒ‰ ì¡ìŒì´ë‹¤.</p>
<p>AR($p$) ê³¼ì •ì˜ PSD:</p>
<p>$$S_x(e^{j\omega}) = \frac{\sigma_w^2}{|A(e^{j\omega})|^2} = \frac{\sigma_w^2}{\left|1 + \sum_{k=1}^{p} a_k e^{-j\omega k}\right|^2}$$</p>
<h3 id="92-ar">9.2 AR ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ <a class="header-link" href="#92-ar" title="Permanent link">&para;</a></h3>
<p>AR ëª¨ë¸ì´ ì¸ê¸° ìˆëŠ” ì´ìœ :
- PSDê°€ ìŠ¤í™íŠ¸ëŸ¼ í”¼í¬ ëª¨ë¸ë§ì— ì í•©í•œ ë§¤ë„ëŸ½ê³  ë¾°ì¡±í•œ í˜•íƒœë¥¼ ê°€ì§
- íŒŒë¼ë¯¸í„° ì¶”ì •ì´ ì„ í˜• ë°©ì •ì‹ í’€ê¸°(Yule-Walker)ë¡œ ê·€ê²°ë¨
- ì§§ì€ ë°ì´í„°ì—ì„œë„ íƒì›”í•œ ì£¼íŒŒìˆ˜ í•´ìƒë„ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆìŒ
- ë§ì€ ìì—° ì‹ í˜¸(ìŒì„±, ì§„ë™)ê°€ AR ê³¼ì •ìœ¼ë¡œ ì˜ ëª¨ë¸ë§ë¨</p>
<h3 id="93-yule-walker">9.3 Yule-Walker ë°©ì •ì‹<a class="header-link" href="#93-yule-walker" title="Permanent link">&para;</a></h3>
<p>AR íŒŒë¼ë¯¸í„°ëŠ” <strong>Yule-Walker ë°©ì •ì‹</strong>ìœ¼ë¡œ ê²°ì •ëœë‹¤:</p>
<p>$$\begin{bmatrix} r_{xx}[0] & r_{xx}[1] & \cdots & r_{xx}[p-1] \\ r_{xx}[1] & r_{xx}[0] & \cdots & r_{xx}[p-2] \\ \vdots & \vdots & \ddots & \vdots \\ r_{xx}[p-1] & r_{xx}[p-2] & \cdots & r_{xx}[0] \end{bmatrix} \begin{bmatrix} a_1 \\ a_2 \\ \vdots \\ a_p \end{bmatrix} = -\begin{bmatrix} r_{xx}[1] \\ r_{xx}[2] \\ \vdots \\ r_{xx}[p] \end{bmatrix}$$</p>
<p>í–‰ë ¬ í˜•íƒœë¡œ: $\mathbf{R} \mathbf{a} = -\mathbf{r}$</p>
<h3 id="94-levinson-durbin">9.4 Levinson-Durbin ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#94-levinson-durbin" title="Permanent link">&para;</a></h3>
<p>Levinson-Durbin ì•Œê³ ë¦¬ì¦˜ì€ Yule-Walker ë°©ì •ì‹ì„ íš¨ìœ¨ì ìœ¼ë¡œ $O(p^2)$ ì—°ì‚°ìœ¼ë¡œ í’€ ìˆ˜ ìˆë‹¤ (ì§ì ‘ í–‰ë ¬ ì—­ì‚°ì˜ $O(p^3)$ ëŒ€ë¹„):</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Levinson-Durbin recursion for AR parameter estimation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        r: autocorrelation sequence r[0], r[1], ..., r[order]</span>
<span class="sd">        order: AR model order p</span>

<span class="sd">    Returns:</span>
<span class="sd">        a: AR coefficients [a1, a2, ..., ap]</span>
<span class="sd">        sigma2: driving noise variance</span>
<span class="sd">        reflection_coeffs: reflection coefficients (PARCOR)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="n">reflection_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

    <span class="c1"># Order 1</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reflection_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Recursion</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="c1"># Compute reflection coefficient</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">m</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">k_m</span> <span class="o">=</span> <span class="o">-</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">sigma2</span>
        <span class="n">reflection_coeffs</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_m</span>

        <span class="c1"># Update AR coefficients</span>
        <span class="n">a_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="n">a_new</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_m</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">a_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">k_m</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a_new</span>

        <span class="c1"># Update variance</span>
        <span class="n">sigma2</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">reflection_coeffs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ar_psd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute PSD from AR parameters.&quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># A(e^jw) = 1 + a1*e^(-jw) + a2*e^(-j2w) + ...</span>
    <span class="n">A_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="n">A_freq</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span>

    <span class="n">Pxx</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span>
</code></pre></div>

<h3 id="95-ar">9.5 AR ìŠ¤í™íŠ¸ëŸ¼ ì¶”ì •<a class="header-link" href="#95-ar" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ar_spectral_estimation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate AR spectral estimation.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c1"># Short data record</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># True signal: sum of two narrow peaks</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">120</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="c1"># Autocorrelation estimate (biased)</span>
    <span class="n">r_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">max_order</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Welch&#39;s method (for reference)</span>
    <span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx_welch</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>

    <span class="c1"># Different AR orders</span>
    <span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">orders</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Levinson-Durbin</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">refl</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

        <span class="c1"># AR PSD</span>
        <span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span> <span class="o">=</span> <span class="n">ar_psd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx_welch</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Welch&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;AR(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;AR Order p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;AR Spectral Estimation (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> samples)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ar_spectral.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">ar_spectral_estimation</span><span class="p">()</span>
</code></pre></div>

<h3 id="96-burg">9.6 Burg ë°©ë²•<a class="header-link" href="#96-burg" title="Permanent link">&para;</a></h3>
<p>Burg ë°©ë²•ì€ ë¨¼ì € ìê¸°ìƒê´€ì„ ê³„ì‚°í•˜ì§€ ì•Šê³  ë°ì´í„°ì—ì„œ ì§ì ‘ AR íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•˜ì—¬ ë” ë‚˜ì€ í•´ìƒë„ë¥¼ ì–»ëŠ”ë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">burg_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Burg&#39;s method for AR parameter estimation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        order: AR model order</span>

<span class="sd">    Returns:</span>
<span class="sd">        a: AR coefficients</span>
<span class="sd">        sigma2: prediction error power</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Initialize forward and backward prediction errors</span>
    <span class="n">ef</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">eb</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="c1"># Compute reflection coefficient</span>
        <span class="n">ef_m</span> <span class="o">=</span> <span class="n">ef</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">eb_m</span> <span class="o">=</span> <span class="n">eb</span><span class="p">[</span><span class="n">m</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">num</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ef_m</span> <span class="o">*</span> <span class="n">eb_m</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ef_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">eb_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span> <span class="k">if</span> <span class="n">den</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># Update AR coefficients</span>
        <span class="n">a_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="n">a_new</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">a_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a_new</span>

        <span class="c1"># Update prediction errors</span>
        <span class="n">ef_new</span> <span class="o">=</span> <span class="n">ef</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">eb</span><span class="p">[</span><span class="n">m</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">eb_new</span> <span class="o">=</span> <span class="n">eb</span><span class="p">[</span><span class="n">m</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">ef</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">ef</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">ef_new</span><span class="p">)</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ef_new</span>
        <span class="n">eb</span><span class="p">[</span><span class="n">m</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">eb_new</span><span class="p">)</span><span class="o">+</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">eb_new</span>

        <span class="c1"># Update variance</span>
        <span class="n">sigma2</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span>

<span class="c1"># Compare Burg vs Yule-Walker for a short data record</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># Very short!</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Two close sinusoids</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">115</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># AR order</span>

<span class="c1"># Yule-Walker</span>
<span class="n">r_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">a_yw</span><span class="p">,</span> <span class="n">sigma2_yw</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">f_yw</span><span class="p">,</span> <span class="n">Pxx_yw</span> <span class="o">=</span> <span class="n">ar_psd</span><span class="p">(</span><span class="n">a_yw</span><span class="p">,</span> <span class="n">sigma2_yw</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Burg</span>
<span class="n">a_burg</span><span class="p">,</span> <span class="n">sigma2_burg</span> <span class="o">=</span> <span class="n">burg_method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">f_burg</span><span class="p">,</span> <span class="n">Pxx_burg</span> <span class="o">=</span> <span class="n">ar_psd</span><span class="p">(</span><span class="n">a_burg</span><span class="p">,</span> <span class="n">sigma2_burg</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="c1"># Periodogram</span>
<span class="n">f_per</span><span class="p">,</span> <span class="n">Pxx_per</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_per</span><span class="p">,</span> <span class="n">Pxx_per</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_yw</span><span class="p">,</span> <span class="n">Pxx_yw</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Yule-Walker AR(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_burg</span><span class="p">,</span> <span class="n">Pxx_burg</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Burg AR(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">115</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Burg vs Yule-Walker (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;burg_method.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10-ma-arma">10. ëª¨ìˆ˜ì  ë°©ë²•: MA ë° ARMA<a class="header-link" href="#10-ma-arma" title="Permanent link">&para;</a></h2>
<h3 id="101-ma">10.1 ì´ë™ í‰ê· (MA) ëª¨ë¸<a class="header-link" href="#101-ma" title="Permanent link">&para;</a></h3>
<p>ì°¨ìˆ˜ $q$ì˜ MA ê³¼ì •:</p>
<p>$$x[n] = w[n] + \sum_{k=1}^{q} b_k w[n-k]$$</p>
<p>PSD:</p>
<p>$$S_x(e^{j\omega}) = \sigma_w^2 \left|1 + \sum_{k=1}^{q} b_k e^{-j\omega k}\right|^2$$</p>
<p>MA ëª¨ë¸ì€ ìŠ¤í™íŠ¸ëŸ¼ <strong>ì˜ì (nulls)</strong> (ìŠ¤í™íŠ¸ëŸ¼ì˜ ì˜)ì´ ìˆëŠ” ê³¼ì •ì— ìœ ìš©í•˜ë‹¤.</p>
<h3 id="102-arma">10.2 ARMA ëª¨ë¸<a class="header-link" href="#102-arma" title="Permanent link">&para;</a></h3>
<p>ARMA($p, q$) ê³¼ì •ì€ ARê³¼ MAë¥¼ ê²°í•©í•œë‹¤:</p>
<p>$$x[n] = -\sum_{k=1}^{p} a_k x[n-k] + w[n] + \sum_{k=1}^{q} b_k w[n-k]$$</p>
<p>PSD:</p>
<p>$$S_x(e^{j\omega}) = \sigma_w^2 \frac{|B(e^{j\omega})|^2}{|A(e^{j\omega})|^2}$$</p>
<p>ì—¬ê¸°ì„œ $B(z) = 1 + b_1 z^{-1} + \cdots + b_q z^{-q}$ì´ê³  $A(z) = 1 + a_1 z^{-1} + \cdots + a_p z^{-p}$ì´ë‹¤.</p>
<p>ARMA ëª¨ë¸ì€ ìˆœìˆ˜ AR ë˜ëŠ” MA ëª¨ë¸ë³´ë‹¤ ì ì€ íŒŒë¼ë¯¸í„°ë¡œ ìŠ¤í™íŠ¸ëŸ¼ í”¼í¬(AR ë¶€ë¶„)ì™€ ìŠ¤í™íŠ¸ëŸ¼ ì˜ì (MA ë¶€ë¶„)ì„ ëª¨ë‘ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.</p>
<h3 id="103-arma">10.3 ARMA íŒŒë¼ë¯¸í„° ì¶”ì •<a class="header-link" href="#103-arma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

<span class="k">def</span><span class="w"> </span><span class="nf">arma_psd_estimate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate ARMA(p,q) PSD using a two-stage method.</span>

<span class="sd">    Stage 1: Estimate AR model of high order to approximate the signal</span>
<span class="sd">    Stage 2: Fit ARMA(p,q) model to the AR-estimated autocorrelation</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        p: AR order</span>
<span class="sd">        q: MA order</span>
<span class="sd">        fs: sampling frequency</span>
<span class="sd">        nfft: FFT size for PSD computation</span>

<span class="sd">    Returns:</span>
<span class="sd">        f: frequency vector</span>
<span class="sd">        Pxx: PSD estimate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Stage 1: High-order AR estimate</span>
    <span class="n">high_order</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">r_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">high_order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a_high</span><span class="p">,</span> <span class="n">sigma2_high</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">high_order</span><span class="p">)</span>

    <span class="c1"># Stage 2: Fit ARMA(p,q) - simplified approach using scipy</span>
    <span class="c1"># We minimize the prediction error</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">arma_cost</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
        <span class="n">a_params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[:</span><span class="n">p</span><span class="p">]</span>
        <span class="n">b_params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">p</span><span class="p">:</span><span class="n">p</span><span class="o">+</span><span class="n">q</span><span class="p">]</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Compute theoretical autocorrelation from ARMA params</span>
        <span class="c1"># and compare with estimated autocorrelation</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Simple cost: prediction error on the data</span>
            <span class="c1"># Forward filter: A(z) * x[n] should be close to MA filtered noise</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">a_params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:</span><span class="n">N</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1e10</span>

    <span class="c1"># Initial guess from AR model</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r_init</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">a_init</span><span class="p">,</span> <span class="n">sigma_init</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r_init</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">[:</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_init</span>
    <span class="n">x0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># For simplicity, fall back to AR PSD as approximation</span>
    <span class="n">r_ar</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a_ar</span><span class="p">,</span> <span class="n">sigma2_ar</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r_ar</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="n">A_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_ar</span><span class="p">)):</span>
        <span class="n">A_freq</span> <span class="o">+=</span> <span class="n">a_ar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span>

    <span class="n">Pxx</span> <span class="o">=</span> <span class="n">sigma2_ar</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span>

<span class="c1"># Demonstrate: signal that needs ARMA model</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># True ARMA(2,2) process</span>
<span class="n">b_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># MA coefficients</span>
<span class="n">a_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">])</span>  <span class="c1"># AR coefficients</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x_arma</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b_true</span><span class="p">,</span> <span class="n">a_true</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

<span class="c1"># Compare AR and ARMA estimates</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Welch (reference)</span>
<span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx_welch</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x_arma</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx_welch</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Welch&#39;</span><span class="p">)</span>

<span class="c1"># AR estimates of different orders</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x_arma</span><span class="p">,</span> <span class="n">x_arma</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">a_est</span><span class="p">,</span> <span class="n">sig2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span> <span class="o">=</span> <span class="n">ar_psd</span><span class="p">(</span><span class="n">a_est</span><span class="p">,</span> <span class="n">sig2</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;AR(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># True ARMA PSD</span>
<span class="n">f_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">omega_t</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_true</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">B_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">b_true</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega_t</span><span class="p">))</span>
<span class="n">A_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">a_true</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega_t</span><span class="p">))</span>
<span class="n">Pxx_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">B_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_true</span><span class="p">,</span> <span class="n">Pxx_true</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True ARMA(2,2)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AR Approximation of ARMA Process&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;arma_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11_1">11. ëª¨ë¸ ì°¨ìˆ˜ ì„ íƒ<a class="header-link" href="#11_1" title="Permanent link">&para;</a></h2>
<h3 id="111">11.1 ë¬¸ì œ<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<p>ì˜¬ë°”ë¥¸ ëª¨ë¸ ì°¨ìˆ˜ $p$ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
- <strong>ë„ˆë¬´ ë‚®ìŒ</strong>: ê³¼ì†Œì í•©(underfitting), ìŠ¤í™íŠ¸ëŸ¼ í”¼í¬ ëˆ„ë½, í¸í–¥ëœ ì¶”ì •
- <strong>ë„ˆë¬´ ë†’ìŒ</strong>: ê³¼ëŒ€ì í•©(overfitting), ê°€ì§œ í”¼í¬, ë†’ì€ ë¶„ì‚°</p>
<h3 id="112">11.2 ì •ë³´ ê¸°ì¤€<a class="header-link" href="#112" title="Permanent link">&para;</a></h3>
<p><strong>ì•„ì¹´ì´ì¼€ ì •ë³´ ê¸°ì¤€(Akaike Information Criterion, AIC)</strong>:</p>
<p>$$\text{AIC}(p) = N \ln(\hat{\sigma}_p^2) + 2p$$</p>
<p><strong>ë² ì´ì§€ì•ˆ ì •ë³´ ê¸°ì¤€(Bayesian Information Criterion, BIC)</strong> (Schwarz ê¸°ì¤€ì´ë¼ê³ ë„ í•¨):</p>
<p>$$\text{BIC}(p) = N \ln(\hat{\sigma}_p^2) + p \ln(N)$$</p>
<p>ì—¬ê¸°ì„œ $\hat{\sigma}_p^2$ëŠ” ì°¨ìˆ˜ $p$ì—ì„œì˜ ì¶”ì • ì˜ˆì¸¡ ì˜¤ì°¨ ë¶„ì‚°ì´ë‹¤.</p>
<ul>
<li>AICëŠ” ì°¨ìˆ˜ë¥¼ ê³¼ëŒ€ì¶”ì •í•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤</li>
<li>BICëŠ” ì˜¬ë°”ë¥¸ ì°¨ìˆ˜ë¥¼ ì„ íƒí•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤ (ì¼ì¹˜ ì¶”ì •ëŸ‰)</li>
<li>ë‘˜ ë‹¤ ë³µì¡ë„ì— í˜ë„í‹°ë¥¼ ì£¼ì§€ë§Œ BICëŠ” í° $N$ì—ì„œ ë” ë¬´ê²ê²Œ í˜ë„í‹°ë¥¼ ì¤€ë‹¤</li>
</ul>
<h3 id="113-fpe">11.3 ìµœì¢… ì˜ˆì¸¡ ì˜¤ì°¨(FPE)<a class="header-link" href="#113-fpe" title="Permanent link">&para;</a></h3>
<p>$$\text{FPE}(p) = \hat{\sigma}_p^2 \cdot \frac{N + p + 1}{N - p - 1}$$</p>
<h3 id="114">11.4 êµ¬í˜„<a class="header-link" href="#114" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">model_order_selection</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select AR model order using AIC, BIC, and FPE.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x: input signal</span>
<span class="sd">        max_order: maximum order to test</span>

<span class="sd">    Returns:</span>
<span class="sd">        best_orders: dictionary of best orders by each criterion</span>
<span class="sd">        criteria: dictionary of criterion values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Autocorrelation</span>
    <span class="n">r_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">orders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">aic_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_order</span><span class="p">)</span>
    <span class="n">bic_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_order</span><span class="p">)</span>
    <span class="n">fpe_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_order</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orders</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">sigma2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sigma2</span><span class="p">,</span> <span class="mf">1e-15</span><span class="p">)</span>  <span class="c1"># Prevent log of zero</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">sigma2</span> <span class="o">=</span> <span class="mf">1e-15</span>

        <span class="n">aic_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span>
        <span class="n">bic_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">fpe_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">best_aic</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)]</span>
    <span class="n">best_bic</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">bic_values</span><span class="p">)]</span>
    <span class="n">best_fpe</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">fpe_values</span><span class="p">)]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;AIC&#39;</span><span class="p">:</span> <span class="n">best_aic</span><span class="p">,</span>
        <span class="s1">&#39;BIC&#39;</span><span class="p">:</span> <span class="n">best_bic</span><span class="p">,</span>
        <span class="s1">&#39;FPE&#39;</span><span class="p">:</span> <span class="n">best_fpe</span><span class="p">,</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="s1">&#39;AIC&#39;</span><span class="p">:</span> <span class="n">aic_values</span><span class="p">,</span>
        <span class="s1">&#39;BIC&#39;</span><span class="p">:</span> <span class="n">bic_values</span><span class="p">,</span>
        <span class="s1">&#39;FPE&#39;</span><span class="p">:</span> <span class="n">fpe_values</span><span class="p">,</span>
        <span class="s1">&#39;orders&#39;</span><span class="p">:</span> <span class="n">orders</span><span class="p">,</span>
    <span class="p">}</span>

<span class="c1"># Example: known AR(4) process</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># True AR(4)</span>
<span class="n">a_true</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.7607</span><span class="p">,</span> <span class="mf">3.8106</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6535</span><span class="p">,</span> <span class="mf">0.9238</span><span class="p">]</span>  <span class="c1"># 4 poles</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x_ar4</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">a_true</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

<span class="n">best_orders</span><span class="p">,</span> <span class="n">criteria</span> <span class="o">=</span> <span class="n">model_order_selection</span><span class="p">(</span><span class="n">x_ar4</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True order: 4&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AIC selects: p = </span><span class="si">{</span><span class="n">best_orders</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BIC selects: p = </span><span class="si">{</span><span class="n">best_orders</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FPE selects: p = </span><span class="si">{</span><span class="n">best_orders</span><span class="p">[</span><span class="s1">&#39;FPE&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;AIC&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]),</span>
                                       <span class="p">(</span><span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]),</span>
                                       <span class="p">(</span><span class="s1">&#39;FPE&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;FPE&#39;</span><span class="p">])]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;orders&#39;</span><span class="p">],</span> <span class="n">values</span><span class="p">,</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">best_p</span> <span class="o">=</span> <span class="n">best_orders</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">best_p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Best: p=</span><span class="si">{</span><span class="n">best_p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True: p=4&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Model Order p&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (Best: p=</span><span class="si">{</span><span class="n">best_p</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Model Order Selection for AR(4) Process&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;model_order_selection.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="12_1">12. êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ê³¼ ì½”íˆëŸ°ìŠ¤<a class="header-link" href="#12_1" title="Permanent link">&para;</a></h2>
<h3 id="121">12.1 êµì°¨ ì „ë ¥ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„<a class="header-link" href="#121" title="Permanent link">&para;</a></h3>
<p>ë‘ ì‹ í˜¸ $x[n]$ê³¼ $y[n]$ ì‚¬ì´ì˜ <strong>êµì°¨ PSD(cross-PSD)</strong>:</p>
<p>$$S_{xy}(e^{j\omega}) = \sum_{k=-\infty}^{\infty} r_{xy}[k] e^{-j\omega k}$$</p>
<p>ì—¬ê¸°ì„œ $r_{xy}[k] = E\{x[n] y^*[n-k]\}$ëŠ” êµì°¨ìƒê´€(cross-correlation)ì´ë‹¤.</p>
<p>êµì°¨ PSDëŠ” ì¼ë°˜ì ìœ¼ë¡œ <strong>ë³µì†Œìˆ˜ê°’</strong>ì´ë‹¤:</p>
<p>$$S_{xy}(e^{j\omega}) = |S_{xy}(e^{j\omega})| e^{j\phi_{xy}(\omega)}$$</p>
<h3 id="122">12.2 ì½”íˆëŸ°ìŠ¤<a class="header-link" href="#122" title="Permanent link">&para;</a></h3>
<p><strong>í¬ê¸° ì œê³± ì½”íˆëŸ°ìŠ¤(Magnitude-Squared Coherence, MSC)</strong>ëŠ” ê° ì£¼íŒŒìˆ˜ì—ì„œ ë‘ ì‹ í˜¸ ê°„ì˜ ì„ í˜• ê´€ê³„ë¥¼ ì¸¡ì •í•œë‹¤:</p>
<p>$$C_{xy}(f) = \frac{|S_{xy}(f)|^2}{S_{xx}(f) \cdot S_{yy}(f)}$$</p>
<p>ì„±ì§ˆ:
- $0 \leq C_{xy}(f) \leq 1$
- $C_{xy}(f) = 1$: ì£¼íŒŒìˆ˜ $f$ì—ì„œ ì™„ì „í•œ ì„ í˜• ê´€ê³„
- $C_{xy}(f) = 0$: ì£¼íŒŒìˆ˜ $f$ì—ì„œ ì„ í˜• ê´€ê³„ ì—†ìŒ
- ê° ì£¼íŒŒìˆ˜ì—ì„œì˜ $R^2$ (ê²°ì • ê³„ìˆ˜)ì— ìœ ì‚¬</p>
<h3 id="123">12.3 ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼<a class="header-link" href="#123" title="Permanent link">&para;</a></h3>
<p><strong>êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ìœ„ìƒ(cross-spectral phase)</strong>ì€ ëŒ€ì‘í•˜ëŠ” ì£¼íŒŒìˆ˜ ì„±ë¶„ ê°„ì˜ ìœ„ìƒ ì°¨ì´ë¥¼ ë³´ì—¬ì¤€ë‹¤:</p>
<p>$$\phi_{xy}(f) = \angle S_{xy}(f) = \arctan\frac{\text{Im}\{S_{xy}(f)\}}{\text{Re}\{S_{xy}(f)\}}$$</p>
<h3 id="124">12.4 êµ¬í˜„<a class="header-link" href="#124" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cross_spectral_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate cross-spectral analysis and coherence.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">8192</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># System: y is a filtered and delayed version of x, plus independent noise</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Input: broadband noise + tone</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># System: bandpass filter + delay</span>
    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="n">delay_samples</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">delay_samples</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y_filtered</span><span class="p">[:</span><span class="n">N</span> <span class="o">-</span> <span class="n">delay_samples</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># Add independent noise</span>

    <span class="c1"># Compute cross-spectral quantities</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pyy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">csd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

    <span class="c1"># Coherence</span>
    <span class="n">f_coh</span><span class="p">,</span> <span class="n">Cxy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

    <span class="c1"># Phase</span>
    <span class="n">phase_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Pxy</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Auto-PSDs</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sxx&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pyy</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Syy&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Auto Power Spectral Densities&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Cross-PSD magnitude</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Pxy</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cross-PSD |Sxy|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Sxy|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Coherence</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_coh</span><span class="p">,</span> <span class="n">Cxy</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="mi">80</span><span class="o">/</span><span class="mi">500</span><span class="p">,</span> <span class="mi">200</span><span class="o">/</span><span class="mi">500</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis_transform</span><span class="p">())</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Coherence Cxy(f)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Coherence&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Phase spectrum (only where coherence is significant)</span>
    <span class="n">significant</span> <span class="o">=</span> <span class="n">Cxy</span> <span class="o">&gt;</span> <span class="mf">0.3</span>
    <span class="n">f_sig</span> <span class="o">=</span> <span class="n">f_coh</span><span class="p">[</span><span class="n">significant</span><span class="p">]</span>
    <span class="n">phase_sig</span> <span class="o">=</span> <span class="n">phase_xy</span><span class="p">[</span><span class="n">significant</span><span class="p">]</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_sig</span><span class="p">,</span> <span class="n">phase_sig</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cross-Spectral Phase (where C &gt; 0.3)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Transfer function estimate</span>
    <span class="n">H_est</span> <span class="o">=</span> <span class="n">Pxy</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
    <span class="n">w_sys</span><span class="p">,</span> <span class="n">H_sys</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_est</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated |H(f)|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_sys</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_sys</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span>
                     <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True |H(f)|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Transfer Function Estimate&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Time-domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">y</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Cross-Spectral Analysis and Coherence&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cross_spectral.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">cross_spectral_analysis</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="13_1">13. ìŠ¤í™íŠ¸ë¡œê·¸ë¨<a class="header-link" href="#13_1" title="Permanent link">&para;</a></h2>
<h3 id="131-">13.1 ì‹œê°„-ì£¼íŒŒìˆ˜ ë¶„ì„<a class="header-link" href="#131-" title="Permanent link">&para;</a></h3>
<p><strong>ìŠ¤í™íŠ¸ë¡œê·¸ë¨(spectrogram)</strong>ì€ ì‹ í˜¸ì˜ ì£¼íŒŒìˆ˜ ë‚´ìš©ì´ ì‹œê°„ì— ë”°ë¼ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤. ë‹¨ì‹œê°„ í‘¸ë¦¬ì— ë³€í™˜(Short-Time Fourier Transform, STFT)ì˜ ì‹œí€€ìŠ¤ë¡œ ê³„ì‚°ëœë‹¤:</p>
<p>$$S(t, f) = \left| \text{STFT}\{x[n]\}(t, f) \right|^2 = \left| \sum_{m=-\infty}^{\infty} x[m] w[m - t] e^{-j2\pi f m} \right|^2$$</p>
<p>ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì€ ë³¸ì§ˆì ìœ¼ë¡œ ì‹ í˜¸ë¥¼ ë”°ë¼ ìœˆë„ìš°ë¥¼ ìŠ¬ë¼ì´ë”©í•˜ì—¬ ì–»ì€ ì‹œë³€ PSDì´ë‹¤.</p>
<h3 id="132">13.2 íŒŒë¼ë¯¸í„°<a class="header-link" href="#132" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ìœˆë„ìš° ê¸¸ì´</strong> (nperseg): ì£¼íŒŒìˆ˜ í•´ìƒë„ ê²°ì • ($\Delta f = f_s / \text{nperseg}$)</li>
<li><strong>ì¤‘ì²©(Overlap)</strong>: ì‹œê°„ í•´ìƒë„ ê²°ì • (ë” ë§ì€ ì¤‘ì²© = ë” ì„¸ë°€í•œ ì‹œê°„ ìŠ¤í…)</li>
<li><strong>ìœˆë„ìš° íƒ€ì…</strong>: ìŠ¤í™íŠ¸ëŸ¼ ëˆ„ì„¤ ì œì–´ (Welch ë°©ë²•ê³¼ ë™ì¼)</li>
</ul>
<h3 id="133-">13.3 ì‹œê°„-ì£¼íŒŒìˆ˜ í•´ìƒë„<a class="header-link" href="#133-" title="Permanent link">&para;</a></h3>
<p><strong>ë¶ˆí™•ì •ì„± ì›ë¦¬(uncertainty principle)</strong>ëŠ” ë™ì‹œ ì‹œê°„ ë° ì£¼íŒŒìˆ˜ í•´ìƒë„ë¥¼ ì œí•œí•œë‹¤:</p>
<p>$$\Delta t \cdot \Delta f \geq \frac{1}{4\pi}$$</p>
<ul>
<li><strong>ê¸´ ìœˆë„ìš°</strong>: ë†’ì€ ì£¼íŒŒìˆ˜ í•´ìƒë„, ë‚®ì€ ì‹œê°„ í•´ìƒë„</li>
<li><strong>ì§§ì€ ìœˆë„ìš°</strong>: ë†’ì€ ì‹œê°„ í•´ìƒë„, ë‚®ì€ ì£¼íŒŒìˆ˜ í•´ìƒë„</li>
</ul>
<h3 id="134">13.4 êµ¬í˜„<a class="header-link" href="#134" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spectrogram_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate spectrogram with different parameters.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Create a time-varying signal</span>
    <span class="c1"># Chirp (frequency sweep from 100 to 3000 Hz)</span>
    <span class="n">x_chirp</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">f1</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

    <span class="c1"># Add some tone bursts</span>
    <span class="n">x_bursts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">burst_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">burst_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">x_bursts</span><span class="p">[</span><span class="n">burst_start</span><span class="p">:</span><span class="n">burst_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">1500</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">burst_start</span><span class="p">:</span><span class="n">burst_end</span><span class="p">])</span>

    <span class="n">burst_start2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">burst_end2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">x_bursts</span><span class="p">[</span><span class="n">burst_start2</span><span class="p">:</span><span class="n">burst_end2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2500</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">burst_start2</span><span class="p">:</span><span class="n">burst_end2</span><span class="p">])</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x_chirp</span> <span class="o">+</span> <span class="n">x_bursts</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

    <span class="c1"># Time domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Signal (Chirp + Tone Bursts + Noise)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrum (overall)</span>
    <span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_welch</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Overall PSD (Welch)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrograms with different window sizes</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">title_prefix</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;Short&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">),</span>
                                                     <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;Long&#39;</span><span class="p">)]):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>

        <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
                                                    <span class="n">noverlap</span><span class="o">=</span><span class="n">nperseg</span><span class="o">*</span><span class="mi">3</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span>
                                                    <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span>
                                        <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                                        <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                                        <span class="n">vmin</span><span class="o">=-</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title_prefix</span><span class="si">}</span><span class="s1"> Window (nperseg=</span><span class="si">{</span><span class="n">nperseg</span><span class="si">}</span><span class="s1">, &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;Î”f=</span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="n">nperseg</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz, &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;Î”t=</span><span class="si">{</span><span class="n">nperseg</span><span class="o">/</span><span class="n">fs</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> ms)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSD (dB)&#39;</span><span class="p">)</span>

    <span class="c1"># matplotlib specgram for comparison</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;matplotlib specgram (NFFT=256)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Spectrogram: Time-Frequency Analysis&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spectrogram_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">spectrogram_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="135">13.5 ëŒ€í™”í˜• ìŠ¤í™íŠ¸ë¡œê·¸ë¨ ì˜ˆì œ<a class="header-link" href="#135" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">music_like_spectrogram</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a spectrogram of a music-like signal.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mf">3.0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Simulate a simple melody</span>
    <span class="n">notes_hz</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;C4&#39;</span><span class="p">:</span> <span class="mf">261.63</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">:</span> <span class="mf">293.66</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">:</span> <span class="mf">329.63</span><span class="p">,</span> <span class="s1">&#39;F4&#39;</span><span class="p">:</span> <span class="mf">349.23</span><span class="p">,</span>
        <span class="s1">&#39;G4&#39;</span><span class="p">:</span> <span class="mf">392.00</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">:</span> <span class="mf">440.00</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">:</span> <span class="mf">493.88</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">:</span> <span class="mf">523.25</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">melody</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span>
              <span class="s1">&#39;F4&#39;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">]</span>
    <span class="n">note_duration</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">melody</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">note</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">melody</span><span class="p">):</span>
        <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">note_duration</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">note_duration</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="n">t_note</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">start_idx</span><span class="p">]</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="n">notes_hz</span><span class="p">[</span><span class="n">note</span><span class="p">]</span>

        <span class="c1"># Envelope (ADSR-like)</span>
        <span class="n">env_len</span> <span class="o">=</span> <span class="n">end_idx</span> <span class="o">-</span> <span class="n">start_idx</span>
        <span class="n">attack</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
        <span class="n">decay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
        <span class="n">release</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>

        <span class="n">envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">env_len</span><span class="p">)</span>
        <span class="n">envelope</span><span class="p">[:</span><span class="n">attack</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">attack</span><span class="p">)</span>
        <span class="n">envelope</span><span class="p">[</span><span class="n">attack</span><span class="p">:</span><span class="n">attack</span><span class="o">+</span><span class="n">decay</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>
        <span class="n">envelope</span><span class="p">[</span><span class="o">-</span><span class="n">release</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">release</span><span class="p">)</span>

        <span class="c1"># Add harmonics</span>
        <span class="k">for</span> <span class="n">harmonic</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">envelope</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="n">harmonic</span><span class="o">*</span><span class="n">t_note</span><span class="p">)</span> <span class="o">/</span> <span class="n">harmonic</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># Add slight noise</span>

    <span class="c1"># Spectrogram</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Music-like Signal (Time Domain)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
                                               <span class="n">noverlap</span><span class="o">=</span><span class="mi">3072</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                             <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span>
                             <span class="n">vmin</span><span class="o">=-</span><span class="mi">80</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrogram&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSD (dB)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;music_spectrogram.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">music_like_spectrogram</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="14-python">14. Python êµ¬í˜„<a class="header-link" href="#14-python" title="Permanent link">&para;</a></h2>
<h3 id="141">14.1 ì¢…í•© ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ íˆ´í‚·<a class="header-link" href="#141" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SpectralAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete spectral analysis toolkit.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">periodogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;boxcar&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute periodogram.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="n">nfft</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">welch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Welch&#39;s PSD estimate.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">noverlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">noverlap</span> <span class="o">=</span> <span class="n">nperseg</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
                           <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ar_psd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;burg&#39;</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute AR model PSD.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Auto-select using BIC</span>
            <span class="n">best_orders</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model_order_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">best_orders</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto-selected AR order: p = </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (BIC)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;burg&#39;</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span> <span class="o">=</span> <span class="n">burg_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
            <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r_full</span><span class="p">[</span><span class="n">center</span><span class="p">:</span><span class="n">center</span> <span class="o">+</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">levinson_durbin</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>

        <span class="n">A_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="n">A_freq</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span>

        <span class="n">Pxx</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute spectrogram.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">noverlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">noverlap</span> <span class="o">=</span> <span class="n">nperseg</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">4</span>
        <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
                                   <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">comprehensive_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;comprehensive_spectral.png&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform and plot comprehensive spectral analysis.&quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

        <span class="c1"># Time domain</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Periodogram</span>
        <span class="n">f_per</span><span class="p">,</span> <span class="n">Pxx_per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodogram</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_per</span><span class="p">,</span> <span class="n">Pxx_per</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Welch</span>
        <span class="n">f_w</span><span class="p">,</span> <span class="n">Pxx_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">nperseg</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_w</span><span class="p">,</span> <span class="n">Pxx_w</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Welch&#39;s Method&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># AR PSD</span>
        <span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ar_psd</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_ar</span><span class="p">,</span> <span class="n">Pxx_ar</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AR (Burg)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_w</span><span class="p">,</span> <span class="n">Pxx_w</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Welch&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AR Spectral Estimate&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># Spectrogram</span>
        <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">nperseg</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span>
                                     <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                                     <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrogram&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSD (dB)&#39;</span><span class="p">)</span>

        <span class="c1"># Autocorrelation</span>
        <span class="n">max_lag</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">max_lag</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>
                         <span class="n">r</span><span class="p">[</span><span class="n">center</span><span class="o">-</span><span class="n">max_lag</span><span class="p">:</span><span class="n">center</span><span class="o">+</span><span class="n">max_lag</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lag (ms)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r_xx[k]&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comprehensive Spectral Analysis&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">fig</span>

<span class="c1"># Example usage</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Complex signal: tones + AR noise + chirp</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
     <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">120</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
     <span class="n">signal</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">300</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">+</span>
     <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">SpectralAnalyzer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">analyzer</span><span class="o">.</span><span class="n">comprehensive_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="142">14.2 ì‹¤ì„¸ê³„ ì˜ˆì œ: ì§„ë™ ë¶„ì„<a class="header-link" href="#142" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vibration_analysis_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate vibration analysis of a rotating machine.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># 10 kHz sampling</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mf">5.0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># Fundamental rotation frequency</span>
    <span class="n">f_rot</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Hz (1800 RPM)</span>

    <span class="c1"># Normal vibration: fundamental + harmonics</span>
    <span class="n">x_normal</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="c1"># Faulty vibration: bearing defect frequency</span>
    <span class="n">f_bearing</span> <span class="o">=</span> <span class="mf">4.7</span> <span class="o">*</span> <span class="n">f_rot</span>  <span class="c1"># Ball pass frequency (outer race)</span>
    <span class="n">x_faulty</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_bearing</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># Bearing defect</span>
                <span class="mf">0.15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">f_bearing</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># PSDs</span>
    <span class="n">f_n</span><span class="p">,</span> <span class="n">Pxx_n</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x_normal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
    <span class="n">f_f</span><span class="p">,</span> <span class="n">Pxx_f</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x_faulty</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_n</span><span class="p">,</span> <span class="n">Pxx_n</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal Machine PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">f_rot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_f</span><span class="p">,</span> <span class="n">Pxx_f</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Faulty Machine PSD (Bearing Defect)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">f_rot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_bearing</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;BPFO = </span><span class="si">{</span><span class="n">f_bearing</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f_bearing</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Overlay comparison</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_n</span><span class="p">,</span> <span class="n">Pxx_n</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f_f</span><span class="p">,</span> <span class="n">Pxx_f</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Faulty&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparison&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrogram (faulty - developing fault)</span>
    <span class="c1"># Simulate fault developing over time</span>
    <span class="n">x_developing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">fault_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># Gradually increasing</span>
    <span class="n">x_developing</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                    <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">f_rot</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">fault_amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_bearing</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
                    <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="n">f_spec</span><span class="p">,</span> <span class="n">t_spec</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">x_developing</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span>
                                               <span class="n">nperseg</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">1536</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_spec</span><span class="p">,</span> <span class="n">f_spec</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">),</span>
                                <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                <span class="n">vmin</span><span class="o">=-</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Developing Fault (Spectrogram)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSD (dB)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Vibration Spectral Analysis: Machine Condition Monitoring&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vibration_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">vibration_analysis_demo</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="15">15. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#15" title="Permanent link">&para;</a></h2>
<h3 id="1-vs-welch">ì—°ìŠµ ë¬¸ì œ 1: ì£¼ê¸°ë„ vs Welch<a class="header-link" href="#1-vs-welch" title="Permanent link">&para;</a></h3>
<p>100, 150, 200 Hzì—ì„œ ì§„í­ 1.0, 0.5, 0.1ì¸ ì„¸ ê°œì˜ ì •í˜„íŒŒì™€ ê°€ë²• ë°±ìƒ‰ ê°€ìš°ì‹œì•ˆ ì¡ìŒ(SNR = 10 dB)ìœ¼ë¡œ êµ¬ì„±ëœ ì‹ í˜¸ë¥¼ ìƒì„±í•˜ë¼. $f_s = 1000$ Hz, $N = 4096$ ìƒ˜í”Œì„ ì‚¬ìš©í•œë‹¤.</p>
<p>(a) ì£¼ê¸°ë„ë¥¼ ê³„ì‚°í•˜ê³  ê·¸ë ¤ë¼. ì„¸ ê°œì˜ ìŒì¡°ë¥¼ ëª¨ë‘ ì‹ë³„í•  ìˆ˜ ìˆëŠ”ê°€?</p>
<p>(b) <code>nperseg = 256</code>ê³¼ <code>512</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ Welch ë°©ë²•ì„ ì ìš©í•˜ë¼. ì–´ëŠ ì„¤ì •ì´ ìŒì¡°ë¥¼ ë” ì˜ ë¶„í•´í•˜ëŠ”ê°€?</p>
<p>(c) ìœˆë„ìš° í•¨ìˆ˜ ì„ íƒ(<code>boxcar</code>, <code>hann</code>, <code>blackmanharris</code>)ì´ ê°€ì¥ ì•½í•œ ìŒì¡°(200 Hz)ë¥¼ ê°ì§€í•˜ëŠ” ëŠ¥ë ¥ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€?</p>
<p>(d) 100ë²ˆì˜ ëª¬í…Œ ì¹´ë¥¼ë¡œ ì‹œí–‰ì„ ì‹¤í–‰í•˜ì—¬ ê° PSD ì¶”ì •ì¹˜ì˜ ë¶„ì‚°ì„ ê³„ì‚°í•˜ë¼. ê° ë°©ë²•ì— ëŒ€í•´ ì£¼íŒŒìˆ˜ì˜ í•¨ìˆ˜ë¡œ ë¶„ì‚°ì„ ê·¸ë ¤ë¼.</p>
<h3 id="2-ar">ì—°ìŠµ ë¬¸ì œ 2: AR ëª¨ë¸ ì‹ë³„<a class="header-link" href="#2-ar" title="Permanent link">&para;</a></h3>
<p>ì•Œë ¤ì§„ ê³„ìˆ˜ë¥¼ ê°–ëŠ” AR(4) ê³¼ì •ì„ ìƒì„±í•˜ë¼:
$x[n] + 1.5x[n-1] - 0.75x[n-2] + 0.2x[n-3] - 0.05x[n-4] = w[n]$</p>
<p>(a) $N = 512$ ìƒ˜í”Œì„ ìƒì„±í•˜ê³  ì°¨ìˆ˜ $p = 2, 4, 6, 8, 12$ì— ëŒ€í•´ Yule-Walker ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ AR íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•˜ë¼.</p>
<p>(b) ê° ì°¨ìˆ˜ì— ëŒ€í•´ ì¶”ì •ëœ PSDì™€ ì°¸ PSDë¥¼ í•¨ê»˜ ê³„ì‚°í•˜ê³  ê·¸ë ¤ë¼.</p>
<p>(c) AICì™€ BICë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì  ì°¨ìˆ˜ë¥¼ ì„ íƒí•˜ë¼. ë‘˜ ë‹¤ ë™ì˜í•˜ëŠ”ê°€?</p>
<p>(d) $N = 64$ ìƒ˜í”Œë¡œ ë°˜ë³µí•˜ë¼. ë°ì´í„° ê¸¸ì´ ê°ì†Œê°€ ê²°ê³¼ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€?</p>
<h3 id="3">ì—°ìŠµ ë¬¸ì œ 3: êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ë‘ ì„¼ì„œê°€ êµ¬ì¡°ë¬¼ì˜ ì„œë¡œ ë‹¤ë¥¸ ìœ„ì¹˜ì—ì„œ ì§„ë™ì„ ì¸¡ì •í•œë‹¤. ì´ë“¤ ì‚¬ì´ì˜ ì‹œìŠ¤í…œ ì „ë‹¬ í•¨ìˆ˜ëŠ” 150 Hzë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” 4ì°¨ ëŒ€ì—­í†µê³¼ í•„í„°ì´ë‹¤.</p>
<p>(a) ì…ë ¥(ê´‘ëŒ€ì—­ ëœë¤ ê°€ì§„)ê³¼ ì¶œë ¥(í•„í„°ë§ + ë…ë¦½ ì¡ìŒ)ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ë¼.</p>
<p>(b) ì½”íˆëŸ°ìŠ¤ í•¨ìˆ˜ë¥¼ ì¶”ì •í•˜ë¼. ì–´ëŠ ì£¼íŒŒìˆ˜ì—ì„œ ì½”íˆëŸ°ìŠ¤ê°€ ê°€ì¥ ë†’ì€ê°€?</p>
<p>(c) êµì°¨ ìŠ¤í™íŠ¸ëŸ¼ ë°€ë„ë¡œë¶€í„° ì „ë‹¬ í•¨ìˆ˜ í¬ê¸°ì™€ ìœ„ìƒì„ ì¶”ì •í•˜ë¼.</p>
<p>(d) ìœ„ìƒ ìŠ¤í™íŠ¸ëŸ¼ìœ¼ë¡œë¶€í„° êµ°ì§€ì—°(group delay)ì„ ê³„ì‚°í•˜ë¼. ì•Œë ¤ì§„ í•„í„° êµ°ì§€ì—°ê³¼ ì¼ì¹˜í•˜ëŠ”ê°€?</p>
<h3 id="4_1">ì—°ìŠµ ë¬¸ì œ 4: ë°•ì¥ ë°˜í–¥ ìœ„ì¹˜ ì¸¡ì • ìŠ¤í™íŠ¸ë¡œê·¸ë¨<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒìœ¼ë¡œ êµ¬ì„±ëœ í•©ì„± ë°•ì¥ ë°˜í–¥ ìœ„ì¹˜ ì¸¡ì • ì‹ í˜¸ë¥¼ ë§Œë“¤ì–´ë¼:
- ê°ê° 100 kHzì—ì„œ 50 kHzë¡œ 5 ms ë™ì•ˆ ìŠ¤ìœ•í•˜ëŠ” 5ê°œì˜ ì²˜í”„(chirp) ì‹œí€€ìŠ¤
- 50 msì˜ í„ìŠ¤ ê°„ê²©
- -20 dBì˜ ê°€ë²• ì¡ìŒ</p>
<p>(a) Hanning ìœˆë„ìš°ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì„ ê·¸ë ¤ë¼. <code>nperseg = 64, 256, 1024</code>ë¡œ ì‹¤í—˜í•˜ì—¬ ìµœì ì˜ ì ˆì¶©ì ì„ ì°¾ì•„ë¼.</p>
<p>(b) ìŠ¤í™íŠ¸ë¡œê·¸ë¨ í”¼í¬ì—ì„œ ìˆœê°„ ì£¼íŒŒìˆ˜ë¥¼ ì¸¡ì •í•˜ë¼. ì•Œë ¤ì§„ ì²˜í”„ ì†ë„ì™€ ë¹„êµí•˜ë¼.</p>
<p>(c) ì—ì½”(ê°ì‡ ë˜ê³  ì§€ì—°ëœ ë³µì‚¬ë³¸)ë¥¼ ì¶”ê°€í•˜ë¼. ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì—ì„œ ì—ì½”ë¥¼ ê°ì§€í•  ìˆ˜ ìˆëŠ”ê°€? ìµœì†Œ ê°ì§€ ê°€ëŠ¥ ì§€ì—°ì€ ì–¼ë§ˆì¸ê°€?</p>
<h3 id="5">ì—°ìŠµ ë¬¸ì œ 5: í•´ìƒë„ í•œê³„<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>ì£¼íŒŒìˆ˜ $f_1$ê³¼ $f_2 = f_1 + \Delta f$ì˜ ë“±í­ ë‘ ì •í˜„íŒŒê°€ ì¡ìŒ ì†ì— ìˆë‹¤.</p>
<p>(a) $f_1 = 100$ Hz, $f_s = 1000$ Hz, $N = 256$ì¼ ë•Œ: ì£¼ê¸°ë„ê°€ ë‘ ìŒì¡°ë¥¼ ë¶„í•´í•  ìˆ˜ ìˆëŠ” ìµœì†Œ $\Delta f$ëŠ” ì–¼ë§ˆì¸ê°€? ì‹¤í—˜ì ìœ¼ë¡œ ê²€ì¦í•˜ë¼.</p>
<p>(b) $\Delta f = 5$ Hzì— ëŒ€í•´ ì£¼ê¸°ë„, Welch ë°©ë²• ($\text{nperseg} = 128$), AR Burg ë°©ë²• ($p = 20$)ì˜ í•´ìƒë„ë¥¼ ë¹„êµí•˜ë¼.</p>
<p>(c) SNRì´ í•´ìƒë„ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€? SNR = 0, 10, 20, 40 dBë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ê° ë°©ë²•ì— ëŒ€í•´ ìµœì†Œ ë¶„í•´ ê°€ëŠ¥í•œ $\Delta f$ë¥¼ ê·¸ë ¤ë¼.</p>
<h3 id="6-eeg">ì—°ìŠµ ë¬¸ì œ 6: ì‹¤ì„¸ê³„ ì‘ìš©: EEG ë¶„ì„<a class="header-link" href="#6-eeg" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ í¬í•¨í•˜ëŠ” ë‹¨ìˆœí™”ëœ EEG ì‹ í˜¸ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ë¼:
- "ëˆˆ ê°ìŒ" ìƒíƒœ ë™ì•ˆì˜ ì•ŒíŒŒ ëŒ€ì—­ í™œë™(8-13 Hz)
- "ëˆˆ ëœ¸" ìƒíƒœ ë™ì•ˆì˜ ë² íƒ€ ëŒ€ì—­ í™œë™(13-30 Hz)
- $t = 5$ sì—ì„œ ëˆˆ ê°ìŒì—ì„œ ëˆˆ ëœ¸ìœ¼ë¡œì˜ ì „í™˜</p>
<p>(a) $f_s = 256$ Hzì—ì„œ ë‘ ìƒíƒœ ê°„ì— ì „í™˜í•˜ëŠ” 10ì´ˆ ì‹ í˜¸ë¥¼ ë§Œë“¤ì–´ë¼.</p>
<p>(b) ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì„ ê³„ì‚°í•˜ê³  ì „í™˜ ì§€ì ì„ ì‹ë³„í•˜ë¼.</p>
<p>(c) ì‹œê°„ì— ë”°ë¥¸ ì•ŒíŒŒì™€ ë² íƒ€ ëŒ€ì—­ì˜ ëŒ€ì—­ ì „ë ¥(ì£¼íŒŒìˆ˜ ëŒ€ì—­ì—ì„œ ì ë¶„ëœ ì´ PSD)ì„ ê³„ì‚°í•˜ë¼. ì´ë¥¼ ì‹œê³„ì—´ë¡œ ê·¸ë ¤ë¼.</p>
<p>(d) ì•ŒíŒŒ/ë² íƒ€ ì „ë ¥ ë¹„ìœ¨ì„ ê³„ì‚°í•˜ë¼. ìƒíƒœ ì „í™˜ì„ ì–¼ë§ˆë‚˜ ëª…í™•í•˜ê²Œ ê°ì§€í•  ìˆ˜ ìˆëŠ”ê°€?</p>
<h3 id="7-burg-vs-welch">ì—°ìŠµ ë¬¸ì œ 7: ì§§ì€ ë°ì´í„°ì—ì„œ Burg vs Welch<a class="header-link" href="#7-burg-vs-welch" title="Permanent link">&para;</a></h3>
<p>ì ì  ë” ì§§ì€ ë°ì´í„° ê¸°ë¡ì— ëŒ€í•´ Burgì˜ AR ë°©ë²•ê³¼ Welch ë°©ë²•ì„ ë¹„êµí•˜ë¼.</p>
<p>(a) 100 Hzì™€ 108 Hzì—ì„œ ë‘ ìŒì¡°ë¥¼ ê°–ëŠ” ì‹ í˜¸ë¥¼ ìƒì„±í•˜ë¼ ($f_s = 1000$ Hz). $N$ì„ 32ì—ì„œ 4096ê¹Œì§€ (2ì˜ ê±°ë“­ì œê³±) ë³€í™”ì‹œì¼œë¼.</p>
<p>(b) ê° $N$ì— ëŒ€í•´ Welch (nperseg = N/2)ì™€ Burg (order = 20) PSD ì¶”ì •ì¹˜ë¥¼ ëª¨ë‘ ê³„ì‚°í•˜ë¼.</p>
<p>(c) "í•´ìƒë„ ì„±ê³µ" ê¸°ì¤€ì„ ì •ì˜í•˜ë¼: ë‘ í”¼í¬ ì‚¬ì´ì— ìµœì†Œ 3 dBì˜ ë…¸ì¹˜ê°€ ìˆìœ¼ë©´ ë‘ ìŒì¡°ê°€ ë¶„í•´ëœ ê²ƒìœ¼ë¡œ ë³¸ë‹¤. ê° ë°©ë²•ì— ëŒ€í•´ ìµœì†Œ $N$ì„ ê²°ì •í•˜ë¼.</p>
<p>(d) ë‘ ë°©ë²•ì— ëŒ€í•´ $N$ì˜ í•¨ìˆ˜ë¡œ í•´ìƒë„ ì„±ê³µë¥ (100ë²ˆì˜ ëª¬í…Œ ì¹´ë¥¼ë¡œ ì‹œí–‰ì— ê±¸ì³)ì„ ê·¸ë ¤ë¼.</p>
<hr />
<h2 id="_3">ì°¸ê³ ë¬¸í—Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Oppenheim, A. V., &amp; Schafer, R. W. (2010).</strong> <em>Discrete-Time Signal Processing</em> (3rd ed.). Pearson. Chapter 10.</li>
<li><strong>Kay, S. M. (1988).</strong> <em>Modern Spectral Estimation: Theory and Application</em>. Prentice Hall. [ëª¨ìˆ˜ì  ë°©ë²•ì˜ ê³ ì „ ì°¸ê³ ì„œ]</li>
<li><strong>Stoica, P., &amp; Moses, R. L. (2005).</strong> <em>Spectral Analysis of Signals</em>. Prentice Hall. [ìš°ìˆ˜í•œ í˜„ëŒ€ì  ì²˜ë¦¬]</li>
<li><strong>Welch, P. D. (1967).</strong> "The Use of Fast Fourier Transform for the Estimation of Power Spectra." <em>IEEE Trans. Audio Electroacoustics</em>, 15(2), 70-73.</li>
<li><strong>Burg, J. P. (1975).</strong> "Maximum Entropy Spectral Analysis." PhD Dissertation, Stanford University.</li>
<li><strong>Marple, S. L. (1987).</strong> <em>Digital Spectral Analysis with Applications</em>. Prentice Hall.</li>
<li><strong>SciPy Documentation</strong> -- ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„ í•¨ìˆ˜: https://docs.scipy.org/doc/scipy/reference/signal.html#spectral-analysis</li>
</ol>
<hr />
<h2 id="_4">ë‚´ë¹„ê²Œì´ì…˜<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li>ì´ì „: <a href="11_Multirate_Processing.md">11. ë‹¤ì¤‘ ë ˆì´íŠ¸ ì‹ í˜¸ ì²˜ë¦¬</a></li>
<li>ë‹¤ìŒ: <a href="13_Adaptive_Filters.md">13. ì ì‘ í•„í„°</a></li>
<li><a href="00_Overview.md">ê°œìš”ë¡œ ëŒì•„ê°€ê¸°</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Signal_Processing/11_Multirate_Processing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë‹¤ì¤‘ë¥  ì‹ í˜¸ ì²˜ë¦¬(Multirate Signal Processing)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Signal_Processing/13_Adaptive_Filters.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">13. ì ì‘ í•„í„°</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}