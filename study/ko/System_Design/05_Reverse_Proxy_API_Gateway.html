{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>리버스 프록시와 API 게이트웨이 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/System_Design/">System Design</a>
    <span class="separator">/</span>
    <span class="current">리버스 프록시와 API 게이트웨이</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>리버스 프록시와 API 게이트웨이</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/System_Design/04_Load_Balancing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">로드 밸런싱</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/System_Design/06_Caching_Strategies.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">캐싱 전략</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">개요</a></li>
<li><a href="#_2">목차</a></li>
<li><a href="#1">1. 리버스 프록시란?</a><ul>
<li><a href="#11-forward-proxy-vs-reverse-proxy">1.1 Forward Proxy vs Reverse Proxy</a></li>
<li><a href="#12">1.2 리버스 프록시 위치</a></li>
</ul>
</li>
<li><a href="#2">2. 리버스 프록시 핵심 기능</a><ul>
<li><a href="#21-ssltls-ssl-termination">2.1 SSL/TLS 종료 (SSL Termination)</a></li>
<li><a href="#22">2.2 응답 압축</a></li>
<li><a href="#23">2.3 캐싱</a></li>
<li><a href="#24">2.4 보안 기능</a></li>
</ul>
</li>
<li><a href="#3-api">3. API 게이트웨이 패턴</a><ul>
<li><a href="#31-api">3.1 API 게이트웨이란?</a></li>
<li><a href="#32-api">3.2 API 게이트웨이 핵심 기능</a></li>
<li><a href="#33-api">3.3 API 게이트웨이 제품 비교</a></li>
</ul>
</li>
<li><a href="#4-rate-limiting">4. Rate Limiting</a><ul>
<li><a href="#41-rate-limiting">4.1 Rate Limiting이란?</a></li>
<li><a href="#42-token-bucket">4.2 토큰 버킷 (Token Bucket)</a></li>
<li><a href="#43-leaky-bucket">4.3 리키 버킷 (Leaky Bucket)</a></li>
<li><a href="#44-fixed-window">4.4 고정 윈도우 (Fixed Window)</a></li>
<li><a href="#45-sliding-window">4.5 슬라이딩 윈도우 (Sliding Window)</a></li>
<li><a href="#46">4.6 알고리즘 비교</a></li>
</ul>
</li>
<li><a href="#5">5. 연습 문제</a><ul>
<li><a href="#1_1">문제 1: 리버스 프록시 설계</a></li>
<li><a href="#2-api">문제 2: API 게이트웨이 설계</a></li>
<li><a href="#3-rate-limiting">문제 3: Rate Limiting 선택</a></li>
<li><a href="#4-rate-limiting_1">문제 4: Rate Limiting 구현</a></li>
</ul>
</li>
<li><a href="#_3">정답</a><ul>
<li><a href="#1_2">문제 1 정답</a></li>
<li><a href="#2_1">문제 2 정답</a></li>
<li><a href="#3">문제 3 정답</a></li>
<li><a href="#4">문제 4 정답</a></li>
</ul>
</li>
<li><a href="#6">6. 다음 단계</a><ul>
<li><a href="#_4">다음 레슨</a></li>
<li><a href="#_5">관련 레슨</a></li>
<li><a href="#_6">추천 실습</a></li>
</ul>
</li>
<li><a href="#7">7. 참고 자료</a><ul>
<li><a href="#_7">도구</a></li>
<li><a href="#_8">문서</a></li>
<li><a href="#_9">알고리즘</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="api">리버스 프록시와 API 게이트웨이<a class="header-link" href="#api" title="Permanent link">&para;</a></h1>
<h2 id="_1">개요<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>이 문서에서는 리버스 프록시의 역할과 API 게이트웨이 패턴을 다룹니다. SSL 종료, 압축, 캐싱 등 리버스 프록시의 핵심 기능과 인증/인가, 라우팅, Rate Limiting 알고리즘을 학습합니다.</p>
<p><strong>난이도</strong>: ⭐⭐⭐
<strong>예상 학습 시간</strong>: 2-3시간
<strong>선수 지식</strong>: <a href="./04_Load_Balancing.md">04_Load_Balancing.md</a></p>
<hr />
<h2 id="_2">목차<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-리버스-프록시란">리버스 프록시란?</a></li>
<li><a href="#2-리버스-프록시-핵심-기능">리버스 프록시 핵심 기능</a></li>
<li><a href="#3-api-게이트웨이-패턴">API 게이트웨이 패턴</a></li>
<li><a href="#4-rate-limiting">Rate Limiting</a></li>
<li><a href="#5-연습-문제">연습 문제</a></li>
<li><a href="#6-다음-단계">다음 단계</a></li>
<li><a href="#7-참고-자료">참고 자료</a></li>
</ol>
<hr />
<h2 id="1">1. 리버스 프록시란?<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11-forward-proxy-vs-reverse-proxy">1.1 Forward Proxy vs Reverse Proxy<a class="header-link" href="#11-forward-proxy-vs-reverse-proxy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│              Forward Proxy vs Reverse Proxy                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Forward Proxy (정방향 프록시)                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  &quot;클라이언트를 대신하여 서버에 요청&quot;                       │ │
│  │                                                            │ │
│  │  ┌──────┐    ┌──────────┐    ┌──────────┐                  │ │
│  │  │Client│───▶│ Forward  │───▶│  Server  │                  │ │
│  │  │      │    │ Proxy    │    │  (Web)   │                  │ │
│  │  └──────┘    └──────────┘    └──────────┘                  │ │
│  │                                                            │ │
│  │  용도: 익명성, 접근 제어, 캐싱                             │ │
│  │  예: 회사 방화벽, VPN, Squid                               │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  Reverse Proxy (역방향 프록시)                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  &quot;서버를 대신하여 클라이언트 요청을 처리&quot;                  │ │
│  │                                                            │ │
│  │  ┌──────┐    ┌──────────┐    ┌──────────┐                  │ │
│  │  │Client│───▶│ Reverse  │───▶│ Backend  │                  │ │
│  │  │      │    │ Proxy    │    │ Servers  │                  │ │
│  │  └──────┘    └──────────┘    └──────────┘                  │ │
│  │                                                            │ │
│  │  클라이언트는 실제 서버를 모름!                            │ │
│  │                                                            │ │
│  │  용도: 로드밸런싱, SSL 종료, 캐싱, 보안                    │ │
│  │  예: Nginx, HAProxy, AWS ALB                               │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="12">1.2 리버스 프록시 위치<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                   리버스 프록시 아키텍처                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│                         Internet                                 │
│                            │                                     │
│                            ▼                                     │
│                    ┌──────────────┐                              │
│                    │   Firewall   │                              │
│                    └──────┬───────┘                              │
│                           │                                      │
│                           ▼                                      │
│                    ┌──────────────┐                              │
│                    │   Reverse    │ ◀── SSL 종료, 캐싱          │
│                    │   Proxy      │     압축, 보안               │
│                    │   (Nginx)    │                              │
│                    └──────┬───────┘                              │
│                           │                                      │
│              ┌────────────┼────────────┐                         │
│              │            │            │                         │
│              ▼            ▼            ▼                         │
│         ┌────────┐   ┌────────┐   ┌────────┐                    │
│         │ App    │   │ App    │   │ App    │                    │
│         │ Server │   │ Server │   │ Server │                    │
│         │   1    │   │   2    │   │   3    │                    │
│         └────────┘   └────────┘   └────────┘                    │
│                                                                  │
│  클라이언트 → 프록시 IP만 알고, 실제 서버 IP 모름               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="2">2. 리버스 프록시 핵심 기능<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-ssltls-ssl-termination">2.1 SSL/TLS 종료 (SSL Termination)<a class="header-link" href="#21-ssltls-ssl-termination" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                     </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">종료</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">종료</span><span class="w"> </span><span class="nt">없이</span><span class="w"> </span><span class="o">(</span><span class="nt">End-to-End</span><span class="w"> </span><span class="nt">Encryption</span><span class="o">):</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">Client</span><span class="w"> </span><span class="err">═══</span><span class="nt">HTTPS</span><span class="err">═══▶</span><span class="w"> </span><span class="nt">Proxy</span><span class="w"> </span><span class="err">═══</span><span class="nt">HTTPS</span><span class="err">═══▶</span><span class="w"> </span><span class="nt">Server</span><span class="w">            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">모든</span><span class="w"> </span><span class="nt">서버에</span><span class="w"> </span><span class="nt">인증서</span><span class="w"> </span><span class="nt">설치</span><span class="w"> </span><span class="nt">필요</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">서버</span><span class="w"> </span><span class="nt">부하</span><span class="w"> </span><span class="nt">증가</span><span class="w"> </span><span class="o">(</span><span class="nt">암호화</span><span class="o">/</span><span class="nt">복호화</span><span class="o">)</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">인증서</span><span class="w"> </span><span class="nt">관리</span><span class="w"> </span><span class="nt">복잡</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">종료</span><span class="w"> </span><span class="o">(</span><span class="nt">프록시에서</span><span class="w"> </span><span class="nt">처리</span><span class="o">):</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">Client</span><span class="w"> </span><span class="err">═══</span><span class="nt">HTTPS</span><span class="err">═══▶</span><span class="w"> </span><span class="nt">Proxy</span><span class="w"> </span><span class="err">───</span><span class="nt">HTTP</span><span class="err">───▶</span><span class="w"> </span><span class="nt">Server</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                        </span><span class="err">│</span><span class="w">                                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">종료</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">인증서는</span><span class="w"> </span><span class="nt">프록시에만</span><span class="w"> </span><span class="nt">설치</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">서버</span><span class="w"> </span><span class="nt">부하</span><span class="w"> </span><span class="nt">감소</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nt">중앙</span><span class="w"> </span><span class="nt">집중식</span><span class="w"> </span><span class="nt">인증서</span><span class="w"> </span><span class="nt">관리</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">Nginx</span><span class="w"> </span><span class="nt">설정</span><span class="o">:</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">server</span><span class="w"> </span><span class="p">{</span><span class="w">                                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">listen</span><span class="w"> </span><span class="err">443</span><span class="w"> </span><span class="err">ssl</span><span class="p">;</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">ssl_certificate</span><span class="w"> </span><span class="err">/path/to/cert.pem</span><span class="p">;</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">ssl_certificate_key</span><span class="w"> </span><span class="err">/path/to/key.pem</span><span class="p">;</span><span class="w">                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">location</span><span class="w"> </span><span class="err">/</span><span class="w"> </span><span class="err">{</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">proxy_pass</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">backend</span><span class="p">;</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">HTTP로</span><span class="w"> </span><span class="err">백엔드</span><span class="w"> </span><span class="err">연결</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="p">}</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">}</span><span class="w">                                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">주의</span><span class="o">:</span><span class="w"> </span><span class="nt">내부</span><span class="w"> </span><span class="nt">네트워크가</span><span class="w"> </span><span class="nt">신뢰할</span><span class="w"> </span><span class="nt">수</span><span class="w"> </span><span class="nt">없으면</span><span class="w"> </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">Passthrough</span><span class="w"> </span><span class="nt">고려</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="22">2.2 응답 압축<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                      </span><span class="nx">응답</span><span class="w"> </span><span class="nx">압축</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="s">&quot;네트워크 대역폭 절약, 응답 속도 향상&quot;</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">압축</span><span class="w"> </span><span class="nx">전</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="nx">KB</span><span class="w"> </span><span class="nx">HTML</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">압축</span><span class="w"> </span><span class="nx">후</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="nx">KB</span><span class="w"> </span><span class="p">(</span><span class="nx">gzip</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">80</span><span class="o">%</span><span class="w"> </span><span class="nx">절약</span><span class="p">!</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">Client</span><span class="w">                </span><span class="nx">Proxy</span><span class="w">              </span><span class="nx">Server</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│──</span><span class="nx">Request</span><span class="w"> </span><span class="err">──────────▶│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="nx">Accept</span><span class="o">-</span><span class="nx">Encoding</span><span class="p">:</span><span class="w">   </span><span class="err">│──────────────────▶</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip</span><span class="p">,</span><span class="w"> </span><span class="nx">deflate</span><span class="w">      </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                     </span><span class="err">│◀─────────────────│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span><span class="w">  </span><span class="nx">원본</span><span class="w"> </span><span class="nx">응답</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span><span class="w">  </span><span class="p">(</span><span class="mi">100</span><span class="nx">KB</span><span class="p">)</span><span class="w">         </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│◀──</span><span class="w"> </span><span class="nx">압축</span><span class="w"> </span><span class="nx">응답</span><span class="w"> </span><span class="err">───────│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="nx">Content</span><span class="o">-</span><span class="nx">Encoding</span><span class="p">:</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">(</span><span class="nx">프록시에서</span><span class="w">     </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip</span><span class="w">               </span><span class="err">│</span><span class="w">   </span><span class="nx">gzip</span><span class="w"> </span><span class="nx">압축</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="p">(</span><span class="mi">20</span><span class="nx">KB</span><span class="p">)</span><span class="w">             </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Nginx</span><span class="w"> </span><span class="nx">설정</span><span class="p">:</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip</span><span class="w"> </span><span class="nx">on</span><span class="p">;</span><span class="w">                                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip_types</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">css</span><span class="w"> </span><span class="nx">application</span><span class="o">/</span><span class="nx">json</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">             </span><span class="nx">application</span><span class="o">/</span><span class="nx">javascript</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">xml</span><span class="p">;</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip_min_length</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="nx">KB</span><span class="w"> </span><span class="nx">이상만</span><span class="w"> </span><span class="nx">압축</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nx">gzip_comp_level</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="nx">압축</span><span class="w"> </span><span class="nx">레벨</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">압축</span><span class="w"> </span><span class="nx">알고리즘</span><span class="w"> </span><span class="nx">비교</span><span class="p">:</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nx">gzip</span><span class="p">:</span><span class="w"> </span><span class="nx">널리</span><span class="w"> </span><span class="nx">지원</span><span class="p">,</span><span class="w"> </span><span class="nx">좋은</span><span class="w"> </span><span class="nx">압축률</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nx">Brotli</span><span class="p">:</span><span class="w"> </span><span class="nx">더</span><span class="w"> </span><span class="nx">나은</span><span class="w"> </span><span class="nx">압축률</span><span class="p">,</span><span class="w"> </span><span class="nx">현대</span><span class="w"> </span><span class="nx">브라우저</span><span class="w"> </span><span class="nx">지원</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="nx">zstd</span><span class="p">:</span><span class="w"> </span><span class="nx">빠른</span><span class="w"> </span><span class="nx">압축</span><span class="o">/</span><span class="nx">해제</span><span class="p">,</span><span class="w"> </span><span class="nx">최신</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="23">2.3 캐싱<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">프록시</span><span class="w"> </span><span class="n">캐싱</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="ss">&quot;반복 요청에 대해 캐시된 응답 반환&quot;</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">첫</span><span class="w"> </span><span class="n">번째</span><span class="w"> </span><span class="n">요청</span><span class="w"> </span><span class="p">(</span><span class="n">Cache</span><span class="w"> </span><span class="n">Miss</span><span class="p">)</span><span class="err">:</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Server</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">         </span><span class="err">◀────────◀────</span><span class="w">  </span><span class="p">(</span><span class="n">응답</span><span class="w"> </span><span class="n">저장</span><span class="p">)</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                  </span><span class="err">▼</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">두</span><span class="w"> </span><span class="n">번째</span><span class="w"> </span><span class="n">요청</span><span class="w"> </span><span class="p">(</span><span class="n">Cache</span><span class="w"> </span><span class="n">Hit</span><span class="p">)</span><span class="err">:</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Proxy</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">         </span><span class="err">◀────</span><span class="w">  </span><span class="p">(</span><span class="n">캐시에서</span><span class="w"> </span><span class="n">응답</span><span class="p">,</span><span class="w"> </span><span class="n">서버</span><span class="w"> </span><span class="n">안</span><span class="w"> </span><span class="n">감</span><span class="err">!</span><span class="p">)</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">▲</span><span class="w">                                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w">                                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Nginx</span><span class="w"> </span><span class="n">캐싱</span><span class="w"> </span><span class="nl">설정</span><span class="p">:</span><span class="w">                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">경로</span><span class="w"> </span><span class="n">정의</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">proxy_cache_path</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">nginx</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="mi">1</span><span class="err">:</span><span class="mi">2</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="n">keys_zone</span><span class="o">=</span><span class="nl">my_cache</span><span class="p">:</span><span class="mi">10</span><span class="n">m</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="n">max_size</span><span class="o">=</span><span class="mi">10</span><span class="n">g</span><span class="w"> </span><span class="n">inactive</span><span class="o">=</span><span class="mi">60</span><span class="n">m</span><span class="p">;</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">server</span><span class="w"> </span><span class="err">{</span><span class="w">                                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">location</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="err">{</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">proxy_cache</span><span class="w"> </span><span class="n">my_cache</span><span class="p">;</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">proxy_cache_valid</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">60</span><span class="n">m</span><span class="p">;</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">응답</span><span class="w"> </span><span class="mi">60</span><span class="n">분</span><span class="w"> </span><span class="n">캐시</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">proxy_cache_valid</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="mi">1</span><span class="n">m</span><span class="p">;</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="n">응답</span><span class="w"> </span><span class="mi">1</span><span class="n">분</span><span class="w"> </span><span class="n">캐시</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">proxy_cache_use_stale</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">timeout</span><span class="p">;</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">add_header</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Cache</span><span class="o">-</span><span class="n">Status</span><span class="w"> </span><span class="err">$</span><span class="n">upstream_cache_status</span><span class="p">;</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">proxy_pass</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">backend</span><span class="p">;</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">}</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">}</span><span class="w">                                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">캐시</span><span class="w"> </span><span class="n">상태</span><span class="w"> </span><span class="nl">헤더</span><span class="p">:</span><span class="w">                                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Cache</span><span class="o">-</span><span class="nl">Status</span><span class="p">:</span><span class="w"> </span><span class="n">HIT</span><span class="w"> </span><span class="p">(</span><span class="n">캐시</span><span class="w"> </span><span class="n">적중</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Cache</span><span class="o">-</span><span class="nl">Status</span><span class="p">:</span><span class="w"> </span><span class="n">MISS</span><span class="w"> </span><span class="p">(</span><span class="n">캐시</span><span class="w"> </span><span class="n">미스</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Cache</span><span class="o">-</span><span class="nl">Status</span><span class="p">:</span><span class="w"> </span><span class="n">EXPIRED</span><span class="w"> </span><span class="p">(</span><span class="n">만료됨</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Cache</span><span class="o">-</span><span class="nl">Status</span><span class="p">:</span><span class="w"> </span><span class="n">STALE</span><span class="w"> </span><span class="p">(</span><span class="n">오래된</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">사용</span><span class="p">)</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="24">2.4 보안 기능<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                   </span><span class="nt">리버스</span><span class="w"> </span><span class="nt">프록시</span><span class="w"> </span><span class="nt">보안</span><span class="w"> </span><span class="nt">기능</span><span class="w">                        </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">1</span><span class="o">.</span><span class="w"> </span><span class="nt">IP</span><span class="w"> </span><span class="nt">기반</span><span class="w"> </span><span class="nt">접근</span><span class="w"> </span><span class="nt">제어</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">location</span><span class="w"> </span><span class="o">/</span><span class="nt">admin</span><span class="w"> </span><span class="p">{</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">allow</span><span class="w"> </span><span class="err">10.0.0.0/8</span><span class="p">;</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="err">내부</span><span class="w"> </span><span class="err">네트워크만</span><span class="w"> </span><span class="err">허용</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">allow</span><span class="w"> </span><span class="err">192.168.1.100</span><span class="p">;</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">특정</span><span class="w"> </span><span class="err">IP</span><span class="w"> </span><span class="err">허용</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">deny</span><span class="w"> </span><span class="err">all</span><span class="p">;</span><span class="w">               </span><span class="err">#</span><span class="w"> </span><span class="err">나머지</span><span class="w"> </span><span class="err">거부</span><span class="w">                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">proxy_pass</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">backend</span><span class="p">;</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">}</span><span class="w">                                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">2</span><span class="o">.</span><span class="w"> </span><span class="nt">헤더</span><span class="w"> </span><span class="nt">보안</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nt">민감한</span><span class="w"> </span><span class="nt">헤더</span><span class="w"> </span><span class="nt">숨기기</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">proxy_hide_header</span><span class="w"> </span><span class="nt">X-Powered-By</span><span class="o">;</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">proxy_hide_header</span><span class="w"> </span><span class="nt">Server</span><span class="o">;</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nt">보안</span><span class="w"> </span><span class="nt">헤더</span><span class="w"> </span><span class="nt">추가</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">add_header</span><span class="w"> </span><span class="nt">X-Frame-Options</span><span class="w"> </span><span class="s2">&quot;SAMEORIGIN&quot;</span><span class="o">;</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">add_header</span><span class="w"> </span><span class="nt">X-Content-Type-Options</span><span class="w"> </span><span class="s2">&quot;nosniff&quot;</span><span class="o">;</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">add_header</span><span class="w"> </span><span class="nt">X-XSS-Protection</span><span class="w"> </span><span class="s2">&quot;1; mode=block&quot;</span><span class="o">;</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">add_header</span><span class="w"> </span><span class="nt">Strict-Transport-Security</span><span class="w"> </span><span class="s2">&quot;max-age=31536000&quot;</span><span class="o">;</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">3</span><span class="o">.</span><span class="w"> </span><span class="nt">요청</span><span class="w"> </span><span class="nt">크기</span><span class="w"> </span><span class="nt">제한</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">client_max_body_size</span><span class="w"> </span><span class="nt">10m</span><span class="o">;</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nt">최대</span><span class="w"> </span><span class="nt">업로드</span><span class="w"> </span><span class="nt">크기</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">client_body_timeout</span><span class="w"> </span><span class="nt">60s</span><span class="o">;</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="nt">요청</span><span class="w"> </span><span class="nt">본문</span><span class="w"> </span><span class="nt">타임아웃</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">client_header_timeout</span><span class="w"> </span><span class="nt">60s</span><span class="o">;</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nt">헤더</span><span class="w"> </span><span class="nt">타임아웃</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">4</span><span class="o">.</span><span class="w"> </span><span class="nt">백엔드</span><span class="w"> </span><span class="nt">서버</span><span class="w"> </span><span class="nt">숨기기</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">클라이언트가</span><span class="w"> </span><span class="nt">보는</span><span class="w"> </span><span class="nt">것</span><span class="o">:</span><span class="w"> </span><span class="nt">proxy</span><span class="p">.</span><span class="nc">example</span><span class="p">.</span><span class="nc">com</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">실제</span><span class="w"> </span><span class="nt">백엔드</span><span class="o">:</span><span class="w"> </span><span class="nt">10</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="p">.</span><span class="nc">5</span><span class="p">:</span><span class="nd">8080</span><span class="w"> </span><span class="o">(</span><span class="nt">외부</span><span class="w"> </span><span class="nt">노출</span><span class="w"> </span><span class="nt">안</span><span class="w"> </span><span class="nt">됨</span><span class="o">)</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="nt">직접</span><span class="w"> </span><span class="nt">공격</span><span class="w"> </span><span class="nt">방지</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<hr />
<h2 id="3-api">3. API 게이트웨이 패턴<a class="header-link" href="#3-api" title="Permanent link">&para;</a></h2>
<h3 id="31-api">3.1 API 게이트웨이란?<a class="header-link" href="#31-api" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    API 게이트웨이                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;마이크로서비스의 단일 진입점 (Single Entry Point)&quot;            │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  API 게이트웨이 없이:                                      │ │
│  │                                                            │ │
│  │  Client ──▶ User Service (users.example.com)               │ │
│  │         ──▶ Order Service (orders.example.com)             │ │
│  │         ──▶ Product Service (products.example.com)         │ │
│  │                                                            │ │
│  │  문제:                                                     │ │
│  │  • 클라이언트가 여러 서비스 URL 알아야 함                  │ │
│  │  • 각 서비스마다 인증 로직 중복                            │ │
│  │  • 클라이언트-서비스 강결합                                │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  API 게이트웨이 적용:                                      │ │
│  │                                                            │ │
│  │            ┌───────────────────────────────┐               │ │
│  │            │         API Gateway           │               │ │
│  │  Client ──▶│  api.example.com              │               │ │
│  │            │  ┌─────────────────────────┐  │               │ │
│  │            │  │ • 인증/인가            │  │               │ │
│  │            │  │ • 라우팅               │  │               │ │
│  │            │  │ • Rate Limiting        │  │               │ │
│  │            │  │ • 요청/응답 변환       │  │               │ │
│  │            │  │ • 로깅/모니터링        │  │               │ │
│  │            │  └─────────────────────────┘  │               │ │
│  │            └───────────────┬───────────────┘               │ │
│  │                            │                               │ │
│  │              ┌─────────────┼─────────────┐                 │ │
│  │              ▼             ▼             ▼                 │ │
│  │         User Service  Order Service  Product Service      │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="32-api">3.2 API 게이트웨이 핵심 기능<a class="header-link" href="#32-api" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                 </span><span class="n">API</span><span class="w"> </span><span class="err">게이트웨이</span><span class="w"> </span><span class="err">핵심</span><span class="w"> </span><span class="err">기능</span><span class="w">                         </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="err">요청</span><span class="w"> </span><span class="err">라우팅</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">users</span><span class="o">/*</span><span class="w">    </span><span class="err">──────────▶</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Service</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">orders</span><span class="o">/*</span><span class="w">   </span><span class="err">──────────▶</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">Service</span><span class="w">                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">products</span><span class="o">/*</span><span class="w"> </span><span class="err">──────────▶</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">Service</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v2</span><span class="o">/*</span><span class="w">       </span><span class="err">──────────▶</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p">(</span><span class="err">버전</span><span class="w"> </span><span class="err">관리</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="err">인증</span><span class="o">/</span><span class="err">인가</span><span class="w"> </span><span class="p">(</span><span class="n">Authentication</span><span class="o">/</span><span class="n">Authorization</span><span class="p">)</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Gateway</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">                                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">├─</span><span class="w"> </span><span class="n">JWT</span><span class="w"> </span><span class="err">토큰</span><span class="w"> </span><span class="err">검증</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">├─</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="err">확인</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">├─</span><span class="w"> </span><span class="n">OAuth2</span><span class="w"> </span><span class="err">처리</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">└─</span><span class="w"> </span><span class="err">권한</span><span class="w"> </span><span class="err">확인</span><span class="w"> </span><span class="err">후</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Backend</span><span class="w"> </span><span class="n">Service</span><span class="w">            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">장점</span><span class="o">:</span><span class="w"> </span><span class="err">백엔드</span><span class="w"> </span><span class="err">서비스에서</span><span class="w"> </span><span class="err">인증</span><span class="w"> </span><span class="err">로직</span><span class="w"> </span><span class="err">제거</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="err">요청</span><span class="o">/</span><span class="err">응답</span><span class="w"> </span><span class="err">변환</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Protocol</span><span class="w"> </span><span class="err">변환</span><span class="o">:</span><span class="w">                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">REST</span><span class="w"> </span><span class="p">(</span><span class="err">외부</span><span class="p">)</span><span class="w"> </span><span class="err">←─────────▶</span><span class="w"> </span><span class="n">gRPC</span><span class="w"> </span><span class="p">(</span><span class="err">내부</span><span class="p">)</span><span class="w">                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">데이터</span><span class="w"> </span><span class="err">형식</span><span class="w"> </span><span class="err">변환</span><span class="o">:</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">JSON</span><span class="w"> </span><span class="err">←─────────▶</span><span class="w"> </span><span class="n">Protobuf</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">응답</span><span class="w"> </span><span class="err">집계</span><span class="w"> </span><span class="p">(</span><span class="n">Aggregation</span><span class="p">)</span><span class="o">:</span><span class="w">                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────┐</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">dashboard</span><span class="w">                                </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                            </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">├──▶</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p">(</span><span class="err">사용자</span><span class="w"> </span><span class="err">정보</span><span class="p">)</span><span class="w">              </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">├──▶</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p">(</span><span class="err">최근</span><span class="w"> </span><span class="err">주문</span><span class="p">)</span><span class="w">               </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">└──▶</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="p">(</span><span class="err">통계</span><span class="p">)</span><span class="w">                    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">◀──</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">응답</span><span class="w"> </span><span class="err">합쳐서</span><span class="w"> </span><span class="err">반환</span><span class="w"> </span><span class="err">──</span><span class="w">                 </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────┘</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="err">로깅</span><span class="w"> </span><span class="err">및</span><span class="w"> </span><span class="err">모니터링</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="err">호출</span><span class="w"> </span><span class="err">로깅</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="err">응답</span><span class="w"> </span><span class="err">시간</span><span class="w"> </span><span class="err">측정</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="err">에러율</span><span class="w"> </span><span class="err">모니터링</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="err">분산</span><span class="w"> </span><span class="err">트레이싱</span><span class="w"> </span><span class="p">(</span><span class="n">Trace</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="err">전파</span><span class="p">)</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="33-api">3.3 API 게이트웨이 제품 비교<a class="header-link" href="#33-api" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                API 게이트웨이 제품 비교                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Kong                                                           │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ • Nginx + Lua 기반                                         │ │
│  │ • 풍부한 플러그인 에코시스템                               │ │
│  │ • 오픈소스 / Enterprise                                    │ │
│  │ • 높은 성능                                                │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  AWS API Gateway                                                │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ • 완전 관리형                                              │ │
│  │ • Lambda, DynamoDB 통합                                    │ │
│  │ • WebSocket 지원                                           │ │
│  │ • 사용량 기반 과금                                         │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  Envoy (Istio)                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ • 클라우드 네이티브                                        │ │
│  │ • 서비스 메시 사이드카                                     │ │
│  │ • gRPC 네이티브 지원                                       │ │
│  │ • 고급 트래픽 관리                                         │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  Nginx Plus / Nginx                                             │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ • 경량, 고성능                                             │ │
│  │ • 설정 기반 (코드 불필요)                                  │ │
│  │ • 광범위한 사용 사례                                       │ │
│  │ • Plus: 상용 기능 (헬스체크, 모니터링)                     │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  선택 기준:                                                     │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ • 클라우드 환경: AWS API Gateway, GCP Cloud Endpoints      │ │
│  │ • 온프레미스: Kong, Nginx                                  │ │
│  │ • Kubernetes: Envoy, Istio, NGINX Ingress                  │ │
│  │ • 간단한 요구: Nginx                                       │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="4-rate-limiting">4. Rate Limiting<a class="header-link" href="#4-rate-limiting" title="Permanent link">&para;</a></h2>
<h3 id="41-rate-limiting">4.1 Rate Limiting이란?<a class="header-link" href="#41-rate-limiting" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    Rate Limiting                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;단위 시간당 요청 수를 제한&quot;                                   │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  왜 필요한가?                                              │ │
│  │                                                            │ │
│  │  • DDoS 방어                                               │ │
│  │  • 서비스 안정성 보호                                      │ │
│  │  • 공정한 리소스 분배                                      │ │
│  │  • 비용 제어                                               │ │
│  │  • API 남용 방지                                           │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  제한 기준:                                                     │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  • IP 주소별: 100 req/min per IP                           │ │
│  │  • 사용자별: 1000 req/hour per user                        │ │
│  │  • API 키별: 10000 req/day per API key                     │ │
│  │  • 엔드포인트별: /login은 5 req/min                        │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  응답 헤더:                                                     │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │  X-RateLimit-Limit: 100        # 제한                      │ │
│  │  X-RateLimit-Remaining: 45     # 남은 요청 수              │ │
│  │  X-RateLimit-Reset: 1640000000 # 리셋 시간 (Unix)          │ │
│  │                                                            │ │
│  │  제한 초과 시: 429 Too Many Requests                       │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="42-token-bucket">4.2 토큰 버킷 (Token Bucket)<a class="header-link" href="#42-token-bucket" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    토큰 버킷 알고리즘                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;버킷에 토큰이 있으면 요청 허용, 없으면 거부&quot;                  │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │           ┌──────────┐                                     │ │
│  │           │  Token   │  ◀── 일정 속도로 토큰 추가          │ │
│  │           │  Bucket  │      (예: 10개/초)                  │ │
│  │           │  ●●●●●   │                                     │ │
│  │           │  ●●●     │  ◀── 버킷 용량 (예: 100개)          │ │
│  │           └────┬─────┘                                     │ │
│  │                │                                           │ │
│  │                ▼                                           │ │
│  │  Request ──▶ 토큰 있음? ──Yes──▶ 허용 (토큰 소비)          │ │
│  │                │                                           │ │
│  │               No                                           │ │
│  │                │                                           │ │
│  │                ▼                                           │ │
│  │              거부 (429)                                    │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  특징:                                                          │
│  • 버스트 허용 (버킷에 토큰이 쌓여있으면)                       │
│  • 평균 속도 제한                                               │
│  • AWS, Stripe 등에서 사용                                      │
│                                                                  │
│  예시:                                                          │
│  버킷 크기: 100, 충전 속도: 10/초                               │
│  → 순간 100개 요청 가능 (버스트)                                │
│  → 이후 초당 10개 요청 가능                                     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="43-leaky-bucket">4.3 리키 버킷 (Leaky Bucket)<a class="header-link" href="#43-leaky-bucket" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    리키 버킷 알고리즘                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;일정한 속도로만 요청 처리 (버스트 없음)&quot;                      │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  Requests ──▶  ┌──────────┐                                │ │
│  │                │  Queue   │  ◀── 요청을 큐에 저장          │ │
│  │                │  ○○○○○   │                                │ │
│  │                │  ○○○     │  ◀── 큐 크기 제한              │ │
│  │                └────┬─────┘                                │ │
│  │                     │                                      │ │
│  │              ●      │                                      │ │
│  │              ●  ◀───┘  일정 속도로 &quot;새어나감&quot;              │ │
│  │              ●         (예: 10개/초)                       │ │
│  │              ▼                                             │ │
│  │           처리됨                                           │ │
│  │                                                            │ │
│  │  큐가 가득 찼을 때:                                        │ │
│  │  새 요청 ──▶ 거부 (429)                                    │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  특징:                                                          │
│  • 출력 속도가 일정 (트래픽 쉐이핑)                             │
│  • 버스트 불가                                                  │
│  • 네트워크 트래픽 조절에 적합                                  │
│                                                                  │
│  토큰 버킷 vs 리키 버킷:                                        │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │  토큰 버킷: 버스트 허용, 평균 속도 제한                    │ │
│  │  리키 버킷: 버스트 불가, 고정 속도 출력                    │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="44-fixed-window">4.4 고정 윈도우 (Fixed Window)<a class="header-link" href="#44-fixed-window" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                  고정 윈도우 알고리즘                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;시간 윈도우마다 카운터 리셋&quot;                                  │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  1분 윈도우, 제한 100개:                                   │ │
│  │                                                            │ │
│  │  00:00 ~ 00:59                 01:00 ~ 01:59              │ │
│  │  ┌────────────────────┐       ┌────────────────────┐      │ │
│  │  │ Count: 0 → 100     │       │ Count: 0 (리셋)   │      │ │
│  │  │ ●●●●●●●●●●●●●●●●●  │       │ ●●●●●●●●●         │      │ │
│  │  └────────────────────┘       └────────────────────┘      │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  문제점 (경계 문제):                                            │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  00:00          00:30          01:00         01:30        │ │
│  │    │              │              │              │          │ │
│  │    └──────────────┴──────────────┴──────────────┘          │ │
│  │           │               │                                │ │
│  │           ▼               ▼                                │ │
│  │     00:30~00:59     01:00~01:29                            │ │
│  │     100개 요청      100개 요청                             │ │
│  │                                                            │ │
│  │  → 1분 사이에 200개 요청 가능!                             │ │
│  │     (00:30 ~ 01:30)                                        │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  장점: 구현 단순, 메모리 효율                                   │
│  단점: 윈도우 경계에서 버스트 가능                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="45-sliding-window">4.5 슬라이딩 윈도우 (Sliding Window)<a class="header-link" href="#45-sliding-window" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                 슬라이딩 윈도우 알고리즘                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;시간에 따라 윈도우가 이동 (경계 문제 해결)&quot;                   │
│                                                                  │
│  슬라이딩 윈도우 로그:                                          │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  각 요청의 타임스탬프를 저장                               │ │
│  │  [00:30:15, 00:30:20, 00:30:45, 00:31:00, ...]             │ │
│  │                                                            │ │
│  │  현재 시간: 01:30:00                                       │ │
│  │  윈도우: 00:30:00 ~ 01:30:00 (1분)                         │ │
│  │                                                            │ │
│  │  윈도우 내 요청 수 계산                                    │ │
│  │                                                            │ │
│  │  단점: 메모리 사용량 높음 (모든 타임스탬프 저장)           │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  슬라이딩 윈도우 카운터 (최적화):                               │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  이전 윈도우와 현재 윈도우의 가중 평균                     │ │
│  │                                                            │ │
│  │  현재: 01:15 (1분 윈도우)                                  │ │
│  │                                                            │ │
│  │  ├── 이전 윈도우 (00:00~01:00): 80개 ──┤                   │ │
│  │  ├── 현재 윈도우 (01:00~02:00): 40개 ──┤                   │ │
│  │                                                            │ │
│  │  01:15는 현재 윈도우의 25% 지점                            │ │
│  │  가중치: 이전 75%, 현재 25%                                │ │
│  │                                                            │ │
│  │  예상 요청 수 = 80 <span class="gs">* 0.75 + 40 *</span> 0.25 = 70개               │ │
│  │                                                            │ │
│  │  장점: 메모리 효율 (카운터 2개만)                          │ │
│  │        경계 문제 완화                                      │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="46">4.6 알고리즘 비교<a class="header-link" href="#46" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>알고리즘</th>
<th>버스트</th>
<th>메모리</th>
<th>정확도</th>
<th>사용 사례</th>
</tr>
</thead>
<tbody>
<tr>
<td>토큰 버킷</td>
<td>허용</td>
<td>작음</td>
<td>높음</td>
<td>API 제한</td>
</tr>
<tr>
<td>리키 버킷</td>
<td>불가</td>
<td>작음</td>
<td>높음</td>
<td>트래픽 쉐이핑</td>
</tr>
<tr>
<td>고정 윈도우</td>
<td>경계 버스트</td>
<td>작음</td>
<td>낮음</td>
<td>단순 구현</td>
</tr>
<tr>
<td>슬라이딩 윈도우</td>
<td>허용</td>
<td>큼/중간</td>
<td>높음</td>
<td>정확한 제한</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. 연습 문제<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="1_1">문제 1: 리버스 프록시 설계<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>다음 요구사항을 만족하는 Nginx 설정을 작성하세요.</p>
<ul>
<li>HTTPS 수신 (포트 443)</li>
<li>HTTP → HTTPS 리다이렉트</li>
<li>백엔드: http://localhost:8080</li>
<li>Gzip 압축 활성화</li>
<li>정적 파일 캐싱 (1일)</li>
</ul>
<h3 id="2-api">문제 2: API 게이트웨이 설계<a class="header-link" href="#2-api" title="Permanent link">&para;</a></h3>
<p>마이크로서비스 환경에서 API 게이트웨이를 설계하세요.</p>
<p>서비스:
- User Service: /api/users/<em>
- Order Service: /api/orders/</em>
- Auth Service: /api/auth/*</p>
<p>요구사항:
- JWT 인증 (Auth 제외)
- Rate Limiting: 1000 req/min per user
- 응답 로깅</p>
<h3 id="3-rate-limiting">문제 3: Rate Limiting 선택<a class="header-link" href="#3-rate-limiting" title="Permanent link">&para;</a></h3>
<p>다음 시나리오에 적합한 Rate Limiting 알고리즘을 선택하세요.</p>
<p>a) 공개 API (버스트 허용, 평균 제한)
b) 실시간 스트리밍 서비스
c) 로그인 엔드포인트 (브루트 포스 방지)
d) 단순한 요구사항, 빠른 구현</p>
<h3 id="4-rate-limiting_1">문제 4: Rate Limiting 구현<a class="header-link" href="#4-rate-limiting_1" title="Permanent link">&para;</a></h3>
<p>토큰 버킷 알고리즘을 의사 코드로 구현하세요.</p>
<p>조건:
- 버킷 크기: 100
- 충전 속도: 10 토큰/초</p>
<hr />
<h2 id="_3">정답<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="1_2">문제 1 정답<a class="header-link" href="#1_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>
<span class="w">    </span><span class="kn">return</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="s">https://</span><span class="nv">$server_name$request_uri</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>

<span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/path/to/cert.pem</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/path/to/key.pem</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Gzip 압축</span>
<span class="w">    </span><span class="kn">gzip</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_types</span><span class="w"> </span><span class="s">text/plain</span><span class="w"> </span><span class="s">text/css</span><span class="w"> </span><span class="s">application/json</span>
<span class="w">               </span><span class="s">application/javascript</span><span class="w"> </span><span class="s">text/xml</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_min_length</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># 정적 파일 캐싱</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/static/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1d</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># 백엔드 프록시</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8080</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="2_1">문제 2 정답<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>API Gateway 설계:

┌─────────────────────────────────────────────────┐
│                  API Gateway                    │
├─────────────────────────────────────────────────┤
│                                                 │
│  1. 요청 수신                                   │
│       │                                         │
│  2. Rate Limiting 체크 (Redis 기반)             │
│       │ key: user_id, limit: 1000/min           │
│       │                                         │
│  3. 경로 확인                                   │
│       ├── /api/auth/* → Auth Service (인증 Skip)│
│       ├── /api/users/* → JWT 검증 → User Service│
│       └── /api/orders/*→ JWT 검증 → Order Service│
│                                                 │
│  4. 응답 로깅 (ELK Stack)                       │
│       - timestamp, user_id, path, status,       │
│         response_time                           │
│                                                 │
└─────────────────────────────────────────────────┘

기술 스택:
<span class="k">-</span> Kong Gateway + JWT Plugin + Rate Limiting Plugin
<span class="k">-</span> 또는 AWS API Gateway + Lambda Authorizer
</code></pre></div>

<h3 id="3">문제 3 정답<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>a) 공개 API: 토큰 버킷
   - 버스트 허용으로 사용자 경험 좋음
   - 평균 속도 제한으로 남용 방지

b) 실시간 스트리밍: 리키 버킷
   - 일정한 출력 속도로 품질 유지
   - 버스트 불가로 안정적인 전송

c) 로그인: 고정 윈도우 또는 슬라이딩 윈도우
   - 엄격한 제한 (예: 5회/분)
   - 경계 문제보다 단순함 우선

d) 단순한 요구: 고정 윈도우
   - 구현 가장 단순
   - 카운터 + 타임스탬프만 필요
</code></pre></div>

<h3 id="4">문제 4 정답<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TokenBucket</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">refill_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>        <span class="c1"># 버킷 최대 크기</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refill_rate</span> <span class="o">=</span> <span class="n">refill_rate</span>  <span class="c1"># 초당 토큰 추가</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="n">capacity</span>          <span class="c1"># 현재 토큰 수</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_refill</span> <span class="o">=</span> <span class="n">current_time</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">allow_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refill</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">refill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">current_time</span><span class="p">()</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_refill</span>

        <span class="c1"># 경과 시간에 비례하여 토큰 추가</span>
        <span class="n">tokens_to_add</span> <span class="o">=</span> <span class="n">elapsed</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">refill_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">+</span> <span class="n">tokens_to_add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_refill</span> <span class="o">=</span> <span class="n">now</span>

<span class="c1"># 사용 예</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">TokenBucket</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">refill_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">if</span> <span class="n">bucket</span><span class="o">.</span><span class="n">allow_request</span><span class="p">():</span>
    <span class="n">process_request</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">429</span>  <span class="c1"># Too Many Requests</span>
</code></pre></div>

<hr />
<h2 id="6">6. 다음 단계<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<p>리버스 프록시와 API 게이트웨이를 이해했다면, 캐싱 전략을 학습하세요.</p>
<h3 id="_4">다음 레슨<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="./06_Caching_Strategies.md">06_Caching_Strategies.md</a></li>
</ul>
<h3 id="_5">관련 레슨<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="./04_Load_Balancing.md">04_Load_Balancing.md</a> - 트래픽 분산</li>
<li><a href="./07_Distributed_Cache_Systems.md">07_Distributed_Cache_Systems.md</a> - Redis, Memcached</li>
</ul>
<h3 id="_6">추천 실습<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li>Nginx 리버스 프록시 설정 실습</li>
<li>Kong Gateway 설치 및 플러그인 테스트</li>
<li>Rate Limiting 직접 구현해보기</li>
</ol>
<hr />
<h2 id="7">7. 참고 자료<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="_7">도구<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://nginx.org/">Nginx</a></li>
<li><a href="https://konghq.com/">Kong Gateway</a></li>
<li><a href="https://aws.amazon.com/api-gateway/">AWS API Gateway</a></li>
<li><a href="https://www.envoyproxy.io/">Envoy Proxy</a></li>
</ul>
<h3 id="_8">문서<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/">Nginx Reverse Proxy</a></li>
<li><a href="https://cloud.google.com/architecture/rate-limiting-strategies-techniques">Rate Limiting Best Practices</a></li>
</ul>
<h3 id="_9">알고리즘<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.cloudflare.com/learning/bots/what-is-rate-limiting/">Token Bucket vs Leaky Bucket</a></li>
</ul>
<hr />
<p><strong>문서 정보</strong>
- 최종 수정: 2024년
- 난이도: ⭐⭐⭐
- 예상 학습 시간: 2-3시간</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/System_Design/04_Load_Balancing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">로드 밸런싱</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/System_Design/06_Caching_Strategies.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">캐싱 전략</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}