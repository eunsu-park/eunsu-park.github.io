{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>캐싱 전략 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/System_Design/">System Design</a>
    <span class="separator">/</span>
    <span class="current">캐싱 전략</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>캐싱 전략</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/System_Design/05_Reverse_Proxy_API_Gateway.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">리버스 프록시와 API 게이트웨이</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/System_Design/07_Distributed_Cache_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">분산 캐시 시스템</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">개요</a></li>
<li><a href="#_3">목차</a></li>
<li><a href="#1">1. 캐싱이란?</a><ul>
<li><a href="#11">1.1 캐싱의 정의</a></li>
<li><a href="#12">1.2 캐시 계층</a></li>
<li><a href="#13">1.3 캐시 히트율</a></li>
</ul>
</li>
<li><a href="#2">2. 캐싱 전략 패턴</a><ul>
<li><a href="#21-cache-aside-lazy-loading">2.1 Cache-Aside (Lazy Loading)</a></li>
<li><a href="#22-read-through">2.2 Read-Through</a></li>
<li><a href="#23-write-through">2.3 Write-Through</a></li>
<li><a href="#24-write-behind-write-back">2.4 Write-Behind (Write-Back)</a></li>
<li><a href="#25">2.5 패턴 비교 요약</a></li>
</ul>
</li>
<li><a href="#3">3. 캐시 무효화</a><ul>
<li><a href="#31">3.1 무효화 전략</a></li>
<li><a href="#32-ttl">3.2 TTL 설정 가이드</a></li>
</ul>
</li>
<li><a href="#4">4. 캐시 문제와 해결책</a><ul>
<li><a href="#41-cache-penetration">4.1 캐시 침투 (Cache Penetration)</a></li>
<li><a href="#42-cache-avalanche">4.2 캐시 눈사태 (Cache Avalanche)</a></li>
<li><a href="#43-hot-key">4.3 핫키 문제 (Hot Key)</a></li>
<li><a href="#44">4.4 문제 요약</a></li>
</ul>
</li>
<li><a href="#5-cdn">5. CDN 캐싱</a><ul>
<li><a href="#51-cdn">5.1 CDN 캐싱 개요</a></li>
<li><a href="#52-cache-control">5.2 Cache-Control 헤더</a></li>
</ul>
</li>
<li><a href="#6">6. 연습 문제</a><ul>
<li><a href="#1_1">문제 1: 캐싱 전략 선택</a></li>
<li><a href="#2-ttl">문제 2: TTL 설정</a></li>
<li><a href="#3_1">문제 3: 캐시 문제 해결</a></li>
<li><a href="#4-cache-control">문제 4: Cache-Control 작성</a></li>
</ul>
</li>
<li><a href="#_4">정답</a><ul>
<li><a href="#1_2">문제 1 정답</a></li>
<li><a href="#2_1">문제 2 정답</a></li>
<li><a href="#3_2">문제 3 정답</a></li>
<li><a href="#4_1">문제 4 정답</a></li>
</ul>
</li>
<li><a href="#7">7. 다음 단계</a><ul>
<li><a href="#_5">다음 레슨</a></li>
<li><a href="#_6">관련 레슨</a></li>
<li><a href="#_7">추천 실습</a></li>
</ul>
</li>
<li><a href="#8">8. 참고 자료</a><ul>
<li><a href="#_8">문서</a></li>
<li><a href="#_9">도구</a></li>
<li><a href="#_10">참고 자료</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">캐싱 전략<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">개요<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>이 문서에서는 캐싱의 핵심 전략과 패턴을 다룹니다. Cache-Aside, Read-Through, Write-Through, Write-Behind 패턴의 차이를 이해하고, 캐시 무효화, TTL 설정, 그리고 캐시 침투/눈사태/핫키 문제와 해결책을 학습합니다.</p>
<p><strong>난이도</strong>: ⭐⭐⭐
<strong>예상 학습 시간</strong>: 2-3시간
<strong>선수 지식</strong>: <a href="./05_Reverse_Proxy_API_Gateway.md">05_Reverse_Proxy_API_Gateway.md</a></p>
<hr />
<h2 id="_3">목차<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-캐싱이란">캐싱이란?</a></li>
<li><a href="#2-캐싱-전략-패턴">캐싱 전략 패턴</a></li>
<li><a href="#3-캐시-무효화">캐시 무효화</a></li>
<li><a href="#4-캐시-문제와-해결책">캐시 문제와 해결책</a></li>
<li><a href="#5-cdn-캐싱">CDN 캐싱</a></li>
<li><a href="#6-연습-문제">연습 문제</a></li>
<li><a href="#7-다음-단계">다음 단계</a></li>
<li><a href="#8-참고-자료">참고 자료</a></li>
</ol>
<hr />
<h2 id="1">1. 캐싱이란?<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 캐싱의 정의<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                      캐싱이란?                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;자주 사용하는 데이터를 빠른 저장소에 임시 저장&quot;               │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  캐시 없이:                                                │ │
│  │                                                            │ │
│  │  Client ──▶ Server ──▶ Database                            │ │
│  │         ◀──────────────    (매번 DB 조회)                  │ │
│  │         ~100ms                                             │ │
│  │                                                            │ │
│  │  캐시 사용:                                                │ │
│  │                                                            │ │
│  │  Client ──▶ Server ──▶ Cache (Hit!) ──▶ 응답              │ │
│  │         ◀────────────    ~1ms                              │ │
│  │                                                            │ │
│  │  Cache Miss 시:                                            │ │
│  │  Server ──▶ Database ──▶ Cache 저장 ──▶ 응답              │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  100배 이상 빠른 응답 가능!                                     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="12">1.2 캐시 계층<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                      캐시 계층                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Client                                                         │
│    │                                                            │
│    ├── 브라우저 캐시 (가장 빠름)                                │
│    │     L1: 메모리 캐시                                        │
│    │     L2: 디스크 캐시                                        │
│    │                                                            │
│    ├── CDN 캐시 (Edge)                                          │
│    │     지리적으로 가까운 서버                                 │
│    │                                                            │
│    ├── 리버스 프록시 캐시                                       │
│    │     Nginx, Varnish                                         │
│    │                                                            │
│    ├── 애플리케이션 캐시                                        │
│    │     로컬 캐시 (in-memory)                                  │
│    │     분산 캐시 (Redis, Memcached)                           │
│    │                                                            │
│    └── 데이터베이스 캐시                                        │
│          Query Cache, Buffer Pool                               │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │       빠름                              느림                │ │
│  │  ◀───────────────────────────────────────────────▶         │ │
│  │  브라우저 → CDN → 프록시 → App Cache → DB                  │ │
│  │                                                            │ │
│  │       작음                              큼                  │ │
│  │  ◀───────────────────────────────────────────────▶         │ │
│  │        (저장 용량)                                         │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="13">1.3 캐시 히트율<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    캐시 히트율                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Cache Hit Rate = (캐시 적중 수) / (전체 요청 수) × 100%        │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  예시: 1000 요청, 950 Hit, 50 Miss                         │ │
│  │  Hit Rate = 950 / 1000 = 95%                               │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  히트율에 따른 효과:                                            │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  Hit Rate   │ DB 부하 감소  │ 평균 응답 시간               │ │
│  │  ───────────┼───────────────┼────────────────              │ │
│  │  50%        │ 50%           │ 50ms (예시)                  │ │
│  │  90%        │ 90%           │ 10ms                         │ │
│  │  95%        │ 95%           │ 5ms                          │ │
│  │  99%        │ 99%           │ 2ms                          │ │
│  │                                                            │ │
│  │  높은 히트율 = 더 빠른 응답 + DB 보호                      │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  히트율 향상 전략:                                              │
│  • 적절한 TTL 설정                                              │
│  • 캐시 크기 최적화                                             │
│  • 핫 데이터 사전 로딩                                          │
│  • 캐시 키 설계 최적화                                          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="2">2. 캐싱 전략 패턴<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-cache-aside-lazy-loading">2.1 Cache-Aside (Lazy Loading)<a class="header-link" href="#21-cache-aside-lazy-loading" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">Cache</span><span class="o">-</span><span class="n">Aside</span><span class="w"> </span><span class="n">패턴</span><span class="w">                              </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="ss">&quot;애플리케이션이 캐시를 직접 관리&quot;</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">읽기</span><span class="w"> </span><span class="p">(</span><span class="k">Read</span><span class="p">)</span><span class="err">:</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시에서</span><span class="w"> </span><span class="n">조회</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="err">──</span><span class="n">Hit</span><span class="vm">?</span><span class="err">──▶</span><span class="w"> </span><span class="n">Yes</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">반환</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">     </span><span class="k">No</span><span class="w"> </span><span class="p">(</span><span class="n">Miss</span><span class="p">)</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">DB에서</span><span class="w"> </span><span class="n">조회</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">Database</span><span class="o">]</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">반환</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">저장</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="n">업데이트</span><span class="p">)</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">쓰기</span><span class="w"> </span><span class="p">(</span><span class="k">Write</span><span class="p">)</span><span class="err">:</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">DB에</span><span class="w"> </span><span class="n">쓰기</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">Database</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="n">업데이트</span><span class="p">)</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">무효화</span><span class="w"> </span><span class="p">(</span><span class="n">삭제</span><span class="p">)</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="n">삭제</span><span class="p">)</span><span class="w">                                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">코드</span><span class="w"> </span><span class="nl">예시</span><span class="p">:</span><span class="w">                                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">def</span><span class="w"> </span><span class="n">get_user</span><span class="p">(</span><span class="nf">user_id</span><span class="p">)</span><span class="err">:</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">확인</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;user:{user_id}&quot;</span><span class="p">)</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="k">user</span><span class="err">:</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">user</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">Hit</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w"> </span><span class="p">(</span><span class="n">Cache</span><span class="w"> </span><span class="n">Miss</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;SELECT * FROM users WHERE id={id}&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">저장</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">cache</span><span class="p">.</span><span class="k">set</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;user:{user_id}&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">user</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">user</span><span class="w">                                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">장점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">필요한</span><span class="w"> </span><span class="n">데이터만</span><span class="w"> </span><span class="n">캐싱</span><span class="w"> </span><span class="p">(</span><span class="n">메모리</span><span class="w"> </span><span class="n">효율</span><span class="p">)</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">장애</span><span class="w"> </span><span class="n">시에도</span><span class="w"> </span><span class="n">DB로</span><span class="w"> </span><span class="n">동작</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">단점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">첫</span><span class="w"> </span><span class="n">요청은</span><span class="w"> </span><span class="n">항상</span><span class="w"> </span><span class="n">느림</span><span class="w"> </span><span class="p">(</span><span class="n">Cache</span><span class="w"> </span><span class="n">Miss</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">캐시</span><span class="o">-</span><span class="n">DB</span><span class="w"> </span><span class="n">불일치</span><span class="w"> </span><span class="n">가능성</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="22-read-through">2.2 Read-Through<a class="header-link" href="#22-read-through" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                   </span><span class="k">Read</span><span class="o">-</span><span class="n">Through</span><span class="w"> </span><span class="n">패턴</span><span class="w">                              </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="ss">&quot;캐시가 DB 조회를 대행&quot;</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">요청</span><span class="w"> </span><span class="p">(</span><span class="n">항상</span><span class="p">)</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="err">──</span><span class="n">Hit</span><span class="vm">?</span><span class="err">──▶</span><span class="w"> </span><span class="n">Yes</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">반환</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">     </span><span class="k">No</span><span class="w"> </span><span class="p">(</span><span class="n">Miss</span><span class="p">)</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">캐시가</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w"> </span><span class="p">(</span><span class="n">자동</span><span class="p">)</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">Database</span><span class="o">]</span><span class="w">                                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">저장</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">반환</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">애플리케이션은</span><span class="w"> </span><span class="n">캐시만</span><span class="w"> </span><span class="n">바라봄</span><span class="err">!</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w"> </span><span class="n">로직이</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">내장됨</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Cache</span><span class="o">-</span><span class="n">Aside</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="k">Read</span><span class="o">-</span><span class="nl">Through</span><span class="p">:</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Cache</span><span class="o">-</span><span class="nl">Aside</span><span class="p">:</span><span class="w"> </span><span class="n">앱이</span><span class="w"> </span><span class="n">캐시와</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">모두</span><span class="w"> </span><span class="n">관리</span><span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="k">Read</span><span class="o">-</span><span class="nl">Through</span><span class="p">:</span><span class="w"> </span><span class="n">앱은</span><span class="w"> </span><span class="n">캐시만</span><span class="w"> </span><span class="n">사용</span><span class="p">,</span><span class="w"> </span><span class="n">캐시가</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">관리</span><span class="w">            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">장점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">애플리케이션</span><span class="w"> </span><span class="n">코드</span><span class="w"> </span><span class="n">단순화</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">로직</span><span class="w"> </span><span class="n">중앙화</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">단점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">시스템에</span><span class="w"> </span><span class="n">로더</span><span class="w"> </span><span class="n">구현</span><span class="w"> </span><span class="n">필요</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">유연성</span><span class="w"> </span><span class="n">감소</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="23-write-through">2.3 Write-Through<a class="header-link" href="#23-write-through" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                  </span><span class="k">Write</span><span class="o">-</span><span class="n">Through</span><span class="w"> </span><span class="n">패턴</span><span class="w">                              </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="ss">&quot;쓰기 시 캐시와 DB 동시 업데이트 (동기)&quot;</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">쓰기</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="err">─────────────────────────────────────┐</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">캐시가</span><span class="w"> </span><span class="n">DB에</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="p">(</span><span class="n">동기</span><span class="p">)</span><span class="w">              </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="n">동시에</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">Database</span><span class="o">]</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="n">완료</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">완료</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">응답</span><span class="w">                         </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                         </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w"> </span><span class="err">◀─────────────────────────────────┘</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">특징</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">캐시와</span><span class="w"> </span><span class="n">DB가</span><span class="w"> </span><span class="n">항상</span><span class="w"> </span><span class="n">동기화</span><span class="w"> </span><span class="p">(</span><span class="n">강한</span><span class="w"> </span><span class="n">일관성</span><span class="p">)</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="k">Read</span><span class="o">-</span><span class="n">Through와</span><span class="w"> </span><span class="n">함께</span><span class="w"> </span><span class="n">사용하면</span><span class="w"> </span><span class="n">효과적</span><span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">장점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">일관성</span><span class="w"> </span><span class="n">보장</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">손실</span><span class="w"> </span><span class="n">없음</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">단점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="n">지연</span><span class="w"> </span><span class="p">(</span><span class="n">두</span><span class="w"> </span><span class="n">곳에</span><span class="w"> </span><span class="n">쓰기</span><span class="p">)</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">불필요한</span><span class="w"> </span><span class="n">데이터도</span><span class="w"> </span><span class="n">캐싱될</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">있음</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="24-write-behind-write-back">2.4 Write-Behind (Write-Back)<a class="header-link" href="#24-write-behind-write-back" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                 </span><span class="k">Write</span><span class="o">-</span><span class="n">Behind</span><span class="w"> </span><span class="p">(</span><span class="k">Write</span><span class="o">-</span><span class="n">Back</span><span class="p">)</span><span class="w"> </span><span class="n">패턴</span><span class="w">                   </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="ss">&quot;캐시에 먼저 쓰고, DB에는 나중에 쓰기 (비동기)&quot;</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Application</span><span class="w">                                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">쓰기</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="o">[</span><span class="n">Cache</span><span class="o">]</span><span class="w"> </span><span class="err">──────────────▶</span><span class="w"> </span><span class="n">즉시</span><span class="w"> </span><span class="n">응답</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">나중에</span><span class="w"> </span><span class="n">DB에</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="p">(</span><span class="n">비동기</span><span class="p">)</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">┌─────────────────────────────┐</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">Queue</span><span class="w">                 </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">data1, data2, data3, ...</span><span class="o">]</span><span class="w">  </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">└─────────────────────────────┘</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="n">배치</span><span class="w"> </span><span class="n">처리</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">              </span><span class="err">▼</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">└─────────▶</span><span class="w"> </span><span class="o">[</span><span class="n">Database</span><span class="o">]</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">시간대별</span><span class="w"> </span><span class="nl">동작</span><span class="p">:</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="p">(</span><span class="n">즉시</span><span class="w"> </span><span class="n">완료</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="p">(</span><span class="n">즉시</span><span class="w"> </span><span class="n">완료</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="p">(</span><span class="n">즉시</span><span class="w"> </span><span class="n">완료</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">...</span><span class="w">                                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="err">:</span><span class="w"> </span><span class="n">배치로</span><span class="w"> </span><span class="n">DB에</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">번에</span><span class="w"> </span><span class="n">저장</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">장점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="n">성능</span><span class="w"> </span><span class="n">우수</span><span class="w"> </span><span class="p">(</span><span class="n">캐시에만</span><span class="w"> </span><span class="n">쓰고</span><span class="w"> </span><span class="n">응답</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">부하</span><span class="w"> </span><span class="n">감소</span><span class="w"> </span><span class="p">(</span><span class="n">배치</span><span class="w"> </span><span class="n">처리</span><span class="p">)</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="n">병합</span><span class="w"> </span><span class="n">가능</span><span class="w"> </span><span class="p">(</span><span class="n">같은</span><span class="w"> </span><span class="n">키</span><span class="w"> </span><span class="n">여러</span><span class="w"> </span><span class="n">번</span><span class="w"> </span><span class="n">쓰기</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">마지막만</span><span class="w"> </span><span class="n">저장</span><span class="p">)</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nl">단점</span><span class="p">:</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">손실</span><span class="w"> </span><span class="n">위험</span><span class="w"> </span><span class="p">(</span><span class="n">캐시</span><span class="w"> </span><span class="n">장애</span><span class="w"> </span><span class="n">시</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">구현</span><span class="w"> </span><span class="n">복잡</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">일관성</span><span class="w"> </span><span class="n">문제</span><span class="w"> </span><span class="p">(</span><span class="n">DB에</span><span class="w"> </span><span class="n">아직</span><span class="w"> </span><span class="n">없는</span><span class="w"> </span><span class="n">데이터</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">사용</span><span class="w"> </span><span class="nl">사례</span><span class="p">:</span><span class="w">                                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">로그</span><span class="w"> </span><span class="n">수집</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">조회수</span><span class="o">/</span><span class="n">좋아요</span><span class="w"> </span><span class="n">카운터</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">실시간성보다</span><span class="w"> </span><span class="n">성능이</span><span class="w"> </span><span class="n">중요한</span><span class="w"> </span><span class="n">경우</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="25">2.5 패턴 비교 요약<a class="header-link" href="#25" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>패턴</th>
<th>읽기</th>
<th>쓰기</th>
<th>일관성</th>
<th>성능</th>
<th>복잡도</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cache-Aside</td>
<td>앱이 관리</td>
<td>DB 직접, 캐시 무효화</td>
<td>약함</td>
<td>좋음</td>
<td>낮음</td>
</tr>
<tr>
<td>Read-Through</td>
<td>캐시가 관리</td>
<td>-</td>
<td>-</td>
<td>좋음</td>
<td>중간</td>
</tr>
<tr>
<td>Write-Through</td>
<td>-</td>
<td>캐시→DB 동기</td>
<td>강함</td>
<td>보통</td>
<td>중간</td>
</tr>
<tr>
<td>Write-Behind</td>
<td>-</td>
<td>캐시 먼저, DB 나중</td>
<td>약함</td>
<td>매우 좋음</td>
<td>높음</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. 캐시 무효화<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 무효화 전략<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">캐시</span><span class="w"> </span><span class="n">무효화</span><span class="w"> </span><span class="n">전략</span><span class="w">                              </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="s">&quot;캐시된 데이터를 언제, 어떻게 삭제/갱신할 것인가?&quot;</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">Live</span><span class="p">)</span><span class="w"> </span><span class="n">기반</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">cache</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;user:123&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="n">시간</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">만료</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="o">:</span><span class="w">     </span><span class="p">[</span><span class="n">user</span><span class="o">:</span><span class="mi">123</span><span class="p">]</span><span class="w"> </span><span class="n">저장</span><span class="w">                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">3600</span><span class="o">:</span><span class="w">  </span><span class="p">[</span><span class="n">user</span><span class="o">:</span><span class="mi">123</span><span class="p">]</span><span class="w"> </span><span class="n">자동</span><span class="w"> </span><span class="n">삭제</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">장점</span><span class="o">:</span><span class="w"> </span><span class="n">단순</span><span class="p">,</span><span class="w"> </span><span class="n">자동</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">단점</span><span class="o">:</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="n">동안</span><span class="w"> </span><span class="n">오래된</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">서빙</span><span class="w"> </span><span class="n">가능</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">명시적</span><span class="w"> </span><span class="n">삭제</span><span class="w"> </span><span class="p">(</span><span class="n">Explicit</span><span class="w"> </span><span class="n">Invalidation</span><span class="p">)</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">수정</span><span class="w"> </span><span class="n">시</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">db</span><span class="p">.</span><span class="n">update_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">new_data</span><span class="p">)</span><span class="w">                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">cache</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;user:{user_id}&quot;</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">삭제</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">장점</span><span class="o">:</span><span class="w"> </span><span class="n">즉시</span><span class="w"> </span><span class="n">일관성</span><span class="w"> </span><span class="n">회복</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">단점</span><span class="o">:</span><span class="w"> </span><span class="n">삭제</span><span class="w"> </span><span class="n">로직</span><span class="w"> </span><span class="n">필요</span><span class="p">,</span><span class="w"> </span><span class="n">실수</span><span class="w"> </span><span class="n">가능</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">이벤트</span><span class="w"> </span><span class="n">기반</span><span class="w"> </span><span class="n">무효화</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">DB</span><span class="w"> </span><span class="n">변경</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">이벤트</span><span class="w"> </span><span class="n">발행</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">무효화</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">CDC</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Kafka</span><span class="p">]</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Cache</span><span class="w"> </span><span class="n">Invalidator</span><span class="p">]</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">장점</span><span class="o">:</span><span class="w"> </span><span class="n">느슨한</span><span class="w"> </span><span class="n">결합</span><span class="p">,</span><span class="w"> </span><span class="n">확장성</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">단점</span><span class="o">:</span><span class="w"> </span><span class="n">복잡도</span><span class="w"> </span><span class="n">증가</span><span class="p">,</span><span class="w"> </span><span class="n">지연</span><span class="w"> </span><span class="n">가능</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="32-ttl">3.2 TTL 설정 가이드<a class="header-link" href="#32-ttl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                     TTL 설정 가이드                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  데이터 특성별 TTL 권장:                                        │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  거의 변하지 않는 데이터:                                  │ │
│  │  • 설정 값, 메타데이터: 24시간 ~ 7일                       │ │
│  │  • 국가/지역 정보: 7일+                                    │ │
│  │                                                            │ │
│  │  자주 변하지 않는 데이터:                                  │ │
│  │  • 사용자 프로필: 1시간 ~ 24시간                           │ │
│  │  • 상품 정보: 1시간 ~ 6시간                                │ │
│  │                                                            │ │
│  │  자주 변하는 데이터:                                       │ │
│  │  • 재고 수량: 1분 ~ 5분                                    │ │
│  │  • 실시간 통계: 30초 ~ 1분                                 │ │
│  │                                                            │ │
│  │  실시간 데이터:                                            │ │
│  │  • 캐싱하지 않거나 매우 짧은 TTL (초 단위)                 │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  TTL 결정 공식:                                                 │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  TTL = f(변경 빈도, 일관성 요구, 트래픽 패턴)              │ │
│  │                                                            │ │
│  │  • 변경 빈도 낮음 → TTL 길게                               │ │
│  │  • 일관성 중요 → TTL 짧게 또는 명시적 무효화               │ │
│  │  • 트래픽 높음 → TTL 길게 (히트율 중요)                    │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  TTL Jitter (지터):                                             │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │  문제: 같은 TTL → 동시 만료 → 캐시 스탬피드                │ │
│  │                                                            │ │
│  │  해결: TTL에 랜덤 값 추가                                  │ │
│  │                                                            │ │
│  │  base_ttl = 3600  # 1시간                                  │ │
│  │  jitter = random(-300, 300)  # ±5분                        │ │
│  │  ttl = base_ttl + jitter  # 55분 ~ 65분                    │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="4">4. 캐시 문제와 해결책<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-cache-penetration">4.1 캐시 침투 (Cache Penetration)<a class="header-link" href="#41-cache-penetration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">캐시</span><span class="w"> </span><span class="n">침투</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="s">&quot;존재하지 않는 데이터를 계속 요청 → DB 과부하&quot;</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">공격자</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="n">user</span><span class="o">?</span><span class="kt">id</span><span class="o">=</span><span class="mi">-1</span><span class="w"> </span><span class="p">(</span><span class="n">존재하지</span><span class="w"> </span><span class="n">않는</span><span class="w"> </span><span class="n">ID</span><span class="p">)</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">매번</span><span class="o">:</span><span class="w">                                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">확인</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">결과</span><span class="w"> </span><span class="n">없음</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">저장</span><span class="w"> </span><span class="n">안</span><span class="w"> </span><span class="n">함</span><span class="w"> </span><span class="p">(</span><span class="n">없으니까</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">다음</span><span class="w"> </span><span class="n">요청도</span><span class="w"> </span><span class="n">같은</span><span class="w"> </span><span class="n">과정</span><span class="w"> </span><span class="n">반복</span><span class="o">!</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">Miss</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Empty</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">Miss</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Empty</span><span class="w"> </span><span class="p">(</span><span class="n">반복</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">Miss</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w"> </span><span class="err">──▶</span><span class="w"> </span><span class="n">Empty</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Null</span><span class="w"> </span><span class="n">값</span><span class="w"> </span><span class="n">캐싱</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w">                                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w">                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">cache</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NULL&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">짧은</span><span class="w"> </span><span class="n">TTL</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">else</span><span class="o">:</span><span class="w">                                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">cache</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">Bloom</span><span class="w"> </span><span class="n">Filter</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">Bloom</span><span class="w"> </span><span class="n">Filter</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="s">&quot;key 존재할 수 있음?&quot;</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">확실히</span><span class="w"> </span><span class="n">없음</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">바로</span><span class="w"> </span><span class="n">반환</span><span class="w"> </span><span class="p">(</span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w"> </span><span class="n">안</span><span class="w"> </span><span class="n">함</span><span class="p">)</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">있을</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">있음</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">캐시</span><span class="o">/</span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w">                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Bloom</span><span class="w"> </span><span class="n">Filter</span><span class="o">:</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">효율적인</span><span class="w"> </span><span class="n">존재</span><span class="w"> </span><span class="n">확인</span><span class="w"> </span><span class="n">자료구조</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">False</span><span class="w"> </span><span class="n">Positive</span><span class="w"> </span><span class="n">가능</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="w"> </span><span class="n">Negative</span><span class="w"> </span><span class="n">불가</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="42-cache-avalanche">4.2 캐시 눈사태 (Cache Avalanche)<a class="header-link" href="#42-cache-avalanche" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">캐시</span><span class="w"> </span><span class="n">눈사태</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="s">&quot;대량의 캐시가 동시에 만료 → DB 폭주&quot;</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">워밍</span><span class="w"> </span><span class="p">(</span><span class="mi">1000</span><span class="n">개</span><span class="w"> </span><span class="n">항목</span><span class="p">,</span><span class="w"> </span><span class="n">TTL</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">T</span><span class="o">=</span><span class="mi">3600</span><span class="o">:</span><span class="w"> </span><span class="mi">1000</span><span class="n">개</span><span class="w"> </span><span class="n">동시</span><span class="w"> </span><span class="n">만료</span><span class="o">!</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">──▶</span><span class="w"> </span><span class="mi">1000</span><span class="n">개</span><span class="w"> </span><span class="n">동시</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">──▶</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">과부하</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">장애</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">═════════════════════════════════════</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">  </span><span class="n">All</span><span class="w"> </span><span class="n">Expired</span><span class="o">!</span><span class="w">  </span><span class="err">│</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">└────────────────┘</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">┌────────┴────────┐</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">동시</span><span class="w"> </span><span class="n">요청</span><span class="w">   </span><span class="err">│</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="mi">1000</span><span class="n">개</span><span class="o">!</span><span class="w">       </span><span class="err">│</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">└────────────────┘</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                   </span><span class="err">▼</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w"> </span><span class="err">💥</span><span class="w"> </span><span class="n">과부하</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="n">분산</span><span class="w"> </span><span class="p">(</span><span class="n">Jitter</span><span class="p">)</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_ttl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">0</span><span class="o">~</span><span class="mi">10</span><span class="n">분</span><span class="w"> </span><span class="n">랜덤</span><span class="w"> </span><span class="n">추가</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">만료</span><span class="w"> </span><span class="n">시점이</span><span class="w"> </span><span class="n">분산됨</span><span class="w">                                      </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">워밍</span><span class="w"> </span><span class="p">(</span><span class="n">Pre</span><span class="o">-</span><span class="n">loading</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">서버</span><span class="w"> </span><span class="n">시작</span><span class="w"> </span><span class="n">시</span><span class="w"> </span><span class="n">핫</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">미리</span><span class="w"> </span><span class="n">로딩</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">•</span><span class="w"> </span><span class="n">만료</span><span class="w"> </span><span class="n">전에</span><span class="w"> </span><span class="n">백그라운드에서</span><span class="w"> </span><span class="n">갱신</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">다중</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">레이어</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">L1</span><span class="w"> </span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">Miss</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">L2</span><span class="w"> </span><span class="n">Cache</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">Miss</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">DB</span><span class="p">]</span><span class="w">            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="p">(</span><span class="n">로컬</span><span class="p">)</span><span class="w">               </span><span class="p">(</span><span class="n">분산</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">뮤텍스</span><span class="o">/</span><span class="n">락</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">캐시</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">시</span><span class="w"> </span><span class="n">하나의</span><span class="w"> </span><span class="n">요청만</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="p">,</span><span class="w"> </span><span class="n">나머지</span><span class="w"> </span><span class="n">대기</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">def</span><span class="w"> </span><span class="n">get_with_lock</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">:</span><span class="w">                                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">data</span><span class="o">:</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">data</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="n">setnx</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;lock:{key}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">:</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">락</span><span class="w"> </span><span class="n">획득</span><span class="w"> </span><span class="n">성공</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="n">조회</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">cache</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">cache</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;lock:{key}&quot;</span><span class="p">)</span><span class="w">                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="k">else</span><span class="o">:</span><span class="w">                                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">락</span><span class="w"> </span><span class="n">획득</span><span class="w"> </span><span class="n">실패</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">잠시</span><span class="w"> </span><span class="n">대기</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">재시도</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="w">                                        </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w">                             </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="43-hot-key">4.3 핫키 문제 (Hot Key)<a class="header-link" href="#43-hot-key" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                      </span><span class="n">핫키</span><span class="w"> </span><span class="n">문제</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="s">&quot;특정 키에 트래픽 집중 → 해당 캐시 노드 과부하&quot;</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">예</span><span class="o">:</span><span class="w"> </span><span class="n">인기</span><span class="w"> </span><span class="n">연예인</span><span class="w"> </span><span class="n">게시글</span><span class="p">,</span><span class="w"> </span><span class="n">플래시</span><span class="w"> </span><span class="n">세일</span><span class="w"> </span><span class="n">상품</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="w"> </span><span class="p">(</span><span class="n">핫</span><span class="w"> </span><span class="n">상품</span><span class="p">)</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">┌────────┼────────┐</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">▼</span><span class="w">        </span><span class="err">▼</span><span class="w">        </span><span class="err">▼</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">요청</span><span class="p">]</span><span class="w">   </span><span class="p">[</span><span class="n">요청</span><span class="p">]</span><span class="w">   </span><span class="p">[</span><span class="n">요청</span><span class="p">]</span><span class="w">  </span><span class="err">×</span><span class="mi">10000</span><span class="w">                          </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">             </span><span class="err">▼</span><span class="w">                                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="p">[</span><span class="n">Redis</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="err">💥</span><span class="w"> </span><span class="n">과부하</span><span class="w">                                </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">다른</span><span class="w"> </span><span class="n">노드들은</span><span class="w"> </span><span class="n">한가한데</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">노드만</span><span class="w"> </span><span class="n">과부하</span><span class="o">!</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">로컬</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">추가</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">App</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="p">[</span><span class="n">Local</span><span class="w"> </span><span class="n">Cache</span><span class="p">]</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">App</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="p">[</span><span class="n">Local</span><span class="w"> </span><span class="n">Cache</span><span class="p">]</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">App</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="p">[</span><span class="n">Local</span><span class="w"> </span><span class="n">Cache</span><span class="p">]</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">          </span><span class="err">└───────────────┘</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                  </span><span class="err">▼</span><span class="w">                                         </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">            </span><span class="p">[</span><span class="n">Redis</span><span class="w"> </span><span class="n">Cluster</span><span class="p">]</span><span class="w">                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">로컬</span><span class="w"> </span><span class="n">캐시로</span><span class="w"> </span><span class="n">핫키</span><span class="w"> </span><span class="n">분산</span><span class="o">!</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">키</span><span class="w"> </span><span class="n">복제</span><span class="w"> </span><span class="p">(</span><span class="n">Key</span><span class="w"> </span><span class="n">Replication</span><span class="p">)</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">원래</span><span class="o">:</span><span class="w"> </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">복제</span><span class="o">:</span><span class="w"> </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="o">:</span><span class="mi">0</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">        </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="o">:</span><span class="mi">1</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">        </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="o">:</span><span class="mi">2</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">        </span><span class="p">...</span><span class="w">                                                 </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">        </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="o">:</span><span class="n">N</span><span class="w">                                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">조회</span><span class="w"> </span><span class="n">시</span><span class="o">:</span><span class="w"> </span><span class="n">product</span><span class="o">:</span><span class="mi">12345</span><span class="o">:</span><span class="p">{</span><span class="n">random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">)}</span><span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">여러</span><span class="w"> </span><span class="n">노드에</span><span class="w"> </span><span class="n">분산</span><span class="o">!</span><span class="w">                                       </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">해결책</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">읽기</span><span class="w"> </span><span class="n">복제본</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────────────────────┐</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">Master</span><span class="p">]</span><span class="w"> </span><span class="err">──</span><span class="n">복제</span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Replica</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">               </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Replica</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">               </span><span class="err">──▶</span><span class="w"> </span><span class="p">[</span><span class="n">Replica</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">                              </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">읽기</span><span class="w"> </span><span class="n">요청을</span><span class="w"> </span><span class="n">복제본들에</span><span class="w"> </span><span class="n">분산</span><span class="w">                               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                                            </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="44">4.4 문제 요약<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>문제</th>
<th>원인</th>
<th>영향</th>
<th>해결책</th>
</tr>
</thead>
<tbody>
<tr>
<td>캐시 침투</td>
<td>없는 데이터 조회</td>
<td>DB 과부하</td>
<td>Null 캐싱, Bloom Filter</td>
</tr>
<tr>
<td>캐시 눈사태</td>
<td>동시 만료</td>
<td>DB 폭주</td>
<td>TTL Jitter, 락, 워밍</td>
</tr>
<tr>
<td>핫키</td>
<td>특정 키 집중</td>
<td>노드 과부하</td>
<td>로컬 캐시, 키 복제</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-cdn">5. CDN 캐싱<a class="header-link" href="#5-cdn" title="Permanent link">&para;</a></h2>
<h3 id="51-cdn">5.1 CDN 캐싱 개요<a class="header-link" href="#51-cdn" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                     CDN 캐싱                                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  &quot;정적 콘텐츠를 엣지 서버에 캐싱&quot;                               │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │              ┌─────────────┐                               │ │
│  │              │   Origin    │                               │ │
│  │              │   Server    │                               │ │
│  │              └──────┬──────┘                               │ │
│  │                     │                                      │ │
│  │        ┌────────────┼────────────┐                         │ │
│  │        │            │            │                         │ │
│  │        ▼            ▼            ▼                         │ │
│  │   ┌─────────┐  ┌─────────┐  ┌─────────┐                   │ │
│  │   │ Edge    │  │ Edge    │  │ Edge    │                   │ │
│  │   │ Seoul   │  │ Tokyo   │  │ NYC     │                   │ │
│  │   └────┬────┘  └────┬────┘  └────┬────┘                   │ │
│  │        │            │            │                         │ │
│  │        ▼            ▼            ▼                         │ │
│  │   한국 사용자    일본 사용자   미국 사용자                  │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  CDN 캐싱 대상:                                                 │
│  • 이미지, CSS, JavaScript                                      │
│  • 폰트, 동영상                                                 │
│  • API 응답 (GET, 캐시 가능한 것)                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="52-cache-control">5.2 Cache-Control 헤더<a class="header-link" href="#52-cache-control" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│<span class="w">                  </span><span class="nv">Cache</span><span class="o">-</span><span class="nv">Control</span><span class="w"> </span>헤더<span class="w">                              </span>│
├─────────────────────────────────────────────────────────────────┤
│<span class="w">                                                                  </span>│
│<span class="w">  </span>주요<span class="w"> </span>디렉티브:<span class="w">                                                 </span>│
│<span class="w">  </span>┌────────────────────────────────────────────────────────────┐<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">max</span><span class="o">-</span><span class="nv">age</span><span class="o">=</span><span class="mi">3600</span><span class="w">                                              </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>브라우저<span class="o">/</span><span class="nv">CDN</span><span class="w"> </span>캐싱<span class="w"> </span>시간<span class="w"> </span><span class="ss">(</span>초<span class="ss">)</span><span class="w">                             </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">s</span><span class="o">-</span><span class="nv">maxage</span><span class="o">=</span><span class="mi">86400</span><span class="w">                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span><span class="nv">CDN</span><span class="o">/</span>공유<span class="w"> </span>캐시<span class="w"> </span>전용<span class="w"> </span>시간<span class="w"> </span><span class="ss">(</span><span class="nv">max</span><span class="o">-</span><span class="nv">age</span>보다<span class="w"> </span>우선<span class="ss">)</span><span class="w">              </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">public</span><span class="w">                                                    </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>모든<span class="w"> </span>캐시에서<span class="w"> </span>저장<span class="w"> </span>가능<span class="w">                                 </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">private</span><span class="w">                                                   </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>브라우저만<span class="w"> </span>캐시<span class="w"> </span>가능<span class="w"> </span><span class="ss">(</span><span class="nv">CDN</span><span class="w"> </span>불가<span class="ss">)</span><span class="w">                         </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">no</span><span class="o">-</span><span class="nv">cache</span><span class="w">                                                  </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>캐시<span class="w"> </span>전에<span class="w"> </span>원본에<span class="w"> </span>검증<span class="w"> </span>필요<span class="w">                              </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">no</span><span class="o">-</span><span class="nv">store</span><span class="w">                                                  </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>캐싱<span class="w"> </span>금지<span class="w">                                               </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">stale</span><span class="o">-</span><span class="k">while</span><span class="o">-</span><span class="nv">revalidate</span><span class="o">=</span><span class="mi">60</span><span class="w">                                 </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>오래된<span class="w"> </span>캐시<span class="w"> </span>서빙하면서<span class="w"> </span>백그라운드<span class="w"> </span>갱신<span class="w">                  </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">immutable</span><span class="w">                                                 </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">    </span>콘텐츠가<span class="w"> </span>절대<span class="w"> </span>변하지<span class="w"> </span>않음<span class="w"> </span><span class="ss">(</span>버전이<span class="w"> </span><span class="nv">URL</span>에<span class="w"> </span>포함<span class="ss">)</span><span class="w">           </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>└────────────────────────────────────────────────────────────┘<span class="w"> </span>│
│<span class="w">                                                                  </span>│
│<span class="w">  </span>예시:<span class="w">                                                          </span>│
│<span class="w">  </span>┌────────────────────────────────────────────────────────────┐<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span>#<span class="w"> </span>정적<span class="w"> </span>자산<span class="w"> </span><span class="ss">(</span><span class="mi">1</span>년<span class="ss">)</span><span class="w">                                         </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">Cache</span><span class="o">-</span><span class="nv">Control</span>:<span class="w"> </span><span class="nv">public</span>,<span class="w"> </span><span class="nv">max</span><span class="o">-</span><span class="nv">age</span><span class="o">=</span><span class="mi">31536000</span>,<span class="w"> </span><span class="nv">immutable</span><span class="w">        </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span>#<span class="w"> </span><span class="nv">API</span><span class="w"> </span>응답<span class="w"> </span><span class="ss">(</span><span class="nv">CDN</span><span class="w"> </span><span class="mi">1</span>시간,<span class="w"> </span>브라우저<span class="w"> </span><span class="mi">5</span>분<span class="ss">)</span><span class="w">                      </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">Cache</span><span class="o">-</span><span class="nv">Control</span>:<span class="w"> </span><span class="nv">public</span>,<span class="w"> </span><span class="nv">max</span><span class="o">-</span><span class="nv">age</span><span class="o">=</span><span class="mi">300</span>,<span class="w"> </span><span class="nv">s</span><span class="o">-</span><span class="nv">maxage</span><span class="o">=</span><span class="mi">3600</span><span class="w">         </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span>#<span class="w"> </span>개인<span class="w"> </span>데이터<span class="w"> </span><span class="ss">(</span>브라우저만<span class="ss">)</span><span class="w">                                </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">Cache</span><span class="o">-</span><span class="nv">Control</span>:<span class="w"> </span><span class="nv">private</span>,<span class="w"> </span><span class="nv">max</span><span class="o">-</span><span class="nv">age</span><span class="o">=</span><span class="mi">600</span><span class="w">                       </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span>#<span class="w"> </span>민감한<span class="w"> </span>데이터<span class="w"> </span><span class="ss">(</span>캐싱<span class="w"> </span>금지<span class="ss">)</span><span class="w">                               </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">  </span><span class="nv">Cache</span><span class="o">-</span><span class="nv">Control</span>:<span class="w"> </span><span class="nv">no</span><span class="o">-</span><span class="nv">store</span><span class="w">                                   </span>│<span class="w"> </span>│
│<span class="w">  </span>│<span class="w">                                                            </span>│<span class="w"> </span>│
│<span class="w">  </span>└────────────────────────────────────────────────────────────┘<span class="w"> </span>│
│<span class="w">                                                                  </span>│
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="6">6. 연습 문제<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="1_1">문제 1: 캐싱 전략 선택<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>다음 시나리오에 적합한 캐싱 패턴을 선택하고 이유를 설명하세요.</p>
<p>a) 읽기 위주 서비스 (읽기:쓰기 = 100:1)
b) 쓰기가 많은 로그 시스템
c) 강한 일관성이 필요한 재고 관리
d) 간단한 웹 애플리케이션</p>
<h3 id="2-ttl">문제 2: TTL 설정<a class="header-link" href="#2-ttl" title="Permanent link">&para;</a></h3>
<p>다음 데이터에 적절한 TTL을 설정하세요.</p>
<p>a) 사용자 프로필 (하루에 몇 번 변경)
b) 상품 가격 (실시간 변동)
c) 국가 목록 (거의 변하지 않음)
d) 실시간 주식 가격</p>
<h3 id="3_1">문제 3: 캐시 문제 해결<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>다음 상황의 문제를 식별하고 해결책을 제시하세요.</p>
<p>상황: "매일 자정에 캐시가 모두 만료되어 서버가 느려집니다."</p>
<h3 id="4-cache-control">문제 4: Cache-Control 작성<a class="header-link" href="#4-cache-control" title="Permanent link">&para;</a></h3>
<p>다음 요구사항에 맞는 Cache-Control 헤더를 작성하세요.</p>
<p>a) 정적 이미지 (버전 포함 URL, 1년 캐싱)
b) API 응답 (CDN 10분, 브라우저 1분)
c) 로그인 상태 확인 API (캐싱 금지)</p>
<hr />
<h2 id="_4">정답<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="1_2">문제 1 정답<a class="header-link" href="#1_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>a) 읽기 위주 서비스: Cache-Aside
   - 읽기 시 캐시 우선 조회
   - 캐시 미스 시 DB 조회 후 캐싱
   - 읽기 최적화에 적합

b) 쓰기가 많은 로그 시스템: Write-Behind
   - 캐시에 빠르게 쓰고 응답
   - 배치로 DB에 저장
   - 쓰기 성능 극대화

c) 강한 일관성 재고 관리: Write-Through
   - 캐시와 DB 동시 업데이트
   - 항상 일관된 재고 수량
   - 과판매 방지

d) 간단한 웹 애플리케이션: Cache-Aside
   - 구현 단순
   - 캐시 장애 시에도 DB로 동작
   - 가장 범용적
</code></pre></div>

<h3 id="2_1">문제 2 정답<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>a) 사용자 프로필: 1-4시간
   - 변경 빈도 낮음
   - 명시적 무효화와 함께 사용

b) 상품 가격: 1-5분 또는 캐싱 안 함
   - 가격 정확성 중요
   - 짧은 TTL 또는 이벤트 기반 무효화

c) 국가 목록: 24시간 ~ 7일
   - 거의 변하지 않음
   - 긴 TTL로 캐시 효율 극대화

d) 실시간 주식 가격: 캐싱하지 않음
   - 실시간성이 중요
   - 오래된 데이터는 위험
</code></pre></div>

<h3 id="3_2">문제 3 정답<a class="header-link" href="#3_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">문제</span><span class="o">:</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">눈사태</span><span class="w"> </span><span class="o">(</span><span class="n">Cache</span><span class="w"> </span><span class="n">Avalanche</span><span class="o">)</span>
<span class="w">      </span><span class="err">모든</span><span class="w"> </span><span class="err">캐시가</span><span class="w"> </span><span class="err">자정에</span><span class="w"> </span><span class="err">동시</span><span class="w"> </span><span class="err">만료</span>

<span class="err">해결책</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="n">Jitter</span>
<span class="w">   </span><span class="n">base_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">86400</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">24</span><span class="err">시간</span>
<span class="w">   </span><span class="n">jitter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="o">(-</span><span class="mi">3600</span><span class="o">,</span><span class="w"> </span><span class="mi">3600</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">±</span><span class="mi">1</span><span class="err">시간</span>
<span class="w">   </span><span class="n">ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_ttl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">jitter</span>

<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">워밍</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">자정</span><span class="w"> </span><span class="err">전에</span><span class="w"> </span><span class="err">백그라운드에서</span><span class="w"> </span><span class="err">갱신</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">만료</span><span class="w"> </span><span class="mi">1</span><span class="err">시간</span><span class="w"> </span><span class="err">전에</span><span class="w"> </span><span class="err">미리</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="err">조회</span>

<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Stale</span><span class="o">-</span><span class="n">While</span><span class="o">-</span><span class="n">Revalidate</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">오래된</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">서빙하면서</span><span class="w"> </span><span class="err">비동기</span><span class="w"> </span><span class="err">갱신</span>

<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">갱신</span><span class="w"> </span><span class="err">분산</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">항목별로</span><span class="w"> </span><span class="err">다른</span><span class="w"> </span><span class="err">시간에</span><span class="w"> </span><span class="err">캐싱</span>
</code></pre></div>

<h3 id="4_1">문제 4 정답<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>a) 정적 이미지 (버전 포함)
   Cache-Control: public, max-age=31536000, immutable

b) API 응답
   Cache-Control: public, max-age=60, s-maxage=600

c) 로그인 상태 API
   Cache-Control: no-store
   (또는: Cache-Control: private, no-cache)
</code></pre></div>

<hr />
<h2 id="7">7. 다음 단계<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<p>캐싱 전략을 이해했다면, 분산 캐시 시스템을 학습하세요.</p>
<h3 id="_5">다음 레슨<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="./07_Distributed_Cache_Systems.md">07_Distributed_Cache_Systems.md</a></li>
</ul>
<h3 id="_6">관련 레슨<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="./05_Reverse_Proxy_API_Gateway.md">05_Reverse_Proxy_API_Gateway.md</a> - 프록시 캐싱</li>
</ul>
<h3 id="_7">추천 실습<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<ol>
<li>Redis에서 캐시 패턴 구현해보기</li>
<li>Nginx 캐싱 설정 실습</li>
<li>Cache-Control 헤더 테스트</li>
</ol>
<hr />
<h2 id="8">8. 참고 자료<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_8">문서<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://redis.io/docs/manual/client-side-caching/">Redis Caching</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching">HTTP Caching - MDN</a></li>
<li><a href="https://developers.cloudflare.com/cache/">Cloudflare Cache</a></li>
</ul>
<h3 id="_9">도구<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://redis.io/">Redis</a></li>
<li><a href="https://memcached.org/">Memcached</a></li>
<li><a href="https://varnish-cache.org/">Varnish Cache</a></li>
</ul>
<h3 id="_10">참고 자료<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://aws.amazon.com/caching/best-practices/">Caching Strategies</a></li>
</ul>
<hr />
<p><strong>문서 정보</strong>
- 최종 수정: 2024년
- 난이도: ⭐⭐⭐
- 예상 학습 시간: 2-3시간</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/System_Design/05_Reverse_Proxy_API_Gateway.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">리버스 프록시와 API 게이트웨이</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/System_Design/07_Distributed_Cache_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">분산 캐시 시스템</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}